#+TITLE: RNA-seq Report
#+OPTIONS:  H:4 ^:nil
#+SETUPFILE: https://fniessen.github.io/org-html-themes/setup/theme-bigblow.setup
#+HTML_HEAD: <style> #content{max-width:1800px;}</style>
#+HTML_HEAD: <style> p{max-width:800px;}</style>
#+HTML_HEAD: <style> li{max-width:800px;}</style>

#+INCLUDE: "./chapter1.org" :minlevel 1

* General helper functions

** Making nice tables

#+BEGIN_SRC ipython :session
  import tabulate
  import IPython

  class OrgFormatter(IPython.core.formatters.BaseFormatter):
      format_type = IPython.core.formatters.Unicode('text/org')
      print_method = IPython.core.formatters.ObjectName('_repr_org_')

  def pd_dataframe_to_org(df):
      return tabulate.tabulate(df, headers='keys', tablefmt='orgtbl', showindex='always')

  ip = get_ipython()
  ip.display_formatter.formatters['text/org'] = OrgFormatter()

  f = ip.display_formatter.formatters['text/org']
  f.for_type_by_name('pandas.core.frame', 'DataFrame', pd_dataframe_to_org)
#+END_SRC

#+RESULTS:
:RESULTS:
# Out [129]:
:END:


** Excel reader and loading count data
#+BEGIN_SRC ipython :session :display text/org :tangle recursive_feature.py
  import pandas as pd
  import warnings
  warnings.filterwarnings('ignore')


  def read_xl(fn="/Users/nathan/PHD/Transcripts/Data/diff_from_col0:False_onlyDiff:False.xlsx"):
      xl = pd.ExcelFile(fn)
      sheet_names = xl.sheet_names
      dfs = []
      for s in sheet_names:
          d = xl.parse(s)
          d['sample'] = s.split("|")[0].replace(" ", "")
          dfs.append(d)

      DE = pd.concat(dfs)
      DE = DE.rename_axis('gene').sort_values(by=['gene', 'log2FoldChange'],
                                              ascending=[False, False])
      return DE

  counts = pd.read_csv(
      "/Users/hughesn/PHD/Transcripts/Data/norml_count_data.csv",index_col=0)
  counts[[c for c in counts.columns if 'cer_c' in c]].head(5)
#+END_SRC

#+RESULTS:
:RESULTS:
# Out [130]:
# text/org
|           |   cer_c_05h_a37 |   cer_c_05h_b38 |   cer_c_05h_c39 |   cer_c_6h_a85 |   cer_c_6h_b86 |   cer_c_6h_c87 |
|-----------+-----------------+-----------------+-----------------+----------------+----------------+----------------|
| AT1G01010 |         7.65333 |         7.73449 |         7.5679  |        7.63575 |        7.62055 |        7.81064 |
| AT1G01020 |         7.93999 |         7.79909 |         7.79347 |        7.95616 |        7.924   |        7.88399 |
| AT1G01030 |         7.27285 |         7.09544 |         7.00389 |        6.88372 |        6.72014 |        6.58998 |
| AT1G01040 |         9.16837 |         9.09566 |         9.13567 |        9.05724 |        9.0856  |        9.21304 |
| AT1G01050 |         9.825   |         9.80514 |         9.76124 |        9.82781 |        9.91565 |        9.77211 |
:END:

** Gprofiler function
#+BEGIN_SRC ipython :tangle analysis_from_wb.py :session :display text/org :tangle recursive_feature.py
  from gprofiler import GProfiler

  def get_gene_names(geneList):

      gp = GProfiler(return_dataframe=True)
      df = gp.convert(organism='athaliana',
                 query=geneList)[['incoming', 'name', 'description']]
      df['description'] = df.apply(lambda x: x['description'].split('[')[0].split(';')[0], axis=1)
      return df
  get_gene_names(list(counts.head(5).index))
#+END_SRC

#+RESULTS:
:RESULTS:
# Out [131]:
# text/org
|    | incoming   | name   | description                                    |
|----+------------+--------+------------------------------------------------|
|  0 | AT1G01010  | NAC001 | NAC domain-containing protein 1                |
|  1 | AT1G01020  | ARV1   | ARV1 family protein                            |
|  2 | AT1G01030  | NGA3   | B3 domain-containing transcription factor NGA3 |
|  3 | AT1G01040  | DCL1   | Dicer-like 1                                   |
|  4 | AT1G01050  | PPA1   | Soluble inorganic pyrophosphatase 1            |
:END:


** Misc plotting functions

#+BEGIN_SRC ipython :session
  def get_locs(DE, n, include_large=True, include_small=True):
      samples = DE['sample'].unique()
      locs = []
      for idx, s in enumerate(samples):
          if include_large:
              l1 = DE[DE['sample'] == s][['log2FoldChange']].groupby(['gene']).sum().sort_values(by='log2FoldChange',
                                                                                                 ascending=False).head(n).index.values
              locs.extend(l1)
          if include_small:
              l2 = DE[DE['sample'] == s][['log2FoldChange']].groupby(['gene']).sum().sort_values(by='log2FoldChange',
                                                                                                 ascending=True).head(n).index.values
              locs.extend(l2)
      locs = np.array(locs)
      return locs


  def make_clustermap_df_n_samples(DE, description='description', n=20, include_large=True, include_small=True):
      locs = get_locs(DE, n, include_large=include_large, include_small=include_small)
      top = DE.loc[locs]
      top = top.groupby(['sample', 'gene']).mean(
      ).reset_index().set_index('gene')
      top = top.pivot(columns='sample', values='log2FoldChange')
      top['gene name'] = list(get_gene_names(
          list(top.index.values))[description])
      top = top.set_index('gene name')
      return top


  def make_two_clustermaps(df, n=20):
      top = make_clustermap_df_n_samples(df, n=n, include_small=False)
      bot = make_clustermap_df_n_samples(df, n=n, include_large=False)
      sns.clustermap(top, cmap='bwr', vmin=-10, vmax=10, yticklabels=True)
      sns.clustermap(bot, cmap='bwr', vmin=-10, vmax=10, yticklabels=True)

  def make_clustermap_table(df, n=20):
      top = make_clustermap_df_n_samples(df, n=n, include_small=False)
      bot = make_clustermap_df_n_samples(df, n=n, include_large=False)
      return pd.concat([top, bot])
#+END_SRC

#+RESULTS:
:RESULTS:
# Out [132]:
:END:

* Count Data

** Count data feature ranking

So it's worth noting that all expression profiles look similar, so choosing from 20k+ genes for being a key trait is not going to work.

#+BEGIN_SRC ipython :session :ipyfile '((:name "histo" :filename "obipy-resources/histo.png" :caption "Histogram of samples expression profile" :attr_html ":width 450px" :attsr_latex ":width 15cm"))
  import pandas as pd
  import matplotlib.pyplot as plt
  import seaborn as sns
  sns.set()
  counts = pd.read_csv(
      "/Users/hughesn/PHD/Transcripts/Data/norml_count_data.csv", index_col=0)

  filter_cols = [c for c in counts.columns if (
      c.startswith('col_w_6h') or c.startswith('col_c_6h'))]

  col_counts = counts[filter_cols]

  col_w_counts = col_counts[[c for c in col_counts.columns if '_w_' in c]]
  col_c_counts = col_counts[[c for c in col_counts.columns if '_c_' in c]]

  fig, ax = plt.subplots(1,3, sharex=True, sharey=True, figsize=(15,5))
  axes = iter(ax)
  for c,w in zip(col_c_counts.columns, col_w_counts.columns):
      a = next(axes)
      a.hist(col_c_counts[c], alpha=0.3)
      a.hist(col_w_counts[w], alpha=0.3)
#+END_SRC

#+RESULTS:
:RESULTS:
# Out [133]:
# text/plain
: <Figure size 1080x360 with 3 Axes>

# image/png
#+attr_html: :width 450px
#+caption: Histogram of samples expression profile
#+name: histo
[[file:obipy-resources/histo.png]]
:END:


*** Specifically grouped genes to test with random forest
**** Grouped by counts
     /N.B. doesn't work well/

#+BEGIN_SRC ipython :session
  import jenkspy
  from sklearn.ensemble import RandomForestClassifier
  from sklearn.model_selection import train_test_split
  import numpy as np
  import time

  col0 = counts[[c for c in counts.columns if c.startswith('col_w_05h')]].mean(axis=1).sort_values()
  col0A = np.array(col0)
  breaks = jenkspy.jenks_breaks(col0A, nb_class=20)

  col0_index = pd.Index(col0)

  indices = []
  for b in breaks:
      r = col0_index.get_loc(b)
      if isinstance(r, slice):
          r = r.stop
      indices.append(r)

  group_locs = [df.index for df in np.split(col0, indices)]

  cols = {}
  for c in counts.columns:
      avg_vals = []
      for g in group_locs:
          avg_vals.append(np.mean(counts[c].loc[g]))
      cols[c] = avg_vals
  refined_counts = pd.DataFrame(cols)
  refined_counts = refined_counts.set_index(pd.Index(["group {0}".format(i) for i in refined_counts.index]))



  subset = refined_counts[[c for c in refined_counts.columns if (c.startswith('col_w_05h') or c.startswith('col_c_05h')) ]]
  data = refined_counts.T
  data = data.reset_index()
  data['index'] = data['index'].apply(lambda x: x.rsplit('_',1)[0])
  data = data.set_index('index')
  feat_labels = data.columns

  t_start = time.time()
  X_train, X_test, y_train, y_test = train_test_split(data.values.T, feat_labels, test_size=0.33, random_state=42)
  forest = RandomForestClassifier(n_estimators=10000, random_state=0, n_jobs=-1)
  forest.fit(X_train, y_train)
  t_end = time.time()
  importances = forest.feature_importances_
  indices = np.argsort(importances)[::-1]

  for feature in sorted(zip(feat_labels, forest.feature_importances_), key=lambda x: x[1]):
      print(feature)

#+END_SRC

#+RESULTS:
:RESULTS:
# Out [134]:
# output
('group 19', 0.02673065440188904)
('group 0', 0.026805531708766744)
('group 8', 0.02693006569866829)
('group 7', 0.026945590365085717)
('group 11', 0.0273549621065065)
('group 14', 0.027445354116411903)
('group 13', 0.027541784964519728)
('group 12', 0.0277207993593499)
('group 5', 0.02775004237869988)
('group 15', 0.02779604871488358)
('group 3', 0.027869968213346162)
('group 17', 0.0279730082624969)
('group 6', 0.028066443188964892)
('group 21', 0.028163391058461162)
('group 2', 0.0281666759612335)
('group 10', 0.02826043573185192)
('group 20', 0.02829118692473585)
('group 4', 0.028328336739638103)
('group 16', 0.028503011380151832)
('group 1', 0.0287560048630577)
('group 9', 0.028834542073436394)
('group 18', 0.028910475534047003)

:END:




* 05hr c/w

These treatments are comparing the X axis to their water treatments, not to each other, selection is done with the 10 most upregulated genes from each 3 genotypes, and pooled together for reference across genotypes.
 The second heatmap is the same, only it is downregulated top 10 for each

#+BEGIN_SRC ipython :session
  DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
#+END_SRC

#+RESULTS:
:RESULTS:
# Out [135]:
:END:


** Clustermap of largest/smallest DE genes
#+BEGIN_SRC ipython :tangle analysis_from_wb.py :session
  import matplotlib.pyplot as plt
  import seaborn as sns
  import numpy as np
  %matplotlib inline
  make_two_clustermaps(DE_pairings_05hr, n=10)

#+END_SRC

#+RESULTS:
:RESULTS:
# Out [136]:
# text/plain
: <Figure size 720x720 with 4 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/384a5b8d1959576a2479e38efbe99e05746b2508.png]]

# text/plain
: <Figure size 720x720 with 4 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/2956fef86cdb7fef3f1fc0336577b42a633ba97f.png]]
:END:



** Boxplots of differential changes

    #+BEGIN_SRC ipython :tangle analysis_from_wb.py :session :ipyfile '((:name "pairings_05hr_boxplots" :filename "obipy-resources/pairings_05hr_boxplots.png" :caption "Boxplots of differential expressions from 50 largest (left) and 50 lowe05hst (right) DE genes" :attr_html ":width 850px" :attsr_latex ":width 15cm")) :exports results
    import matplotlib.pyplot as plt
    import seaborn as sns
    import numpy as np
    %matplotlib inline

    fig, ax = plt.subplots(1,2, sharex=True, sharey =True, figsize=(15,5))
    top = DE_pairings_05hr.groupby(['sample', 'gene']).mean().reset_index().set_index('gene')
    top_extracted = top.loc[get_locs(top, 50, include_small=False)]
    sns.boxplot(data=top_extracted, x='sample', y='log2FoldChange', ax=ax[0])


    bot = DE_pairings_05hr.groupby(['sample', 'gene']).mean().reset_index().set_index('gene')
    bot_extracted = bot.loc[get_locs(bot, 50, include_large=False)]
    sns.boxplot(data=bot_extracted, x='sample', y='log2FoldChange', ax=ax[1])


    #+END_SRC

    #+RESULTS:
    :RESULTS:
    # Out [137]:


    # text/plain
    : <Figure size 1080x360 with 2 Axes>

    # image/png
    #+attr_html: :width 850px
    #+caption: Boxplots of differential expressions from 50 largest (left) and 50 lowe05hst (right) DE genes
    #+name: pairings_05hr_boxplots
    [[file:obipy-resources/pairings_05hr_boxplots.png]]
    :END:


\clearpage

* 6hr c/w

These treatments are comparing the X axis to their water treatments, not to each other, selection is done with the 10 most upregulated genes from each 3 genotypes, and pooled together for reference across genotypes.
 The second heatmap is the same, only it is downregulated top 10 for each

#+BEGIN_SRC ipython :session
  DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
#+END_SRC

#+RESULTS:
:RESULTS:
# Out [138]:
:END:

** Clustermap of largest/smallest DE genes
#+BEGIN_SRC ipython :tangle analysis_from_wb.py :session
  import matplotlib.pyplot as plt
  import seaborn as sns
  import numpy as np
  %matplotlib inline

  make_two_clustermaps(DE_pairings_6hr, n=10)


#+END_SRC

#+RESULTS:
:RESULTS:
# Out [139]:
# text/plain
: <Figure size 720x720 with 4 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/27053162e46c053828971bef81d956b3f7e9a490.png]]

# text/plain
: <Figure size 720x720 with 4 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/ed937ebb166b8ea42a903209e3e5a97e82123a59.png]]
:END:

** Boxplots of differential changes

    #+BEGIN_SRC ipython :tangle analysis_from_wb.py :session :ipyfile '((:name "pairings_6hr_boxplots" :filename "obipy-resources/pairings_6hr_boxplots.png" :caption "Boxplots of differential expressions from 50 largest (left) and 50 lowest (right) DE genes" :attr_html ":width 850px" :attsr_latex ":width 15cm")) :exports results
    import matplotlib.pyplot as plt
    import seaborn as sns
    import numpy as np
    %matplotlib inline

    fig, ax = plt.subplots(1,2, sharex=True, sharey =True, figsize=(15,5))
    top = DE_pairings_6hr.groupby(['sample', 'gene']).mean().reset_index().set_index('gene')
    top_extracted = top.loc[get_locs(top, 50, include_small=False)]
    sns.boxplot(data=top_extracted, x='sample', y='log2FoldChange', ax=ax[0])


    bot = DE_pairings_6hr.groupby(['sample', 'gene']).mean().reset_index().set_index('gene')
    bot_extracted = bot.loc[get_locs(bot, 50, include_large=False)]
    sns.boxplot(data=bot_extracted, x='sample', y='log2FoldChange', ax=ax[1])


    #+END_SRC

    #+RESULTS:
    :RESULTS:
    # Out [140]:


    # text/plain
    : <Figure size 1080x360 with 2 Axes>

    # image/png
    #+attr_html: :width 850px
    #+caption: Boxplots of differential expressions from 50 largest (left) and 50 lowest (right) DE genes
    #+name: pairings_6hr_boxplots
    [[file:obipy-resources/pairings_6hr_boxplots.png]]
    :END:



\clearpage
* lym 05hr c/w

These treatments are comparing the X axis to their lym counter part. e.g. cer_w is compared to lym_w and col_c is compared to lym_c.

#+BEGIN_SRC ipython :session
  DE_pairings_to_lym_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_to_lym_05hr.xlsx')
#+END_SRC

#+RESULTS:
:RESULTS:
# Out [141]:
:END:

** Clustermap of largest/smallest DE genes
#+BEGIN_SRC ipython :tangle analysis_from_wb.py :session
  import matplotlib.pyplot as plt
  import seaborn as sns
  import numpy as np
  %matplotlib inline
  make_two_clustermaps(DE_pairings_to_lym_05hr, n=10)

#+END_SRC

#+RESULTS:
:RESULTS:
# Out [142]:
# text/plain
: <Figure size 720x720 with 4 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/38f963f596a7e16c887db5595838656510ce8ebd.png]]

# text/plain
: <Figure size 720x720 with 4 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/07b9050e44a77bc19a28abf0f99fd4b549ed974e.png]]
:END:

** Boxplots of differential changes

    #+BEGIN_SRC ipython :tangle analysis_from_wb.py :session :ipyfile '((:name "pairings_05hr_lym_boxplots" :filename "obipy-resources/pairings_05hr_lym_boxplots.png" :caption "Boxplots of differential expressions from 50 largest (left) and 50 lowest (right) DE genes" :attr_html ":width 850px" :attsr_latex ":width 15cm")) :exports results
    import matplotlib.pyplot as plt
    import seaborn as sns
    import numpy as np
    %matplotlib inline

    fig, ax = plt.subplots(1,2, sharex=True, sharey =True, figsize=(15,5))
    top = DE_pairings_to_lym_05hr.groupby(['sample', 'gene']).mean().reset_index().set_index('gene')
    top_extracted = top.loc[get_locs(top, 50, include_small=False)]
    sns.boxplot(data=top_extracted, x='sample', y='log2FoldChange', ax=ax[0])


    bot = DE_pairings_to_lym_05hr.groupby(['sample', 'gene']).mean().reset_index().set_index('gene')
    bot_extracted = bot.loc[get_locs(bot, 50, include_large=False)]
    sns.boxplot(data=bot_extracted, x='sample', y='log2FoldChange', ax=ax[1])


    #+END_SRC

    #+RESULTS:
    :RESULTS:
    # Out [143]:


    # text/plain
    : <Figure size 1080x360 with 2 Axes>

    # image/png
    #+attr_html: :width 850px
    #+caption: Boxplots of differential expressions from 50 largest (left) and 50 lowest (right) DE genes
    #+name: pairings_05hr_lym_boxplots
    [[file:obipy-resources/pairings_05hr_lym_boxplots.png]]
    :END:


\clearpage
* lym 6hr c/w

These treatments are comparing the X axis to their lym counter part. e.g. cer_w is compared to lym_w and col_c is compared to lym_c.
#+BEGIN_SRC ipython :session
  DE_pairings_to_lym_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_to_lym_6hr.xlsx')
#+END_SRC

#+RESULTS:
:RESULTS:
# Out [144]:
:END:


** Clustermap of largest/smallest DE genes
#+BEGIN_SRC ipython :tangle analysis_from_wb.py :session
  import matplotlib.pyplot as plt
  import seaborn as sns
  import numpy as np
  %matplotlib inline

  make_two_clustermaps(DE_pairings_to_lym_6hr, n=10)



#+END_SRC

#+RESULTS:
:RESULTS:
# Out [145]:
# text/plain
: <Figure size 720x720 with 4 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/81329caccb22c1c5c10dbdc8f02fd586f0fd377e.png]]

# text/plain
: <Figure size 720x720 with 4 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/a7398d39fd79f29f417ae53d41924aee2c280281.png]]
:END:


** Boxplots of differential changes

    #+BEGIN_SRC ipython :tangle analysis_from_wb.py :session :ipyfile '((:name "pairings_6hr_lym_boxplots" :filename "obipy-resources/pairings_6hr_lym_boxplots.png" :caption "Boxplots of differential expressions from 50 largest (left) and 50 lowest (right) DE genes" :attr_html ":width 850px" :attsr_latex ":width 15cm")) :exports results
    import matplotlib.pyplot as plt
    import seaborn as sns
    import numpy as np
    %matplotlib inline

    fig, ax = plt.subplots(1,2, sharex=True, sharey =True, figsize=(15,5))
    top = DE_pairings_6hr.groupby(['sample', 'gene']).mean().reset_index().set_index('gene')
    top_extracted = top.loc[get_locs(top, 50, include_small=False)]
    sns.boxplot(data=top_extracted, x='sample', y='log2FoldChange', ax=ax[0])


    bot = DE_pairings_6hr.groupby(['sample', 'gene']).mean().reset_index().set_index('gene')
    bot_extracted = bot.loc[get_locs(bot, 50, include_large=False)]
    sns.boxplot(data=bot_extracted, x='sample', y='log2FoldChange', ax=ax[1])


    #+END_SRC

    #+RESULTS:
    :RESULTS:
    # Out [146]:


    # text/plain
    : <Figure size 1080x360 with 2 Axes>

    # image/png
    #+attr_html: :width 850px
    #+caption: Boxplots of differential expressions from 50 largest (left) and 50 lowest (right) DE genes
    #+name: pairings_6hr_lym_boxplots
    [[file:obipy-resources/pairings_6hr_lym_boxplots.png]]
    :END:


\clearpage
* all genotypes across time

Here these figures show the change for each treatment from it's 30min (05hr) to their 6hr counterpart.

#+BEGIN_SRC ipython :session
  DE_cross_time_pairings = read_xl('/Users/hughesn/PHD/Transcripts/Data/cross_time_pairings.xlsx')
#+END_SRC

#+RESULTS:
:RESULTS:
# Out [147]:
:END:


** Clustermap of largest/smallest DE genes
#+BEGIN_SRC ipython :tangle analysis_from_wb.py :session
  import matplotlib.pyplot as plt
  import seaborn as sns
  import numpy as np
  %matplotlib inline

  make_two_clustermaps(DE_cross_time_pairings, n=10)

#+END_SRC

#+RESULTS:
:RESULTS:
# Out [148]:
# text/plain
: <Figure size 720x720 with 4 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/e92555b69f4f07ec2b3f8e711ed88b8dbe17c687.png]]

# text/plain
: <Figure size 720x720 with 4 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/5606a8e491c69602ebc3199c1d72599041052d72.png]]
:END:


** Boxplots of differential changes

   #+BEGIN_SRC ipython :tangle analysis_from_wb.py :session :ipyfile '((:name "pairings_timings_boxplots" :filename "obipy-resources/pairings_timingsr_boxplots.png" :caption "Boxplots of differential expressions from 50 largest (left) and 50 lowest (right) DE genes" :attr_html ":width 850px" :attsr_latex ":width 15cm")) :exports results
   import matplotlib.pyplot as plt
   import seaborn as sns
   import numpy as np
   %matplotlib inline

   fig, ax = plt.subplots(1,2, sharex=True, sharey =True, figsize=(15,5))
   top = DE_cross_time_pairings.groupby(['sample', 'gene']).mean().reset_index().set_index('gene')
   top_extracted = top.loc[get_locs(top, 50, include_small=False)]
   sns.boxplot(data=top_extracted, x='sample', y='log2FoldChange', ax=ax[0])


   bot = DE_cross_time_pairings.groupby(['sample', 'gene']).mean().reset_index().set_index('gene')
   bot_extracted = bot.loc[get_locs(bot, 50, include_large=False)]
   sns.boxplot(data=bot_extracted, x='sample', y='log2FoldChange', ax=ax[1])


   #+END_SRC

   #+RESULTS:
   :RESULTS:
   # Out [149]:


   # text/plain
   : <Figure size 1080x360 with 2 Axes>

   # image/png
   #+attr_html: :width 850px
   #+caption: Boxplots of differential expressions from 50 largest (left) and 50 lowest (right) DE genes
   #+name: pairings_timings_boxplots
   [[file:obipy-resources/pairings_timingsr_boxplots.png]]
   :END:

** Lineplots of changes between samples for genes of interest

These lineplots are looking at the rate of change between the each sample's most up/down regulated genes (top 5 for each genotype/sample).

#+BEGIN_SRC ipython :session
  import matplotlib.pyplot as plt
  import seaborn as sns
  import numpy as np
  DE_cross_time_pairings = read_xl('/Users/hughesn/PHD/Transcripts/Data/cross_time_pairings.xlsx')

  def get_linedata(time_pair_df, n=5, include_large=True, include_small=True):
      top = time_pair_df.groupby(
          ['sample', 'gene']).mean().reset_index().set_index('gene')
      locs = get_locs(top, n, include_large=include_large,
                      include_small=include_small)
      tc = counts.loc[locs]
      tc = tc.T.reset_index()
      tc['sample'] = tc['index'].apply(lambda x: str(x).rsplit('_', 1)[0])
      tc = tc.set_index('index')
      tc = tc.reset_index().melt(id_vars=['index', 'sample'])
      tc.rename(columns={'index': 'id'}, inplace=True)
      tc['time'] = tc['sample'].apply(lambda x: str(x).rsplit('_', 1)[-1])
      tc['treatment'] = tc['id'].apply(lambda x: str(x).split('_')[1])
      tc['geno'] = tc['id'].apply(lambda x: str(x).split('_')[0])
      tc['sample'] = tc['sample'].apply(lambda x: str(x)[:5])
      return tc


  def generate_plots_method_2(df):
      for s in df['sample'].unique():
          tdf = get_linedata(df[df['sample'] == s], include_small=False, include_large=True)
          fig, axes = plt.subplots(
              2, len(tdf['variable'].unique()), figsize=(20,10))
          j = -1
          for v in tdf['variable'].unique():
              i = 1
              j = j+1

              sns.lineplot(data=tdf[tdf['variable']==v], x='time', y='value', err_style="bars",
                           hue='geno', style="treatment", ax=axes[i, j], legend=False)
              axes[i, j].set_title(v)

          tdf = get_linedata(df[df['sample'] == s], include_small=True, include_large=False)
          j = -1
          for  v in tdf['variable'].unique():
              i = 0
              j = j+1
              if j+1 == len(tdf['variable'].unique()):
                  sns.lineplot(data=tdf[tdf['variable']==v], x='time', y='value', err_style="bars",
                               hue='geno', style="treatment", ax=axes[i, j])
              else:
                  sns.lineplot(data=tdf[tdf['variable']==v], x='time', y='value', err_style="bars",
                               hue='geno', style="treatment", ax=axes[i, j], legend=False)
              axes[i, j].set_title(v)

          fig.suptitle("Largest upreg (top row) and downreg (bottom row) DE genes for sample{0}".format(s))
  generate_plots_method_2(DE_cross_time_pairings)
#+END_SRC

#+RESULTS:
:RESULTS:
# Out [150]:
# text/plain
: <Figure size 1440x720 with 10 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/2e1dcdd476268fa47acba4442cf4062685d3139d.png]]

# text/plain
: <Figure size 1440x720 with 10 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/ed7878489b5bbff80688c7060b2971a1bd60819f.png]]

# text/plain
: <Figure size 1440x720 with 10 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/0805b9264e8195cc516bdcaf83864078969dc75a.png]]

# text/plain
: <Figure size 1440x720 with 10 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/8b57079270a2e48588aa55d8e02c6651fe7b127e.png]]

# text/plain
: <Figure size 1440x720 with 10 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/0b103b5da66d0203307c2aa52ed83582444394ce.png]]

# text/plain
: <Figure size 1440x720 with 10 Axes>

# image/png
[[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/544b67ff3a90a381b5fd6de277e9a9107f810e2e.png]]
:END:


** Checking up and down data's largest

#+BEGIN_SRC ipython :session :display text/org
  DE_cross_time_pairings = read_xl('/Users/hughesn/PHD/Transcripts/Data/cross_time_pairings.xlsx')
  n = 5
  df = DE_cross_time_pairings
  s = list(df['sample'].unique())[0]
  #tdf =  get_linedata(df[df['sample'] == s], include_small=True, include_large=False)
  #tdf.head(10)

  df = df[df['sample'] == s]
  top = df.groupby(
      ['sample', 'gene']).mean().reset_index().set_index('gene')
  locs = get_locs(top, n, include_large=True,
                  include_small=False)
  top=top.loc[locs]
  bot = df.groupby(
      ['sample', 'gene']).mean().reset_index().set_index('gene')
  locs = get_locs(bot, n, include_large=False,
                  include_small=True)
  bot=bot.loc[locs]
  top_and_bot = pd.concat([top, bot])
  filter_cols = [c for c in counts if (c.startswith(s) or c.startswith(s.replace('05h', '6h')))]
  pd.merge(top_and_bot, counts[filter_cols], left_index=True, right_index=True)

#+END_SRC

#+RESULTS:
:RESULTS:
# Out [151]:
# text/org
|           | sample    |   baseMean |   log2FoldChange |    lfcSE |      stat |      pvalue |        padj |   lym_c_05h_a21 |   lym_c_05h_b22 |   lym_c_05h_c23 |   lym_c_6h_a69 |   lym_c_6h_b70 |   lym_c_6h_d72 |
|-----------+-----------+------------+------------------+----------+-----------+-------------+-------------+-----------------+-----------------+-----------------+----------------+----------------+----------------|
| AT5G11140 | lym_c_05h |   193.93   |          8.02627 | 0.302206 |  14.2693  | 3.39885e-46 | 1.77167e-44 |        10.0746  |        10.0683  |        10.2896  |        5.94226 |        5.60783 |        5.91306 |
| AT3G01165 | lym_c_05h |   199.868  |          7.47067 | 0.29057  |  17.4156  | 6.27809e-68 | 4.93084e-66 |        10.2797  |         9.96508 |        10.3646  |        6.07973 |        5.86799 |        5.91306 |
| AT1G07160 | lym_c_05h |   489.663  |          7.27727 | 0.303962 |  20.531   | 1.13789e-93 | 1.42224e-91 |        11.4944  |        11.4053  |        11.551   |        6.15194 |        6.15713 |        6.21495 |
| AT4G31950 | lym_c_05h |    62.134  |          7.24523 | 0.333259 |   9.31583 | 1.21003e-20 | 3.04446e-19 |         9.02695 |         8.85273 |         8.77664 |        5.60783 |        5.60783 |        5.60783 |
| AT1G05767 | lym_c_05h |    39.595  |          6.55168 | 0.344912 |   8.7192  | 2.80169e-18 | 6.36071e-17 |         8.51408 |         8.23432 |         8.45238 |        5.60783 |        5.60783 |        5.60783 |
| AT5G39120 | lym_c_05h |   134.311  |         -3.77404 | 0.244364 | -14.8739  | 4.87108e-50 | 2.76202e-48 |         6.81626 |         6.77907 |         6.72882 |        9.37176 |        9.16792 |        9.66175 |
| AT1G31173 | lym_c_05h |    29.224  |         -3.17483 | 0.344681 |  -6.50649 | 7.69248e-11 | 1.12916e-09 |         5.60783 |         5.60783 |         5.60783 |        7.04642 |        6.68769 |        7.24795 |
| AT3G09275 | lym_c_05h |   529.907  |         -3.09702 | 0.18082  | -16.9667  | 1.44802e-64 | 1.0586e-62  |         7.48199 |         7.25206 |         6.99692 |        9.38704 |        9.70817 |        9.78729 |
| AT1G49205 | lym_c_05h |    37.8818 |         -3.00666 | 0.326604 |  -7.27043 | 3.5835e-13  | 6.1802e-12  |         5.84268 |         5.60783 |         6.10935 |        6.98954 |        7.20347 |        7.17624 |
| AT5G61590 | lym_c_05h |   467.208  |         -2.92774 | 0.178787 | -16.2392  | 2.66458e-59 | 1.78006e-57 |         7.05217 |         7.5295  |         7.21094 |        9.33478 |        9.62606 |        9.63805 |
:END:





* Selecting genes for Col0 at 05hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [152]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [153]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [3979 3219 1982 ... 4050 2573 5809]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [154]:
 # text/org
 |    | incoming   | name      | description                                          |
 |----+------------+-----------+------------------------------------------------------|
 |  0 | AT1G68520  | COL6      | Zinc finger protein CONSTANS-LIKE 6                  |
 |  1 | AT5G25350  | EBF2      | EIN3-binding F-box protein 2                         |
 |  2 | AT2G37430  | ZAT11     | ZAT11                                                |
 |  3 | AT4G19700  | BOI       | E3 ubiquitin-protein ligase BOI                      |
 |  4 | AT3G09275  | AT3G09275 | None                                                 |
 |  5 | AT1G72520  | LOX4      | Lipoxygenase 4, chloroplastic                        |
 |  6 | AT3G59940  | SKIP20    | F-box/kelch-repeat protein SKIP20                    |
 |  7 | AT5G24110  | WRKY30    | Probable WRKY transcription factor 30                |
 |  8 | AT1G07160  | AT1G07160 | PP2C-type phosphatase AP2C2                          |
 |  9 | AT1G25440  | COL16     | Zinc finger protein CONSTANS-LIKE 16                 |
 | 10 | AT1G66090  | AT1G66090 | Disease resistance protein (TIR-NBS class)           |
 | 11 | AT2G18440  | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)             |
 | 12 | AT5G11140  | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein |
 | 13 | AT1G56242  | AT1G56242 | other RNA                                            |
 | 14 | AT2G21210  | AT2G21210 | SAUR-like auxin-responsive protein family            |
 | 15 | AT5G37260  | RVE2      | Protein REVEILLE 2                                   |
 | 16 | AT4G38840  | AT4G38840 | At4g38840                                            |
 | 17 | AT5G27420  | ATL31     | E3 ubiquitin-protein ligase ATL31                    |
 | 18 | AT1G56240  | PP2B13    | F-box protein PP2-B13                                |
 | 19 | AT5G47230  | ERF5      | ERF5                                                 |
 | 20 | AT5G60390  | A1        | Elongation factor 1-alpha 4                          |
 | 21 | AT5G61590  | ERF107    | Ethylene-responsive transcription factor ERF107      |
 | 22 | AT1G14540  | PER4      | Peroxidase                                           |
 | 23 | AT3G02840  | AT3G02840 | ARM repeat superfamily protein                       |
 | 24 | AT5G59780  | MYB59     | Transcription factor MYB59                           |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'col' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [155]:
 # text/org
 | gene      |   importance | name      | description                                          |
 |-----------+--------------+-----------+------------------------------------------------------|
 | AT2G18440 |      0.04035 | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)             |
 | AT2G21210 |      0.04005 | AT2G21210 | SAUR-like auxin-responsive protein family            |
 | AT3G59940 |      0.03895 | SKIP20    | F-box/kelch-repeat protein SKIP20                    |
 | AT4G38840 |      0.03825 | AT4G38840 | At4g38840                                            |
 | AT5G61590 |      0.03815 | ERF107    | Ethylene-responsive transcription factor ERF107      |
 | AT3G02840 |      0.0381  | AT3G02840 | ARM repeat superfamily protein                       |
 | AT5G37260 |      0.038   | RVE2      | Protein REVEILLE 2                                   |
 | AT1G14540 |      0.0378  | PER4      | Peroxidase                                           |
 | AT5G47230 |      0.0377  | ERF5      | ERF5                                                 |
 | AT1G68520 |      0.0376  | COL6      | Zinc finger protein CONSTANS-LIKE 6                  |
 | AT5G25350 |      0.03745 | EBF2      | EIN3-binding F-box protein 2                         |
 | AT1G66090 |      0.03725 | AT1G66090 | Disease resistance protein (TIR-NBS class)           |
 | AT5G11140 |      0.03705 | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein |
 | AT3G09275 |      0.03685 | AT3G09275 | None                                                 |
 | AT1G56242 |      0.0368  | AT1G56242 | other RNA                                            |
 | AT5G59780 |      0.0368  | MYB59     | Transcription factor MYB59                           |
 | AT1G56240 |      0.03675 | PP2B13    | F-box protein PP2-B13                                |
 | AT4G19700 |      0.03655 | BOI       | E3 ubiquitin-protein ligase BOI                      |
 | AT1G72520 |      0.0363  | LOX4      | Lipoxygenase 4, chloroplastic                        |
 | AT1G25440 |      0.03625 | COL16     | Zinc finger protein CONSTANS-LIKE 16                 |
 | AT1G07160 |      0.03585 | AT1G07160 | PP2C-type phosphatase AP2C2                          |
 | AT5G24110 |      0.03585 | WRKY30    | Probable WRKY transcription factor 30                |
 | AT5G27420 |      0.0355  | ATL31     | E3 ubiquitin-protein ligase ATL31                    |
 | AT2G37430 |      0.03495 | ZAT11     | ZAT11                                                |
 | AT5G60390 |      0.0178  | A1        | Elongation factor 1-alpha 4                          |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance', ax=ax)
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [156]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/9c0949ccb9db94210da0831756a3e74e9d48d98d.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [157]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [158]:
 # output
 Num Features: 250
 Selected Features: [False False False ... False False False]
 Feature Ranking: [3754 2994 1757 ... 3825 2348 5584]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [159]:
 # text/org
 |     | incoming   | name      | description                                                                       |
 |-----+------------+-----------+-----------------------------------------------------------------------------------|
 |   0 | AT5G57220  | CYP81F2   | Cytochrome P450 81F2                                                              |
 |   1 | AT1G68520  | COL6      | Zinc finger protein CONSTANS-LIKE 6                                               |
 |   2 | AT3G04840  | RPS3AA    | 40S ribosomal protein S3a-1                                                       |
 |   3 | AT5G52050  | DTX50     | Protein DETOXIFICATION 50                                                         |
 |   4 | AT2G44670  | FLZ3      | FCS-Like Zinc finger 3                                                            |
 |   5 | AT1G12820  | AFB3      | Protein AUXIN SIGNALING F-BOX 3                                                   |
 |   6 | AT2G23270  | AT2G23270 | At2g23270                                                                         |
 |   7 | AT5G59730  | ATEXO70H7 | Exocyst subunit Exo70 family protein                                              |
 |   8 | AT5G02760  | AT5G02760 | Probable protein phosphatase 2C 67                                                |
 |   9 | AT3G63200  | PLP9      | Probable inactive patatin-like protein 9                                          |
 |  10 | AT3G28340  | GATL10    | Hexosyltransferase (Fragment)                                                     |
 |  11 | AT1G69890  | AT1G69890 | Actin cross-linking protein (DUF569)                                              |
 |  12 | AT1G79110  | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                                |
 |  13 | AT2G40330  | PYL6      | Abscisic acid receptor PYL6                                                       |
 |  14 | AT2G41840  | RPS2C     | 40S ribosomal protein S2-3                                                        |
 |  15 | AT2G27820  | ADT3      | Arogenate dehydratase 3, chloroplastic                                            |
 |  16 | AT3G53460  | CP29      | Chloroplast RNA-binding protein 29                                                |
 |  17 | AT1G12090  | ELP       | ELP                                                                               |
 |  18 | AT5G49910  | HSP70-7   | Heat shock 70 kDa protein 7, chloroplastic                                        |
 |  19 | AT5G47850  | CCR4      | Serine/threonine-protein kinase-like protein CCR4                                 |
 |  20 | AT4G31950  | CYP82C3   | CYP82C3                                                                           |
 |  21 | AT4G16370  | ATOPT3    | oligopeptide transporter                                                          |
 |  22 | AT5G25350  | EBF2      | EIN3-binding F-box protein 2                                                      |
 |  23 | AT3G09260  | BGLU23    | PYK10                                                                             |
 |  24 | AT2G18020  | RPL8A     | EMB2296                                                                           |
 |  25 | AT1G57990  | PUP18     | PUP18                                                                             |
 |  26 | AT1G17147  | VQ1       | VQ motif-containing protein 1                                                     |
 |  27 | AT2G37430  | ZAT11     | ZAT11                                                                             |
 |  28 | AT5G15200  | RPS9B     | 40S ribosomal protein S9-1                                                        |
 |  29 | AT1G70600  | RPL27AC   | 60S ribosomal protein L27a-3                                                      |
 |  30 | AT4G16720  | RPL15A    | Ribosomal protein L15                                                             |
 |  31 | AT3G09630  | RPL4A     | 60S ribosomal protein L4-1                                                        |
 |  32 | AT3G23250  | MYB15     | Transcription factor MYB15                                                        |
 |  33 | AT4G19700  | BOI       | E3 ubiquitin-protein ligase BOI                                                   |
 |  34 | AT1G80840  | WRKY40    | Probable WRKY transcription factor 40                                             |
 |  35 | AT2G33580  | LYK5      | Protein LYK5                                                                      |
 |  36 | AT1G48300  | AT1G48300 | unknown protein                                                                   |
 |  37 | AT4G22710  | CYP706A2  | Cytochrome P450 - like protein                                                    |
 |  38 | AT2G35935  | AT2G35935 | None                                                                              |
 |  39 | AT3G09200  | RPP0B     | 60S acidic ribosomal protein P0-2                                                 |
 |  40 | AT5G03240  | UBQ3      | Ubiquitin 4                                                                       |
 |  41 | AT5G56030  | HSP81-2   | Heat shock protein 81-2                                                           |
 |  42 | AT1G74850  | PTAC2     | PTAC2                                                                             |
 |  43 | AT5G25250  | FLOT1     | Flotillin-like protein 1                                                          |
 |  44 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                                                    |
 |  45 | AT4G15975  | AT4G15975 | RING/U-box superfamily protein                                                    |
 |  46 | AT3G01165  | AT3G01165 | None                                                                              |
 |  47 | AT3G62870  | RPL7AB    | 60S ribosomal protein L7a-2                                                       |
 |  48 | AT1G56250  | VBF       | F-box protein VBF                                                                 |
 |  49 | AT4G23180  | CRK10     | Cysteine-rich receptor-like protein kinase 10                                     |
 |  50 | AT5G02500  | MED37E    | Probable mediator of RNA polymerase II transcription subunit 37e                  |
 |  51 | AT4G11470  | CRK31     | cysteine-rich RLK (RECEPTOR-like protein kinase) 31                               |
 |  52 | AT5G15870  | AT5G15870 | Glycosyl hydrolase family 81 protein                                              |
 |  53 | AT4G37370  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                            |
 |  54 | AT5G19240  | AT5G19240 | Uncharacterized GPI-anchored protein At5g19240                                    |
 |  55 | AT2G36690  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein           |
 |  56 | AT2G34480  | AT2G34480 | Ribosomal protein L18ae/LX family protein                                         |
 |  57 | AT1G61560  | MLO6      | MLO-like protein 6                                                                |
 |  58 | AT1G02780  | RPL19A    | 60S ribosomal protein L19-1                                                       |
 |  59 | AT1G78100  | AT1G78100 | AUF1                                                                              |
 |  60 | AT5G44680  | AT5G44680 | DNA glycosylase superfamily protein                                               |
 |  61 | AT3G53430  | RPL12B    | 60S ribosomal Protein L12-like                                                    |
 |  62 | AT1G73540  | NUDT21    | Nudix hydrolase 21, chloroplastic                                                 |
 |  63 | AT1G72910  | AT1G72910 | Similar to part of disease resistance protein                                     |
 |  64 | AT4G18197  | PUP7      | Probable purine permease 7                                                        |
 |  65 | AT5G67480  | BT4       | BTB and TAZ domain protein 4                                                      |
 |  66 | AT2G31345  | AT2G31345 | Transmembrane protein                                                             |
 |  67 | AT3G16420  | PBP1      | PYK10-binding protein 1                                                           |
 |  68 | AT1G80080  | TMM       | TMM                                                                               |
 |  69 | AT3G29000  | CML45     | Probable calcium-binding protein CML45                                            |
 |  70 | AT3G07195  | AT3G07195 | RPM1-interacting protein 4 (RIN4) family protein                                  |
 |  71 | AT1G17420  | LOX3      | Lipoxygenase 3, chloroplastic                                                     |
 |  72 | AT2G08475  | AT2G08475 | None                                                                              |
 |  73 | AT5G26742  | RH3       | RH3                                                                               |
 |  74 | AT5G25340  | AT5G25340 | Ubiquitin-like superfamily protein                                                |
 |  75 | AT1G69530  | ATEXPA1   | Expansin                                                                          |
 |  76 | AT3G09275  | AT3G09275 | None                                                                              |
 |  77 | AT1G20310  | AT1G20310 | Syringolide-induced protein                                                       |
 |  78 | AT5G26920  | CBP60G    | Calmodulin-binding protein 60 G                                                   |
 |  79 | AT4G22030  | AT4G22030 | F-box family protein with a domain of unknown function (DUF295)                   |
 |  80 | AT4G36648  | AT4G36648 | other RNA                                                                         |
 |  81 | AT2G25735  | AT2G25735 | Expressed protein                                                                 |
 |  82 | AT1G61340  | AT1G61340 | F-box protein At1g61340                                                           |
 |  83 | AT1G18080  | RACK1A    | RACK1A_AT                                                                         |
 |  84 | AT4G39260  | RBG8      | GRP8                                                                              |
 |  85 | AT1G68550  | ERF118    | Ethylene-responsive transcription factor ERF118                                   |
 |  86 | AT1G61360  | AT1G61360 | Serine/threonine-protein kinase                                                   |
 |  87 | AT1G24140  | 3MMP      | Metalloendoproteinase 3-MMP                                                       |
 |  88 | AT4G38620  | MYB4      | Transcription repressor MYB4                                                      |
 |  89 | AT5G44130  | FLA13     | Fasciclin-like arabinogalactan protein 13                                         |
 |  90 | AT2G24600  | AT2G24600 | Ankyrin repeat family protein                                                     |
 |  91 | AT2G10940  | AT2G10940 | At2g10940/F15K19.1                                                                |
 |  92 | AT3G46130  | ATMYB48   | myb domain protein 48                                                             |
 |  93 | AT2G47440  | AT2G47440 | Tetratricopeptide repeat (TPR)-like superfamily protein                           |
 |  94 | AT4G14370  | AT4G14370 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 |  95 | AT5G57760  | AT5G57760 | At5g57760                                                                         |
 |  96 | AT3G18710  | PUB29     | RING-type E3 ubiquitin transferase                                                |
 |  97 | AT5G59820  | ZAT12     | Zinc finger protein ZAT12                                                         |
 |  98 | AT3G25520  | ATL5      | RPL5A                                                                             |
 |  99 | AT4G02410  | LECRK43   | L-type lectin-domain containing receptor kinase IV.3                              |
 | 100 | AT4G36500  | AT4G36500 | Uncharacterized protein At4g36500                                                 |
 | 101 | AT1G72520  | LOX4      | Lipoxygenase 4, chloroplastic                                                     |
 | 102 | AT5G65310  | ATHB-5    | Homeobox-leucine zipper protein ATHB-5                                            |
 | 103 | AT5G05300  | AT5G05300 | Gb                                                                                |
 | 104 | AT1G78170  | AT1G78170 | E3 ubiquitin-protein ligase                                                       |
 | 105 | AT3G44260  | CAF1-9    | Probable CCR4-associated factor 1 homolog 9                                       |
 | 106 | AT3G03125  | AT3G03125 | None                                                                              |
 | 107 | AT1G05575  | AT1G05575 | Transmembrane protein                                                             |
 | 108 | AT1G72370  | RPSAA     | 40S ribosomal protein SA                                                          |
 | 109 | AT1G56070  | LOS1      | Elongation factor 2                                                               |
 | 110 | AT1G30370  | AT1G30370 | DLAH                                                                              |
 | 111 | AT5G13930  | CHS       | Chalcone synthase family protein                                                  |
 | 112 | AT2G23130  | AGP17     | Lysine-rich arabinogalactan protein 17                                            |
 | 113 | AT3G59940  | SKIP20    | F-box/kelch-repeat protein SKIP20                                                 |
 | 114 | AT1G65390  | PP2A5     | Protein PHLOEM PROTEIN 2-LIKE A5                                                  |
 | 115 | AT3G09500  | RPL35A    | 60S ribosomal protein L35-1                                                       |
 | 116 | AT3G10930  | AT3G10930 | Uncharacterized protein At3g10930                                                 |
 | 117 | AT5G02870  | RPL4D     | 60S ribosomal protein L4-2                                                        |
 | 118 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3                                          |
 | 119 | AT3G58120  | BZIP61    | BZIP61                                                                            |
 | 120 | AT4G17490  | ERF6      | Ethylene-responsive transcription factor 6                                        |
 | 121 | AT1G19020  | AT1G19020 | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                 |
 | 122 | AT2G38470  | WRKY33    | WRKY33                                                                            |
 | 123 | AT5G41750  | AT5G41750 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | 124 | AT5G24110  | WRKY30    | Probable WRKY transcription factor 30                                             |
 | 125 | AT3G50930  | HSR4      | Protein HYPER-SENSITIVITY-RELATED 4                                               |
 | 126 | AT5G01540  | LECRK62   | L-type lectin-domain containing receptor kinase VI.2                              |
 | 127 | AT1G21326  | AT1G21326 | F16F4.1 protein                                                                   |
 | 128 | AT1G07135  | AT1G07135 | At1g07135                                                                         |
 | 129 | AT5G28610  | AT5G28610 | LOW protein: ATP-dependent RNA helicase DRS1-like protein                         |
 | 130 | AT1G21120  | AT1G21120 | O-methyltransferase family protein                                                |
 | 131 | AT1G07160  | AT1G07160 | PP2C-type phosphatase AP2C2                                                       |
 | 132 | AT1G43170  | ARP1      | 60S ribosomal protein L3-1                                                        |
 | 133 | AT5G56010  | HSP90-3   | Heat shock protein 90-3                                                           |
 | 134 | AT4G37540  | LBD39     | LOB domain-containing protein 39                                                  |
 | 135 | AT5G25280  | AT5G25280 | AT5g25280/F18G18_20                                                               |
 | 136 | AT4G23220  | CRK14     | Cysteine-rich receptor-like protein kinase 14                                     |
 | 137 | AT1G25440  | COL16     | Zinc finger protein CONSTANS-LIKE 16                                              |
 | 138 | AT4G17390  | RPL15B    | 60S ribosomal protein L15-2                                                       |
 | 139 | AT4G23810  | WRKY53    | Probable WRKY transcription factor 53                                             |
 | 140 | AT4G27280  | KRP1      | Calcium-binding protein KRP1                                                      |
 | 141 | AT5G41740  | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | 142 | AT1G50040  | AT1G50040 | F2J10.8 protein                                                                   |
 | 143 | AT5G01542  | AT5G01542 | Potential natural antisense gene, locus overlaps with AT5G01540                   |
 | 144 | AT1G66090  | AT1G66090 | Disease resistance protein (TIR-NBS class)                                        |
 | 145 | AT2G18440  | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)                                          |
 | 146 | AT5G22250  | CAF1-11   | Probable CCR4-associated factor 1 homolog 11                                      |
 | 147 | AT1G09780  | PGM1      | IPGAM1                                                                            |
 | 148 | AT5G61600  | ERF104    | Ethylene-responsive transcription factor ERF104                                   |
 | 149 | AT3G49010  | RPL13B    | 60S ribosomal protein L13-1                                                       |
 | 150 | AT5G20290  | RPS8A     | 40S ribosomal protein S8                                                          |
 | 151 | AT5G11140  | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                              |
 | 152 | AT1G67430  | RPL17B    | 60S ribosomal protein L17-2                                                       |
 | 153 | AT3G55980  | SZF1      | Salt-inducible zinc finger 1                                                      |
 | 154 | AT4G01250  | WRKY22    | WRKY transcription factor 22                                                      |
 | 155 | AT4G34950  | AT4G34950 | Major facilitator superfamily protein                                             |
 | 156 | AT2G26530  | AR781     | AR781                                                                             |
 | 157 | AT5G18380  | RPS16C    | 40S ribosomal protein S16-3                                                       |
 | 158 | AT1G56242  | AT1G56242 | other RNA                                                                         |
 | 159 | AT1G13930  | AT1G13930 | At1g13930/F16A14.27                                                               |
 | 160 | AT3G05590  | RPL18B    | RPL18                                                                             |
 | 161 | AT2G38310  | PYL4      | Abscisic acid receptor PYL4                                                       |
 | 162 | AT2G21210  | AT2G21210 | SAUR-like auxin-responsive protein family                                         |
 | 163 | AT2G40000  | HSPRO2    | Nematode resistance protein-like HSPRO2                                           |
 | 164 | AT1G18540  | RPL6A     | 60S ribosomal protein L6-1                                                        |
 | 165 | AT3G22121  | AT3G22121 | other RNA                                                                         |
 | 166 | AT3G53870  | RPS3B     | 40S ribosomal protein S3-2                                                        |
 | 167 | AT5G37260  | RVE2      | Protein REVEILLE 2                                                                |
 | 168 | AT3G19680  | AT3G19680 | Uncharacterized protein At3g19680                                                 |
 | 169 | AT4G38840  | AT4G38840 | At4g38840                                                                         |
 | 170 | AT1G58420  | AT1G58420 | At1g58420                                                                         |
 | 171 | AT5G20230  | BCB       | SAG14                                                                             |
 | 172 | AT5G64905  | PEP3      | Elicitor peptide 3                                                                |
 | 173 | AT1G27730  | ZAT10     | Zinc finger protein ZAT10                                                         |
 | 174 | AT5G42380  | CML37     | Calcium-binding protein CML37                                                     |
 | 175 | AT3G52400  | SYP122    | Syntaxin-122                                                                      |
 | 176 | AT1G09690  | RPL21A    | 60S ribosomal protein L21-1                                                       |
 | 177 | AT1G50750  | AT1G50750 | Plant mobile domain protein family                                                |
 | 178 | AT1G19770  | PUP14     | PUP14                                                                             |
 | 179 | AT3G62980  | TIR1      | TIR1                                                                              |
 | 180 | AT5G15845  | AT5G15845 | other RNA                                                                         |
 | 181 | AT5G27420  | ATL31     | E3 ubiquitin-protein ligase ATL31                                                 |
 | 182 | AT2G36530  | ENO2      | LOS2                                                                              |
 | 183 | AT1G79680  | WAKL10    | Wall-associated receptor kinase-like 10                                           |
 | 184 | AT3G60245  | RPL37AC   | 60S ribosomal protein L37a-2                                                      |
 | 185 | AT1G56240  | PP2B13    | F-box protein PP2-B13                                                             |
 | 186 | AT2G40140  | CZF1      | Zinc finger CCCH domain-containing protein 29                                     |
 | 187 | AT3G04400  | RPL23A    | 60S ribosomal protein L23                                                         |
 | 188 | AT2G44840  | ERF13     | Ethylene-responsive transcription factor 13                                       |
 | 189 | AT2G01180  | ATPAP1    | phosphatidic acid phosphatase 1                                                   |
 | 190 | AT1G78080  | RAP2-4    | Ethylene-responsive transcription factor RAP2-4                                   |
 | 191 | AT2G21660  | RBG7      | Glycine-rich RNA-binding protein 7                                                |
 | 192 | AT2G36090  | AT2G36090 | Probable F-box protein At2g36090                                                  |
 | 193 | AT5G51190  | ERF105    | Ethylene-responsive transcription factor ERF105                                   |
 | 194 | AT2G43340  | AT2G43340 | At2g43340                                                                         |
 | 195 | AT2G45180  | AT2G45180 | At2g45180/T14P1.1                                                                 |
 | 196 | AT4G34760  | SAUR50    | Auxin-responsive protein SAUR50                                                   |
 | 197 | AT1G72430  | SAUR78    | Auxin-responsive protein SAUR78                                                   |
 | 198 | AT1G10020  | AT1G10020 | At1g10020                                                                         |
 | 199 | AT2G27660  | AT2G27660 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | 200 | AT5G47230  | ERF5      | ERF5                                                                              |
 | 201 | AT5G60390  | A1        | Elongation factor 1-alpha 4                                                       |
 | 202 | AT5G65630  | GTE7      | Transcription factor GTE7                                                         |
 | 203 | AT1G14320  | RPL10A    | 60S ribosomal protein L10-1                                                       |
 | 204 | AT5G17920  | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1           |
 | 205 | AT5G04340  | ZAT6      | Zinc finger protein ZAT6                                                          |
 | 206 | AT2G02630  | AT2G02630 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | 207 | AT2G31880  | SOBIR1    | Leucine-rich repeat receptor-like serine/threonine/tyrosine-protein kinase SOBIR1 |
 | 208 | AT2G18160  | BZIP2     | bZIP transcription factor 2                                                       |
 | 209 | AT4G31550  | WRKY11    | Probable WRKY transcription factor 11                                             |
 | 210 | AT5G52750  | HIPP13    | Heavy metal-associated isoprenylated plant protein 13                             |
 | 211 | AT1G72610  | GLP1      | Germin-like protein subfamily 3 member 1                                          |
 | 212 | AT3G23810  | SAHH2     | Adenosylhomocysteinase                                                            |
 | 213 | AT2G26560  | PLP2      | Patatin-like protein 2                                                            |
 | 214 | AT5G61590  | ERF107    | Ethylene-responsive transcription factor ERF107                                   |
 | 215 | AT2G32030  | AT2G32030 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                             |
 | 216 | AT5G47210  | RGGC      | RGG repeats nuclear RNA binding protein C                                         |
 | 217 | AT5G14700  | AT5G14700 | Cinnamoyl CoA reductase-like protein                                              |
 | 218 | AT2G35930  | PUB23     | E3 ubiquitin-protein ligase PUB23                                                 |
 | 219 | AT4G28460  | PIP1      | PAMP-induced secreted peptide 1                                                   |
 | 220 | AT4G13940  | SAHH1     | Adenosylhomocysteinase 1                                                          |
 | 221 | AT1G14540  | PER4      | Peroxidase                                                                        |
 | 222 | AT1G76600  | AT1G76600 | Poly polymerase                                                                   |
 | 223 | AT3G22120  | CWLP      | Cell wall-plasma membrane linker protein                                          |
 | 224 | AT3G02840  | AT3G02840 | ARM repeat superfamily protein                                                    |
 | 225 | AT1G59590  | ZCF37     | At1g59590                                                                         |
 | 226 | AT1G69760  | AT1G69760 | At1g69760                                                                         |
 | 227 | AT1G74470  | CHLP      | Geranylgeranyl diphosphate reductase, chloroplastic                               |
 | 228 | AT1G72600  | AT1G72600 | At1g72600                                                                         |
 | 229 | AT4G14365  | XBAT34    | Putative E3 ubiquitin-protein ligase XBAT34                                       |
 | 230 | AT4G13930  | SHM4      | Serine hydroxymethyltransferase 4                                                 |
 | 231 | AT1G05675  | UGT74E1   | Glycosyltransferase (Fragment)                                                    |
 | 232 | AT3G21150  | BBX32     | B-box zinc finger protein 32                                                      |
 | 233 | AT4G24570  | PUMP4     | DIC2                                                                              |
 | 234 | AT2G22880  | AT2G22880 | At2g22880                                                                         |
 | 235 | AT2G17040  | anac036   | NAC domain containing protein 36                                                  |
 | 236 | AT2G30520  | RPT2      | Root phototropism protein 2                                                       |
 | 237 | AT4G29780  | AT4G29780 | Nuclease                                                                          |
 | 238 | AT1G15690  | AVP1      | VHP1                                                                              |
 | 239 | AT2G02950  | PKS1      | Protein PHYTOCHROME KINASE SUBSTRATE 1                                            |
 | 240 | AT3G22970  | AT3G22970 | At3g22970                                                                         |
 | 241 | AT4G14450  | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                  |
 | 242 | AT2G28000  | CPN60A1   | SLP                                                                               |
 | 243 | AT5G61570  | AT5G61570 | Protein kinase superfamily protein                                                |
 | 244 | AT4G38860  | AT4G38860 | At4g38860                                                                         |
 | 245 | AT5G59780  | MYB59     | Transcription factor MYB59                                                        |
 | 246 | AT5G59732  | AT5G59732 | other RNA                                                                         |
 | 247 | AT2G29110  | ATGLR2.8  | Glutamate receptor                                                                |
 | 248 | AT4G18100  | RPL32A    | 60S ribosomal protein L32-1                                                       |
 | 249 | AT1G24145  | AT1G24145 | At1g24145                                                                         |
 :END:


**** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'col' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [160]:
 # text/org
 | gene      |   importance | name      | description                                                                       |
 |-----------+--------------+-----------+-----------------------------------------------------------------------------------|
 | AT1G19770 |      0.0048  | PUP14     | PUP14                                                                             |
 | AT4G02410 |      0.00475 | LECRK43   | L-type lectin-domain containing receptor kinase IV.3                              |
 | AT1G80080 |      0.0046  | TMM       | TMM                                                                               |
 | AT2G45180 |      0.0046  | AT2G45180 | At2g45180/T14P1.1                                                                 |
 | AT3G09500 |      0.00455 | RPL35A    | 60S ribosomal protein L35-1                                                       |
 | AT5G52050 |      0.0045  | DTX50     | Protein DETOXIFICATION 50                                                         |
 | AT1G61560 |      0.0045  | MLO6      | MLO-like protein 6                                                                |
 | AT4G18100 |      0.00445 | RPL32A    | 60S ribosomal protein L32-1                                                       |
 | AT4G16370 |      0.00445 | ATOPT3    | oligopeptide transporter                                                          |
 | AT5G49910 |      0.0044  | HSP70-7   | Heat shock 70 kDa protein 7, chloroplastic                                        |
 | AT1G07160 |      0.0044  | AT1G07160 | PP2C-type phosphatase AP2C2                                                       |
 | AT5G25250 |      0.0044  | FLOT1     | Flotillin-like protein 1                                                          |
 | AT2G22880 |      0.00435 | AT2G22880 | At2g22880                                                                         |
 | AT1G50040 |      0.00435 | AT1G50040 | F2J10.8 protein                                                                   |
 | AT3G23810 |      0.00435 | SAHH2     | Adenosylhomocysteinase                                                            |
 | AT4G27280 |      0.00435 | KRP1      | Calcium-binding protein KRP1                                                      |
 | AT1G56242 |      0.00435 | AT1G56242 | other RNA                                                                         |
 | AT1G72610 |      0.00435 | GLP1      | Germin-like protein subfamily 3 member 1                                          |
 | AT2G40140 |      0.0043  | CZF1      | Zinc finger CCCH domain-containing protein 29                                     |
 | AT2G40330 |      0.0043  | PYL6      | Abscisic acid receptor PYL6                                                       |
 | AT5G03240 |      0.0043  | UBQ3      | Ubiquitin 4                                                                       |
 | AT4G24570 |      0.0043  | PUMP4     | DIC2                                                                              |
 | AT3G50930 |      0.0043  | HSR4      | Protein HYPER-SENSITIVITY-RELATED 4                                               |
 | AT2G44840 |      0.0043  | ERF13     | Ethylene-responsive transcription factor 13                                       |
 | AT3G52400 |      0.00425 | SYP122    | Syntaxin-122                                                                      |
 | AT4G38860 |      0.00425 | AT4G38860 | At4g38860                                                                         |
 | AT3G23250 |      0.00425 | MYB15     | Transcription factor MYB15                                                        |
 | AT5G11140 |      0.00425 | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                              |
 | AT3G21150 |      0.00425 | BBX32     | B-box zinc finger protein 32                                                      |
 | AT2G23130 |      0.00425 | AGP17     | Lysine-rich arabinogalactan protein 17                                            |
 | AT4G16720 |      0.0042  | RPL15A    | Ribosomal protein L15                                                             |
 | AT4G17490 |      0.0042  | ERF6      | Ethylene-responsive transcription factor 6                                        |
 | AT2G41840 |      0.0042  | RPS2C     | 40S ribosomal protein S2-3                                                        |
 | AT5G61600 |      0.00415 | ERF104    | Ethylene-responsive transcription factor ERF104                                   |
 | AT2G08475 |      0.00415 | AT2G08475 | None                                                                              |
 | AT2G31880 |      0.00415 | SOBIR1    | Leucine-rich repeat receptor-like serine/threonine/tyrosine-protein kinase SOBIR1 |
 | AT1G43170 |      0.00415 | ARP1      | 60S ribosomal protein L3-1                                                        |
 | AT2G47440 |      0.00415 | AT2G47440 | Tetratricopeptide repeat (TPR)-like superfamily protein                           |
 | AT5G20230 |      0.00415 | BCB       | SAG14                                                                             |
 | AT2G36690 |      0.0041  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein           |
 | AT2G26530 |      0.0041  | AR781     | AR781                                                                             |
 | AT1G56070 |      0.0041  | LOS1      | Elongation factor 2                                                               |
 | AT2G01180 |      0.0041  | ATPAP1    | phosphatidic acid phosphatase 1                                                   |
 | AT5G52750 |      0.0041  | HIPP13    | Heavy metal-associated isoprenylated plant protein 13                             |
 | AT5G02870 |      0.0041  | RPL4D     | 60S ribosomal protein L4-2                                                        |
 | AT5G19240 |      0.0041  | AT5G19240 | Uncharacterized GPI-anchored protein At5g19240                                    |
 | AT3G10930 |      0.0041  | AT3G10930 | Uncharacterized protein At3g10930                                                 |
 | AT4G29780 |      0.0041  | AT4G29780 | Nuclease                                                                          |
 | AT3G03125 |      0.0041  | AT3G03125 | None                                                                              |
 | AT5G27420 |      0.00405 | ATL31     | E3 ubiquitin-protein ligase ATL31                                                 |
 | AT3G04400 |      0.00405 | RPL23A    | 60S ribosomal protein L23                                                         |
 | AT1G20310 |      0.00405 | AT1G20310 | Syringolide-induced protein                                                       |
 | AT3G53430 |      0.00405 | RPL12B    | 60S ribosomal Protein L12-like                                                    |
 | AT5G59820 |      0.00405 | ZAT12     | Zinc finger protein ZAT12                                                         |
 | AT4G22030 |      0.00405 | AT4G22030 | F-box family protein with a domain of unknown function (DUF295)                   |
 | AT2G25735 |      0.004   | AT2G25735 | Expressed protein                                                                 |
 | AT5G59732 |      0.004   | AT5G59732 | other RNA                                                                         |
 | AT1G10020 |      0.004   | AT1G10020 | At1g10020                                                                         |
 | AT4G15975 |      0.004   | AT4G15975 | RING/U-box superfamily protein                                                    |
 | AT5G47230 |      0.004   | ERF5      | ERF5                                                                              |
 | AT5G17920 |      0.004   | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1           |
 | AT1G72430 |      0.004   | SAUR78    | Auxin-responsive protein SAUR78                                                   |
 | AT1G66090 |      0.004   | AT1G66090 | Disease resistance protein (TIR-NBS class)                                        |
 | AT5G02760 |      0.004   | AT5G02760 | Probable protein phosphatase 2C 67                                                |
 | AT1G14320 |      0.004   | RPL10A    | 60S ribosomal protein L10-1                                                       |
 | AT1G58420 |      0.004   | AT1G58420 | At1g58420                                                                         |
 | AT1G15690 |      0.004   | AVP1      | VHP1                                                                              |
 | AT5G57220 |      0.004   | CYP81F2   | Cytochrome P450 81F2                                                              |
 | AT1G02780 |      0.004   | RPL19A    | 60S ribosomal protein L19-1                                                       |
 | AT1G26380 |      0.00395 | FOX1      | Berberine bridge enzyme-like 3                                                    |
 | AT3G53460 |      0.00395 | CP29      | Chloroplast RNA-binding protein 29                                                |
 | AT5G25340 |      0.00395 | AT5G25340 | Ubiquitin-like superfamily protein                                                |
 | AT1G72370 |      0.00395 | RPSAA     | 40S ribosomal protein SA                                                          |
 | AT1G56250 |      0.00395 | VBF       | F-box protein VBF                                                                 |
 | AT1G76600 |      0.0039  | AT1G76600 | Poly polymerase                                                                   |
 | AT2G21210 |      0.0039  | AT2G21210 | SAUR-like auxin-responsive protein family                                         |
 | AT2G23270 |      0.0039  | AT2G23270 | At2g23270                                                                         |
 | AT1G74850 |      0.0039  | PTAC2     | PTAC2                                                                             |
 | AT4G13940 |      0.0039  | SAHH1     | Adenosylhomocysteinase 1                                                          |
 | AT4G23220 |      0.0039  | CRK14     | Cysteine-rich receptor-like protein kinase 14                                     |
 | AT3G22121 |      0.0039  | AT3G22121 | other RNA                                                                         |
 | AT4G31550 |      0.0039  | WRKY11    | Probable WRKY transcription factor 11                                             |
 | AT1G68550 |      0.0039  | ERF118    | Ethylene-responsive transcription factor ERF118                                   |
 | AT3G09200 |      0.0039  | RPP0B     | 60S acidic ribosomal protein P0-2                                                 |
 | AT4G36500 |      0.0039  | AT4G36500 | Uncharacterized protein At4g36500                                                 |
 | AT1G56240 |      0.0039  | PP2B13    | F-box protein PP2-B13                                                             |
 | AT5G15845 |      0.00385 | AT5G15845 | other RNA                                                                         |
 | AT3G58120 |      0.00385 | BZIP61    | BZIP61                                                                            |
 | AT2G26560 |      0.00385 | PLP2      | Patatin-like protein 2                                                            |
 | AT1G57990 |      0.00385 | PUP18     | PUP18                                                                             |
 | AT1G74470 |      0.00385 | CHLP      | Geranylgeranyl diphosphate reductase, chloroplastic                               |
 | AT5G59780 |      0.00385 | MYB59     | Transcription factor MYB59                                                        |
 | AT4G22710 |      0.00385 | CYP706A2  | Cytochrome P450 - like protein                                                    |
 | AT3G07195 |      0.00385 | AT3G07195 | RPM1-interacting protein 4 (RIN4) family protein                                  |
 | AT2G17040 |      0.00385 | anac036   | NAC domain containing protein 36                                                  |
 | AT2G28000 |      0.00385 | CPN60A1   | SLP                                                                               |
 | AT1G17147 |      0.00385 | VQ1       | VQ motif-containing protein 1                                                     |
 | AT1G09690 |      0.00385 | RPL21A    | 60S ribosomal protein L21-1                                                       |
 | AT5G22250 |      0.00385 | CAF1-11   | Probable CCR4-associated factor 1 homolog 11                                      |
 | AT2G18440 |      0.00385 | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)                                          |
 | AT2G02950 |      0.0038  | PKS1      | Protein PHYTOCHROME KINASE SUBSTRATE 1                                            |
 | AT4G31950 |      0.0038  | CYP82C3   | CYP82C3                                                                           |
 | AT2G31345 |      0.0038  | AT2G31345 | Transmembrane protein                                                             |
 | AT2G33580 |      0.0038  | LYK5      | Protein LYK5                                                                      |
 | AT2G35935 |      0.0038  | AT2G35935 | None                                                                              |
 | AT4G37540 |      0.00375 | LBD39     | LOB domain-containing protein 39                                                  |
 | AT1G61340 |      0.00375 | AT1G61340 | F-box protein At1g61340                                                           |
 | AT5G51190 |      0.00375 | ERF105    | Ethylene-responsive transcription factor ERF105                                   |
 | AT2G35930 |      0.00375 | PUB23     | E3 ubiquitin-protein ligase PUB23                                                 |
 | AT1G19020 |      0.00375 | AT1G19020 | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                 |
 | AT5G24110 |      0.00375 | WRKY30    | Probable WRKY transcription factor 30                                             |
 | AT3G28340 |      0.0037  | GATL10    | Hexosyltransferase (Fragment)                                                     |
 | AT3G59940 |      0.0037  | SKIP20    | F-box/kelch-repeat protein SKIP20                                                 |
 | AT1G79680 |      0.0037  | WAKL10    | Wall-associated receptor kinase-like 10                                           |
 | AT1G78170 |      0.0037  | AT1G78170 | E3 ubiquitin-protein ligase                                                       |
 | AT3G53870 |      0.0037  | RPS3B     | 40S ribosomal protein S3-2                                                        |
 | AT2G27820 |      0.0037  | ADT3      | Arogenate dehydratase 3, chloroplastic                                            |
 | AT5G26920 |      0.0037  | CBP60G    | Calmodulin-binding protein 60 G                                                   |
 | AT5G57760 |      0.0037  | AT5G57760 | At5g57760                                                                         |
 | AT5G28610 |      0.0037  | AT5G28610 | LOW protein: ATP-dependent RNA helicase DRS1-like protein                         |
 | AT2G43340 |      0.0037  | AT2G43340 | At2g43340                                                                         |
 | AT3G01165 |      0.0037  | AT3G01165 | None                                                                              |
 | AT1G05575 |      0.0037  | AT1G05575 | Transmembrane protein                                                             |
 | AT4G14370 |      0.0037  | AT4G14370 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT1G21120 |      0.00365 | AT1G21120 | O-methyltransferase family protein                                                |
 | AT2G44670 |      0.00365 | FLZ3      | FCS-Like Zinc finger 3                                                            |
 | AT1G69760 |      0.00365 | AT1G69760 | At1g69760                                                                         |
 | AT1G48300 |      0.00365 | AT1G48300 | unknown protein                                                                   |
 | AT5G05300 |      0.00365 | AT5G05300 | Gb                                                                                |
 | AT1G14540 |      0.00365 | PER4      | Peroxidase                                                                        |
 | AT1G80840 |      0.00365 | WRKY40    | Probable WRKY transcription factor 40                                             |
 | AT4G19700 |      0.00365 | BOI       | E3 ubiquitin-protein ligase BOI                                                   |
 | AT1G09780 |      0.00365 | PGM1      | IPGAM1                                                                            |
 | AT3G18710 |      0.00365 | PUB29     | RING-type E3 ubiquitin transferase                                                |
 | AT3G46130 |      0.00365 | ATMYB48   | myb domain protein 48                                                             |
 | AT1G25440 |      0.0036  | COL16     | Zinc finger protein CONSTANS-LIKE 16                                              |
 | AT2G29110 |      0.0036  | ATGLR2.8  | Glutamate receptor                                                                |
 | AT4G39260 |      0.0036  | RBG8      | GRP8                                                                              |
 | AT5G20290 |      0.0036  | RPS8A     | 40S ribosomal protein S8                                                          |
 | AT5G20630 |      0.0036  | GER3      | Germin-like protein subfamily 3 member 3                                          |
 | AT5G42380 |      0.0036  | CML37     | Calcium-binding protein CML37                                                     |
 | AT1G72910 |      0.0036  | AT1G72910 | Similar to part of disease resistance protein                                     |
 | AT5G02500 |      0.0036  | MED37E    | Probable mediator of RNA polymerase II transcription subunit 37e                  |
 | AT3G25520 |      0.0036  | ATL5      | RPL5A                                                                             |
 | AT3G29000 |      0.0036  | CML45     | Probable calcium-binding protein CML45                                            |
 | AT2G38310 |      0.0036  | PYL4      | Abscisic acid receptor PYL4                                                       |
 | AT3G63200 |      0.0036  | PLP9      | Probable inactive patatin-like protein 9                                          |
 | AT4G23810 |      0.0036  | WRKY53    | Probable WRKY transcription factor 53                                             |
 | AT5G59730 |      0.0036  | ATEXO70H7 | Exocyst subunit Exo70 family protein                                              |
 | AT3G44260 |      0.0036  | CAF1-9    | Probable CCR4-associated factor 1 homolog 9                                       |
 | AT5G61570 |      0.0036  | AT5G61570 | Protein kinase superfamily protein                                                |
 | AT3G49010 |      0.00355 | RPL13B    | 60S ribosomal protein L13-1                                                       |
 | AT2G02630 |      0.00355 | AT2G02630 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | AT5G14700 |      0.00355 | AT5G14700 | Cinnamoyl CoA reductase-like protein                                              |
 | AT2G30520 |      0.00355 | RPT2      | Root phototropism protein 2                                                       |
 | AT3G22120 |      0.00355 | CWLP      | Cell wall-plasma membrane linker protein                                          |
 | AT1G69890 |      0.00355 | AT1G69890 | Actin cross-linking protein (DUF569)                                              |
 | AT4G37370 |      0.00355 | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                            |
 | AT5G67480 |      0.00355 | BT4       | BTB and TAZ domain protein 4                                                      |
 | AT1G73540 |      0.00355 | NUDT21    | Nudix hydrolase 21, chloroplastic                                                 |
 | AT1G12090 |      0.00355 | ELP       | ELP                                                                               |
 | AT5G15870 |      0.00355 | AT5G15870 | Glycosyl hydrolase family 81 protein                                              |
 | AT3G09630 |      0.00355 | RPL4A     | 60S ribosomal protein L4-1                                                        |
 | AT4G18197 |      0.00355 | PUP7      | Probable purine permease 7                                                        |
 | AT5G25350 |      0.0035  | EBF2      | EIN3-binding F-box protein 2                                                      |
 | AT5G18380 |      0.0035  | RPS16C    | 40S ribosomal protein S16-3                                                       |
 | AT1G65390 |      0.0035  | PP2A5     | Protein PHLOEM PROTEIN 2-LIKE A5                                                  |
 | AT4G34950 |      0.0035  | AT4G34950 | Major facilitator superfamily protein                                             |
 | AT1G21326 |      0.0035  | AT1G21326 | F16F4.1 protein                                                                   |
 | AT4G11470 |      0.0035  | CRK31     | cysteine-rich RLK (RECEPTOR-like protein kinase) 31                               |
 | AT4G28460 |      0.0035  | PIP1      | PAMP-induced secreted peptide 1                                                   |
 | AT5G47210 |      0.0035  | RGGC      | RGG repeats nuclear RNA binding protein C                                         |
 | AT1G72520 |      0.0035  | LOX4      | Lipoxygenase 4, chloroplastic                                                     |
 | AT2G10940 |      0.0035  | AT2G10940 | At2g10940/F15K19.1                                                                |
 | AT5G65310 |      0.0035  | ATHB-5    | Homeobox-leucine zipper protein ATHB-5                                            |
 | AT2G32030 |      0.0035  | AT2G32030 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                             |
 | AT2G40000 |      0.0035  | HSPRO2    | Nematode resistance protein-like HSPRO2                                           |
 | AT4G14450 |      0.00345 | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                  |
 | AT1G24145 |      0.00345 | AT1G24145 | At1g24145                                                                         |
 | AT5G44680 |      0.00345 | AT5G44680 | DNA glycosylase superfamily protein                                               |
 | AT1G70600 |      0.00345 | RPL27AC   | 60S ribosomal protein L27a-3                                                      |
 | AT2G38470 |      0.00345 | WRKY33    | WRKY33                                                                            |
 | AT1G61360 |      0.00345 | AT1G61360 | Serine/threonine-protein kinase                                                   |
 | AT5G25280 |      0.00345 | AT5G25280 | AT5g25280/F18G18_20                                                               |
 | AT5G41740 |      0.00345 | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT4G38620 |      0.00345 | MYB4      | Transcription repressor MYB4                                                      |
 | AT5G64905 |      0.00345 | PEP3      | Elicitor peptide 3                                                                |
 | AT1G13930 |      0.00345 | AT1G13930 | At1g13930/F16A14.27                                                               |
 | AT1G69530 |      0.00345 | ATEXPA1   | Expansin                                                                          |
 | AT1G18540 |      0.00345 | RPL6A     | 60S ribosomal protein L6-1                                                        |
 | AT5G26742 |      0.00345 | RH3       | RH3                                                                               |
 | AT1G12820 |      0.0034  | AFB3      | Protein AUXIN SIGNALING F-BOX 3                                                   |
 | AT1G72600 |      0.0034  | AT1G72600 | At1g72600                                                                         |
 | AT4G01250 |      0.0034  | WRKY22    | WRKY transcription factor 22                                                      |
 | AT5G41750 |      0.0034  | AT5G41750 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT1G50750 |      0.0034  | AT1G50750 | Plant mobile domain protein family                                                |
 | AT5G13930 |      0.0034  | CHS       | Chalcone synthase family protein                                                  |
 | AT5G56030 |      0.0034  | HSP81-2   | Heat shock protein 81-2                                                           |
 | AT5G61590 |      0.0034  | ERF107    | Ethylene-responsive transcription factor ERF107                                   |
 | AT3G60245 |      0.0034  | RPL37AC   | 60S ribosomal protein L37a-2                                                      |
 | AT1G68520 |      0.00335 | COL6      | Zinc finger protein CONSTANS-LIKE 6                                               |
 | AT1G67430 |      0.00335 | RPL17B    | 60S ribosomal protein L17-2                                                       |
 | AT2G24600 |      0.00335 | AT2G24600 | Ankyrin repeat family protein                                                     |
 | AT2G37430 |      0.00335 | ZAT11     | ZAT11                                                                             |
 | AT3G05590 |      0.00335 | RPL18B    | RPL18                                                                             |
 | AT1G59590 |      0.00335 | ZCF37     | At1g59590                                                                         |
 | AT2G36090 |      0.0033  | AT2G36090 | Probable F-box protein At2g36090                                                  |
 | AT5G65630 |      0.0033  | GTE7      | Transcription factor GTE7                                                         |
 | AT3G22970 |      0.0033  | AT3G22970 | At3g22970                                                                         |
 | AT4G17390 |      0.0033  | RPL15B    | 60S ribosomal protein L15-2                                                       |
 | AT1G17420 |      0.0033  | LOX3      | Lipoxygenase 3, chloroplastic                                                     |
 | AT3G09275 |      0.00325 | AT3G09275 | None                                                                              |
 | AT3G02840 |      0.00325 | AT3G02840 | ARM repeat superfamily protein                                                    |
 | AT4G23180 |      0.00325 | CRK10     | Cysteine-rich receptor-like protein kinase 10                                     |
 | AT5G37260 |      0.00325 | RVE2      | Protein REVEILLE 2                                                                |
 | AT1G24140 |      0.0032  | 3MMP      | Metalloendoproteinase 3-MMP                                                       |
 | AT3G55980 |      0.0032  | SZF1      | Salt-inducible zinc finger 1                                                      |
 | AT5G47850 |      0.0032  | CCR4      | Serine/threonine-protein kinase-like protein CCR4                                 |
 | AT4G38840 |      0.0032  | AT4G38840 | At4g38840                                                                         |
 | AT1G07135 |      0.0032  | AT1G07135 | At1g07135                                                                         |
 | AT5G15200 |      0.00315 | RPS9B     | 40S ribosomal protein S9-1                                                        |
 | AT3G62980 |      0.00315 | TIR1      | TIR1                                                                              |
 | AT1G30370 |      0.00315 | AT1G30370 | DLAH                                                                              |
 | AT4G36648 |      0.00315 | AT4G36648 | other RNA                                                                         |
 | AT4G34760 |      0.00315 | SAUR50    | Auxin-responsive protein SAUR50                                                   |
 | AT5G01540 |      0.00315 | LECRK62   | L-type lectin-domain containing receptor kinase VI.2                              |
 | AT5G04340 |      0.0031  | ZAT6      | Zinc finger protein ZAT6                                                          |
 | AT1G78080 |      0.0031  | RAP2-4    | Ethylene-responsive transcription factor RAP2-4                                   |
 | AT2G27660 |      0.0031  | AT2G27660 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | AT2G36530 |      0.0031  | ENO2      | LOS2                                                                              |
 | AT3G19680 |      0.00305 | AT3G19680 | Uncharacterized protein At3g19680                                                 |
 | AT4G13930 |      0.00305 | SHM4      | Serine hydroxymethyltransferase 4                                                 |
 | AT5G56010 |      0.00305 | HSP90-3   | Heat shock protein 90-3                                                           |
 | AT1G78100 |      0.00305 | AT1G78100 | AUF1                                                                              |
 | AT1G05675 |      0.003   | UGT74E1   | Glycosyltransferase (Fragment)                                                    |
 | AT5G01542 |      0.003   | AT5G01542 | Potential natural antisense gene, locus overlaps with AT5G01540                   |
 | AT1G79110 |      0.0029  | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                                |
 | AT2G18160 |      0.00285 | BZIP2     | bZIP transcription factor 2                                                       |
 | AT1G27730 |      0.0028  | ZAT10     | Zinc finger protein ZAT10                                                         |
 | AT5G44130 |      0.0027  | FLA13     | Fasciclin-like arabinogalactan protein 13                                         |
 | AT4G14365 |      0.00265 | XBAT34    | Putative E3 ubiquitin-protein ligase XBAT34                                       |
 | AT3G04840 |      0.00245 | RPS3AA    | 40S ribosomal protein S3a-1                                                       |
 | AT1G18080 |      0.002   | RACK1A    | RACK1A_AT                                                                         |
 | AT5G60390 |      0.00195 | A1        | Elongation factor 1-alpha 4                                                       |
 | AT2G21660 |      0.00175 | RBG7      | Glycine-rich RNA-binding protein 7                                                |
 | AT3G62870 |      0.0017  | RPL7AB    | 60S ribosomal protein L7a-2                                                       |
 | AT2G34480 |      0.00155 | AT2G34480 | Ribosomal protein L18ae/LX family protein                                         |
 | AT2G18020 |      0.00145 | RPL8A     | EMB2296                                                                           |
 | AT3G09260 |      0.0011  | BGLU23    | PYK10                                                                             |
 | AT3G16420 |      0.00105 | PBP1      | PYK10-binding protein 1                                                           |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [161]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/66713a271ec9945dd0121d16a034387e0fa64ce3.png]]
 :END:

* Selecting genes for Lym2 at 05hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'lym' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [162]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [163]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [1640 3379  586 ... 3520 2446 3732]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [164]:
 # text/org
 |    | incoming   | name      | description                                                             |
 |----+------------+-----------+-------------------------------------------------------------------------|
 |  0 | AT1G68520  | COL6      | Zinc finger protein CONSTANS-LIKE 6                                     |
 |  1 | AT1G79110  | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                      |
 |  2 | AT3G53460  | CP29      | Chloroplast RNA-binding protein 29                                      |
 |  3 | AT5G25350  | EBF2      | EIN3-binding F-box protein 2                                            |
 |  4 | AT2G37430  | ZAT11     | ZAT11                                                                   |
 |  5 | AT4G19700  | BOI       | E3 ubiquitin-protein ligase BOI                                         |
 |  6 | AT1G56250  | VBF       | F-box protein VBF                                                       |
 |  7 | AT3G09275  | AT3G09275 | None                                                                    |
 |  8 | AT1G72520  | LOX4      | Lipoxygenase 4, chloroplastic                                           |
 |  9 | AT5G24110  | WRKY30    | Probable WRKY transcription factor 30                                   |
 | 10 | AT1G21120  | AT1G21120 | O-methyltransferase family protein                                      |
 | 11 | AT1G07160  | AT1G07160 | PP2C-type phosphatase AP2C2                                             |
 | 12 | AT1G25440  | COL16     | Zinc finger protein CONSTANS-LIKE 16                                    |
 | 13 | AT5G11140  | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                    |
 | 14 | AT1G56242  | AT1G56242 | other RNA                                                               |
 | 15 | AT5G37260  | RVE2      | Protein REVEILLE 2                                                      |
 | 16 | AT5G27420  | ATL31     | E3 ubiquitin-protein ligase ATL31                                       |
 | 17 | AT1G56240  | PP2B13    | F-box protein PP2-B13                                                   |
 | 18 | AT2G21660  | RBG7      | Glycine-rich RNA-binding protein 7                                      |
 | 19 | AT5G47230  | ERF5      | ERF5                                                                    |
 | 20 | AT5G60390  | A1        | Elongation factor 1-alpha 4                                             |
 | 21 | AT5G17920  | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1 |
 | 22 | AT5G61590  | ERF107    | Ethylene-responsive transcription factor ERF107                         |
 | 23 | AT1G14540  | PER4      | Peroxidase                                                              |
 | 24 | AT3G02840  | AT3G02840 | ARM repeat superfamily protein                                          |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'lym' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [165]:
 # text/org
 | gene      |   importance | name      | description                                                             |
 |-----------+--------------+-----------+-------------------------------------------------------------------------|
 | AT5G27420 |      0.03965 | ATL31     | E3 ubiquitin-protein ligase ATL31                                       |
 | AT1G68520 |      0.039   | COL6      | Zinc finger protein CONSTANS-LIKE 6                                     |
 | AT1G25440 |      0.03815 | COL16     | Zinc finger protein CONSTANS-LIKE 16                                    |
 | AT5G11140 |      0.03755 | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                    |
 | AT5G61590 |      0.0375  | ERF107    | Ethylene-responsive transcription factor ERF107                         |
 | AT1G21120 |      0.03745 | AT1G21120 | O-methyltransferase family protein                                      |
 | AT3G02840 |      0.03725 | AT3G02840 | ARM repeat superfamily protein                                          |
 | AT5G37260 |      0.03705 | RVE2      | Protein REVEILLE 2                                                      |
 | AT1G14540 |      0.037   | PER4      | Peroxidase                                                              |
 | AT5G25350 |      0.0369  | EBF2      | EIN3-binding F-box protein 2                                            |
 | AT3G53460 |      0.03675 | CP29      | Chloroplast RNA-binding protein 29                                      |
 | AT2G21660 |      0.0366  | RBG7      | Glycine-rich RNA-binding protein 7                                      |
 | AT1G56242 |      0.03635 | AT1G56242 | other RNA                                                               |
 | AT1G79110 |      0.03625 | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                      |
 | AT1G56240 |      0.0362  | PP2B13    | F-box protein PP2-B13                                                   |
 | AT5G47230 |      0.0362  | ERF5      | ERF5                                                                    |
 | AT3G09275 |      0.0361  | AT3G09275 | None                                                                    |
 | AT4G19700 |      0.03585 | BOI       | E3 ubiquitin-protein ligase BOI                                         |
 | AT1G56250 |      0.0358  | VBF       | F-box protein VBF                                                       |
 | AT1G72520 |      0.0356  | LOX4      | Lipoxygenase 4, chloroplastic                                           |
 | AT5G24110 |      0.03545 | WRKY30    | Probable WRKY transcription factor 30                                   |
 | AT5G17920 |      0.035   | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1 |
 | AT1G07160 |      0.03495 | AT1G07160 | PP2C-type phosphatase AP2C2                                             |
 | AT5G60390 |      0.03425 | A1        | Elongation factor 1-alpha 4                                             |
 | AT2G37430 |      0.0341  | ZAT11     | ZAT11                                                                   |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance')
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [166]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/815d50b29e83983c6877ed5f57190adf9a8a4152.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [167]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [168]:
 # output
 Num Features: 250
 Selected Features: [False False False ... False False False]
 Feature Ranking: [3754 2994 1757 ... 3825 2348 5584]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [169]:
 # text/org
 |     | incoming   | name      | description                                                                       |
 |-----+------------+-----------+-----------------------------------------------------------------------------------|
 |   0 | AT5G57220  | CYP81F2   | Cytochrome P450 81F2                                                              |
 |   1 | AT1G68520  | COL6      | Zinc finger protein CONSTANS-LIKE 6                                               |
 |   2 | AT3G04840  | RPS3AA    | 40S ribosomal protein S3a-1                                                       |
 |   3 | AT5G52050  | DTX50     | Protein DETOXIFICATION 50                                                         |
 |   4 | AT2G44670  | FLZ3      | FCS-Like Zinc finger 3                                                            |
 |   5 | AT1G12820  | AFB3      | Protein AUXIN SIGNALING F-BOX 3                                                   |
 |   6 | AT2G23270  | AT2G23270 | At2g23270                                                                         |
 |   7 | AT5G59730  | ATEXO70H7 | Exocyst subunit Exo70 family protein                                              |
 |   8 | AT5G02760  | AT5G02760 | Probable protein phosphatase 2C 67                                                |
 |   9 | AT3G63200  | PLP9      | Probable inactive patatin-like protein 9                                          |
 |  10 | AT3G28340  | GATL10    | Hexosyltransferase (Fragment)                                                     |
 |  11 | AT1G69890  | AT1G69890 | Actin cross-linking protein (DUF569)                                              |
 |  12 | AT1G79110  | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                                |
 |  13 | AT2G40330  | PYL6      | Abscisic acid receptor PYL6                                                       |
 |  14 | AT2G41840  | RPS2C     | 40S ribosomal protein S2-3                                                        |
 |  15 | AT2G27820  | ADT3      | Arogenate dehydratase 3, chloroplastic                                            |
 |  16 | AT3G53460  | CP29      | Chloroplast RNA-binding protein 29                                                |
 |  17 | AT1G12090  | ELP       | ELP                                                                               |
 |  18 | AT5G49910  | HSP70-7   | Heat shock 70 kDa protein 7, chloroplastic                                        |
 |  19 | AT5G47850  | CCR4      | Serine/threonine-protein kinase-like protein CCR4                                 |
 |  20 | AT4G31950  | CYP82C3   | CYP82C3                                                                           |
 |  21 | AT4G16370  | ATOPT3    | oligopeptide transporter                                                          |
 |  22 | AT5G25350  | EBF2      | EIN3-binding F-box protein 2                                                      |
 |  23 | AT3G09260  | BGLU23    | PYK10                                                                             |
 |  24 | AT2G18020  | RPL8A     | EMB2296                                                                           |
 |  25 | AT1G57990  | PUP18     | PUP18                                                                             |
 |  26 | AT1G17147  | VQ1       | VQ motif-containing protein 1                                                     |
 |  27 | AT2G37430  | ZAT11     | ZAT11                                                                             |
 |  28 | AT5G15200  | RPS9B     | 40S ribosomal protein S9-1                                                        |
 |  29 | AT1G70600  | RPL27AC   | 60S ribosomal protein L27a-3                                                      |
 |  30 | AT4G16720  | RPL15A    | Ribosomal protein L15                                                             |
 |  31 | AT3G09630  | RPL4A     | 60S ribosomal protein L4-1                                                        |
 |  32 | AT3G23250  | MYB15     | Transcription factor MYB15                                                        |
 |  33 | AT4G19700  | BOI       | E3 ubiquitin-protein ligase BOI                                                   |
 |  34 | AT1G80840  | WRKY40    | Probable WRKY transcription factor 40                                             |
 |  35 | AT2G33580  | LYK5      | Protein LYK5                                                                      |
 |  36 | AT1G48300  | AT1G48300 | unknown protein                                                                   |
 |  37 | AT4G22710  | CYP706A2  | Cytochrome P450 - like protein                                                    |
 |  38 | AT2G35935  | AT2G35935 | None                                                                              |
 |  39 | AT3G09200  | RPP0B     | 60S acidic ribosomal protein P0-2                                                 |
 |  40 | AT5G03240  | UBQ3      | Ubiquitin 4                                                                       |
 |  41 | AT5G56030  | HSP81-2   | Heat shock protein 81-2                                                           |
 |  42 | AT1G74850  | PTAC2     | PTAC2                                                                             |
 |  43 | AT5G25250  | FLOT1     | Flotillin-like protein 1                                                          |
 |  44 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                                                    |
 |  45 | AT4G15975  | AT4G15975 | RING/U-box superfamily protein                                                    |
 |  46 | AT3G01165  | AT3G01165 | None                                                                              |
 |  47 | AT3G62870  | RPL7AB    | 60S ribosomal protein L7a-2                                                       |
 |  48 | AT1G56250  | VBF       | F-box protein VBF                                                                 |
 |  49 | AT4G23180  | CRK10     | Cysteine-rich receptor-like protein kinase 10                                     |
 |  50 | AT5G02500  | MED37E    | Probable mediator of RNA polymerase II transcription subunit 37e                  |
 |  51 | AT4G11470  | CRK31     | cysteine-rich RLK (RECEPTOR-like protein kinase) 31                               |
 |  52 | AT5G15870  | AT5G15870 | Glycosyl hydrolase family 81 protein                                              |
 |  53 | AT4G37370  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                            |
 |  54 | AT5G19240  | AT5G19240 | Uncharacterized GPI-anchored protein At5g19240                                    |
 |  55 | AT2G36690  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein           |
 |  56 | AT2G34480  | AT2G34480 | Ribosomal protein L18ae/LX family protein                                         |
 |  57 | AT1G61560  | MLO6      | MLO-like protein 6                                                                |
 |  58 | AT1G02780  | RPL19A    | 60S ribosomal protein L19-1                                                       |
 |  59 | AT1G78100  | AT1G78100 | AUF1                                                                              |
 |  60 | AT5G44680  | AT5G44680 | DNA glycosylase superfamily protein                                               |
 |  61 | AT3G53430  | RPL12B    | 60S ribosomal Protein L12-like                                                    |
 |  62 | AT1G73540  | NUDT21    | Nudix hydrolase 21, chloroplastic                                                 |
 |  63 | AT1G72910  | AT1G72910 | Similar to part of disease resistance protein                                     |
 |  64 | AT4G18197  | PUP7      | Probable purine permease 7                                                        |
 |  65 | AT5G67480  | BT4       | BTB and TAZ domain protein 4                                                      |
 |  66 | AT2G31345  | AT2G31345 | Transmembrane protein                                                             |
 |  67 | AT3G16420  | PBP1      | PYK10-binding protein 1                                                           |
 |  68 | AT1G80080  | TMM       | TMM                                                                               |
 |  69 | AT3G29000  | CML45     | Probable calcium-binding protein CML45                                            |
 |  70 | AT3G07195  | AT3G07195 | RPM1-interacting protein 4 (RIN4) family protein                                  |
 |  71 | AT1G17420  | LOX3      | Lipoxygenase 3, chloroplastic                                                     |
 |  72 | AT2G08475  | AT2G08475 | None                                                                              |
 |  73 | AT5G26742  | RH3       | RH3                                                                               |
 |  74 | AT5G25340  | AT5G25340 | Ubiquitin-like superfamily protein                                                |
 |  75 | AT1G69530  | ATEXPA1   | Expansin                                                                          |
 |  76 | AT3G09275  | AT3G09275 | None                                                                              |
 |  77 | AT1G20310  | AT1G20310 | Syringolide-induced protein                                                       |
 |  78 | AT5G26920  | CBP60G    | Calmodulin-binding protein 60 G                                                   |
 |  79 | AT4G22030  | AT4G22030 | F-box family protein with a domain of unknown function (DUF295)                   |
 |  80 | AT4G36648  | AT4G36648 | other RNA                                                                         |
 |  81 | AT2G25735  | AT2G25735 | Expressed protein                                                                 |
 |  82 | AT1G61340  | AT1G61340 | F-box protein At1g61340                                                           |
 |  83 | AT1G18080  | RACK1A    | RACK1A_AT                                                                         |
 |  84 | AT4G39260  | RBG8      | GRP8                                                                              |
 |  85 | AT1G68550  | ERF118    | Ethylene-responsive transcription factor ERF118                                   |
 |  86 | AT1G61360  | AT1G61360 | Serine/threonine-protein kinase                                                   |
 |  87 | AT1G24140  | 3MMP      | Metalloendoproteinase 3-MMP                                                       |
 |  88 | AT4G38620  | MYB4      | Transcription repressor MYB4                                                      |
 |  89 | AT5G44130  | FLA13     | Fasciclin-like arabinogalactan protein 13                                         |
 |  90 | AT2G24600  | AT2G24600 | Ankyrin repeat family protein                                                     |
 |  91 | AT2G10940  | AT2G10940 | At2g10940/F15K19.1                                                                |
 |  92 | AT3G46130  | ATMYB48   | myb domain protein 48                                                             |
 |  93 | AT2G47440  | AT2G47440 | Tetratricopeptide repeat (TPR)-like superfamily protein                           |
 |  94 | AT4G14370  | AT4G14370 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 |  95 | AT5G57760  | AT5G57760 | At5g57760                                                                         |
 |  96 | AT3G18710  | PUB29     | RING-type E3 ubiquitin transferase                                                |
 |  97 | AT5G59820  | ZAT12     | Zinc finger protein ZAT12                                                         |
 |  98 | AT3G25520  | ATL5      | RPL5A                                                                             |
 |  99 | AT4G02410  | LECRK43   | L-type lectin-domain containing receptor kinase IV.3                              |
 | 100 | AT4G36500  | AT4G36500 | Uncharacterized protein At4g36500                                                 |
 | 101 | AT1G72520  | LOX4      | Lipoxygenase 4, chloroplastic                                                     |
 | 102 | AT5G65310  | ATHB-5    | Homeobox-leucine zipper protein ATHB-5                                            |
 | 103 | AT5G05300  | AT5G05300 | Gb                                                                                |
 | 104 | AT1G78170  | AT1G78170 | E3 ubiquitin-protein ligase                                                       |
 | 105 | AT3G44260  | CAF1-9    | Probable CCR4-associated factor 1 homolog 9                                       |
 | 106 | AT3G03125  | AT3G03125 | None                                                                              |
 | 107 | AT1G05575  | AT1G05575 | Transmembrane protein                                                             |
 | 108 | AT1G72370  | RPSAA     | 40S ribosomal protein SA                                                          |
 | 109 | AT1G56070  | LOS1      | Elongation factor 2                                                               |
 | 110 | AT1G30370  | AT1G30370 | DLAH                                                                              |
 | 111 | AT5G13930  | CHS       | Chalcone synthase family protein                                                  |
 | 112 | AT2G23130  | AGP17     | Lysine-rich arabinogalactan protein 17                                            |
 | 113 | AT3G59940  | SKIP20    | F-box/kelch-repeat protein SKIP20                                                 |
 | 114 | AT1G65390  | PP2A5     | Protein PHLOEM PROTEIN 2-LIKE A5                                                  |
 | 115 | AT3G09500  | RPL35A    | 60S ribosomal protein L35-1                                                       |
 | 116 | AT3G10930  | AT3G10930 | Uncharacterized protein At3g10930                                                 |
 | 117 | AT5G02870  | RPL4D     | 60S ribosomal protein L4-2                                                        |
 | 118 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3                                          |
 | 119 | AT3G58120  | BZIP61    | BZIP61                                                                            |
 | 120 | AT4G17490  | ERF6      | Ethylene-responsive transcription factor 6                                        |
 | 121 | AT1G19020  | AT1G19020 | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                 |
 | 122 | AT2G38470  | WRKY33    | WRKY33                                                                            |
 | 123 | AT5G41750  | AT5G41750 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | 124 | AT5G24110  | WRKY30    | Probable WRKY transcription factor 30                                             |
 | 125 | AT3G50930  | HSR4      | Protein HYPER-SENSITIVITY-RELATED 4                                               |
 | 126 | AT5G01540  | LECRK62   | L-type lectin-domain containing receptor kinase VI.2                              |
 | 127 | AT1G21326  | AT1G21326 | F16F4.1 protein                                                                   |
 | 128 | AT1G07135  | AT1G07135 | At1g07135                                                                         |
 | 129 | AT5G28610  | AT5G28610 | LOW protein: ATP-dependent RNA helicase DRS1-like protein                         |
 | 130 | AT1G21120  | AT1G21120 | O-methyltransferase family protein                                                |
 | 131 | AT1G07160  | AT1G07160 | PP2C-type phosphatase AP2C2                                                       |
 | 132 | AT1G43170  | ARP1      | 60S ribosomal protein L3-1                                                        |
 | 133 | AT5G56010  | HSP90-3   | Heat shock protein 90-3                                                           |
 | 134 | AT4G37540  | LBD39     | LOB domain-containing protein 39                                                  |
 | 135 | AT5G25280  | AT5G25280 | AT5g25280/F18G18_20                                                               |
 | 136 | AT4G23220  | CRK14     | Cysteine-rich receptor-like protein kinase 14                                     |
 | 137 | AT1G25440  | COL16     | Zinc finger protein CONSTANS-LIKE 16                                              |
 | 138 | AT4G17390  | RPL15B    | 60S ribosomal protein L15-2                                                       |
 | 139 | AT4G23810  | WRKY53    | Probable WRKY transcription factor 53                                             |
 | 140 | AT4G27280  | KRP1      | Calcium-binding protein KRP1                                                      |
 | 141 | AT5G41740  | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | 142 | AT1G50040  | AT1G50040 | F2J10.8 protein                                                                   |
 | 143 | AT5G01542  | AT5G01542 | Potential natural antisense gene, locus overlaps with AT5G01540                   |
 | 144 | AT1G66090  | AT1G66090 | Disease resistance protein (TIR-NBS class)                                        |
 | 145 | AT2G18440  | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)                                          |
 | 146 | AT5G22250  | CAF1-11   | Probable CCR4-associated factor 1 homolog 11                                      |
 | 147 | AT1G09780  | PGM1      | IPGAM1                                                                            |
 | 148 | AT5G61600  | ERF104    | Ethylene-responsive transcription factor ERF104                                   |
 | 149 | AT3G49010  | RPL13B    | 60S ribosomal protein L13-1                                                       |
 | 150 | AT5G20290  | RPS8A     | 40S ribosomal protein S8                                                          |
 | 151 | AT5G11140  | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                              |
 | 152 | AT1G67430  | RPL17B    | 60S ribosomal protein L17-2                                                       |
 | 153 | AT3G55980  | SZF1      | Salt-inducible zinc finger 1                                                      |
 | 154 | AT4G01250  | WRKY22    | WRKY transcription factor 22                                                      |
 | 155 | AT4G34950  | AT4G34950 | Major facilitator superfamily protein                                             |
 | 156 | AT2G26530  | AR781     | AR781                                                                             |
 | 157 | AT5G18380  | RPS16C    | 40S ribosomal protein S16-3                                                       |
 | 158 | AT1G56242  | AT1G56242 | other RNA                                                                         |
 | 159 | AT1G13930  | AT1G13930 | At1g13930/F16A14.27                                                               |
 | 160 | AT3G05590  | RPL18B    | RPL18                                                                             |
 | 161 | AT2G38310  | PYL4      | Abscisic acid receptor PYL4                                                       |
 | 162 | AT2G21210  | AT2G21210 | SAUR-like auxin-responsive protein family                                         |
 | 163 | AT2G40000  | HSPRO2    | Nematode resistance protein-like HSPRO2                                           |
 | 164 | AT1G18540  | RPL6A     | 60S ribosomal protein L6-1                                                        |
 | 165 | AT3G22121  | AT3G22121 | other RNA                                                                         |
 | 166 | AT3G53870  | RPS3B     | 40S ribosomal protein S3-2                                                        |
 | 167 | AT5G37260  | RVE2      | Protein REVEILLE 2                                                                |
 | 168 | AT3G19680  | AT3G19680 | Uncharacterized protein At3g19680                                                 |
 | 169 | AT4G38840  | AT4G38840 | At4g38840                                                                         |
 | 170 | AT1G58420  | AT1G58420 | At1g58420                                                                         |
 | 171 | AT5G20230  | BCB       | SAG14                                                                             |
 | 172 | AT5G64905  | PEP3      | Elicitor peptide 3                                                                |
 | 173 | AT1G27730  | ZAT10     | Zinc finger protein ZAT10                                                         |
 | 174 | AT5G42380  | CML37     | Calcium-binding protein CML37                                                     |
 | 175 | AT3G52400  | SYP122    | Syntaxin-122                                                                      |
 | 176 | AT1G09690  | RPL21A    | 60S ribosomal protein L21-1                                                       |
 | 177 | AT1G50750  | AT1G50750 | Plant mobile domain protein family                                                |
 | 178 | AT1G19770  | PUP14     | PUP14                                                                             |
 | 179 | AT3G62980  | TIR1      | TIR1                                                                              |
 | 180 | AT5G15845  | AT5G15845 | other RNA                                                                         |
 | 181 | AT5G27420  | ATL31     | E3 ubiquitin-protein ligase ATL31                                                 |
 | 182 | AT2G36530  | ENO2      | LOS2                                                                              |
 | 183 | AT1G79680  | WAKL10    | Wall-associated receptor kinase-like 10                                           |
 | 184 | AT3G60245  | RPL37AC   | 60S ribosomal protein L37a-2                                                      |
 | 185 | AT1G56240  | PP2B13    | F-box protein PP2-B13                                                             |
 | 186 | AT2G40140  | CZF1      | Zinc finger CCCH domain-containing protein 29                                     |
 | 187 | AT3G04400  | RPL23A    | 60S ribosomal protein L23                                                         |
 | 188 | AT2G44840  | ERF13     | Ethylene-responsive transcription factor 13                                       |
 | 189 | AT2G01180  | ATPAP1    | phosphatidic acid phosphatase 1                                                   |
 | 190 | AT1G78080  | RAP2-4    | Ethylene-responsive transcription factor RAP2-4                                   |
 | 191 | AT2G21660  | RBG7      | Glycine-rich RNA-binding protein 7                                                |
 | 192 | AT2G36090  | AT2G36090 | Probable F-box protein At2g36090                                                  |
 | 193 | AT5G51190  | ERF105    | Ethylene-responsive transcription factor ERF105                                   |
 | 194 | AT2G43340  | AT2G43340 | At2g43340                                                                         |
 | 195 | AT2G45180  | AT2G45180 | At2g45180/T14P1.1                                                                 |
 | 196 | AT4G34760  | SAUR50    | Auxin-responsive protein SAUR50                                                   |
 | 197 | AT1G72430  | SAUR78    | Auxin-responsive protein SAUR78                                                   |
 | 198 | AT1G10020  | AT1G10020 | At1g10020                                                                         |
 | 199 | AT2G27660  | AT2G27660 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | 200 | AT5G47230  | ERF5      | ERF5                                                                              |
 | 201 | AT5G60390  | A1        | Elongation factor 1-alpha 4                                                       |
 | 202 | AT5G65630  | GTE7      | Transcription factor GTE7                                                         |
 | 203 | AT1G14320  | RPL10A    | 60S ribosomal protein L10-1                                                       |
 | 204 | AT5G17920  | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1           |
 | 205 | AT5G04340  | ZAT6      | Zinc finger protein ZAT6                                                          |
 | 206 | AT2G02630  | AT2G02630 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | 207 | AT2G31880  | SOBIR1    | Leucine-rich repeat receptor-like serine/threonine/tyrosine-protein kinase SOBIR1 |
 | 208 | AT2G18160  | BZIP2     | bZIP transcription factor 2                                                       |
 | 209 | AT4G31550  | WRKY11    | Probable WRKY transcription factor 11                                             |
 | 210 | AT5G52750  | HIPP13    | Heavy metal-associated isoprenylated plant protein 13                             |
 | 211 | AT1G72610  | GLP1      | Germin-like protein subfamily 3 member 1                                          |
 | 212 | AT3G23810  | SAHH2     | Adenosylhomocysteinase                                                            |
 | 213 | AT2G26560  | PLP2      | Patatin-like protein 2                                                            |
 | 214 | AT5G61590  | ERF107    | Ethylene-responsive transcription factor ERF107                                   |
 | 215 | AT2G32030  | AT2G32030 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                             |
 | 216 | AT5G47210  | RGGC      | RGG repeats nuclear RNA binding protein C                                         |
 | 217 | AT5G14700  | AT5G14700 | Cinnamoyl CoA reductase-like protein                                              |
 | 218 | AT2G35930  | PUB23     | E3 ubiquitin-protein ligase PUB23                                                 |
 | 219 | AT4G28460  | PIP1      | PAMP-induced secreted peptide 1                                                   |
 | 220 | AT4G13940  | SAHH1     | Adenosylhomocysteinase 1                                                          |
 | 221 | AT1G14540  | PER4      | Peroxidase                                                                        |
 | 222 | AT1G76600  | AT1G76600 | Poly polymerase                                                                   |
 | 223 | AT3G22120  | CWLP      | Cell wall-plasma membrane linker protein                                          |
 | 224 | AT3G02840  | AT3G02840 | ARM repeat superfamily protein                                                    |
 | 225 | AT1G59590  | ZCF37     | At1g59590                                                                         |
 | 226 | AT1G69760  | AT1G69760 | At1g69760                                                                         |
 | 227 | AT1G74470  | CHLP      | Geranylgeranyl diphosphate reductase, chloroplastic                               |
 | 228 | AT1G72600  | AT1G72600 | At1g72600                                                                         |
 | 229 | AT4G14365  | XBAT34    | Putative E3 ubiquitin-protein ligase XBAT34                                       |
 | 230 | AT4G13930  | SHM4      | Serine hydroxymethyltransferase 4                                                 |
 | 231 | AT1G05675  | UGT74E1   | Glycosyltransferase (Fragment)                                                    |
 | 232 | AT3G21150  | BBX32     | B-box zinc finger protein 32                                                      |
 | 233 | AT4G24570  | PUMP4     | DIC2                                                                              |
 | 234 | AT2G22880  | AT2G22880 | At2g22880                                                                         |
 | 235 | AT2G17040  | anac036   | NAC domain containing protein 36                                                  |
 | 236 | AT2G30520  | RPT2      | Root phototropism protein 2                                                       |
 | 237 | AT4G29780  | AT4G29780 | Nuclease                                                                          |
 | 238 | AT1G15690  | AVP1      | VHP1                                                                              |
 | 239 | AT2G02950  | PKS1      | Protein PHYTOCHROME KINASE SUBSTRATE 1                                            |
 | 240 | AT3G22970  | AT3G22970 | At3g22970                                                                         |
 | 241 | AT4G14450  | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                  |
 | 242 | AT2G28000  | CPN60A1   | SLP                                                                               |
 | 243 | AT5G61570  | AT5G61570 | Protein kinase superfamily protein                                                |
 | 244 | AT4G38860  | AT4G38860 | At4g38860                                                                         |
 | 245 | AT5G59780  | MYB59     | Transcription factor MYB59                                                        |
 | 246 | AT5G59732  | AT5G59732 | other RNA                                                                         |
 | 247 | AT2G29110  | ATGLR2.8  | Glutamate receptor                                                                |
 | 248 | AT4G18100  | RPL32A    | 60S ribosomal protein L32-1                                                       |
 | 249 | AT1G24145  | AT1G24145 | At1g24145                                                                         |
 :END:


**** Forest on this RFE

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'lym' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [170]:
 # text/org
 | gene      |   importance | name      | description                                                                       |
 |-----------+--------------+-----------+-----------------------------------------------------------------------------------|
 | AT1G19770 |      0.00475 | PUP14     | PUP14                                                                             |
 | AT4G02410 |      0.0047  | LECRK43   | L-type lectin-domain containing receptor kinase IV.3                              |
 | AT3G09500 |      0.0046  | RPL35A    | 60S ribosomal protein L35-1                                                       |
 | AT4G16370 |      0.00455 | ATOPT3    | oligopeptide transporter                                                          |
 | AT2G22880 |      0.00445 | AT2G22880 | At2g22880                                                                         |
 | AT1G61560 |      0.0044  | MLO6      | MLO-like protein 6                                                                |
 | AT1G80080 |      0.0044  | TMM       | TMM                                                                               |
 | AT4G18100 |      0.0044  | RPL32A    | 60S ribosomal protein L32-1                                                       |
 | AT5G52050 |      0.00435 | DTX50     | Protein DETOXIFICATION 50                                                         |
 | AT5G25250 |      0.00435 | FLOT1     | Flotillin-like protein 1                                                          |
 | AT1G72610 |      0.00435 | GLP1      | Germin-like protein subfamily 3 member 1                                          |
 | AT3G23810 |      0.00435 | SAHH2     | Adenosylhomocysteinase                                                            |
 | AT3G23250 |      0.0043  | MYB15     | Transcription factor MYB15                                                        |
 | AT4G27280 |      0.0043  | KRP1      | Calcium-binding protein KRP1                                                      |
 | AT2G40140 |      0.0043  | CZF1      | Zinc finger CCCH domain-containing protein 29                                     |
 | AT1G56242 |      0.0043  | AT1G56242 | other RNA                                                                         |
 | AT4G24570 |      0.00425 | PUMP4     | DIC2                                                                              |
 | AT1G50040 |      0.00425 | AT1G50040 | F2J10.8 protein                                                                   |
 | AT1G07160 |      0.00425 | AT1G07160 | PP2C-type phosphatase AP2C2                                                       |
 | AT2G44840 |      0.00425 | ERF13     | Ethylene-responsive transcription factor 13                                       |
 | AT3G21150 |      0.00425 | BBX32     | B-box zinc finger protein 32                                                      |
 | AT5G11140 |      0.00425 | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                              |
 | AT5G49910 |      0.00425 | HSP70-7   | Heat shock 70 kDa protein 7, chloroplastic                                        |
 | AT2G40330 |      0.00425 | PYL6      | Abscisic acid receptor PYL6                                                       |
 | AT3G52400 |      0.0042  | SYP122    | Syntaxin-122                                                                      |
 | AT4G17490 |      0.0042  | ERF6      | Ethylene-responsive transcription factor 6                                        |
 | AT2G41840 |      0.0042  | RPS2C     | 40S ribosomal protein S2-3                                                        |
 | AT2G23130 |      0.0042  | AGP17     | Lysine-rich arabinogalactan protein 17                                            |
 | AT5G19240 |      0.00415 | AT5G19240 | Uncharacterized GPI-anchored protein At5g19240                                    |
 | AT1G43170 |      0.00415 | ARP1      | 60S ribosomal protein L3-1                                                        |
 | AT4G16720 |      0.00415 | RPL15A    | Ribosomal protein L15                                                             |
 | AT3G50930 |      0.00415 | HSR4      | Protein HYPER-SENSITIVITY-RELATED 4                                               |
 | AT3G16420 |      0.00415 | PBP1      | PYK10-binding protein 1                                                           |
 | AT4G38860 |      0.00415 | AT4G38860 | At4g38860                                                                         |
 | AT3G03125 |      0.0041  | AT3G03125 | None                                                                              |
 | AT5G20230 |      0.0041  | BCB       | SAG14                                                                             |
 | AT2G08475 |      0.0041  | AT2G08475 | None                                                                              |
 | AT4G29780 |      0.0041  | AT4G29780 | Nuclease                                                                          |
 | AT2G26530 |      0.0041  | AR781     | AR781                                                                             |
 | AT1G02780 |      0.00405 | RPL19A    | 60S ribosomal protein L19-1                                                       |
 | AT1G58420 |      0.00405 | AT1G58420 | At1g58420                                                                         |
 | AT2G47440 |      0.00405 | AT2G47440 | Tetratricopeptide repeat (TPR)-like superfamily protein                           |
 | AT5G57220 |      0.00405 | CYP81F2   | Cytochrome P450 81F2                                                              |
 | AT1G20310 |      0.00405 | AT1G20310 | Syringolide-induced protein                                                       |
 | AT5G61600 |      0.00405 | ERF104    | Ethylene-responsive transcription factor ERF104                                   |
 | AT4G22030 |      0.00405 | AT4G22030 | F-box family protein with a domain of unknown function (DUF295)                   |
 | AT2G31880 |      0.004   | SOBIR1    | Leucine-rich repeat receptor-like serine/threonine/tyrosine-protein kinase SOBIR1 |
 | AT1G56070 |      0.004   | LOS1      | Elongation factor 2                                                               |
 | AT5G47230 |      0.004   | ERF5      | ERF5                                                                              |
 | AT1G72430 |      0.004   | SAUR78    | Auxin-responsive protein SAUR78                                                   |
 | AT1G56250 |      0.004   | VBF       | F-box protein VBF                                                                 |
 | AT5G52750 |      0.004   | HIPP13    | Heavy metal-associated isoprenylated plant protein 13                             |
 | AT5G17920 |      0.004   | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1           |
 | AT1G66090 |      0.004   | AT1G66090 | Disease resistance protein (TIR-NBS class)                                        |
 | AT1G15690 |      0.004   | AVP1      | VHP1                                                                              |
 | AT1G26380 |      0.00395 | FOX1      | Berberine bridge enzyme-like 3                                                    |
 | AT2G23270 |      0.00395 | AT2G23270 | At2g23270                                                                         |
 | AT3G04400 |      0.00395 | RPL23A    | 60S ribosomal protein L23                                                         |
 | AT4G15975 |      0.00395 | AT4G15975 | RING/U-box superfamily protein                                                    |
 | AT2G01180 |      0.00395 | ATPAP1    | phosphatidic acid phosphatase 1                                                   |
 | AT2G36690 |      0.00395 | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein           |
 | AT5G25340 |      0.00395 | AT5G25340 | Ubiquitin-like superfamily protein                                                |
 | AT3G53430 |      0.00395 | RPL12B    | 60S ribosomal Protein L12-like                                                    |
 | AT5G59820 |      0.00395 | ZAT12     | Zinc finger protein ZAT12                                                         |
 | AT5G02760 |      0.00395 | AT5G02760 | Probable protein phosphatase 2C 67                                                |
 | AT5G02870 |      0.00395 | RPL4D     | 60S ribosomal protein L4-2                                                        |
 | AT5G59732 |      0.0039  | AT5G59732 | other RNA                                                                         |
 | AT1G14320 |      0.0039  | RPL10A    | 60S ribosomal protein L10-1                                                       |
 | AT5G15845 |      0.0039  | AT5G15845 | other RNA                                                                         |
 | AT2G18440 |      0.0039  | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)                                          |
 | AT5G27420 |      0.0039  | ATL31     | E3 ubiquitin-protein ligase ATL31                                                 |
 | AT1G72370 |      0.0039  | RPSAA     | 40S ribosomal protein SA                                                          |
 | AT1G76600 |      0.0039  | AT1G76600 | Poly polymerase                                                                   |
 | AT1G68550 |      0.0039  | ERF118    | Ethylene-responsive transcription factor ERF118                                   |
 | AT1G09690 |      0.0039  | RPL21A    | 60S ribosomal protein L21-1                                                       |
 | AT3G09200 |      0.0039  | RPP0B     | 60S acidic ribosomal protein P0-2                                                 |
 | AT5G22250 |      0.00385 | CAF1-11   | Probable CCR4-associated factor 1 homolog 11                                      |
 | AT3G10930 |      0.00385 | AT3G10930 | Uncharacterized protein At3g10930                                                 |
 | AT2G28000 |      0.00385 | CPN60A1   | SLP                                                                               |
 | AT2G25735 |      0.00385 | AT2G25735 | Expressed protein                                                                 |
 | AT1G74850 |      0.00385 | PTAC2     | PTAC2                                                                             |
 | AT1G18080 |      0.00385 | RACK1A    | RACK1A_AT                                                                         |
 | AT3G53460 |      0.00385 | CP29      | Chloroplast RNA-binding protein 29                                                |
 | AT1G57990 |      0.00385 | PUP18     | PUP18                                                                             |
 | AT1G10020 |      0.00385 | AT1G10020 | At1g10020                                                                         |
 | AT2G21210 |      0.0038  | AT2G21210 | SAUR-like auxin-responsive protein family                                         |
 | AT4G22710 |      0.0038  | CYP706A2  | Cytochrome P450 - like protein                                                    |
 | AT4G13940 |      0.0038  | SAHH1     | Adenosylhomocysteinase 1                                                          |
 | AT2G26560 |      0.0038  | PLP2      | Patatin-like protein 2                                                            |
 | AT3G07195 |      0.0038  | AT3G07195 | RPM1-interacting protein 4 (RIN4) family protein                                  |
 | AT4G31950 |      0.0038  | CYP82C3   | CYP82C3                                                                           |
 | AT2G17040 |      0.0038  | anac036   | NAC domain containing protein 36                                                  |
 | AT4G23220 |      0.0038  | CRK14     | Cysteine-rich receptor-like protein kinase 14                                     |
 | AT1G17147 |      0.0038  | VQ1       | VQ motif-containing protein 1                                                     |
 | AT2G21660 |      0.0038  | RBG7      | Glycine-rich RNA-binding protein 7                                                |
 | AT4G36500 |      0.0038  | AT4G36500 | Uncharacterized protein At4g36500                                                 |
 | AT5G51190 |      0.00375 | ERF105    | Ethylene-responsive transcription factor ERF105                                   |
 | AT2G35935 |      0.00375 | AT2G35935 | None                                                                              |
 | AT3G58120 |      0.00375 | BZIP61    | BZIP61                                                                            |
 | AT3G59940 |      0.00375 | SKIP20    | F-box/kelch-repeat protein SKIP20                                                 |
 | AT2G33580 |      0.00375 | LYK5      | Protein LYK5                                                                      |
 | AT1G74470 |      0.00375 | CHLP      | Geranylgeranyl diphosphate reductase, chloroplastic                               |
 | AT4G37540 |      0.00375 | LBD39     | LOB domain-containing protein 39                                                  |
 | AT2G31345 |      0.00375 | AT2G31345 | Transmembrane protein                                                             |
 | AT1G19020 |      0.00375 | AT1G19020 | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                 |
 | AT2G02950 |      0.00375 | PKS1      | Protein PHYTOCHROME KINASE SUBSTRATE 1                                            |
 | AT3G22121 |      0.00375 | AT3G22121 | other RNA                                                                         |
 | AT3G04840 |      0.00375 | RPS3AA    | 40S ribosomal protein S3a-1                                                       |
 | AT1G56240 |      0.0037  | PP2B13    | F-box protein PP2-B13                                                             |
 | AT5G24110 |      0.0037  | WRKY30    | Probable WRKY transcription factor 30                                             |
 | AT5G57760 |      0.0037  | AT5G57760 | At5g57760                                                                         |
 | AT3G28340 |      0.0037  | GATL10    | Hexosyltransferase (Fragment)                                                     |
 | AT2G27820 |      0.0037  | ADT3      | Arogenate dehydratase 3, chloroplastic                                            |
 | AT3G53870 |      0.0037  | RPS3B     | 40S ribosomal protein S3-2                                                        |
 | AT1G78170 |      0.0037  | AT1G78170 | E3 ubiquitin-protein ligase                                                       |
 | AT5G59780 |      0.0037  | MYB59     | Transcription factor MYB59                                                        |
 | AT1G48300 |      0.00365 | AT1G48300 | unknown protein                                                                   |
 | AT1G80840 |      0.00365 | WRKY40    | Probable WRKY transcription factor 40                                             |
 | AT2G43340 |      0.00365 | AT2G43340 | At2g43340                                                                         |
 | AT1G61340 |      0.00365 | AT1G61340 | F-box protein At1g61340                                                           |
 | AT1G69760 |      0.00365 | AT1G69760 | At1g69760                                                                         |
 | AT5G28610 |      0.00365 | AT5G28610 | LOW protein: ATP-dependent RNA helicase DRS1-like protein                         |
 | AT3G46130 |      0.00365 | ATMYB48   | myb domain protein 48                                                             |
 | AT1G09780 |      0.00365 | PGM1      | IPGAM1                                                                            |
 | AT3G01165 |      0.00365 | AT3G01165 | None                                                                              |
 | AT3G18710 |      0.00365 | PUB29     | RING-type E3 ubiquitin transferase                                                |
 | AT1G05575 |      0.00365 | AT1G05575 | Transmembrane protein                                                             |
 | AT4G14370 |      0.00365 | AT4G14370 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT5G26920 |      0.00365 | CBP60G    | Calmodulin-binding protein 60 G                                                   |
 | AT4G31550 |      0.00365 | WRKY11    | Probable WRKY transcription factor 11                                             |
 | AT5G05300 |      0.0036  | AT5G05300 | Gb                                                                                |
 | AT5G25350 |      0.0036  | EBF2      | EIN3-binding F-box protein 2                                                      |
 | AT5G42380 |      0.0036  | CML37     | Calcium-binding protein CML37                                                     |
 | AT2G30520 |      0.0036  | RPT2      | Root phototropism protein 2                                                       |
 | AT3G22120 |      0.0036  | CWLP      | Cell wall-plasma membrane linker protein                                          |
 | AT5G02500 |      0.0036  | MED37E    | Probable mediator of RNA polymerase II transcription subunit 37e                  |
 | AT3G25520 |      0.0036  | ATL5      | RPL5A                                                                             |
 | AT2G44670 |      0.0036  | FLZ3      | FCS-Like Zinc finger 3                                                            |
 | AT2G35930 |      0.0036  | PUB23     | E3 ubiquitin-protein ligase PUB23                                                 |
 | AT5G15870 |      0.0036  | AT5G15870 | Glycosyl hydrolase family 81 protein                                              |
 | AT4G28460 |      0.00355 | PIP1      | PAMP-induced secreted peptide 1                                                   |
 | AT1G79680 |      0.00355 | WAKL10    | Wall-associated receptor kinase-like 10                                           |
 | AT4G39260 |      0.00355 | RBG8      | GRP8                                                                              |
 | AT1G21120 |      0.00355 | AT1G21120 | O-methyltransferase family protein                                                |
 | AT5G20630 |      0.00355 | GER3      | Germin-like protein subfamily 3 member 3                                          |
 | AT2G29110 |      0.00355 | ATGLR2.8  | Glutamate receptor                                                                |
 | AT1G25440 |      0.00355 | COL16     | Zinc finger protein CONSTANS-LIKE 16                                              |
 | AT1G12090 |      0.00355 | ELP       | ELP                                                                               |
 | AT3G63200 |      0.00355 | PLP9      | Probable inactive patatin-like protein 9                                          |
 | AT1G14540 |      0.00355 | PER4      | Peroxidase                                                                        |
 | AT5G59730 |      0.00355 | ATEXO70H7 | Exocyst subunit Exo70 family protein                                              |
 | AT2G32030 |      0.00355 | AT2G32030 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                             |
 | AT1G69890 |      0.0035  | AT1G69890 | Actin cross-linking protein (DUF569)                                              |
 | AT4G34950 |      0.0035  | AT4G34950 | Major facilitator superfamily protein                                             |
 | AT1G21326 |      0.0035  | AT1G21326 | F16F4.1 protein                                                                   |
 | AT4G11470 |      0.0035  | CRK31     | cysteine-rich RLK (RECEPTOR-like protein kinase) 31                               |
 | AT1G72910 |      0.0035  | AT1G72910 | Similar to part of disease resistance protein                                     |
 | AT3G29000 |      0.0035  | CML45     | Probable calcium-binding protein CML45                                            |
 | AT5G65310 |      0.0035  | ATHB-5    | Homeobox-leucine zipper protein ATHB-5                                            |
 | AT1G73540 |      0.0035  | NUDT21    | Nudix hydrolase 21, chloroplastic                                                 |
 | AT4G23810 |      0.0035  | WRKY53    | Probable WRKY transcription factor 53                                             |
 | AT4G18197 |      0.0035  | PUP7      | Probable purine permease 7                                                        |
 | AT5G61570 |      0.0035  | AT5G61570 | Protein kinase superfamily protein                                                |
 | AT1G70600 |      0.00345 | RPL27AC   | 60S ribosomal protein L27a-3                                                      |
 | AT5G18380 |      0.00345 | RPS16C    | 40S ribosomal protein S16-3                                                       |
 | AT1G65390 |      0.00345 | PP2A5     | Protein PHLOEM PROTEIN 2-LIKE A5                                                  |
 | AT2G18020 |      0.00345 | RPL8A     | EMB2296                                                                           |
 | AT5G14700 |      0.00345 | AT5G14700 | Cinnamoyl CoA reductase-like protein                                              |
 | AT1G18540 |      0.00345 | RPL6A     | 60S ribosomal protein L6-1                                                        |
 | AT4G19700 |      0.00345 | BOI       | E3 ubiquitin-protein ligase BOI                                                   |
 | AT5G67480 |      0.00345 | BT4       | BTB and TAZ domain protein 4                                                      |
 | AT2G38310 |      0.00345 | PYL4      | Abscisic acid receptor PYL4                                                       |
 | AT5G13930 |      0.00345 | CHS       | Chalcone synthase family protein                                                  |
 | AT1G68520 |      0.00345 | COL6      | Zinc finger protein CONSTANS-LIKE 6                                               |
 | AT1G61360 |      0.0034  | AT1G61360 | Serine/threonine-protein kinase                                                   |
 | AT2G02630 |      0.0034  | AT2G02630 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | AT5G44680 |      0.0034  | AT5G44680 | DNA glycosylase superfamily protein                                               |
 | AT2G38470 |      0.0034  | WRKY33    | WRKY33                                                                            |
 | AT3G49010 |      0.0034  | RPL13B    | 60S ribosomal protein L13-1                                                       |
 | AT2G10940 |      0.0034  | AT2G10940 | At2g10940/F15K19.1                                                                |
 | AT5G25280 |      0.0034  | AT5G25280 | AT5g25280/F18G18_20                                                               |
 | AT5G65630 |      0.0034  | GTE7      | Transcription factor GTE7                                                         |
 | AT3G09630 |      0.0034  | RPL4A     | 60S ribosomal protein L4-1                                                        |
 | AT1G13930 |      0.0034  | AT1G13930 | At1g13930/F16A14.27                                                               |
 | AT1G69530 |      0.0034  | ATEXPA1   | Expansin                                                                          |
 | AT3G44260 |      0.0034  | CAF1-9    | Probable CCR4-associated factor 1 homolog 9                                       |
 | AT5G64905 |      0.0034  | PEP3      | Elicitor peptide 3                                                                |
 | AT2G24600 |      0.00335 | AT2G24600 | Ankyrin repeat family protein                                                     |
 | AT1G72600 |      0.00335 | AT1G72600 | At1g72600                                                                         |
 | AT3G62870 |      0.00335 | RPL7AB    | 60S ribosomal protein L7a-2                                                       |
 | AT1G24145 |      0.00335 | AT1G24145 | At1g24145                                                                         |
 | AT1G72520 |      0.00335 | LOX4      | Lipoxygenase 4, chloroplastic                                                     |
 | AT4G14450 |      0.00335 | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                  |
 | AT5G20290 |      0.00335 | RPS8A     | 40S ribosomal protein S8                                                          |
 | AT5G41740 |      0.00335 | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT5G26742 |      0.00335 | RH3       | RH3                                                                               |
 | AT2G37430 |      0.00335 | ZAT11     | ZAT11                                                                             |
 | AT4G38620 |      0.00335 | MYB4      | Transcription repressor MYB4                                                      |
 | AT2G40000 |      0.00335 | HSPRO2    | Nematode resistance protein-like HSPRO2                                           |
 | AT3G05590 |      0.00335 | RPL18B    | RPL18                                                                             |
 | AT1G67430 |      0.0033  | RPL17B    | 60S ribosomal protein L17-2                                                       |
 | AT1G17420 |      0.0033  | LOX3      | Lipoxygenase 3, chloroplastic                                                     |
 | AT4G01250 |      0.0033  | WRKY22    | WRKY transcription factor 22                                                      |
 | AT3G09260 |      0.0033  | BGLU23    | PYK10                                                                             |
 | AT5G41750 |      0.0033  | AT5G41750 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT4G17390 |      0.0033  | RPL15B    | 60S ribosomal protein L15-2                                                       |
 | AT5G47210 |      0.0033  | RGGC      | RGG repeats nuclear RNA binding protein C                                         |
 | AT4G37370 |      0.0033  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                            |
 | AT1G50750 |      0.0033  | AT1G50750 | Plant mobile domain protein family                                                |
 | AT2G34480 |      0.0033  | AT2G34480 | Ribosomal protein L18ae/LX family protein                                         |
 | AT5G61590 |      0.0033  | ERF107    | Ethylene-responsive transcription factor ERF107                                   |
 | AT5G37260 |      0.00325 | RVE2      | Protein REVEILLE 2                                                                |
 | AT1G12820 |      0.00325 | AFB3      | Protein AUXIN SIGNALING F-BOX 3                                                   |
 | AT1G30370 |      0.00325 | AT1G30370 | DLAH                                                                              |
 | AT5G56030 |      0.00325 | HSP81-2   | Heat shock protein 81-2                                                           |
 | AT5G60390 |      0.00325 | A1        | Elongation factor 1-alpha 4                                                       |
 | AT3G09275 |      0.00325 | AT3G09275 | None                                                                              |
 | AT3G60245 |      0.00325 | RPL37AC   | 60S ribosomal protein L37a-2                                                      |
 | AT2G36090 |      0.00325 | AT2G36090 | Probable F-box protein At2g36090                                                  |
 | AT3G02840 |      0.0032  | AT3G02840 | ARM repeat superfamily protein                                                    |
 | AT1G59590 |      0.0032  | ZCF37     | At1g59590                                                                         |
 | AT5G47850 |      0.0032  | CCR4      | Serine/threonine-protein kinase-like protein CCR4                                 |
 | AT4G23180 |      0.0032  | CRK10     | Cysteine-rich receptor-like protein kinase 10                                     |
 | AT4G13930 |      0.00315 | SHM4      | Serine hydroxymethyltransferase 4                                                 |
 | AT3G22970 |      0.00315 | AT3G22970 | At3g22970                                                                         |
 | AT3G62980 |      0.00315 | TIR1      | TIR1                                                                              |
 | AT3G55980 |      0.00315 | SZF1      | Salt-inducible zinc finger 1                                                      |
 | AT1G24140 |      0.00315 | 3MMP      | Metalloendoproteinase 3-MMP                                                       |
 | AT2G27660 |      0.00315 | AT2G27660 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | AT5G15200 |      0.0031  | RPS9B     | 40S ribosomal protein S9-1                                                        |
 | AT5G01540 |      0.0031  | LECRK62   | L-type lectin-domain containing receptor kinase VI.2                              |
 | AT4G36648 |      0.0031  | AT4G36648 | other RNA                                                                         |
 | AT4G38840 |      0.0031  | AT4G38840 | At4g38840                                                                         |
 | AT2G36530 |      0.0031  | ENO2      | LOS2                                                                              |
 | AT1G07135 |      0.00305 | AT1G07135 | At1g07135                                                                         |
 | AT5G01542 |      0.00305 | AT5G01542 | Potential natural antisense gene, locus overlaps with AT5G01540                   |
 | AT5G56010 |      0.00305 | HSP90-3   | Heat shock protein 90-3                                                           |
 | AT4G34760 |      0.00305 | SAUR50    | Auxin-responsive protein SAUR50                                                   |
 | AT5G04340 |      0.00305 | ZAT6      | Zinc finger protein ZAT6                                                          |
 | AT3G19680 |      0.003   | AT3G19680 | Uncharacterized protein At3g19680                                                 |
 | AT1G78080 |      0.00295 | RAP2-4    | Ethylene-responsive transcription factor RAP2-4                                   |
 | AT1G05675 |      0.00295 | UGT74E1   | Glycosyltransferase (Fragment)                                                    |
 | AT1G78100 |      0.0029  | AT1G78100 | AUF1                                                                              |
 | AT1G79110 |      0.0029  | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                                |
 | AT2G18160 |      0.00285 | BZIP2     | bZIP transcription factor 2                                                       |
 | AT4G14365 |      0.0027  | XBAT34    | Putative E3 ubiquitin-protein ligase XBAT34                                       |
 | AT5G44130 |      0.0026  | FLA13     | Fasciclin-like arabinogalactan protein 13                                         |
 | AT1G27730 |      0.0026  | ZAT10     | Zinc finger protein ZAT10                                                         |
 | AT2G45180 |      0.00225 | AT2G45180 | At2g45180/T14P1.1                                                                 |
 | AT5G03240 |      0.0017  | UBQ3      | Ubiquitin 4                                                                       |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [171]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/576f876e92f2f5600b2ed363a09f6df9f5baf8b2.png]]
 :END:

* Selecting genes for cerk at 05hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.#+BEGIN_SRC ipython :session

   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'cer' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [172]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [173]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [5728 5855 2645 ...  259 3105 2822]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [174]:
 # text/org
 |    | incoming   | name      | description                                                             |
 |----+------------+-----------+-------------------------------------------------------------------------|
 |  0 | AT3G09440  | HSP70-3   | Heat shock protein 70 (Hsp 70) family protein                           |
 |  1 | AT4G01360  | AT4G01360 | BPS1-like protein                                                       |
 |  2 | AT5G42800  | DFRA      | Dihydroflavonol reductase                                               |
 |  3 | AT3G13020  | AT3G13020 | HAT transposon superfamily protein                                      |
 |  4 | AT2G44578  | AT2G44578 | RING/U-box superfamily protein                                          |
 |  5 | AT3G60690  | AT3G60690 | AT3g60690/T4C21_100                                                     |
 |  6 | AT5G05300  | AT5G05300 | Gb                                                                      |
 |  7 | AT3G21080  | AT3G21080 | ABC transporter-like protein                                            |
 |  8 | AT5G24530  | DMR6      | Protein DOWNY MILDEW RESISTANCE 6                                       |
 |  9 | AT4G17490  | ERF6      | Ethylene-responsive transcription factor 6                              |
 | 10 | AT1G07135  | AT1G07135 | At1g07135                                                               |
 | 11 | AT4G23680  | AT4G23680 | AT4g23680/F9D16_150                                                     |
 | 12 | AT3G63095  | AT3G63095 | Tetratricopeptide repeat (TPR)-like superfamily protein                 |
 | 13 | AT3G49900  | AT3G49900 | Phototropic-responsive NPH3 family protein                              |
 | 14 | AT3G60415  | AT3G60415 | At3g60420                                                               |
 | 15 | AT4G35180  | LHT7      | Lysine histidine transporter-like 7                                     |
 | 16 | AT5G59320  | LTP3      | Non-specific lipid-transfer protein 3                                   |
 | 17 | AT2G22860  | PSK2      | Phytosulfokines 2                                                       |
 | 18 | AT1G56242  | AT1G56242 | other RNA                                                               |
 | 19 | AT1G48740  | AT1G48740 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein |
 | 20 | AT5G50790  | SWEET10   | Bidirectional sugar transporter SWEET10                                 |
 | 21 | AT3G48080  | EDS1B     | Protein EDS1B                                                           |
 | 22 | AT5G47500  | PME68     | Probable pectinesterase 68                                              |
 | 23 | AT1G30135  | TIFY5A    | Protein TIFY 5A                                                         |
 | 24 | AT5G05250  | AT5G05250 | AT5g05250/K18I23_5                                                      |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'cer' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [175]:
 # text/org
 | gene      |   importance | name      | description                                                             |
 |-----------+--------------+-----------+-------------------------------------------------------------------------|
 | AT5G50790 |      0.0425  | SWEET10   | Bidirectional sugar transporter SWEET10                                 |
 | AT5G05250 |      0.04245 | AT5G05250 | AT5g05250/K18I23_5                                                      |
 | AT5G24530 |      0.0409  | DMR6      | Protein DOWNY MILDEW RESISTANCE 6                                       |
 | AT5G47500 |      0.0406  | PME68     | Probable pectinesterase 68                                              |
 | AT2G44578 |      0.04055 | AT2G44578 | RING/U-box superfamily protein                                          |
 | AT4G23680 |      0.04025 | AT4G23680 | AT4g23680/F9D16_150                                                     |
 | AT3G13020 |      0.0398  | AT3G13020 | HAT transposon superfamily protein                                      |
 | AT4G35180 |      0.0397  | LHT7      | Lysine histidine transporter-like 7                                     |
 | AT3G49900 |      0.03945 | AT3G49900 | Phototropic-responsive NPH3 family protein                              |
 | AT5G05300 |      0.0394  | AT5G05300 | Gb                                                                      |
 | AT4G17490 |      0.03935 | ERF6      | Ethylene-responsive transcription factor 6                              |
 | AT3G09440 |      0.0393  | HSP70-3   | Heat shock protein 70 (Hsp 70) family protein                           |
 | AT4G01360 |      0.0391  | AT4G01360 | BPS1-like protein                                                       |
 | AT3G48080 |      0.0388  | EDS1B     | Protein EDS1B                                                           |
 | AT1G56242 |      0.0387  | AT1G56242 | other RNA                                                               |
 | AT1G07135 |      0.0386  | AT1G07135 | At1g07135                                                               |
 | AT1G48740 |      0.0386  | AT1G48740 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein |
 | AT5G59320 |      0.0386  | LTP3      | Non-specific lipid-transfer protein 3                                   |
 | AT1G30135 |      0.0377  | TIFY5A    | Protein TIFY 5A                                                         |
 | AT2G22860 |      0.03755 | PSK2      | Phytosulfokines 2                                                       |
 | AT3G60690 |      0.03715 | AT3G60690 | AT3g60690/T4C21_100                                                     |
 | AT5G42800 |      0.0215  | DFRA      | Dihydroflavonol reductase                                               |
 | AT3G60415 |      0.021   | AT3G60415 | At3g60420                                                               |
 | AT3G21080 |      0.021   | AT3G21080 | ABC transporter-like protein                                            |
 | AT3G63095 |      0.0204  | AT3G63095 | Tetratricopeptide repeat (TPR)-like superfamily protein                 |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance', ax=ax)
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [176]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/0d638f691b31ca4778c1b6a683b7a9f64424c46f.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'cer' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [177]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [178]:
 # output
 Num Features: 250
 Selected Features: [False False False ... False False False]
 Feature Ranking: [5503 5630 2420 ...   34 2880 2597]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [179]:
 # text/org
 |     | incoming   | name       | description                                                                                                                  |
 |-----+------------+------------+------------------------------------------------------------------------------------------------------------------------------|
 |   0 | AT3G09440  | HSP70-3    | Heat shock protein 70 (Hsp 70) family protein                                                                                |
 |   1 | AT3G52780  | PAP20      | Probable purple acid phosphatase 20                                                                                          |
 |   2 | AT4G29180  | RHS16      | RHS16                                                                                                                        |
 |   3 | AT1G07143  | AT1G07143  | None                                                                                                                         |
 |   4 | AT1G68520  | COL6       | Zinc finger protein CONSTANS-LIKE 6                                                                                          |
 |   5 | AT1G77000  | SKP2B      | F-box protein SKP2B                                                                                                          |
 |   6 | AT5G06839  | TGA10      | Transcription factor TGA10                                                                                                   |
 |   7 | AT1G69910  | LRK10L-1.5 | LEAF RUST 10 DISEASE-RESISTANCE LOCUS RECEPTOR-LIKE PROTEIN KINASE-like 1.5                                                  |
 |   8 | AT2G01900  | AT2G01900  | DNAse I-like superfamily protein                                                                                             |
 |   9 | AT3G43580  | AT3G43580  | At3g43580                                                                                                                    |
 |  10 | AT4G01360  | AT4G01360  | BPS1-like protein                                                                                                            |
 |  11 | AT1G48930  | AtGH9C1    | Endoglucanase 5                                                                                                              |
 |  12 | AT2G04050  | DTX3       | Protein DETOXIFICATION 3                                                                                                     |
 |  13 | AT1G69890  | AT1G69890  | Actin cross-linking protein (DUF569)                                                                                         |
 |  14 | AT4G18880  | HSFA4A     | HSF A4A                                                                                                                      |
 |  15 | AT4G04540  | CRK39      | Putative cysteine-rich receptor-like protein kinase 39                                                                       |
 |  16 | AT1G49200  | ATL75      | RING-H2 finger protein ATL75                                                                                                 |
 |  17 | AT3G50770  | CML41      | Probable calcium-binding protein CML41                                                                                       |
 |  18 | AT2G37430  | ZAT11      | ZAT11                                                                                                                        |
 |  19 | AT5G59020  | AT5G59020  | Gb                                                                                                                           |
 |  20 | AT3G07900  | OFUT24     | O-fucosyltransferase 24                                                                                                      |
 |  21 | AT5G19080  | LUL3       | Probable E3 ubiquitin-protein ligase LUL3                                                                                    |
 |  22 | AT5G40780  | LHT1       | Lysine histidine transporter 1                                                                                               |
 |  23 | AT5G42800  | DFRA       | Dihydroflavonol reductase                                                                                                    |
 |  24 | AT1G72300  | PSY1R      | Leucine-rich repeat receptor-like protein kinase (Fragment)                                                                  |
 |  25 | AT4G24380  | AT4G24380  | INVOLVED IN: 10-formyltetrahydrofolate biosynthetic process, folic acid and derivative biosynthetic process                  |
 |  26 | AT4G22710  | CYP706A2   | Cytochrome P450 - like protein                                                                                               |
 |  27 | AT2G04240  | XERICO     | Probable E3 ubiquitin-protein ligase XERICO                                                                                  |
 |  28 | AT5G56030  | HSP81-2    | Heat shock protein 81-2                                                                                                      |
 |  29 | AT1G69930  | GSTU11     | Glutathione S-transferase U11                                                                                                |
 |  30 | AT5G66000  | AT5G66000  | Uncharacterized protein At5g66000                                                                                            |
 |  31 | AT4G15270  | AT4G15270  | Glucosyltransferase-like protein (Fragment)                                                                                  |
 |  32 | AT2G36800  | UGT73C5    | Glycosyltransferase (Fragment)                                                                                               |
 |  33 | AT1G16510  | SAUR41     | Auxin-responsive protein SAUR41                                                                                              |
 |  34 | AT1G23830  | AT1G23830  | At1g23830/F5O8_36                                                                                                            |
 |  35 | AT5G49680  | KIP        | Protein KINKY POLLEN                                                                                                         |
 |  36 | AT5G02500  | MED37E     | Probable mediator of RNA polymerase II transcription subunit 37e                                                             |
 |  37 | AT3G13020  | AT3G13020  | HAT transposon superfamily protein                                                                                           |
 |  38 | AT1G60080  | AT1G60080  | 3'-5'-exoribonuclease family protein                                                                                         |
 |  39 | AT4G16350  | CBL6       | Calcineurin B-like protein 6                                                                                                 |
 |  40 | AT1G51660  | MKK4       | MKK4                                                                                                                         |
 |  41 | AT2G36690  | AT2G36690  | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                                      |
 |  42 | AT2G47190  | ATMYB2     | ATMYB2                                                                                                                       |
 |  43 | AT4G18205  | PUP22      | Probable purine permease 22                                                                                                  |
 |  44 | AT4G35730  | AT4G35730  | Regulator of Vps4 activity in the MVB pathway protein                                                                        |
 |  45 | AT1G80160  | AT1G80160  | F18B13.24 protein                                                                                                            |
 |  46 | AT3G52525  | OFP6       | Transcription repressor OFP6                                                                                                 |
 |  47 | AT3G55090  | ABCG16     | ABC transporter G family member 16                                                                                           |
 |  48 | AT1G68450  | VQ8        | VQ motif-containing protein 8, chloroplastic                                                                                 |
 |  49 | AT3G22830  | HSFA6B     | Heat stress transcription factor A-6b                                                                                        |
 |  50 | AT3G60550  | CYCU2-2    | Cyclin-U2-2                                                                                                                  |
 |  51 | AT2G02680  | AT2G02680  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 |  52 | AT3G23170  | AT3G23170  | At3g23170                                                                                                                    |
 |  53 | AT5G52545  | AT5G52545  | unknown protein                                                                                                              |
 |  54 | AT1G66500  | PCFS1      | Polyadenylation and cleavage factor homolog 1                                                                                |
 |  55 | AT4G18197  | PUP7       | Probable purine permease 7                                                                                                   |
 |  56 | AT5G57625  | AT5G57625  | At5g57625                                                                                                                    |
 |  57 | AT2G33815  | AT2G33815  | other RNA                                                                                                                    |
 |  58 | AT1G05950  | AT1G05950  | unknown protein                                                                                                              |
 |  59 | AT5G43420  | ATL16      | RING-H2 finger protein ATL16                                                                                                 |
 |  60 | AT2G09975  | AT2G09975  | None                                                                                                                         |
 |  61 | AT3G29000  | CML45      | Probable calcium-binding protein CML45                                                                                       |
 |  62 | AT1G17420  | LOX3       | Lipoxygenase 3, chloroplastic                                                                                                |
 |  63 | AT1G24260  | SEP3       | At1g24260                                                                                                                    |
 |  64 | AT1G61840  | AT1G61840  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 |  65 | AT3G56880  | AT3G56880  | VQ motif-containing protein                                                                                                  |
 |  66 | AT1G08592  | AT1G08592  | Potential natural antisense gene, locus overlaps with AT1G08590                                                              |
 |  67 | AT4G05910  | AT4G05910  | None                                                                                                                         |
 |  68 | AT1G18300  | NUDT4      | Nudix hydrolase 4                                                                                                            |
 |  69 | AT3G01970  | WRKY45     | Probable WRKY transcription factor 45                                                                                        |
 |  70 | AT1G21100  | IGMT1      | Indole glucosinolate O-methyltransferase 1                                                                                   |
 |  71 | AT1G76240  | AT1G76240  | At1g76240                                                                                                                    |
 |  72 | AT4G24110  | AT4G24110  | NADP-specific glutamate dehydrogenase                                                                                        |
 |  73 | AT3G43840  | AT3G43840  | 3-oxo-5-alpha-steroid 4-dehydrogenase family protein                                                                         |
 |  74 | AT4G17500  | ERF1A      | Ethylene-responsive transcription factor 1A                                                                                  |
 |  75 | AT1G55365  | AT1G55365  | Putative uncharacterized protein                                                                                             |
 |  76 | AT1G54970  | PRP1       | Proline-rich protein 1                                                                                                       |
 |  77 | AT4G03210  | XTH9       | Xyloglucan endotransglucosylase/hydrolase (Fragment)                                                                         |
 |  78 | AT2G44578  | AT2G44578  | RING/U-box superfamily protein                                                                                               |
 |  79 | AT4G37100  | AT4G37100  | Pyridoxal phosphate (PLP)-dependent transferases superfamily protein                                                         |
 |  80 | AT5G51720  | NEET       | NEET                                                                                                                         |
 |  81 | AT2G18210  | AT2G18210  | At2g18210                                                                                                                    |
 |  82 | AT5G55840  | AT5G55840  | Pentatricopeptide repeat (PPR) superfamily protein                                                                           |
 |  83 | AT1G02405  | AT1G02405  | At1g02405                                                                                                                    |
 |  84 | AT2G15390  | FUT4       | Probable fucosyltransferase 4                                                                                                |
 |  85 | AT5G57760  | AT5G57760  | At5g57760                                                                                                                    |
 |  86 | AT4G27657  | AT4G27657  | At4g27657                                                                                                                    |
 |  87 | AT5G53450  | PAP14      | Probable plastid-lipid-associated protein 14, chloroplastic                                                                  |
 |  88 | AT3G60690  | AT3G60690  | AT3g60690/T4C21_100                                                                                                          |
 |  89 | AT1G72520  | LOX4       | Lipoxygenase 4, chloroplastic                                                                                                |
 |  90 | AT3G61760  | DRP1B      | DL1B                                                                                                                         |
 |  91 | AT1G21110  | IGMT3      | Indole glucosinolate O-methyltransferase 3                                                                                   |
 |  92 | AT1G24148  | AT1G24148  | unknown protein                                                                                                              |
 |  93 | AT5G05300  | AT5G05300  | Gb                                                                                                                           |
 |  94 | AT3G48640  | AT3G48640  | Transmembrane protein                                                                                                        |
 |  95 | AT3G21080  | AT3G21080  | ABC transporter-like protein                                                                                                 |
 |  96 | AT3G44260  | CAF1-9     | Probable CCR4-associated factor 1 homolog 9                                                                                  |
 |  97 | AT2G30760  | AT2G30760  | Uncharacterized protein At2g30760                                                                                            |
 |  98 | AT4G26790  | AT4G26790  | GDSL esterase/lipase At4g26790                                                                                               |
 |  99 | AT5G35753  | AT5G35753  | Domain of unknown function (DUF3444)                                                                                         |
 | 100 | AT2G19150  | PME10      | Putative pectinesterase 10                                                                                                   |
 | 101 | AT1G69790  | PBL18      | Probable serine/threonine-protein kinase PBL18                                                                               |
 | 102 | AT5G62470  | MYB96      | Transcription factor MYB96                                                                                                   |
 | 103 | AT5G24530  | DMR6       | Protein DOWNY MILDEW RESISTANCE 6                                                                                            |
 | 104 | AT1G80640  | AT1G80640  | Probable receptor-like protein kinase At1g80640                                                                              |
 | 105 | AT1G55430  | AT1G55430  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | 106 | AT4G17490  | ERF6       | Ethylene-responsive transcription factor 6                                                                                   |
 | 107 | AT1G19020  | AT1G19020  | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                                                            |
 | 108 | AT5G26310  | UGT72E3    | Glycosyltransferase (Fragment)                                                                                               |
 | 109 | AT4G19230  | CYP707A1   | Cytochrome P450, family 707, subfamily A, polypeptide 1                                                                      |
 | 110 | AT1G17240  | AtRLP2     | receptor like protein 2                                                                                                      |
 | 111 | AT5G20710  | BGAL7      | Beta-galactosidase 7                                                                                                         |
 | 112 | AT1G02390  | GPAT2      | Probable glycerol-3-phosphate acyltransferase 2                                                                              |
 | 113 | AT1G35710  | AT1G35710  | Probable leucine-rich repeat receptor-like protein kinase At1g35710                                                          |
 | 114 | AT4G31805  | POLAR      | Protein POLAR LOCALIZATION DURING ASYMMETRIC DIVISION AND REDISTRIBUTION                                                     |
 | 115 | AT3G54590  | EXT2       | Extensin-2                                                                                                                   |
 | 116 | AT1G07135  | AT1G07135  | At1g07135                                                                                                                    |
 | 117 | AT3G46320  | AT3G46320  | Histone H4                                                                                                                   |
 | 118 | AT4G23680  | AT4G23680  | AT4g23680/F9D16_150                                                                                                          |
 | 119 | AT3G05600  | AT3G05600  | Alpha/beta-Hydrolases superfamily protein                                                                                    |
 | 120 | AT4G25220  | RHS15      | Putative glycerol-3-phosphate transporter 2                                                                                  |
 | 121 | AT1G21120  | AT1G21120  | O-methyltransferase family protein                                                                                           |
 | 122 | AT1G75295  | AT1G75295  | other RNA                                                                                                                    |
 | 123 | AT4G28550  | AT4G28550  | At4g28550                                                                                                                    |
 | 124 | AT5G46350  | WRKY8      | WRKY transcription factor 8                                                                                                  |
 | 125 | AT2G17780  | MCA2       | Protein MID1-COMPLEMENTING ACTIVITY 2                                                                                        |
 | 126 | AT3G61800  | AT3G61800  | UV-stimulated scaffold protein A homolog                                                                                     |
 | 127 | AT5G24210  | AT5G24210  | Alpha/beta-Hydrolases superfamily protein                                                                                    |
 | 128 | AT3G63095  | AT3G63095  | Tetratricopeptide repeat (TPR)-like superfamily protein                                                                      |
 | 129 | AT5G56010  | HSP90-3    | Heat shock protein 90-3                                                                                                      |
 | 130 | AT2G36650  | AT2G36650  | CHUP1-like protein                                                                                                           |
 | 131 | AT3G49900  | AT3G49900  | Phototropic-responsive NPH3 family protein                                                                                   |
 | 132 | AT5G25280  | AT5G25280  | AT5g25280/F18G18_20                                                                                                          |
 | 133 | AT1G19397  | AT1G19397  | unknown protein                                                                                                              |
 | 134 | AT4G22467  | AT4G22467  | None                                                                                                                         |
 | 135 | AT4G21865  | AT4G21865  | At4g21865                                                                                                                    |
 | 136 | AT3G60415  | AT3G60415  | At3g60420                                                                                                                    |
 | 137 | AT4G11280  | ACS6       | 1-aminocyclopropane-1-carboxylate synthase 6                                                                                 |
 | 138 | AT1G61080  | AT1G61080  | Hydroxyproline-rich glycoprotein family protein                                                                              |
 | 139 | AT3G51330  | AT3G51330  | Eukaryotic aspartyl protease family protein                                                                                  |
 | 140 | AT3G30460  | AT3G30460  | RING/U-box superfamily protein                                                                                               |
 | 141 | AT2G45760  | BAP2       | BON1-associated protein 2                                                                                                    |
 | 142 | AT5G22250  | CAF1-11    | Probable CCR4-associated factor 1 homolog 11                                                                                 |
 | 143 | AT4G35180  | LHT7       | Lysine histidine transporter-like 7                                                                                          |
 | 144 | AT5G61600  | ERF104     | Ethylene-responsive transcription factor ERF104                                                                              |
 | 145 | AT3G03000  | CML18      | Probable calcium-binding protein CML18                                                                                       |
 | 146 | AT2G39370  | MAKR4      | Probable membrane-associated kinase regulator 4                                                                              |
 | 147 | AT1G63580  | CRRSP6     | Probable cysteine-rich repeat secretory protein 6                                                                            |
 | 148 | AT2G29460  | GSTU4      | Glutathione S-transferase U4                                                                                                 |
 | 149 | AT2G35980  | NHL10      | NDR1/HIN1-like protein 10                                                                                                    |
 | 150 | AT1G33170  | AT1G33170  | Probable methyltransferase PMT18                                                                                             |
 | 151 | AT3G47430  | PEX11B     | Peroxisomal membrane protein 11B                                                                                             |
 | 152 | AT5G64810  | WRKY51     | Probable WRKY transcription factor 51                                                                                        |
 | 153 | AT2G36430  | AT2G36430  | Transmembrane protein, putative (DUF247)                                                                                     |
 | 154 | AT5G17780  | AT5G17780  | alpha/beta-Hydrolases superfamily protein                                                                                    |
 | 155 | AT5G21960  | ERF016     | Ethylene-responsive transcription factor ERF016                                                                              |
 | 156 | AT5G59320  | LTP3       | Non-specific lipid-transfer protein 3                                                                                        |
 | 157 | AT2G44700  | AT2G44700  | F-box/kelch-repeat protein At2g44700                                                                                         |
 | 158 | AT1G32970  | SBT3.2     | Subtilisin-like protease SBT3.2                                                                                              |
 | 159 | AT3G55980  | SZF1       | Salt-inducible zinc finger 1                                                                                                 |
 | 160 | AT4G15070  | AT4G15070  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | 161 | AT2G26530  | AR781      | AR781                                                                                                                        |
 | 162 | AT2G22860  | PSK2       | Phytosulfokines 2                                                                                                            |
 | 163 | AT1G56242  | AT1G56242  | other RNA                                                                                                                    |
 | 164 | AT1G73740  | AT1G73740  | Putative UDP-N-acetylglucosamine--N-acetylmuramyl-(Pentapeptide)-pyrophosphoryl-undecaprenol N-acetylglucosamine transferase |
 | 165 | AT3G18915  | AT3G18915  | Transmembrane protein                                                                                                        |
 | 166 | AT4G31510  | AT4G31510  | Major centromere autoantigen B-like protein                                                                                  |
 | 167 | AT1G48740  | AT1G48740  | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                                      |
 | 168 | AT5G08070  | TCP17      | Transcription factor TCP17                                                                                                   |
 | 169 | AT2G21210  | AT2G21210  | SAUR-like auxin-responsive protein family                                                                                    |
 | 170 | AT3G61280  | AT3G61280  | Glycosyltransferase                                                                                                          |
 | 171 | AT1G02400  | GA2OX6     | Gibberellin 2-beta-dioxygenase 6                                                                                             |
 | 172 | AT5G60310  | LECRK110   | Putative L-type lectin-domain containing receptor kinase I.10                                                                |
 | 173 | AT3G56790  | AT3G56790  | RNA splicing factor-like protein                                                                                             |
 | 174 | AT1G63350  | AT1G63350  | Disease resistance protein (CC-NBS-LRR class) family                                                                         |
 | 175 | AT2G22890  | FAD4L2     | Fatty acid desaturase 4-like 2, chloroplastic                                                                                |
 | 176 | AT2G18560  | AT2G18560  | UDP-Glycosyltransferase superfamily protein                                                                                  |
 | 177 | AT3G57630  | AT3G57630  | At3g57630                                                                                                                    |
 | 178 | AT2G32150  | AT2G32150  | At2g32150/F22D22.10                                                                                                          |
 | 179 | AT5G17220  | GSTF12     | Glutathione S-transferase F12                                                                                                |
 | 180 | AT5G23990  | ATFRO5     | ferric reduction oxidase 5                                                                                                   |
 | 181 | AT1G27730  | ZAT10      | Zinc finger protein ZAT10                                                                                                    |
 | 182 | AT3G52400  | SYP122     | Syntaxin-122                                                                                                                 |
 | 183 | AT5G50790  | SWEET10    | Bidirectional sugar transporter SWEET10                                                                                      |
 | 184 | AT5G24910  | CYP714A1   | Cytochrome P450 714A1                                                                                                        |
 | 185 | AT4G26470  | AT4G26470  | Calcium-binding EF-hand family protein                                                                                       |
 | 186 | AT5G27420  | ATL31      | E3 ubiquitin-protein ligase ATL31                                                                                            |
 | 187 | AT1G16830  | AT1G16830  | Putative pentatricopeptide repeat-containing protein At1g16830                                                               |
 | 188 | AT1G32920  | AT1G32920  | At1g32920/F9L11_25                                                                                                           |
 | 189 | AT5G19070  | AT5G19070  | At5g19070                                                                                                                    |
 | 190 | AT3G19390  | RD21C      | Probable cysteine protease RD21C                                                                                             |
 | 191 | AT1G79680  | WAKL10     | Wall-associated receptor kinase-like 10                                                                                      |
 | 192 | AT1G27370  | SPL10      | Squamosa promoter-binding-like protein 10                                                                                    |
 | 193 | AT3G53270  | AT3G53270  | Small nuclear RNA activating complex (SNAPc), subunit SNAP43 protein                                                         |
 | 194 | AT2G16870  | AT2G16870  | Disease resistance protein (TIR-NBS-LRR class) family                                                                        |
 | 195 | AT2G45870  | AT2G45870  | UPF0187 protein At2g45870, chloroplastic                                                                                     |
 | 196 | AT2G47750  | GH3.9      | Putative indole-3-acetic acid-amido synthetase GH3.9                                                                         |
 | 197 | AT5G54860  | AT5G54860  | Probable folate-biopterin transporter 4                                                                                      |
 | 198 | AT3G21700  | SGP2       | Monomeric G-protein                                                                                                          |
 | 199 | AT5G51190  | ERF105     | Ethylene-responsive transcription factor ERF105                                                                              |
 | 200 | AT2G18193  | AT2G18193  | AAA-ATPase At2g18193                                                                                                         |
 | 201 | AT5G59220  | SAG113     | Probable protein phosphatase 2C 78                                                                                           |
 | 202 | AT4G02290  | AtGH9B13   | Endoglucanase 17                                                                                                             |
 | 203 | AT4G08985  | AT4G08985  | None                                                                                                                         |
 | 204 | AT5G51465  | AT5G51465  | None                                                                                                                         |
 | 205 | AT1G31290  | AGO3       | Protein argonaute 3                                                                                                          |
 | 206 | AT1G15890  | AT1G15890  | Probable disease resistance protein At1g15890                                                                                |
 | 207 | AT5G21940  | AT5G21940  | At5g21940                                                                                                                    |
 | 208 | AT5G56750  | NDL1       | Protein NDL1                                                                                                                 |
 | 209 | AT1G19025  | AT1G19025  | DNA repair metallo-beta-lactamase family protein                                                                             |
 | 210 | AT5G41080  | GDPD2      | Glycerophosphodiester phosphodiesterase GDPD2                                                                                |
 | 211 | AT4G11910  | SGR2       | Protein STAY-GREEN 2, chloroplastic                                                                                          |
 | 212 | AT3G57910  | AT3G57910  | At3g57910                                                                                                                    |
 | 213 | AT3G47780  | ABCA7      | ABC transporter A family member 7                                                                                            |
 | 214 | AT1G54650  | AT1G54650  | Methyltransferase family protein                                                                                             |
 | 215 | AT1G28230  | PUP1       | Purine permease 1                                                                                                            |
 | 216 | AT3G15060  | RABA1G     | Ras-related protein RABA1g                                                                                                   |
 | 217 | AT4G31550  | WRKY11     | Probable WRKY transcription factor 11                                                                                        |
 | 218 | AT1G11050  | AT1G11050  | Probable receptor-like protein kinase At1g11050                                                                              |
 | 219 | AT2G35000  | ATL9       | E3 ubiquitin-protein ligase ATL9                                                                                             |
 | 220 | AT1G48500  | TIFY6A     | Protein TIFY 6A                                                                                                              |
 | 221 | AT2G32030  | AT2G32030  | Acyl-CoA N-acyltransferases (NAT) superfamily protein                                                                        |
 | 222 | AT5G23350  | AT5G23350  | GEM-like protein 6                                                                                                           |
 | 223 | AT5G22794  | AT5G22794  | FUNCTIONS IN: molecular_function unknown                                                                                     |
 | 224 | AT5G57560  | XTH22      | Xyloglucan endotransglucosylase/hydrolase                                                                                    |
 | 225 | AT2G02635  | AT2G02635  | None                                                                                                                         |
 | 226 | AT5G36970  | NHL25      | NHL25                                                                                                                        |
 | 227 | AT1G76650  | CML38      | CML38                                                                                                                        |
 | 228 | AT4G08935  | AT4G08935  | None                                                                                                                         |
 | 229 | AT1G60590  | AT1G60590  | Pectin lyase-like superfamily protein                                                                                        |
 | 230 | AT3G48080  | EDS1B      | Protein EDS1B                                                                                                                |
 | 231 | AT5G47500  | PME68      | Probable pectinesterase 68                                                                                                   |
 | 232 | AT4G38950  | KIN7F      | Kinesin-like protein KIN-7F                                                                                                  |
 | 233 | AT2G41010  | CAMBP25    | Calmodulin-binding protein 25                                                                                                |
 | 234 | AT4G24570  | PUMP4      | DIC2                                                                                                                         |
 | 235 | AT5G57770  | AT5G57770  | Plant protein of unknown function (DUF828) with plant pleckstrin homology-like region                                        |
 | 236 | AT3G49620  | DIN11      | Probable 2-oxoglutarate-dependent dioxygenase DIN11                                                                          |
 | 237 | AT1G30135  | TIFY5A     | Protein TIFY 5A                                                                                                              |
 | 238 | AT5G56220  | AT5G56220  | P-loop containing nucleoside triphosphate hydrolases superfamily protein                                                     |
 | 239 | AT1G78090  | TPPB       | Trehalose-phosphate phosphatase B                                                                                            |
 | 240 | AT4G21830  | MSRB7      | Peptide methionine sulfoxide reductase B7                                                                                    |
 | 241 | AT5G05250  | AT5G05250  | AT5g05250/K18I23_5                                                                                                           |
 | 242 | AT3G16860  | COBL8      | COBRA-like protein 8                                                                                                         |
 | 243 | AT4G01450  | AT4G01450  | WAT1-related protein At4g01450                                                                                               |
 | 244 | AT1G29500  | SAUR66     | Auxin-responsive protein SAUR66                                                                                              |
 | 245 | AT4G31330  | AT4G31330  | Uncharacterized protein At4g31330                                                                                            |
 | 246 | AT4G35770  | STR15      | SEN1                                                                                                                         |
 | 247 | AT3G14475  | AT3G14475  | snoRNA                                                                                                                       |
 | 248 | AT5G66080  | AT5G66080  | Probable protein phosphatase 2C 79                                                                                           |
 | 249 | AT3G02210  | COBL1      | COBRA-like protein                                                                                                           |
 :END:


**** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'cer' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [180]:
 # text/org
 | gene      |   importance | name       | description                                                                                                                  |
 |-----------+--------------+------------+------------------------------------------------------------------------------------------------------------------------------|
 | AT5G66000 |      0.0056  | AT5G66000  | Uncharacterized protein At5g66000                                                                                            |
 | AT5G57770 |      0.00555 | AT5G57770  | Plant protein of unknown function (DUF828) with plant pleckstrin homology-like region                                        |
 | AT4G18205 |      0.00535 | PUP22      | Probable purine permease 22                                                                                                  |
 | AT3G61280 |      0.00525 | AT3G61280  | Glycosyltransferase                                                                                                          |
 | AT1G69890 |      0.00525 | AT1G69890  | Actin cross-linking protein (DUF569)                                                                                         |
 | AT3G03000 |      0.0051  | CML18      | Probable calcium-binding protein CML18                                                                                       |
 | AT3G23170 |      0.0051  | AT3G23170  | At3g23170                                                                                                                    |
 | AT2G16870 |      0.00505 | AT2G16870  | Disease resistance protein (TIR-NBS-LRR class) family                                                                        |
 | AT5G24530 |      0.00495 | DMR6       | Protein DOWNY MILDEW RESISTANCE 6                                                                                            |
 | AT1G56242 |      0.0049  | AT1G56242  | other RNA                                                                                                                    |
 | AT3G14475 |      0.0049  | AT3G14475  | snoRNA                                                                                                                       |
 | AT3G05600 |      0.0049  | AT3G05600  | Alpha/beta-Hydrolases superfamily protein                                                                                    |
 | AT5G59320 |      0.0049  | LTP3       | Non-specific lipid-transfer protein 3                                                                                        |
 | AT5G25280 |      0.0049  | AT5G25280  | AT5g25280/F18G18_20                                                                                                          |
 | AT3G61760 |      0.00485 | DRP1B      | DL1B                                                                                                                         |
 | AT3G54590 |      0.00485 | EXT2       | Extensin-2                                                                                                                   |
 | AT4G31550 |      0.00485 | WRKY11     | Probable WRKY transcription factor 11                                                                                        |
 | AT4G35180 |      0.0048  | LHT7       | Lysine histidine transporter-like 7                                                                                          |
 | AT5G62470 |      0.0048  | MYB96      | Transcription factor MYB96                                                                                                   |
 | AT4G15270 |      0.00475 | AT4G15270  | Glucosyltransferase-like protein (Fragment)                                                                                  |
 | AT5G61600 |      0.00475 | ERF104     | Ethylene-responsive transcription factor ERF104                                                                              |
 | AT2G37430 |      0.00475 | ZAT11      | ZAT11                                                                                                                        |
 | AT4G01450 |      0.00475 | AT4G01450  | WAT1-related protein At4g01450                                                                                               |
 | AT1G68520 |      0.00475 | COL6       | Zinc finger protein CONSTANS-LIKE 6                                                                                          |
 | AT4G17490 |      0.0047  | ERF6       | Ethylene-responsive transcription factor 6                                                                                   |
 | AT3G46320 |      0.0047  | AT3G46320  | Histone H4                                                                                                                   |
 | AT2G29460 |      0.0047  | GSTU4      | Glutathione S-transferase U4                                                                                                 |
 | AT4G02290 |      0.00465 | AtGH9B13   | Endoglucanase 17                                                                                                             |
 | AT4G24110 |      0.00465 | AT4G24110  | NADP-specific glutamate dehydrogenase                                                                                        |
 | AT4G25220 |      0.00465 | RHS15      | Putative glycerol-3-phosphate transporter 2                                                                                  |
 | AT3G52400 |      0.00465 | SYP122     | Syntaxin-122                                                                                                                 |
 | AT3G01970 |      0.00465 | WRKY45     | Probable WRKY transcription factor 45                                                                                        |
 | AT2G18560 |      0.00465 | AT2G18560  | UDP-Glycosyltransferase superfamily protein                                                                                  |
 | AT1G24260 |      0.00465 | SEP3       | At1g24260                                                                                                                    |
 | AT4G38950 |      0.0046  | KIN7F      | Kinesin-like protein KIN-7F                                                                                                  |
 | AT2G32150 |      0.0046  | AT2G32150  | At2g32150/F22D22.10                                                                                                          |
 | AT1G33170 |      0.0046  | AT1G33170  | Probable methyltransferase PMT18                                                                                             |
 | AT1G18300 |      0.0046  | NUDT4      | Nudix hydrolase 4                                                                                                            |
 | AT5G51190 |      0.00455 | ERF105     | Ethylene-responsive transcription factor ERF105                                                                              |
 | AT1G48500 |      0.00455 | TIFY6A     | Protein TIFY 6A                                                                                                              |
 | AT2G35980 |      0.00455 | NHL10      | NDR1/HIN1-like protein 10                                                                                                    |
 | AT5G46350 |      0.00455 | WRKY8      | WRKY transcription factor 8                                                                                                  |
 | AT2G36650 |      0.00455 | AT2G36650  | CHUP1-like protein                                                                                                           |
 | AT5G21940 |      0.00455 | AT5G21940  | At5g21940                                                                                                                    |
 | AT1G77000 |      0.00455 | SKP2B      | F-box protein SKP2B                                                                                                          |
 | AT3G53270 |      0.00455 | AT3G53270  | Small nuclear RNA activating complex (SNAPc), subunit SNAP43 protein                                                         |
 | AT4G23680 |      0.00455 | AT4G23680  | AT4g23680/F9D16_150                                                                                                          |
 | AT4G21830 |      0.0045  | MSRB7      | Peptide methionine sulfoxide reductase B7                                                                                    |
 | AT2G21210 |      0.0045  | AT2G21210  | SAUR-like auxin-responsive protein family                                                                                    |
 | AT4G15070 |      0.0045  | AT4G15070  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | AT1G49200 |      0.0045  | ATL75      | RING-H2 finger protein ATL75                                                                                                 |
 | AT4G27657 |      0.0045  | AT4G27657  | At4g27657                                                                                                                    |
 | AT5G56750 |      0.0045  | NDL1       | Protein NDL1                                                                                                                 |
 | AT5G51720 |      0.0045  | NEET       | NEET                                                                                                                         |
 | AT5G02500 |      0.0045  | MED37E     | Probable mediator of RNA polymerase II transcription subunit 37e                                                             |
 | AT3G47430 |      0.0045  | PEX11B     | Peroxisomal membrane protein 11B                                                                                             |
 | AT1G15890 |      0.0045  | AT1G15890  | Probable disease resistance protein At1g15890                                                                                |
 | AT5G21960 |      0.0045  | ERF016     | Ethylene-responsive transcription factor ERF016                                                                              |
 | AT3G60690 |      0.0045  | AT3G60690  | AT3g60690/T4C21_100                                                                                                          |
 | AT1G32920 |      0.0045  | AT1G32920  | At1g32920/F9L11_25                                                                                                           |
 | AT1G75295 |      0.0045  | AT1G75295  | other RNA                                                                                                                    |
 | AT3G55090 |      0.0045  | ABCG16     | ABC transporter G family member 16                                                                                           |
 | AT2G04240 |      0.0045  | XERICO     | Probable E3 ubiquitin-protein ligase XERICO                                                                                  |
 | AT1G02390 |      0.0045  | GPAT2      | Probable glycerol-3-phosphate acyltransferase 2                                                                              |
 | AT5G59020 |      0.00445 | AT5G59020  | Gb                                                                                                                           |
 | AT1G79680 |      0.00445 | WAKL10     | Wall-associated receptor kinase-like 10                                                                                      |
 | AT1G30135 |      0.00445 | TIFY5A     | Protein TIFY 5A                                                                                                              |
 | AT4G31330 |      0.00445 | AT4G31330  | Uncharacterized protein At4g31330                                                                                            |
 | AT1G19020 |      0.00445 | AT1G19020  | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                                                            |
 | AT4G29180 |      0.00445 | RHS16      | RHS16                                                                                                                        |
 | AT1G61080 |      0.00445 | AT1G61080  | Hydroxyproline-rich glycoprotein family protein                                                                              |
 | AT1G31290 |      0.00445 | AGO3       | Protein argonaute 3                                                                                                          |
 | AT1G29500 |      0.0044  | SAUR66     | Auxin-responsive protein SAUR66                                                                                              |
 | AT4G16350 |      0.0044  | CBL6       | Calcineurin B-like protein 6                                                                                                 |
 | AT4G26470 |      0.0044  | AT4G26470  | Calcium-binding EF-hand family protein                                                                                       |
 | AT4G19230 |      0.0044  | CYP707A1   | Cytochrome P450, family 707, subfamily A, polypeptide 1                                                                      |
 | AT2G18193 |      0.00435 | AT2G18193  | AAA-ATPase At2g18193                                                                                                         |
 | AT5G27420 |      0.00435 | ATL31      | E3 ubiquitin-protein ligase ATL31                                                                                            |
 | AT5G56220 |      0.00435 | AT5G56220  | P-loop containing nucleoside triphosphate hydrolases superfamily protein                                                     |
 | AT3G56790 |      0.00435 | AT3G56790  | RNA splicing factor-like protein                                                                                             |
 | AT4G35730 |      0.00435 | AT4G35730  | Regulator of Vps4 activity in the MVB pathway protein                                                                        |
 | AT4G31510 |      0.00435 | AT4G31510  | Major centromere autoantigen B-like protein                                                                                  |
 | AT2G22860 |      0.0043  | PSK2       | Phytosulfokines 2                                                                                                            |
 | AT5G20710 |      0.0043  | BGAL7      | Beta-galactosidase 7                                                                                                         |
 | AT5G49680 |      0.0043  | KIP        | Protein KINKY POLLEN                                                                                                         |
 | AT2G41010 |      0.0043  | CAMBP25    | Calmodulin-binding protein 25                                                                                                |
 | AT1G66500 |      0.0043  | PCFS1      | Polyadenylation and cleavage factor homolog 1                                                                                |
 | AT2G32030 |      0.0043  | AT2G32030  | Acyl-CoA N-acyltransferases (NAT) superfamily protein                                                                        |
 | AT1G02400 |      0.0043  | GA2OX6     | Gibberellin 2-beta-dioxygenase 6                                                                                             |
 | AT4G11910 |      0.0043  | SGR2       | Protein STAY-GREEN 2, chloroplastic                                                                                          |
 | AT5G59220 |      0.0043  | SAG113     | Probable protein phosphatase 2C 78                                                                                           |
 | AT5G55840 |      0.00425 | AT5G55840  | Pentatricopeptide repeat (PPR) superfamily protein                                                                           |
 | AT2G44700 |      0.00425 | AT2G44700  | F-box/kelch-repeat protein At2g44700                                                                                         |
 | AT1G60590 |      0.00425 | AT1G60590  | Pectin lyase-like superfamily protein                                                                                        |
 | AT5G05250 |      0.00425 | AT5G05250  | AT5g05250/K18I23_5                                                                                                           |
 | AT5G52545 |      0.00425 | AT5G52545  | unknown protein                                                                                                              |
 | AT5G17780 |      0.0042  | AT5G17780  | alpha/beta-Hydrolases superfamily protein                                                                                    |
 | AT4G01360 |      0.0042  | AT4G01360  | BPS1-like protein                                                                                                            |
 | AT2G47750 |      0.0042  | GH3.9      | Putative indole-3-acetic acid-amido synthetase GH3.9                                                                         |
 | AT5G22250 |      0.0042  | CAF1-11    | Probable CCR4-associated factor 1 homolog 11                                                                                 |
 | AT1G69930 |      0.0042  | GSTU11     | Glutathione S-transferase U11                                                                                                |
 | AT1G16510 |      0.0042  | SAUR41     | Auxin-responsive protein SAUR41                                                                                              |
 | AT4G24380 |      0.00415 | AT4G24380  | INVOLVED IN: 10-formyltetrahydrofolate biosynthetic process, folic acid and derivative biosynthetic process                  |
 | AT5G19070 |      0.00415 | AT5G19070  | At5g19070                                                                                                                    |
 | AT4G37100 |      0.00415 | AT4G37100  | Pyridoxal phosphate (PLP)-dependent transferases superfamily protein                                                         |
 | AT1G11050 |      0.00415 | AT1G11050  | Probable receptor-like protein kinase At1g11050                                                                              |
 | AT1G16830 |      0.00415 | AT1G16830  | Putative pentatricopeptide repeat-containing protein At1g16830                                                               |
 | AT4G18197 |      0.00415 | PUP7       | Probable purine permease 7                                                                                                   |
 | AT5G19080 |      0.00415 | LUL3       | Probable E3 ubiquitin-protein ligase LUL3                                                                                    |
 | AT5G57560 |      0.0041  | XTH22      | Xyloglucan endotransglucosylase/hydrolase                                                                                    |
 | AT3G61800 |      0.0041  | AT3G61800  | UV-stimulated scaffold protein A homolog                                                                                     |
 | AT5G41080 |      0.0041  | GDPD2      | Glycerophosphodiester phosphodiesterase GDPD2                                                                                |
 | AT3G21700 |      0.0041  | SGP2       | Monomeric G-protein                                                                                                          |
 | AT5G50790 |      0.0041  | SWEET10    | Bidirectional sugar transporter SWEET10                                                                                      |
 | AT1G55430 |      0.0041  | AT1G55430  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | AT1G54650 |      0.0041  | AT1G54650  | Methyltransferase family protein                                                                                             |
 | AT4G18880 |      0.0041  | HSFA4A     | HSF A4A                                                                                                                      |
 | AT3G09440 |      0.00405 | HSP70-3    | Heat shock protein 70 (Hsp 70) family protein                                                                                |
 | AT1G60080 |      0.00405 | AT1G60080  | 3'-5'-exoribonuclease family protein                                                                                         |
 | AT1G55365 |      0.00405 | AT1G55365  | Putative uncharacterized protein                                                                                             |
 | AT4G22710 |      0.00405 | CYP706A2   | Cytochrome P450 - like protein                                                                                               |
 | AT1G05950 |      0.004   | AT1G05950  | unknown protein                                                                                                              |
 | AT1G32970 |      0.004   | SBT3.2     | Subtilisin-like protease SBT3.2                                                                                              |
 | AT1G19025 |      0.004   | AT1G19025  | DNA repair metallo-beta-lactamase family protein                                                                             |
 | AT4G26790 |      0.004   | AT4G26790  | GDSL esterase/lipase At4g26790                                                                                               |
 | AT2G36800 |      0.004   | UGT73C5    | Glycosyltransferase (Fragment)                                                                                               |
 | AT2G02635 |      0.00395 | AT2G02635  | None                                                                                                                         |
 | AT5G05300 |      0.00395 | AT5G05300  | Gb                                                                                                                           |
 | AT5G26310 |      0.00395 | UGT72E3    | Glycosyltransferase (Fragment)                                                                                               |
 | AT3G51330 |      0.00395 | AT3G51330  | Eukaryotic aspartyl protease family protein                                                                                  |
 | AT3G48080 |      0.00395 | EDS1B      | Protein EDS1B                                                                                                                |
 | AT1G54970 |      0.0039  | PRP1       | Proline-rich protein 1                                                                                                       |
 | AT1G07135 |      0.0039  | AT1G07135  | At1g07135                                                                                                                    |
 | AT1G21120 |      0.0039  | AT1G21120  | O-methyltransferase family protein                                                                                           |
 | AT3G13020 |      0.0039  | AT3G13020  | HAT transposon superfamily protein                                                                                           |
 | AT4G03210 |      0.0039  | XTH9       | Xyloglucan endotransglucosylase/hydrolase (Fragment)                                                                         |
 | AT1G17420 |      0.0039  | LOX3       | Lipoxygenase 3, chloroplastic                                                                                                |
 | AT2G02680 |      0.0039  | AT2G02680  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | AT1G28230 |      0.0039  | PUP1       | Purine permease 1                                                                                                            |
 | AT2G36430 |      0.0039  | AT2G36430  | Transmembrane protein, putative (DUF247)                                                                                     |
 | AT4G17500 |      0.0039  | ERF1A      | Ethylene-responsive transcription factor 1A                                                                                  |
 | AT2G01900 |      0.0039  | AT2G01900  | DNAse I-like superfamily protein                                                                                             |
 | AT2G18210 |      0.00385 | AT2G18210  | At2g18210                                                                                                                    |
 | AT5G40780 |      0.00385 | LHT1       | Lysine histidine transporter 1                                                                                               |
 | AT4G21865 |      0.00385 | AT4G21865  | At4g21865                                                                                                                    |
 | AT2G47190 |      0.00385 | ATMYB2     | ATMYB2                                                                                                                       |
 | AT5G23350 |      0.00385 | AT5G23350  | GEM-like protein 6                                                                                                           |
 | AT4G08935 |      0.00385 | AT4G08935  | None                                                                                                                         |
 | AT3G18915 |      0.00385 | AT3G18915  | Transmembrane protein                                                                                                        |
 | AT2G39370 |      0.00385 | MAKR4      | Probable membrane-associated kinase regulator 4                                                                              |
 | AT3G29000 |      0.00385 | CML45      | Probable calcium-binding protein CML45                                                                                       |
 | AT4G31805 |      0.00385 | POLAR      | Protein POLAR LOCALIZATION DURING ASYMMETRIC DIVISION AND REDISTRIBUTION                                                     |
 | AT5G57760 |      0.0038  | AT5G57760  | At5g57760                                                                                                                    |
 | AT2G22890 |      0.0038  | FAD4L2     | Fatty acid desaturase 4-like 2, chloroplastic                                                                                |
 | AT1G76650 |      0.0038  | CML38      | CML38                                                                                                                        |
 | AT5G47500 |      0.0038  | PME68      | Probable pectinesterase 68                                                                                                   |
 | AT5G08070 |      0.0038  | TCP17      | Transcription factor TCP17                                                                                                   |
 | AT4G11280 |      0.00375 | ACS6       | 1-aminocyclopropane-1-carboxylate synthase 6                                                                                 |
 | AT3G44260 |      0.00375 | CAF1-9     | Probable CCR4-associated factor 1 homolog 9                                                                                  |
 | AT2G44578 |      0.00375 | AT2G44578  | RING/U-box superfamily protein                                                                                               |
 | AT1G07143 |      0.00375 | AT1G07143  | None                                                                                                                         |
 | AT1G27370 |      0.00375 | SPL10      | Squamosa promoter-binding-like protein 10                                                                                    |
 | AT3G56880 |      0.00375 | AT3G56880  | VQ motif-containing protein                                                                                                  |
 | AT5G56010 |      0.00375 | HSP90-3    | Heat shock protein 90-3                                                                                                      |
 | AT1G48740 |      0.00375 | AT1G48740  | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                                      |
 | AT3G49900 |      0.00375 | AT3G49900  | Phototropic-responsive NPH3 family protein                                                                                   |
 | AT2G17780 |      0.00375 | MCA2       | Protein MID1-COMPLEMENTING ACTIVITY 2                                                                                        |
 | AT5G56030 |      0.0037  | HSP81-2    | Heat shock protein 81-2                                                                                                      |
 | AT3G60550 |      0.0037  | CYCU2-2    | Cyclin-U2-2                                                                                                                  |
 | AT4G05910 |      0.0037  | AT4G05910  | None                                                                                                                         |
 | AT5G06839 |      0.0036  | TGA10      | Transcription factor TGA10                                                                                                   |
 | AT2G35000 |      0.0036  | ATL9       | E3 ubiquitin-protein ligase ATL9                                                                                             |
 | AT1G17240 |      0.00355 | AtRLP2     | receptor like protein 2                                                                                                      |
 | AT5G35753 |      0.00355 | AT5G35753  | Domain of unknown function (DUF3444)                                                                                         |
 | AT2G45870 |      0.0035  | AT2G45870  | UPF0187 protein At2g45870, chloroplastic                                                                                     |
 | AT3G19390 |      0.0035  | RD21C      | Probable cysteine protease RD21C                                                                                             |
 | AT5G22794 |      0.00345 | AT5G22794  | FUNCTIONS IN: molecular_function unknown                                                                                     |
 | AT1G80640 |      0.00345 | AT1G80640  | Probable receptor-like protein kinase At1g80640                                                                              |
 | AT3G22830 |      0.00335 | HSFA6B     | Heat stress transcription factor A-6b                                                                                        |
 | AT2G45760 |      0.0032  | BAP2       | BON1-associated protein 2                                                                                                    |
 | AT1G02405 |      0.00315 | AT1G02405  | At1g02405                                                                                                                    |
 | AT4G28550 |      0.0031  | AT4G28550  | At4g28550                                                                                                                    |
 | AT2G09975 |      0.00295 | AT2G09975  | None                                                                                                                         |
 | AT5G53450 |      0.00285 | PAP14      | Probable plastid-lipid-associated protein 14, chloroplastic                                                                  |
 | AT5G51465 |      0.00265 | AT5G51465  | None                                                                                                                         |
 | AT3G55980 |      0.0026  | SZF1       | Salt-inducible zinc finger 1                                                                                                 |
 | AT5G23990 |      0.0026  | ATFRO5     | ferric reduction oxidase 5                                                                                                   |
 | AT5G43420 |      0.0026  | ATL16      | RING-H2 finger protein ATL16                                                                                                 |
 | AT3G30460 |      0.00255 | AT3G30460  | RING/U-box superfamily protein                                                                                               |
 | AT3G43840 |      0.00255 | AT3G43840  | 3-oxo-5-alpha-steroid 4-dehydrogenase family protein                                                                         |
 | AT3G63095 |      0.0025  | AT3G63095  | Tetratricopeptide repeat (TPR)-like superfamily protein                                                                      |
 | AT5G24210 |      0.00245 | AT5G24210  | Alpha/beta-Hydrolases superfamily protein                                                                                    |
 | AT3G16860 |      0.00245 | COBL8      | COBRA-like protein 8                                                                                                         |
 | AT2G15390 |      0.00245 | FUT4       | Probable fucosyltransferase 4                                                                                                |
 | AT3G57630 |      0.00245 | AT3G57630  | At3g57630                                                                                                                    |
 | AT5G42800 |      0.00245 | DFRA       | Dihydroflavonol reductase                                                                                                    |
 | AT1G69910 |      0.00245 | LRK10L-1.5 | LEAF RUST 10 DISEASE-RESISTANCE LOCUS RECEPTOR-LIKE PROTEIN KINASE-like 1.5                                                  |
 | AT3G48640 |      0.00245 | AT3G48640  | Transmembrane protein                                                                                                        |
 | AT3G21080 |      0.00245 | AT3G21080  | ABC transporter-like protein                                                                                                 |
 | AT2G04050 |      0.0024  | DTX3       | Protein DETOXIFICATION 3                                                                                                     |
 | AT1G80160 |      0.0024  | AT1G80160  | F18B13.24 protein                                                                                                            |
 | AT3G02210 |      0.00235 | COBL1      | COBRA-like protein                                                                                                           |
 | AT2G19150 |      0.00235 | PME10      | Putative pectinesterase 10                                                                                                   |
 | AT3G60415 |      0.0023  | AT3G60415  | At3g60420                                                                                                                    |
 | AT3G52780 |      0.00225 | PAP20      | Probable purple acid phosphatase 20                                                                                          |
 | AT5G60310 |      0.0022  | LECRK110   | Putative L-type lectin-domain containing receptor kinase I.10                                                                |
 | AT1G76240 |      0.0022  | AT1G76240  | At1g76240                                                                                                                    |
 | AT3G43580 |      0.0022  | AT3G43580  | At3g43580                                                                                                                    |
 | AT1G27730 |      0.0022  | ZAT10      | Zinc finger protein ZAT10                                                                                                    |
 | AT3G52525 |      0.00215 | OFP6       | Transcription repressor OFP6                                                                                                 |
 | AT1G72520 |      0.00215 | LOX4       | Lipoxygenase 4, chloroplastic                                                                                                |
 | AT1G08592 |      0.00215 | AT1G08592  | Potential natural antisense gene, locus overlaps with AT1G08590                                                              |
 | AT2G36690 |      0.00215 | AT2G36690  | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                                      |
 | AT1G23830 |      0.0021  | AT1G23830  | At1g23830/F5O8_36                                                                                                            |
 | AT3G57910 |      0.0021  | AT3G57910  | At3g57910                                                                                                                    |
 | AT4G35770 |      0.00205 | STR15      | SEN1                                                                                                                         |
 | AT3G07900 |      0.00205 | OFUT24     | O-fucosyltransferase 24                                                                                                      |
 | AT5G17220 |      0.00205 | GSTF12     | Glutathione S-transferase F12                                                                                                |
 | AT1G19397 |      0.00205 | AT1G19397  | unknown protein                                                                                                              |
 | AT1G35710 |      0.00205 | AT1G35710  | Probable leucine-rich repeat receptor-like protein kinase At1g35710                                                          |
 | AT1G24148 |      0.00205 | AT1G24148  | unknown protein                                                                                                              |
 | AT5G57625 |      0.00205 | AT5G57625  | At5g57625                                                                                                                    |
 | AT5G54860 |      0.00195 | AT5G54860  | Probable folate-biopterin transporter 4                                                                                      |
 | AT4G04540 |      0.00195 | CRK39      | Putative cysteine-rich receptor-like protein kinase 39                                                                       |
 | AT1G72300 |      0.00195 | PSY1R      | Leucine-rich repeat receptor-like protein kinase (Fragment)                                                                  |
 | AT1G63350 |      0.0019  | AT1G63350  | Disease resistance protein (CC-NBS-LRR class) family                                                                         |
 | AT3G50770 |      0.0019  | CML41      | Probable calcium-binding protein CML41                                                                                       |
 | AT1G61840 |      0.0019  | AT1G61840  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | AT1G69790 |      0.00185 | PBL18      | Probable serine/threonine-protein kinase PBL18                                                                               |
 | AT1G68450 |      0.00185 | VQ8        | VQ motif-containing protein 8, chloroplastic                                                                                 |
 | AT4G24570 |      0.00185 | PUMP4      | DIC2                                                                                                                         |
 | AT2G26530 |      0.00185 | AR781      | AR781                                                                                                                        |
 | AT2G30760 |      0.00175 | AT2G30760  | Uncharacterized protein At2g30760                                                                                            |
 | AT1G48930 |      0.00165 | AtGH9C1    | Endoglucanase 5                                                                                                              |
 | AT5G24910 |      0.0016  | CYP714A1   | Cytochrome P450 714A1                                                                                                        |
 | AT5G64810 |      0.0016  | WRKY51     | Probable WRKY transcription factor 51                                                                                        |
 | AT1G73740 |      0.0016  | AT1G73740  | Putative UDP-N-acetylglucosamine--N-acetylmuramyl-(Pentapeptide)-pyrophosphoryl-undecaprenol N-acetylglucosamine transferase |
 | AT5G66080 |      0.0016  | AT5G66080  | Probable protein phosphatase 2C 79                                                                                           |
 | AT1G78090 |      0.00155 | TPPB       | Trehalose-phosphate phosphatase B                                                                                            |
 | AT1G51660 |      0.00155 | MKK4       | MKK4                                                                                                                         |
 | AT3G47780 |      0.00155 | ABCA7      | ABC transporter A family member 7                                                                                            |
 | AT1G21100 |      0.00155 | IGMT1      | Indole glucosinolate O-methyltransferase 1                                                                                   |
 | AT1G21110 |      0.0015  | IGMT3      | Indole glucosinolate O-methyltransferase 3                                                                                   |
 | AT4G08985 |      0.00145 | AT4G08985  | None                                                                                                                         |
 | AT4G22467 |      0.00145 | AT4G22467  | None                                                                                                                         |
 | AT1G63580 |      0.0014  | CRRSP6     | Probable cysteine-rich repeat secretory protein 6                                                                            |
 | AT5G36970 |      0.0013  | NHL25      | NHL25                                                                                                                        |
 | AT2G33815 |      0.00125 | AT2G33815  | other RNA                                                                                                                    |
 | AT3G49620 |      0.00095 | DIN11      | Probable 2-oxoglutarate-dependent dioxygenase DIN11                                                                          |
 | AT3G15060 |      0.0009  | RABA1G     | Ras-related protein RABA1g                                                                                                   |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [181]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/7946eccf4b6fea943cb17753211a775a58d63c00.png]]
 :END:






* Selecting genes for Col0 at 6hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [182]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [183]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [5673 3878 2230 ... 1017 1498 3055]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [184]:
 # text/org
 |    | incoming   | name      | description                                                |
 |----+------------+-----------+------------------------------------------------------------|
 |  0 | AT3G09260  | BGLU23    | PYK10                                                      |
 |  1 | AT2G19970  | AT2G19970 | At2g19970                                                  |
 |  2 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                             |
 |  3 | AT5G06730  | PER54     | Peroxidase 54                                              |
 |  4 | AT3G16420  | PBP1      | PYK10-binding protein 1                                    |
 |  5 | AT2G27402  | AT2G27402 | At2g27402                                                  |
 |  6 | AT5G39580  | PER62     | Peroxidase 62                                              |
 |  7 | AT1G26240  | AT1G26240 | Proline-rich extensin-like family protein                  |
 |  8 | AT3G16400  | NSP1      | Nitrile-specifier protein 1                                |
 |  9 | AT5G13930  | CHS       | Chalcone synthase family protein                           |
 | 10 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3                   |
 | 11 | AT4G39950  | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2     |
 | 12 | AT2G15220  | AT2G15220 | At2g15220/F15A23.4                                         |
 | 13 | AT3G26830  | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase |
 | 14 | AT5G14650  | AT5G14650 | Pectin lyase-like superfamily protein                      |
 | 15 | AT1G02920  | GSTF7     | Glutathione S-transferase F7                               |
 | 16 | AT1G09310  | AT1G09310 | T31J12.3 protein                                           |
 | 17 | AT1G66700  | PXMT1     | Paraxanthine methyltransferase 1                           |
 | 18 | AT1G18970  | GLP1      | Germin-like protein subfamily T member 1                   |
 | 19 | AT1G02930  | GSTF6     | Glutathione S-transferase F6                               |
 | 20 | AT2G26560  | PLP2      | Patatin-like protein 2                                     |
 | 21 | AT1G76680  | OPR1      | 12-oxophytodienoate reductase 1                            |
 | 22 | AT5G47500  | PME68     | Probable pectinesterase 68                                 |
 | 23 | AT5G39110  | AT5G39110 | Germin-like protein subfamily 1 member 14                  |
 | 24 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                                      |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'col' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [185]:
 # text/org
 | gene      |   importance | name      | description                                                |
 |-----------+--------------+-----------+------------------------------------------------------------|
 | AT3G26830 |      0.03965 | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase |
 | AT1G02920 |      0.039   | GSTF7     | Glutathione S-transferase F7                               |
 | AT5G13930 |      0.03815 | CHS       | Chalcone synthase family protein                           |
 | AT5G20630 |      0.03755 | GER3      | Germin-like protein subfamily 3 member 3                   |
 | AT1G09310 |      0.0375  | AT1G09310 | T31J12.3 protein                                           |
 | AT5G14650 |      0.03745 | AT5G14650 | Pectin lyase-like superfamily protein                      |
 | AT1G76680 |      0.03725 | OPR1      | 12-oxophytodienoate reductase 1                            |
 | AT3G09260 |      0.03705 | BGLU23    | PYK10                                                      |
 | AT2G26560 |      0.037   | PLP2      | Patatin-like protein 2                                     |
 | AT5G06730 |      0.0369  | PER54     | Peroxidase 54                                              |
 | AT5G39110 |      0.03675 | AT5G39110 | Germin-like protein subfamily 1 member 14                  |
 | AT1G02930 |      0.0366  | GSTF6     | Glutathione S-transferase F6                               |
 | AT1G66700 |      0.03635 | PXMT1     | Paraxanthine methyltransferase 1                           |
 | AT2G19970 |      0.03625 | AT2G19970 | At2g19970                                                  |
 | AT1G26380 |      0.0362  | FOX1      | Berberine bridge enzyme-like 3                             |
 | AT5G39580 |      0.0362  | PER62     | Peroxidase 62                                              |
 | AT3G16400 |      0.0361  | NSP1      | Nitrile-specifier protein 1                                |
 | AT4G39950 |      0.03585 | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2     |
 | AT1G26240 |      0.0358  | AT1G26240 | Proline-rich extensin-like family protein                  |
 | AT2G27402 |      0.0356  | AT2G27402 | At2g27402                                                  |
 | AT3G28740 |      0.03545 | CYP81D11  | Cytochrome P450 81D11                                      |
 | AT1G18970 |      0.035   | GLP1      | Germin-like protein subfamily T member 1                   |
 | AT3G16420 |      0.03495 | PBP1      | PYK10-binding protein 1                                    |
 | AT2G15220 |      0.03425 | AT2G15220 | At2g15220/F15A23.4                                         |
 | AT5G47500 |      0.0341  | PME68     | Probable pectinesterase 68                                 |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance', ax=ax)
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [186]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/3a7f11ad5d6613e0cc792f422e3a0b3aefe293c3.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [187]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [188]:
 # output
 Num Features: 250
 Selected Features: [False False False ... False False False]
 Feature Ranking: [5448 3653 2005 ...  792 1273 2830]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [189]:
 # text/org
 |     | incoming   | name      | description                                                                                             |
 |-----+------------+-----------+---------------------------------------------------------------------------------------------------------|
 |   0 | AT2G41380  | AT2G41380 | At2g41380                                                                                               |
 |   1 | AT5G57220  | CYP81F2   | Cytochrome P450 81F2                                                                                    |
 |   2 | AT4G29905  | AT4G29905 | Putative uncharacterized protein                                                                        |
 |   3 | AT3G25790  | HHO1      | Transcription factor HHO1                                                                               |
 |   4 | AT5G16980  | AT5G16980 | Zinc-binding dehydrogenase family protein                                                               |
 |   5 | AT5G52050  | DTX50     | Protein DETOXIFICATION 50                                                                               |
 |   6 | AT1G18650  | PDCB3     | PLASMODESMATA CALLOSE-BINDING PROTEIN 3                                                                 |
 |   7 | AT3G01420  | DOX1      | Alpha-dioxygenase 1                                                                                     |
 |   8 | AT4G00360  | CYP86A2   | Cytochrome P450 86A2                                                                                    |
 |   9 | AT4G14630  | GLP9      | At4g14630                                                                                               |
 |  10 | AT3G18250  | AT3G18250 | Putative membrane lipoprotein                                                                           |
 |  11 | AT3G56090  | FER3      | Ferritin-3, chloroplastic                                                                               |
 |  12 | AT2G29150  | AT2G29150 | Tropinone reductase homolog At2g29150                                                                   |
 |  13 | AT1G08757  | AT1G08757 | None                                                                                                    |
 |  14 | AT3G51430  | SSL5      | Protein STRICTOSIDINE SYNTHASE-LIKE 5                                                                   |
 |  15 | AT5G23310  | FSD3      | Superoxide dismutase                                                                                    |
 |  16 | AT4G26010  | AT4G26010 | Peroxidase superfamily protein                                                                          |
 |  17 | AT5G07030  | AT5G07030 | Eukaryotic aspartyl protease family protein                                                             |
 |  18 | AT4G28420  | AT4G28420 | Probable aminotransferase TAT1                                                                          |
 |  19 | AT5G05735  | AT5G05735 | None                                                                                                    |
 |  20 | AT3G09260  | BGLU23    | PYK10                                                                                                   |
 |  21 | AT3G50770  | CML41     | Probable calcium-binding protein CML41                                                                  |
 |  22 | AT5G44990  | AT5G44990 | Glutathione S-transferase family protein                                                                |
 |  23 | AT2G19970  | AT2G19970 | At2g19970                                                                                               |
 |  24 | AT5G40780  | LHT1      | Lysine histidine transporter 1                                                                          |
 |  25 | AT4G25810  | XTH23     | Probable xyloglucan endotransglucosylase/hydrolase protein 23                                           |
 |  26 | AT4G26150  | GATA22    | Putative GATA transcription factor 22                                                                   |
 |  27 | AT3G26210  | CYP71B23  | Cytochrome P450 71B23                                                                                   |
 |  28 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                                                                          |
 |  29 | AT5G02780  | GSTL1     | Glutathione S-transferase L1                                                                            |
 |  30 | AT2G32990  | AtGH9B8   | Endoglucanase 11                                                                                        |
 |  31 | AT5G67400  | PER73     | Peroxidase                                                                                              |
 |  32 | AT1G15885  | AT1G15885 | Putative uncharacterized protein                                                                        |
 |  33 | AT3G52450  | PUB22     | RING-type E3 ubiquitin transferase                                                                      |
 |  34 | AT5G26340  | STP13     | STP13                                                                                                   |
 |  35 | AT4G24780  | AT4G24780 | Probable pectate lyase 18                                                                               |
 |  36 | AT3G16670  | AT3G16670 | AT3g16670/MGL6_12                                                                                       |
 |  37 | AT2G24180  | CYP71B6   | Cytochrome P450 71B6                                                                                    |
 |  38 | AT5G06730  | PER54     | Peroxidase 54                                                                                           |
 |  39 | AT4G37370  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                                                  |
 |  40 | AT1G18980  | AT1G18980 | At1g18980                                                                                               |
 |  41 | AT2G36690  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                 |
 |  42 | AT1G10522  | PRIN2     | Protein PLASTID REDOX INSENSITIVE 2, chloroplastic                                                      |
 |  43 | AT3G06145  | AT3G06145 | Putative RING zinc finger protein                                                                       |
 |  44 | AT4G29740  | CKX4      | Cytokinin dehydrogenase 4                                                                               |
 |  45 | AT4G29390  | RPS30A    | 40S ribosomal protein S30                                                                               |
 |  46 | AT3G12930  | IJ        | Protein Iojap, chloroplastic                                                                            |
 |  47 | AT5G58250  | AT5G58250 | YCF54                                                                                                   |
 |  48 | AT4G35730  | AT4G35730 | Regulator of Vps4 activity in the MVB pathway protein                                                   |
 |  49 | AT5G14330  | AT5G14330 | Transmembrane protein                                                                                   |
 |  50 | AT3G05730  | AT3G05730 | Defensin-like protein 205                                                                               |
 |  51 | AT1G55020  | LOX1      | Linoleate 9S-lipoxygenase 1                                                                             |
 |  52 | AT5G49480  | ATCP1     | Calcium-binding protein CP1                                                                             |
 |  53 | AT3G25700  | AT3G25700 | At3g25700                                                                                               |
 |  54 | AT1G26410  | FOX4      | Berberine bridge enzyme-like 6                                                                          |
 |  55 | AT1G52245  | AT1G52245 | Dynein light chain                                                                                      |
 |  56 | AT5G08610  | RH26      | PDE340                                                                                                  |
 |  57 | AT5G05730  | ASA1      | Anthranilate synthase alpha subunit 1                                                                   |
 |  58 | AT1G18570  | MYB51     | Transcription factor MYB51                                                                              |
 |  59 | AT1G48570  | AT1G48570 | T1N15.19                                                                                                |
 |  60 | AT5G57625  | AT5G57625 | At5g57625                                                                                               |
 |  61 | AT3G13950  | AT3G13950 | AT3G13950 protein                                                                                       |
 |  62 | AT4G34290  | AT4G34290 | SWIB/MDM2 domain superfamily protein                                                                    |
 |  63 | AT3G16420  | PBP1      | PYK10-binding protein 1                                                                                 |
 |  64 | AT1G51890  | AT1G51890 | Leucine-rich repeat protein kinase family protein                                                       |
 |  65 | AT5G55580  | MTERF9    | Transcription termination factor MTERF9, chloroplastic                                                  |
 |  66 | AT1G32640  | MYC2      | ZBF1                                                                                                    |
 |  67 | AT3G46280  | AT3G46280 | Kinase-like protein                                                                                     |
 |  68 | AT3G18420  | SG1       | protein SLOW GREEN 1, chloroplastic                                                                     |
 |  69 | AT2G19990  | PR-1-LIKE | PR-1-like protein                                                                                       |
 |  70 | AT3G01970  | WRKY45    | Probable WRKY transcription factor 45                                                                   |
 |  71 | AT4G19370  | AT4G19370 | Chitin synthase, putative (DUF1218)                                                                     |
 |  72 | AT1G21100  | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                              |
 |  73 | AT1G67980  | CCOAMT    | Putative caffeoyl-CoA O-methyltransferase At1g67980                                                     |
 |  74 | AT5G11550  | AT5G11550 | ARM repeat superfamily protein                                                                          |
 |  75 | AT2G36750  | UGT73C1   | UDP-glycosyltransferase 73C1                                                                            |
 |  76 | AT3G45030  | RPS20C    | 40S ribosomal protein S20-1                                                                             |
 |  77 | AT4G24110  | AT4G24110 | NADP-specific glutamate dehydrogenase                                                                   |
 |  78 | AT5G26920  | CBP60G    | Calmodulin-binding protein 60 G                                                                         |
 |  79 | AT4G01037  | WTF1      | WTF1                                                                                                    |
 |  80 | AT4G15610  | AT4G15610 | CASP-like protein 1D1                                                                                   |
 |  81 | AT5G11210  | GLR2.5    | Glutamate receptor 2.5                                                                                  |
 |  82 | AT1G08380  | PSAO      | PSAO                                                                                                    |
 |  83 | AT1G18975  | AT1G18975 | None                                                                                                    |
 |  84 | AT5G51720  | NEET      | NEET                                                                                                    |
 |  85 | AT2G12170  | AT2G12170 | BEST Arabidopsis thaliana protein match is: Transcriptional factor B3 family protein (TAIR:AT2G24645.1) |
 |  86 | AT5G19890  | PER59     | Peroxidase 59                                                                                           |
 |  87 | AT2G02100  | PDF2.2    | PDF2.2                                                                                                  |
 |  88 | AT3G63380  | ACA12     | Calcium-transporting ATPase                                                                             |
 |  89 | AT4G02520  | GSTF2     | Glutathione S-transferase F2                                                                            |
 |  90 | AT2G10940  | AT2G10940 | At2g10940/F15K19.1                                                                                      |
 |  91 | AT5G48657  | AT5G48657 | defense protein-related                                                                                 |
 |  92 | AT2G27402  | AT2G27402 | At2g27402                                                                                               |
 |  93 | AT4G21770  | AT4G21770 | RNA pseudouridine synthase 6, chloroplastic                                                             |
 |  94 | AT4G00050  | UNE10     | Transcription factor UNE10                                                                              |
 |  95 | AT1G11300  | AT1G11300 | G-type lectin S-receptor-like serine/threonine-protein kinase At1g11300                                 |
 |  96 | AT4G19420  | AT4G19420 | Pectinacetylesterase family protein                                                                     |
 |  97 | AT3G09405  | PAE4      | Pectin acetylesterase 4                                                                                 |
 |  98 | AT3G03670  | PER28     | Peroxidase 28                                                                                           |
 |  99 | AT5G54810  | TSB1      | Tryptophan synthase                                                                                     |
 | 100 | AT3G56070  | CYP19-3   | Peptidyl-prolyl cis-trans isomerase CYP19-3                                                             |
 | 101 | AT1G09750  | AED3      | Aspartyl protease AED3                                                                                  |
 | 102 | AT5G64040  | PSAN      | Photosystem I reaction center subunit PSI-N, chloroplast, putative / PSI-N, putative (PSAN)             |
 | 103 | AT5G13080  | WRKY75    | WRKY75                                                                                                  |
 | 104 | AT5G39580  | PER62     | Peroxidase 62                                                                                           |
 | 105 | AT1G26240  | AT1G26240 | Proline-rich extensin-like family protein                                                               |
 | 106 | AT3G16400  | NSP1      | Nitrile-specifier protein 1                                                                             |
 | 107 | AT1G67148  | AT1G67148 | Putative uncharacterized protein                                                                        |
 | 108 | AT4G01700  | AT4G01700 | At4g01700                                                                                               |
 | 109 | AT4G18730  | RPL11C    | 60S ribosomal protein L11-2                                                                             |
 | 110 | AT5G13930  | CHS       | Chalcone synthase family protein                                                                        |
 | 111 | AT4G03985  | AT4G03985 | None                                                                                                    |
 | 112 | AT5G63140  | PAP29     | Probable inactive purple acid phosphatase 29                                                            |
 | 113 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3                                                                |
 | 114 | AT1G78450  | AT1G78450 | F3F9.4                                                                                                  |
 | 115 | AT3G55660  | ROPGEF6   | Rop guanine nucleotide exchange factor 6                                                                |
 | 116 | AT4G39950  | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2                                                  |
 | 117 | AT2G15220  | AT2G15220 | At2g15220/F15A23.4                                                                                      |
 | 118 | AT1G32350  | AOX3      | AOX1D                                                                                                   |
 | 119 | AT4G15530  | PPDK      | Pyruvate, phosphate dikinase 1, chloroplastic                                                           |
 | 120 | AT1G28290  | AGP31     | Non-classical arabinogalactan protein 31                                                                |
 | 121 | AT5G20790  | AT5G20790 | unknown protein                                                                                         |
 | 122 | AT1G14870  | PCR2      | PCR2                                                                                                    |
 | 123 | AT4G21760  | BGLU47    | beta-glucosidase 47                                                                                     |
 | 124 | AT5G64890  | PEP2      | Elicitor peptide 2                                                                                      |
 | 125 | AT1G21120  | AT1G21120 | O-methyltransferase family protein                                                                      |
 | 126 | AT2G25297  | AT2G25297 | None                                                                                                    |
 | 127 | AT4G25740  | RPS10A    | 40S ribosomal protein S10-1                                                                             |
 | 128 | AT5G42650  | CYP74A    | Allene oxide synthase, chloroplastic                                                                    |
 | 129 | AT1G67030  | ZFP6      | Zinc finger protein 6                                                                                   |
 | 130 | AT1G21400  | AT1G21400 | Thiamin diphosphate-binding fold (THDP-binding) superfamily protein                                     |
 | 131 | AT3G26445  | AT3G26445 | Beta-1,4-N-acetylglucosaminyltransferase family protein                                                 |
 | 132 | AT3G24300  | AMT1-3    | Ammonium transporter 1 member 3                                                                         |
 | 133 | AT5G08640  | FLS1      | Flavonol synthase/flavanone 3-hydroxylase                                                               |
 | 134 | AT4G37540  | LBD39     | LOB domain-containing protein 39                                                                        |
 | 135 | AT4G30720  | AT4G30720 | FAD/NAD(P)-binding oxidoreductase family protein                                                        |
 | 136 | AT3G26830  | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase                                              |
 | 137 | AT3G54580  | AT3G54580 | Proline-rich extensin-like family protein                                                               |
 | 138 | AT5G14650  | AT5G14650 | Pectin lyase-like superfamily protein                                                                   |
 | 139 | AT3G58990  | IPMI1     | 3-isopropylmalate dehydratase small subunit 2                                                           |
 | 140 | AT3G44860  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                                             |
 | 141 | AT5G48880  | KAT5      | PKT2                                                                                                    |
 | 142 | AT5G66470  | AT5G66470 | GTPase ERA-like, chloroplastic                                                                          |
 | 143 | AT1G05523  | AT1G05523 | None                                                                                                    |
 | 144 | AT4G20830  | AT4G20830 | Berberine bridge enzyme-like 19                                                                         |
 | 145 | AT2G38870  | AT2G38870 | Putative protease inhibitor                                                                             |
 | 146 | AT2G32650  | AT2G32650 | At2g32650                                                                                               |
 | 147 | AT1G03630  | PORC      | Protochlorophyllide reductase C, chloroplastic                                                          |
 | 148 | AT3G18830  | PLT5      | PMT5                                                                                                    |
 | 149 | AT5G40730  | AGP24     | Arabinogalactan peptide 24                                                                              |
 | 150 | AT4G20835  | AT4G20835 | None                                                                                                    |
 | 151 | AT5G44380  | AT5G44380 | FAD-binding Berberine family protein                                                                    |
 | 152 | AT1G18250  | ATLP-1    | Pathogenesis-related thaumatin superfamily protein                                                      |
 | 153 | AT1G80850  | AT1G80850 | At1g80850                                                                                               |
 | 154 | AT1G02920  | GSTF7     | Glutathione S-transferase F7                                                                            |
 | 155 | AT5G19750  | AT5G19750 | Peroxisomal membrane 22 kDa (Mpv17/PMP22) family protein                                                |
 | 156 | AT2G24850  | TAT3      | Probable aminotransferase TAT3                                                                          |
 | 157 | AT5G03390  | AT5G03390 | At5g03390                                                                                               |
 | 158 | AT5G55280  | FTSZ1     | Cell division protein FtsZ homolog 1, chloroplastic                                                     |
 | 159 | AT3G14900  | AT3G14900 | Uncharacterized protein At3g14900                                                                       |
 | 160 | AT5G15780  | AT5G15780 | At5g15780                                                                                               |
 | 161 | AT4G34950  | AT4G34950 | Major facilitator superfamily protein                                                                   |
 | 162 | AT1G13930  | AT1G13930 | At1g13930/F16A14.27                                                                                     |
 | 163 | AT2G48130  | AT2G48130 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | 164 | AT5G64120  | PER71     | Peroxidase                                                                                              |
 | 165 | AT1G13520  | AT1G13520 | At1g13520                                                                                               |
 | 166 | AT5G08070  | TCP17     | Transcription factor TCP17                                                                              |
 | 167 | AT1G30700  | AT1G30700 | Berberine bridge enzyme-like 8                                                                          |
 | 168 | AT1G06000  | UGT89C1   | Glycosyltransferase (Fragment)                                                                          |
 | 169 | AT1G09310  | AT1G09310 | T31J12.3 protein                                                                                        |
 | 170 | AT1G65490  | AT1G65490 | unknown protein                                                                                         |
 | 171 | AT1G02660  | PLIP2     | Phospholipase A1 PLIP2, chloroplastic                                                                   |
 | 172 | AT3G21305  | AT3G21305 | None                                                                                                    |
 | 173 | AT1G06002  | AT1G06002 | Potential natural antisense gene, locus overlaps with AT1G06000                                         |
 | 174 | AT4G31500  | CYP83B1   | Cytochrome P450 83B1                                                                                    |
 | 175 | AT5G20230  | BCB       | SAG14                                                                                                   |
 | 176 | AT1G64160  | DIR5      | Dirigent protein 5                                                                                      |
 | 177 | AT2G27710  | RPP2B     | AT2G27710 protein                                                                                       |
 | 178 | AT5G46580  | AT5G46580 | Pentatricopeptide repeat-containing protein At5g46580, chloroplastic                                    |
 | 179 | AT3G50480  | HR4       | RPW8-like protein 4                                                                                     |
 | 180 | AT5G06860  | PGIP1     | PGIP1                                                                                                   |
 | 181 | AT4G30090  | AT4G30090 | Golgin family A protein                                                                                 |
 | 182 | AT1G79680  | WAKL10    | Wall-associated receptor kinase-like 10                                                                 |
 | 183 | AT3G54890  | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                                          |
 | 184 | AT5G66530  | AT5G66530 | Glucose-6-phosphate 1-epimerase                                                                         |
 | 185 | AT2G17740  | AT2G17740 | At2g17740                                                                                               |
 | 186 | AT1G59990  | RH22      | DEAD-box ATP-dependent RNA helicase 22                                                                  |
 | 187 | AT2G45870  | AT2G45870 | UPF0187 protein At2g45870, chloroplastic                                                                |
 | 188 | AT1G66700  | PXMT1     | Paraxanthine methyltransferase 1                                                                        |
 | 189 | AT5G49330  | MYB111    | Transcription factor MYB111                                                                             |
 | 190 | AT1G69200  | FLN2      | Fructokinase-like 2, chloroplastic                                                                      |
 | 191 | AT2G02930  | GSTF3     | Glutathione S-transferase F3                                                                            |
 | 192 | AT1G26255  | AT1G26255 | None                                                                                                    |
 | 193 | AT3G62530  | AT3G62530 | ARM repeat superfamily protein                                                                          |
 | 194 | AT4G02290  | AtGH9B13  | Endoglucanase 17                                                                                        |
 | 195 | AT4G34760  | SAUR50    | Auxin-responsive protein SAUR50                                                                         |
 | 196 | AT1G07590  | AT1G07590 | Pentatricopeptide repeat-containing protein At1g07590, mitochondrial                                    |
 | 197 | AT5G24660  | LSU2      | Protein RESPONSE TO LOW SULFUR 2                                                                        |
 | 198 | AT1G29720  | RFK1      | Probable LRR receptor-like serine/threonine-protein kinase At1g29720                                    |
 | 199 | AT1G18970  | GLP1      | Germin-like protein subfamily T member 1                                                                |
 | 200 | AT1G02730  | CSLD5     | Cellulose synthase-like protein D5                                                                      |
 | 201 | AT1G65690  | NHL6      | NDR1/HIN1-like protein 6                                                                                |
 | 202 | AT5G56870  | BGAL4     | Beta-galactosidase 4                                                                                    |
 | 203 | AT2G34180  | CIPK13    | CBL-interacting serine/threonine-protein kinase 13                                                      |
 | 204 | AT1G03220  | AT1G03220 | Eukaryotic aspartyl protease family protein                                                             |
 | 205 | AT4G09040  | AT4G09040 | At4g09040                                                                                               |
 | 206 | AT5G58350  | WNK4      | Probable serine/threonine-protein kinase WNK4                                                           |
 | 207 | AT1G51700  | DOF1.7    | Dof zinc finger protein DOF1.7                                                                          |
 | 208 | AT2G41810  | AT2G41810 | Uncharacterized protein At2g41810                                                                       |
 | 209 | AT1G02930  | GSTF6     | Glutathione S-transferase F6                                                                            |
 | 210 | AT1G71695  | PER12     | Peroxidase                                                                                              |
 | 211 | AT1G30530  | UGT78D1   | Glycosyltransferase (Fragment)                                                                          |
 | 212 | AT5G06865  | AT5G06865 | other RNA                                                                                               |
 | 213 | AT3G48500  | PDE312    | Nucleic acid-binding, OB-fold-like protein                                                              |
 | 214 | AT1G72610  | GLP1      | Germin-like protein subfamily 3 member 1                                                                |
 | 215 | AT2G26560  | PLP2      | Patatin-like protein 2                                                                                  |
 | 216 | AT1G26420  | FOX5      | Berberine bridge enzyme-like 7                                                                          |
 | 217 | AT2G46750  | GULLO2    | L-gulonolactone oxidase 2                                                                               |
 | 218 | AT1G76680  | OPR1      | 12-oxophytodienoate reductase 1                                                                         |
 | 219 | AT2G41310  | ARR8      | Two-component response regulator ARR8                                                                   |
 | 220 | AT1G62510  | AT1G62510 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | 221 | AT1G14540  | PER4      | Peroxidase                                                                                              |
 | 222 | AT2G43120  | AT2G43120 | RmlC-like cupins superfamily protein                                                                    |
 | 223 | AT4G02270  | RHS13     | At4g02270                                                                                               |
 | 224 | AT4G24240  | WRKY7     | Probable WRKY transcription factor 7                                                                    |
 | 225 | AT1G72600  | AT1G72600 | At1g72600                                                                                               |
 | 226 | AT5G47500  | PME68     | Probable pectinesterase 68                                                                              |
 | 227 | AT2G28740  | HIS4      | Histone H4                                                                                              |
 | 228 | AT4G14780  | AT4G14780 | Kinase like protein                                                                                     |
 | 229 | AT4G32260  | AT4G32260 | PDE334                                                                                                  |
 | 230 | AT1G26250  | AT1G26250 | Proline-rich extensin-like family protein                                                               |
 | 231 | AT3G48850  | MPT2      | Mitochondrial phosphate carrier protein 2, mitochondrial                                                |
 | 232 | AT2G18690  | AT2G18690 | Expressed protein                                                                                       |
 | 233 | AT5G42830  | AT5G42830 | HXXXD-type acyl-transferase family protein                                                              |
 | 234 | AT5G39110  | AT5G39110 | Germin-like protein subfamily 1 member 14                                                               |
 | 235 | AT4G23700  | CHX17     | Cation/H(+) antiporter 17                                                                               |
 | 236 | AT1G69490  | NAC029    | NAP                                                                                                     |
 | 237 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                                                                                   |
 | 238 | AT2G28000  | CPN60A1   | SLP                                                                                                     |
 | 239 | AT4G10530  | AT4G10530 | Subtilase family protein                                                                                |
 | 240 | AT5G26290  | AT5G26290 | TRAF-like family protein                                                                                |
 | 241 | AT2G27389  | AT2G27389 | unknown protein                                                                                         |
 | 242 | AT1G15260  | AT1G15260 | LOW protein: ATP-dependent RNA helicase-like protein                                                    |
 | 243 | AT2G46840  | DUF4      | DUF4                                                                                                    |
 | 244 | AT4G12320  | CYP706A6  | At4g12320                                                                                               |
 | 245 | AT2G39670  | AT2G39670 | Radical SAM superfamily protein                                                                         |
 | 246 | AT5G56670  | RPS30A    | 40S ribosomal protein S30                                                                               |
 | 247 | AT4G02510  | TOC159    | Translocase of chloroplast 159, chloroplastic                                                           |
 | 248 | AT5G38900  | AT5G38900 | Thioredoxin superfamily protein                                                                         |
 | 249 | AT3G04070  | NAC047    | NAC transcription factor 47                                                                             |
 :END:


**** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'col' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [190]:
 # text/org
 | gene      |   importance | name      | description                                                                                             |
 |-----------+--------------+-----------+---------------------------------------------------------------------------------------------------------|
 | AT2G17740 |      0.0049  | AT2G17740 | At2g17740                                                                                               |
 | AT2G32650 |      0.0047  | AT2G32650 | At2g32650                                                                                               |
 | AT5G58250 |      0.0046  | AT5G58250 | YCF54                                                                                                   |
 | AT5G20790 |      0.0046  | AT5G20790 | unknown protein                                                                                         |
 | AT1G13520 |      0.00445 | AT1G13520 | At1g13520                                                                                               |
 | AT1G21100 |      0.00445 | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                              |
 | AT1G29720 |      0.0044  | RFK1      | Probable LRR receptor-like serine/threonine-protein kinase At1g29720                                    |
 | AT1G26250 |      0.0044  | AT1G26250 | Proline-rich extensin-like family protein                                                               |
 | AT1G05523 |      0.0044  | AT1G05523 | None                                                                                                    |
 | AT5G24660 |      0.0044  | LSU2      | Protein RESPONSE TO LOW SULFUR 2                                                                        |
 | AT4G29740 |      0.0044  | CKX4      | Cytokinin dehydrogenase 4                                                                               |
 | AT1G28290 |      0.0044  | AGP31     | Non-classical arabinogalactan protein 31                                                                |
 | AT4G03985 |      0.00435 | AT4G03985 | None                                                                                                    |
 | AT4G19370 |      0.00435 | AT4G19370 | Chitin synthase, putative (DUF1218)                                                                     |
 | AT2G32990 |      0.00435 | AtGH9B8   | Endoglucanase 11                                                                                        |
 | AT5G15780 |      0.0043  | AT5G15780 | At5g15780                                                                                               |
 | AT3G44860 |      0.0043  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                                             |
 | AT2G02930 |      0.0043  | GSTF3     | Glutathione S-transferase F3                                                                            |
 | AT4G21770 |      0.0043  | AT4G21770 | RNA pseudouridine synthase 6, chloroplastic                                                             |
 | AT4G24780 |      0.0043  | AT4G24780 | Probable pectate lyase 18                                                                               |
 | AT2G19970 |      0.0043  | AT2G19970 | At2g19970                                                                                               |
 | AT4G02520 |      0.0043  | GSTF2     | Glutathione S-transferase F2                                                                            |
 | AT5G57220 |      0.0043  | CYP81F2   | Cytochrome P450 81F2                                                                                    |
 | AT1G13930 |      0.0043  | AT1G13930 | At1g13930/F16A14.27                                                                                     |
 | AT1G18250 |      0.0043  | ATLP-1    | Pathogenesis-related thaumatin superfamily protein                                                      |
 | AT3G63380 |      0.00425 | ACA12     | Calcium-transporting ATPase                                                                             |
 | AT4G30720 |      0.00425 | AT4G30720 | FAD/NAD(P)-binding oxidoreductase family protein                                                        |
 | AT1G30530 |      0.00425 | UGT78D1   | Glycosyltransferase (Fragment)                                                                          |
 | AT3G12930 |      0.00425 | IJ        | Protein Iojap, chloroplastic                                                                            |
 | AT1G02730 |      0.00425 | CSLD5     | Cellulose synthase-like protein D5                                                                      |
 | AT5G20630 |      0.0042  | GER3      | Germin-like protein subfamily 3 member 3                                                                |
 | AT1G72600 |      0.0042  | AT1G72600 | At1g72600                                                                                               |
 | AT1G69200 |      0.00415 | FLN2      | Fructokinase-like 2, chloroplastic                                                                      |
 | AT4G25810 |      0.00415 | XTH23     | Probable xyloglucan endotransglucosylase/hydrolase protein 23                                           |
 | AT1G48570 |      0.00415 | AT1G48570 | T1N15.19                                                                                                |
 | AT1G32350 |      0.00415 | AOX3      | AOX1D                                                                                                   |
 | AT2G36750 |      0.00415 | UGT73C1   | UDP-glycosyltransferase 73C1                                                                            |
 | AT3G62530 |      0.00415 | AT3G62530 | ARM repeat superfamily protein                                                                          |
 | AT4G02510 |      0.00415 | TOC159    | Translocase of chloroplast 159, chloroplastic                                                           |
 | AT4G01700 |      0.0041  | AT4G01700 | At4g01700                                                                                               |
 | AT1G62510 |      0.0041  | AT1G62510 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | AT5G66530 |      0.0041  | AT5G66530 | Glucose-6-phosphate 1-epimerase                                                                         |
 | AT1G09750 |      0.0041  | AED3      | Aspartyl protease AED3                                                                                  |
 | AT4G20830 |      0.0041  | AT4G20830 | Berberine bridge enzyme-like 19                                                                         |
 | AT3G48500 |      0.0041  | PDE312    | Nucleic acid-binding, OB-fold-like protein                                                              |
 | AT2G29150 |      0.00405 | AT2G29150 | Tropinone reductase homolog At2g29150                                                                   |
 | AT2G34180 |      0.00405 | CIPK13    | CBL-interacting serine/threonine-protein kinase 13                                                      |
 | AT4G20835 |      0.00405 | AT4G20835 | None                                                                                                    |
 | AT1G26410 |      0.00405 | FOX4      | Berberine bridge enzyme-like 6                                                                          |
 | AT1G26380 |      0.00405 | FOX1      | Berberine bridge enzyme-like 3                                                                          |
 | AT3G01970 |      0.00405 | WRKY45    | Probable WRKY transcription factor 45                                                                   |
 | AT1G07590 |      0.00405 | AT1G07590 | Pentatricopeptide repeat-containing protein At1g07590, mitochondrial                                    |
 | AT1G80850 |      0.00405 | AT1G80850 | At1g80850                                                                                               |
 | AT5G06730 |      0.00405 | PER54     | Peroxidase 54                                                                                           |
 | AT3G45030 |      0.004   | RPS20C    | 40S ribosomal protein S20-1                                                                             |
 | AT5G13080 |      0.004   | WRKY75    | WRKY75                                                                                                  |
 | AT4G29905 |      0.004   | AT4G29905 | Putative uncharacterized protein                                                                        |
 | AT4G28420 |      0.004   | AT4G28420 | Probable aminotransferase TAT1                                                                          |
 | AT2G18690 |      0.004   | AT2G18690 | Expressed protein                                                                                       |
 | AT2G28000 |      0.004   | CPN60A1   | SLP                                                                                                     |
 | AT1G18980 |      0.004   | AT1G18980 | At1g18980                                                                                               |
 | AT1G09310 |      0.004   | AT1G09310 | T31J12.3 protein                                                                                        |
 | AT1G67980 |      0.004   | CCOAMT    | Putative caffeoyl-CoA O-methyltransferase At1g67980                                                     |
 | AT2G38870 |      0.004   | AT2G38870 | Putative protease inhibitor                                                                             |
 | AT5G07030 |      0.00395 | AT5G07030 | Eukaryotic aspartyl protease family protein                                                             |
 | AT5G08610 |      0.00395 | RH26      | PDE340                                                                                                  |
 | AT2G26560 |      0.00395 | PLP2      | Patatin-like protein 2                                                                                  |
 | AT5G40730 |      0.00395 | AGP24     | Arabinogalactan peptide 24                                                                              |
 | AT5G14650 |      0.00395 | AT5G14650 | Pectin lyase-like superfamily protein                                                                   |
 | AT5G16980 |      0.00395 | AT5G16980 | Zinc-binding dehydrogenase family protein                                                               |
 | AT4G12320 |      0.0039  | CYP706A6  | At4g12320                                                                                               |
 | AT1G26420 |      0.0039  | FOX5      | Berberine bridge enzyme-like 7                                                                          |
 | AT1G30700 |      0.0039  | AT1G30700 | Berberine bridge enzyme-like 8                                                                          |
 | AT5G19890 |      0.0039  | PER59     | Peroxidase 59                                                                                           |
 | AT5G11210 |      0.0039  | GLR2.5    | Glutamate receptor 2.5                                                                                  |
 | AT1G06002 |      0.0039  | AT1G06002 | Potential natural antisense gene, locus overlaps with AT1G06000                                         |
 | AT1G67148 |      0.0039  | AT1G67148 | Putative uncharacterized protein                                                                        |
 | AT3G16400 |      0.0039  | NSP1      | Nitrile-specifier protein 1                                                                             |
 | AT1G64160 |      0.0039  | DIR5      | Dirigent protein 5                                                                                      |
 | AT5G03390 |      0.0039  | AT5G03390 | At5g03390                                                                                               |
 | AT2G24850 |      0.0039  | TAT3      | Probable aminotransferase TAT3                                                                          |
 | AT2G48130 |      0.0039  | AT2G48130 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | AT2G41310 |      0.00385 | ARR8      | Two-component response regulator ARR8                                                                   |
 | AT1G21400 |      0.00385 | AT1G21400 | Thiamin diphosphate-binding fold (THDP-binding) superfamily protein                                     |
 | AT1G02930 |      0.00385 | GSTF6     | Glutathione S-transferase F6                                                                            |
 | AT3G50480 |      0.00385 | HR4       | RPW8-like protein 4                                                                                     |
 | AT3G58990 |      0.00385 | IPMI1     | 3-isopropylmalate dehydratase small subunit 2                                                           |
 | AT5G44380 |      0.00385 | AT5G44380 | FAD-binding Berberine family protein                                                                    |
 | AT5G54810 |      0.00385 | TSB1      | Tryptophan synthase                                                                                     |
 | AT1G18650 |      0.00385 | PDCB3     | PLASMODESMATA CALLOSE-BINDING PROTEIN 3                                                                 |
 | AT1G59990 |      0.00385 | RH22      | DEAD-box ATP-dependent RNA helicase 22                                                                  |
 | AT5G05730 |      0.00385 | ASA1      | Anthranilate synthase alpha subunit 1                                                                   |
 | AT5G26340 |      0.00385 | STP13     | STP13                                                                                                   |
 | AT5G64120 |      0.0038  | PER71     | Peroxidase                                                                                              |
 | AT4G26150 |      0.0038  | GATA22    | Putative GATA transcription factor 22                                                                   |
 | AT4G10530 |      0.0038  | AT4G10530 | Subtilase family protein                                                                                |
 | AT1G51700 |      0.0038  | DOF1.7    | Dof zinc finger protein DOF1.7                                                                          |
 | AT4G35730 |      0.0038  | AT4G35730 | Regulator of Vps4 activity in the MVB pathway protein                                                   |
 | AT5G66470 |      0.0038  | AT5G66470 | GTPase ERA-like, chloroplastic                                                                          |
 | AT1G18570 |      0.0038  | MYB51     | Transcription factor MYB51                                                                              |
 | AT4G18730 |      0.0038  | RPL11C    | 60S ribosomal protein L11-2                                                                             |
 | AT3G26445 |      0.0038  | AT3G26445 | Beta-1,4-N-acetylglucosaminyltransferase family protein                                                 |
 | AT2G02100 |      0.0038  | PDF2.2    | PDF2.2                                                                                                  |
 | AT5G58350 |      0.00375 | WNK4      | Probable serine/threonine-protein kinase WNK4                                                           |
 | AT5G44990 |      0.00375 | AT5G44990 | Glutathione S-transferase family protein                                                                |
 | AT4G14780 |      0.00375 | AT4G14780 | Kinase like protein                                                                                     |
 | AT5G42830 |      0.00375 | AT5G42830 | HXXXD-type acyl-transferase family protein                                                              |
 | AT3G25700 |      0.00375 | AT3G25700 | At3g25700                                                                                               |
 | AT3G56070 |      0.00375 | CYP19-3   | Peptidyl-prolyl cis-trans isomerase CYP19-3                                                             |
 | AT2G45870 |      0.00375 | AT2G45870 | UPF0187 protein At2g45870, chloroplastic                                                                |
 | AT1G18970 |      0.00375 | GLP1      | Germin-like protein subfamily T member 1                                                                |
 | AT3G18250 |      0.00375 | AT3G18250 | Putative membrane lipoprotein                                                                           |
 | AT3G28740 |      0.0037  | CYP81D11  | Cytochrome P450 81D11                                                                                   |
 | AT4G34950 |      0.0037  | AT4G34950 | Major facilitator superfamily protein                                                                   |
 | AT1G52245 |      0.0037  | AT1G52245 | Dynein light chain                                                                                      |
 | AT5G63140 |      0.0037  | PAP29     | Probable inactive purple acid phosphatase 29                                                            |
 | AT5G51720 |      0.0037  | NEET      | NEET                                                                                                    |
 | AT5G20230 |      0.0037  | BCB       | SAG14                                                                                                   |
 | AT1G18975 |      0.0037  | AT1G18975 | None                                                                                                    |
 | AT1G06000 |      0.0037  | UGT89C1   | Glycosyltransferase (Fragment)                                                                          |
 | AT1G55020 |      0.0037  | LOX1      | Linoleate 9S-lipoxygenase 1                                                                             |
 | AT4G14630 |      0.0037  | GLP9      | At4g14630                                                                                               |
 | AT5G47500 |      0.0037  | PME68     | Probable pectinesterase 68                                                                              |
 | AT2G19990 |      0.00365 | PR-1-LIKE | PR-1-like protein                                                                                       |
 | AT1G72610 |      0.00365 | GLP1      | Germin-like protein subfamily 3 member 1                                                                |
 | AT5G08070 |      0.00365 | TCP17     | Transcription factor TCP17                                                                              |
 | AT5G48657 |      0.00365 | AT5G48657 | defense protein-related                                                                                 |
 | AT1G67030 |      0.00365 | ZFP6      | Zinc finger protein 6                                                                                   |
 | AT3G01420 |      0.00365 | DOX1      | Alpha-dioxygenase 1                                                                                     |
 | AT2G28740 |      0.00365 | HIS4      | Histone H4                                                                                              |
 | AT2G10940 |      0.00365 | AT2G10940 | At2g10940/F15K19.1                                                                                      |
 | AT3G06145 |      0.00365 | AT3G06145 | Putative RING zinc finger protein                                                                       |
 | AT4G39950 |      0.00365 | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2                                                  |
 | AT4G09040 |      0.00365 | AT4G09040 | At4g09040                                                                                               |
 | AT4G15530 |      0.00365 | PPDK      | Pyruvate, phosphate dikinase 1, chloroplastic                                                           |
 | AT5G48880 |      0.00365 | KAT5      | PKT2                                                                                                    |
 | AT5G19750 |      0.00365 | AT5G19750 | Peroxisomal membrane 22 kDa (Mpv17/PMP22) family protein                                                |
 | AT3G05730 |      0.00365 | AT3G05730 | Defensin-like protein 205                                                                               |
 | AT3G21305 |      0.00365 | AT3G21305 | None                                                                                                    |
 | AT4G19420 |      0.0036  | AT4G19420 | Pectinacetylesterase family protein                                                                     |
 | AT1G79680 |      0.0036  | WAKL10    | Wall-associated receptor kinase-like 10                                                                 |
 | AT4G34760 |      0.0036  | SAUR50    | Auxin-responsive protein SAUR50                                                                         |
 | AT1G15260 |      0.0036  | AT1G15260 | LOW protein: ATP-dependent RNA helicase-like protein                                                    |
 | AT4G37540 |      0.0036  | LBD39     | LOB domain-containing protein 39                                                                        |
 | AT4G34290 |      0.0036  | AT4G34290 | SWIB/MDM2 domain superfamily protein                                                                    |
 | AT5G64890 |      0.00355 | PEP2      | Elicitor peptide 2                                                                                      |
 | AT3G50770 |      0.00355 | CML41     | Probable calcium-binding protein CML41                                                                  |
 | AT2G39670 |      0.00355 | AT2G39670 | Radical SAM superfamily protein                                                                         |
 | AT4G24110 |      0.00355 | AT4G24110 | NADP-specific glutamate dehydrogenase                                                                   |
 | AT4G00360 |      0.00355 | CYP86A2   | Cytochrome P450 86A2                                                                                    |
 | AT4G00050 |      0.00355 | UNE10     | Transcription factor UNE10                                                                              |
 | AT3G54890 |      0.00355 | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                                          |
 | AT1G76680 |      0.00355 | OPR1      | 12-oxophytodienoate reductase 1                                                                         |
 | AT3G48850 |      0.00355 | MPT2      | Mitochondrial phosphate carrier protein 2, mitochondrial                                                |
 | AT1G02660 |      0.00355 | PLIP2     | Phospholipase A1 PLIP2, chloroplastic                                                                   |
 | AT4G01037 |      0.00355 | WTF1      | WTF1                                                                                                    |
 | AT3G46280 |      0.00355 | AT3G46280 | Kinase-like protein                                                                                     |
 | AT3G54580 |      0.0035  | AT3G54580 | Proline-rich extensin-like family protein                                                               |
 | AT5G14330 |      0.0035  | AT5G14330 | Transmembrane protein                                                                                   |
 | AT2G43120 |      0.0035  | AT2G43120 | RmlC-like cupins superfamily protein                                                                    |
 | AT1G26255 |      0.0035  | AT1G26255 | None                                                                                                    |
 | AT3G55660 |      0.0035  | ROPGEF6   | Rop guanine nucleotide exchange factor 6                                                                |
 | AT1G08757 |      0.0035  | AT1G08757 | None                                                                                                    |
 | AT4G25740 |      0.0035  | RPS10A    | 40S ribosomal protein S10-1                                                                             |
 | AT5G06865 |      0.0035  | AT5G06865 | other RNA                                                                                               |
 | AT1G26240 |      0.0035  | AT1G26240 | Proline-rich extensin-like family protein                                                               |
 | AT3G24300 |      0.0035  | AMT1-3    | Ammonium transporter 1 member 3                                                                         |
 | AT3G51430 |      0.0035  | SSL5      | Protein STRICTOSIDINE SYNTHASE-LIKE 5                                                                   |
 | AT5G06860 |      0.0035  | PGIP1     | PGIP1                                                                                                   |
 | AT5G39110 |      0.0035  | AT5G39110 | Germin-like protein subfamily 1 member 14                                                               |
 | AT3G04070 |      0.00345 | NAC047    | NAC transcription factor 47                                                                             |
 | AT4G31500 |      0.00345 | CYP83B1   | Cytochrome P450 83B1                                                                                    |
 | AT4G24240 |      0.00345 | WRKY7     | Probable WRKY transcription factor 7                                                                    |
 | AT1G03630 |      0.00345 | PORC      | Protochlorophyllide reductase C, chloroplastic                                                          |
 | AT3G09405 |      0.00345 | PAE4      | Pectin acetylesterase 4                                                                                 |
 | AT2G15220 |      0.00345 | AT2G15220 | At2g15220/F15A23.4                                                                                      |
 | AT3G26830 |      0.00345 | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase                                              |
 | AT1G11300 |      0.00345 | AT1G11300 | G-type lectin S-receptor-like serine/threonine-protein kinase At1g11300                                 |
 | AT5G55280 |      0.00345 | FTSZ1     | Cell division protein FtsZ homolog 1, chloroplastic                                                     |
 | AT5G13930 |      0.00345 | CHS       | Chalcone synthase family protein                                                                        |
 | AT3G18830 |      0.00345 | PLT5      | PMT5                                                                                                    |
 | AT3G18420 |      0.00345 | SG1       | protein SLOW GREEN 1, chloroplastic                                                                     |
 | AT5G49330 |      0.00345 | MYB111    | Transcription factor MYB111                                                                             |
 | AT1G14870 |      0.0034  | PCR2      | PCR2                                                                                                    |
 | AT5G56870 |      0.0034  | BGAL4     | Beta-galactosidase 4                                                                                    |
 | AT3G52450 |      0.0034  | PUB22     | RING-type E3 ubiquitin transferase                                                                      |
 | AT1G32640 |      0.0034  | MYC2      | ZBF1                                                                                                    |
 | AT2G12170 |      0.0034  | AT2G12170 | BEST Arabidopsis thaliana protein match is: Transcriptional factor B3 family protein (TAIR:AT2G24645.1) |
 | AT3G14900 |      0.0034  | AT3G14900 | Uncharacterized protein At3g14900                                                                       |
 | AT1G65490 |      0.0034  | AT1G65490 | unknown protein                                                                                         |
 | AT5G55580 |      0.0034  | MTERF9    | Transcription termination factor MTERF9, chloroplastic                                                  |
 | AT2G27389 |      0.0034  | AT2G27389 | unknown protein                                                                                         |
 | AT4G29390 |      0.00335 | RPS30A    | 40S ribosomal protein S30                                                                               |
 | AT2G24180 |      0.00335 | CYP71B6   | Cytochrome P450 71B6                                                                                    |
 | AT1G66700 |      0.00335 | PXMT1     | Paraxanthine methyltransferase 1                                                                        |
 | AT5G02780 |      0.00335 | GSTL1     | Glutathione S-transferase L1                                                                            |
 | AT1G02920 |      0.00335 | GSTF7     | Glutathione S-transferase F7                                                                            |
 | AT5G52050 |      0.00335 | DTX50     | Protein DETOXIFICATION 50                                                                               |
 | AT1G10522 |      0.00335 | PRIN2     | Protein PLASTID REDOX INSENSITIVE 2, chloroplastic                                                      |
 | AT5G08640 |      0.00335 | FLS1      | Flavonol synthase/flavanone 3-hydroxylase                                                               |
 | AT2G41380 |      0.00335 | AT2G41380 | At2g41380                                                                                               |
 | AT3G16420 |      0.00335 | PBP1      | PYK10-binding protein 1                                                                                 |
 | AT3G26210 |      0.00335 | CYP71B23  | Cytochrome P450 71B23                                                                                   |
 | AT1G03220 |      0.00335 | AT1G03220 | Eukaryotic aspartyl protease family protein                                                             |
 | AT2G27402 |      0.00335 | AT2G27402 | At2g27402                                                                                               |
 | AT1G14540 |      0.00335 | PER4      | Peroxidase                                                                                              |
 | AT5G38900 |      0.0033  | AT5G38900 | Thioredoxin superfamily protein                                                                         |
 | AT5G49480 |      0.0033  | ATCP1     | Calcium-binding protein CP1                                                                             |
 | AT2G36690 |      0.0033  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                 |
 | AT4G15610 |      0.00325 | AT4G15610 | CASP-like protein 1D1                                                                                   |
 | AT4G02290 |      0.00325 | AtGH9B13  | Endoglucanase 17                                                                                        |
 | AT3G09260 |      0.00325 | BGLU23    | PYK10                                                                                                   |
 | AT4G26010 |      0.00325 | AT4G26010 | Peroxidase superfamily protein                                                                          |
 | AT2G46750 |      0.0032  | GULLO2    | L-gulonolactone oxidase 2                                                                               |
 | AT4G37370 |      0.0032  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                                                  |
 | AT1G69490 |      0.0032  | NAC029    | NAP                                                                                                     |
 | AT1G15885 |      0.0032  | AT1G15885 | Putative uncharacterized protein                                                                        |
 | AT5G39580 |      0.00315 | PER62     | Peroxidase 62                                                                                           |
 | AT2G27710 |      0.00315 | RPP2B     | AT2G27710 protein                                                                                       |
 | AT2G41810 |      0.00315 | AT2G41810 | Uncharacterized protein At2g41810                                                                       |
 | AT3G03670 |      0.00315 | PER28     | Peroxidase 28                                                                                           |
 | AT3G16670 |      0.00315 | AT3G16670 | AT3g16670/MGL6_12                                                                                       |
 | AT5G11550 |      0.00315 | AT5G11550 | ARM repeat superfamily protein                                                                          |
 | AT4G23700 |      0.00315 | CHX17     | Cation/H(+) antiporter 17                                                                               |
 | AT5G26290 |      0.0031  | AT5G26290 | TRAF-like family protein                                                                                |
 | AT2G46840 |      0.0031  | DUF4      | DUF4                                                                                                    |
 | AT5G46580 |      0.0031  | AT5G46580 | Pentatricopeptide repeat-containing protein At5g46580, chloroplastic                                    |
 | AT1G78450 |      0.0031  | AT1G78450 | F3F9.4                                                                                                  |
 | AT1G21120 |      0.0031  | AT1G21120 | O-methyltransferase family protein                                                                      |
 | AT2G25297 |      0.00305 | AT2G25297 | None                                                                                                    |
 | AT5G67400 |      0.00305 | PER73     | Peroxidase                                                                                              |
 | AT5G23310 |      0.00305 | FSD3      | Superoxide dismutase                                                                                    |
 | AT1G71695 |      0.00305 | PER12     | Peroxidase                                                                                              |
 | AT1G51890 |      0.00305 | AT1G51890 | Leucine-rich repeat protein kinase family protein                                                       |
 | AT5G05735 |      0.003   | AT5G05735 | None                                                                                                    |
 | AT3G25790 |      0.00295 | HHO1      | Transcription factor HHO1                                                                               |
 | AT5G26920 |      0.00295 | CBP60G    | Calmodulin-binding protein 60 G                                                                         |
 | AT3G56090 |      0.00295 | FER3      | Ferritin-3, chloroplastic                                                                               |
 | AT4G21760 |      0.0029  | BGLU47    | beta-glucosidase 47                                                                                     |
 | AT5G56670 |      0.0029  | RPS30A    | 40S ribosomal protein S30                                                                               |
 | AT5G40780 |      0.00265 | LHT1      | Lysine histidine transporter 1                                                                          |
 | AT1G65690 |      0.00265 | NHL6      | NDR1/HIN1-like protein 6                                                                                |
 | AT3G13950 |      0.0026  | AT3G13950 | AT3G13950 protein                                                                                       |
 | AT4G30090 |      0.0022  | AT4G30090 | Golgin family A protein                                                                                 |
 | AT4G32260 |      0.00215 | AT4G32260 | PDE334                                                                                                  |
 | AT5G57625 |      0.00205 | AT5G57625 | At5g57625                                                                                               |
 | AT1G08380 |      0.00195 | PSAO      | PSAO                                                                                                    |
 | AT5G42650 |      0.0019  | CYP74A    | Allene oxide synthase, chloroplastic                                                                    |
 | AT5G64040 |      0.00165 | PSAN      | Photosystem I reaction center subunit PSI-N, chloroplast, putative / PSI-N, putative (PSAN)             |
 | AT4G02270 |      0.00135 | RHS13     | At4g02270                                                                                               |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [191]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/f094c38938b42a5053f5b46d7f9b367c3f6ccc8c.png]]
 :END:

* Selecting genes for Lym2 at 6hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'lym' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [192]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [193]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [4486 5323 1213 ...  448 2885 1248]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [194]:
 # text/org
 |    | incoming   | name      | description                                 |
 |----+------------+-----------+---------------------------------------------|
 |  0 | AT3G01420  | DOX1      | Alpha-dioxygenase 1                         |
 |  1 | AT3G09260  | BGLU23    | PYK10                                       |
 |  2 | AT2G19970  | AT2G19970 | At2g19970                                   |
 |  3 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3              |
 |  4 | AT5G14330  | AT5G14330 | Transmembrane protein                       |
 |  5 | AT3G16420  | PBP1      | PYK10-binding protein 1                     |
 |  6 | AT2G27402  | AT2G27402 | At2g27402                                   |
 |  7 | AT1G26240  | AT1G26240 | Proline-rich extensin-like family protein   |
 |  8 | AT3G16400  | NSP1      | Nitrile-specifier protein 1                 |
 |  9 | AT5G13930  | CHS       | Chalcone synthase family protein            |
 | 10 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3    |
 | 11 | AT2G15220  | AT2G15220 | At2g15220/F15A23.4                          |
 | 12 | AT4G25220  | RHS15     | Putative glycerol-3-phosphate transporter 2 |
 | 13 | AT1G21120  | AT1G21120 | O-methyltransferase family protein          |
 | 14 | AT5G08640  | FLS1      | Flavonol synthase/flavanone 3-hydroxylase   |
 | 15 | AT2G38870  | AT2G38870 | Putative protease inhibitor                 |
 | 16 | AT1G02920  | GSTF7     | Glutathione S-transferase F7                |
 | 17 | AT1G09310  | AT1G09310 | T31J12.3 protein                            |
 | 18 | AT1G66700  | PXMT1     | Paraxanthine methyltransferase 1            |
 | 19 | AT1G18970  | GLP1      | Germin-like protein subfamily T member 1    |
 | 20 | AT1G02930  | GSTF6     | Glutathione S-transferase F6                |
 | 21 | AT2G26560  | PLP2      | Patatin-like protein 2                      |
 | 22 | AT5G47500  | PME68     | Probable pectinesterase 68                  |
 | 23 | AT5G39110  | AT5G39110 | Germin-like protein subfamily 1 member 14   |
 | 24 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                       |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'lym' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [195]:
 # text/org
 | gene      |   importance | name      | description                                 |
 |-----------+--------------+-----------+---------------------------------------------|
 | AT2G15220 |      0.03965 | AT2G15220 | At2g15220/F15A23.4                          |
 | AT1G02920 |      0.039   | GSTF7     | Glutathione S-transferase F7                |
 | AT5G13930 |      0.03815 | CHS       | Chalcone synthase family protein            |
 | AT5G20630 |      0.03755 | GER3      | Germin-like protein subfamily 3 member 3    |
 | AT1G21120 |      0.0375  | AT1G21120 | O-methyltransferase family protein          |
 | AT2G19970 |      0.03745 | AT2G19970 | At2g19970                                   |
 | AT4G25220 |      0.03725 | RHS15     | Putative glycerol-3-phosphate transporter 2 |
 | AT3G09260 |      0.03705 | BGLU23    | PYK10                                       |
 | AT3G16400 |      0.037   | NSP1      | Nitrile-specifier protein 1                 |
 | AT2G27402 |      0.0369  | AT2G27402 | At2g27402                                   |
 | AT5G39110 |      0.03675 | AT5G39110 | Germin-like protein subfamily 1 member 14   |
 | AT1G02930 |      0.0366  | GSTF6     | Glutathione S-transferase F6                |
 | AT3G01420 |      0.03635 | DOX1      | Alpha-dioxygenase 1                         |
 | AT3G28740 |      0.03625 | CYP81D11  | Cytochrome P450 81D11                       |
 | AT2G38870 |      0.0362  | AT2G38870 | Putative protease inhibitor                 |
 | AT2G26560 |      0.0362  | PLP2      | Patatin-like protein 2                      |
 | AT5G08640 |      0.0361  | FLS1      | Flavonol synthase/flavanone 3-hydroxylase   |
 | AT1G26380 |      0.03585 | FOX1      | Berberine bridge enzyme-like 3              |
 | AT1G26240 |      0.0358  | AT1G26240 | Proline-rich extensin-like family protein   |
 | AT1G09310 |      0.0356  | AT1G09310 | T31J12.3 protein                            |
 | AT1G66700 |      0.03545 | PXMT1     | Paraxanthine methyltransferase 1            |
 | AT1G18970 |      0.035   | GLP1      | Germin-like protein subfamily T member 1    |
 | AT3G16420 |      0.03495 | PBP1      | PYK10-binding protein 1                     |
 | AT5G14330 |      0.03425 | AT5G14330 | Transmembrane protein                       |
 | AT5G47500 |      0.0341  | PME68     | Probable pectinesterase 68                  |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance')
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [196]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/5811645d8a8190e08707507f937756af0845e9b0.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [197]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [198]:
 # output
 Num Features: 250
 Selected Features: [False False False ... False False False]
 Feature Ranking: [5448 3653 2005 ...  792 1273 2830]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [199]:
 # text/org
 |     | incoming   | name      | description                                                                                             |
 |-----+------------+-----------+---------------------------------------------------------------------------------------------------------|
 |   0 | AT2G41380  | AT2G41380 | At2g41380                                                                                               |
 |   1 | AT5G57220  | CYP81F2   | Cytochrome P450 81F2                                                                                    |
 |   2 | AT4G29905  | AT4G29905 | Putative uncharacterized protein                                                                        |
 |   3 | AT3G25790  | HHO1      | Transcription factor HHO1                                                                               |
 |   4 | AT5G16980  | AT5G16980 | Zinc-binding dehydrogenase family protein                                                               |
 |   5 | AT5G52050  | DTX50     | Protein DETOXIFICATION 50                                                                               |
 |   6 | AT1G18650  | PDCB3     | PLASMODESMATA CALLOSE-BINDING PROTEIN 3                                                                 |
 |   7 | AT3G01420  | DOX1      | Alpha-dioxygenase 1                                                                                     |
 |   8 | AT4G00360  | CYP86A2   | Cytochrome P450 86A2                                                                                    |
 |   9 | AT4G14630  | GLP9      | At4g14630                                                                                               |
 |  10 | AT3G18250  | AT3G18250 | Putative membrane lipoprotein                                                                           |
 |  11 | AT3G56090  | FER3      | Ferritin-3, chloroplastic                                                                               |
 |  12 | AT2G29150  | AT2G29150 | Tropinone reductase homolog At2g29150                                                                   |
 |  13 | AT1G08757  | AT1G08757 | None                                                                                                    |
 |  14 | AT3G51430  | SSL5      | Protein STRICTOSIDINE SYNTHASE-LIKE 5                                                                   |
 |  15 | AT5G23310  | FSD3      | Superoxide dismutase                                                                                    |
 |  16 | AT4G26010  | AT4G26010 | Peroxidase superfamily protein                                                                          |
 |  17 | AT5G07030  | AT5G07030 | Eukaryotic aspartyl protease family protein                                                             |
 |  18 | AT4G28420  | AT4G28420 | Probable aminotransferase TAT1                                                                          |
 |  19 | AT5G05735  | AT5G05735 | None                                                                                                    |
 |  20 | AT3G09260  | BGLU23    | PYK10                                                                                                   |
 |  21 | AT3G50770  | CML41     | Probable calcium-binding protein CML41                                                                  |
 |  22 | AT5G44990  | AT5G44990 | Glutathione S-transferase family protein                                                                |
 |  23 | AT2G19970  | AT2G19970 | At2g19970                                                                                               |
 |  24 | AT5G40780  | LHT1      | Lysine histidine transporter 1                                                                          |
 |  25 | AT4G25810  | XTH23     | Probable xyloglucan endotransglucosylase/hydrolase protein 23                                           |
 |  26 | AT4G26150  | GATA22    | Putative GATA transcription factor 22                                                                   |
 |  27 | AT3G26210  | CYP71B23  | Cytochrome P450 71B23                                                                                   |
 |  28 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                                                                          |
 |  29 | AT5G02780  | GSTL1     | Glutathione S-transferase L1                                                                            |
 |  30 | AT2G32990  | AtGH9B8   | Endoglucanase 11                                                                                        |
 |  31 | AT5G67400  | PER73     | Peroxidase                                                                                              |
 |  32 | AT1G15885  | AT1G15885 | Putative uncharacterized protein                                                                        |
 |  33 | AT3G52450  | PUB22     | RING-type E3 ubiquitin transferase                                                                      |
 |  34 | AT5G26340  | STP13     | STP13                                                                                                   |
 |  35 | AT4G24780  | AT4G24780 | Probable pectate lyase 18                                                                               |
 |  36 | AT3G16670  | AT3G16670 | AT3g16670/MGL6_12                                                                                       |
 |  37 | AT2G24180  | CYP71B6   | Cytochrome P450 71B6                                                                                    |
 |  38 | AT5G06730  | PER54     | Peroxidase 54                                                                                           |
 |  39 | AT4G37370  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                                                  |
 |  40 | AT1G18980  | AT1G18980 | At1g18980                                                                                               |
 |  41 | AT2G36690  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                 |
 |  42 | AT1G10522  | PRIN2     | Protein PLASTID REDOX INSENSITIVE 2, chloroplastic                                                      |
 |  43 | AT3G06145  | AT3G06145 | Putative RING zinc finger protein                                                                       |
 |  44 | AT4G29740  | CKX4      | Cytokinin dehydrogenase 4                                                                               |
 |  45 | AT4G29390  | RPS30A    | 40S ribosomal protein S30                                                                               |
 |  46 | AT3G12930  | IJ        | Protein Iojap, chloroplastic                                                                            |
 |  47 | AT5G58250  | AT5G58250 | YCF54                                                                                                   |
 |  48 | AT4G35730  | AT4G35730 | Regulator of Vps4 activity in the MVB pathway protein                                                   |
 |  49 | AT5G14330  | AT5G14330 | Transmembrane protein                                                                                   |
 |  50 | AT3G05730  | AT3G05730 | Defensin-like protein 205                                                                               |
 |  51 | AT1G55020  | LOX1      | Linoleate 9S-lipoxygenase 1                                                                             |
 |  52 | AT5G49480  | ATCP1     | Calcium-binding protein CP1                                                                             |
 |  53 | AT3G25700  | AT3G25700 | At3g25700                                                                                               |
 |  54 | AT1G26410  | FOX4      | Berberine bridge enzyme-like 6                                                                          |
 |  55 | AT1G52245  | AT1G52245 | Dynein light chain                                                                                      |
 |  56 | AT5G08610  | RH26      | PDE340                                                                                                  |
 |  57 | AT5G05730  | ASA1      | Anthranilate synthase alpha subunit 1                                                                   |
 |  58 | AT1G18570  | MYB51     | Transcription factor MYB51                                                                              |
 |  59 | AT1G48570  | AT1G48570 | T1N15.19                                                                                                |
 |  60 | AT5G57625  | AT5G57625 | At5g57625                                                                                               |
 |  61 | AT3G13950  | AT3G13950 | AT3G13950 protein                                                                                       |
 |  62 | AT4G34290  | AT4G34290 | SWIB/MDM2 domain superfamily protein                                                                    |
 |  63 | AT3G16420  | PBP1      | PYK10-binding protein 1                                                                                 |
 |  64 | AT1G51890  | AT1G51890 | Leucine-rich repeat protein kinase family protein                                                       |
 |  65 | AT5G55580  | MTERF9    | Transcription termination factor MTERF9, chloroplastic                                                  |
 |  66 | AT1G32640  | MYC2      | ZBF1                                                                                                    |
 |  67 | AT3G46280  | AT3G46280 | Kinase-like protein                                                                                     |
 |  68 | AT3G18420  | SG1       | protein SLOW GREEN 1, chloroplastic                                                                     |
 |  69 | AT2G19990  | PR-1-LIKE | PR-1-like protein                                                                                       |
 |  70 | AT3G01970  | WRKY45    | Probable WRKY transcription factor 45                                                                   |
 |  71 | AT4G19370  | AT4G19370 | Chitin synthase, putative (DUF1218)                                                                     |
 |  72 | AT1G21100  | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                              |
 |  73 | AT1G67980  | CCOAMT    | Putative caffeoyl-CoA O-methyltransferase At1g67980                                                     |
 |  74 | AT5G11550  | AT5G11550 | ARM repeat superfamily protein                                                                          |
 |  75 | AT2G36750  | UGT73C1   | UDP-glycosyltransferase 73C1                                                                            |
 |  76 | AT3G45030  | RPS20C    | 40S ribosomal protein S20-1                                                                             |
 |  77 | AT4G24110  | AT4G24110 | NADP-specific glutamate dehydrogenase                                                                   |
 |  78 | AT5G26920  | CBP60G    | Calmodulin-binding protein 60 G                                                                         |
 |  79 | AT4G01037  | WTF1      | WTF1                                                                                                    |
 |  80 | AT4G15610  | AT4G15610 | CASP-like protein 1D1                                                                                   |
 |  81 | AT5G11210  | GLR2.5    | Glutamate receptor 2.5                                                                                  |
 |  82 | AT1G08380  | PSAO      | PSAO                                                                                                    |
 |  83 | AT1G18975  | AT1G18975 | None                                                                                                    |
 |  84 | AT5G51720  | NEET      | NEET                                                                                                    |
 |  85 | AT2G12170  | AT2G12170 | BEST Arabidopsis thaliana protein match is: Transcriptional factor B3 family protein (TAIR:AT2G24645.1) |
 |  86 | AT5G19890  | PER59     | Peroxidase 59                                                                                           |
 |  87 | AT2G02100  | PDF2.2    | PDF2.2                                                                                                  |
 |  88 | AT3G63380  | ACA12     | Calcium-transporting ATPase                                                                             |
 |  89 | AT4G02520  | GSTF2     | Glutathione S-transferase F2                                                                            |
 |  90 | AT2G10940  | AT2G10940 | At2g10940/F15K19.1                                                                                      |
 |  91 | AT5G48657  | AT5G48657 | defense protein-related                                                                                 |
 |  92 | AT2G27402  | AT2G27402 | At2g27402                                                                                               |
 |  93 | AT4G21770  | AT4G21770 | RNA pseudouridine synthase 6, chloroplastic                                                             |
 |  94 | AT4G00050  | UNE10     | Transcription factor UNE10                                                                              |
 |  95 | AT1G11300  | AT1G11300 | G-type lectin S-receptor-like serine/threonine-protein kinase At1g11300                                 |
 |  96 | AT4G19420  | AT4G19420 | Pectinacetylesterase family protein                                                                     |
 |  97 | AT3G09405  | PAE4      | Pectin acetylesterase 4                                                                                 |
 |  98 | AT3G03670  | PER28     | Peroxidase 28                                                                                           |
 |  99 | AT5G54810  | TSB1      | Tryptophan synthase                                                                                     |
 | 100 | AT3G56070  | CYP19-3   | Peptidyl-prolyl cis-trans isomerase CYP19-3                                                             |
 | 101 | AT1G09750  | AED3      | Aspartyl protease AED3                                                                                  |
 | 102 | AT5G64040  | PSAN      | Photosystem I reaction center subunit PSI-N, chloroplast, putative / PSI-N, putative (PSAN)             |
 | 103 | AT5G13080  | WRKY75    | WRKY75                                                                                                  |
 | 104 | AT5G39580  | PER62     | Peroxidase 62                                                                                           |
 | 105 | AT1G26240  | AT1G26240 | Proline-rich extensin-like family protein                                                               |
 | 106 | AT3G16400  | NSP1      | Nitrile-specifier protein 1                                                                             |
 | 107 | AT1G67148  | AT1G67148 | Putative uncharacterized protein                                                                        |
 | 108 | AT4G01700  | AT4G01700 | At4g01700                                                                                               |
 | 109 | AT4G18730  | RPL11C    | 60S ribosomal protein L11-2                                                                             |
 | 110 | AT5G13930  | CHS       | Chalcone synthase family protein                                                                        |
 | 111 | AT4G03985  | AT4G03985 | None                                                                                                    |
 | 112 | AT5G63140  | PAP29     | Probable inactive purple acid phosphatase 29                                                            |
 | 113 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3                                                                |
 | 114 | AT1G78450  | AT1G78450 | F3F9.4                                                                                                  |
 | 115 | AT3G55660  | ROPGEF6   | Rop guanine nucleotide exchange factor 6                                                                |
 | 116 | AT4G39950  | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2                                                  |
 | 117 | AT2G15220  | AT2G15220 | At2g15220/F15A23.4                                                                                      |
 | 118 | AT1G32350  | AOX3      | AOX1D                                                                                                   |
 | 119 | AT4G15530  | PPDK      | Pyruvate, phosphate dikinase 1, chloroplastic                                                           |
 | 120 | AT1G28290  | AGP31     | Non-classical arabinogalactan protein 31                                                                |
 | 121 | AT5G20790  | AT5G20790 | unknown protein                                                                                         |
 | 122 | AT1G14870  | PCR2      | PCR2                                                                                                    |
 | 123 | AT4G21760  | BGLU47    | beta-glucosidase 47                                                                                     |
 | 124 | AT5G64890  | PEP2      | Elicitor peptide 2                                                                                      |
 | 125 | AT1G21120  | AT1G21120 | O-methyltransferase family protein                                                                      |
 | 126 | AT2G25297  | AT2G25297 | None                                                                                                    |
 | 127 | AT4G25740  | RPS10A    | 40S ribosomal protein S10-1                                                                             |
 | 128 | AT5G42650  | CYP74A    | Allene oxide synthase, chloroplastic                                                                    |
 | 129 | AT1G67030  | ZFP6      | Zinc finger protein 6                                                                                   |
 | 130 | AT1G21400  | AT1G21400 | Thiamin diphosphate-binding fold (THDP-binding) superfamily protein                                     |
 | 131 | AT3G26445  | AT3G26445 | Beta-1,4-N-acetylglucosaminyltransferase family protein                                                 |
 | 132 | AT3G24300  | AMT1-3    | Ammonium transporter 1 member 3                                                                         |
 | 133 | AT5G08640  | FLS1      | Flavonol synthase/flavanone 3-hydroxylase                                                               |
 | 134 | AT4G37540  | LBD39     | LOB domain-containing protein 39                                                                        |
 | 135 | AT4G30720  | AT4G30720 | FAD/NAD(P)-binding oxidoreductase family protein                                                        |
 | 136 | AT3G26830  | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase                                              |
 | 137 | AT3G54580  | AT3G54580 | Proline-rich extensin-like family protein                                                               |
 | 138 | AT5G14650  | AT5G14650 | Pectin lyase-like superfamily protein                                                                   |
 | 139 | AT3G58990  | IPMI1     | 3-isopropylmalate dehydratase small subunit 2                                                           |
 | 140 | AT3G44860  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                                             |
 | 141 | AT5G48880  | KAT5      | PKT2                                                                                                    |
 | 142 | AT5G66470  | AT5G66470 | GTPase ERA-like, chloroplastic                                                                          |
 | 143 | AT1G05523  | AT1G05523 | None                                                                                                    |
 | 144 | AT4G20830  | AT4G20830 | Berberine bridge enzyme-like 19                                                                         |
 | 145 | AT2G38870  | AT2G38870 | Putative protease inhibitor                                                                             |
 | 146 | AT2G32650  | AT2G32650 | At2g32650                                                                                               |
 | 147 | AT1G03630  | PORC      | Protochlorophyllide reductase C, chloroplastic                                                          |
 | 148 | AT3G18830  | PLT5      | PMT5                                                                                                    |
 | 149 | AT5G40730  | AGP24     | Arabinogalactan peptide 24                                                                              |
 | 150 | AT4G20835  | AT4G20835 | None                                                                                                    |
 | 151 | AT5G44380  | AT5G44380 | FAD-binding Berberine family protein                                                                    |
 | 152 | AT1G18250  | ATLP-1    | Pathogenesis-related thaumatin superfamily protein                                                      |
 | 153 | AT1G80850  | AT1G80850 | At1g80850                                                                                               |
 | 154 | AT1G02920  | GSTF7     | Glutathione S-transferase F7                                                                            |
 | 155 | AT5G19750  | AT5G19750 | Peroxisomal membrane 22 kDa (Mpv17/PMP22) family protein                                                |
 | 156 | AT2G24850  | TAT3      | Probable aminotransferase TAT3                                                                          |
 | 157 | AT5G03390  | AT5G03390 | At5g03390                                                                                               |
 | 158 | AT5G55280  | FTSZ1     | Cell division protein FtsZ homolog 1, chloroplastic                                                     |
 | 159 | AT3G14900  | AT3G14900 | Uncharacterized protein At3g14900                                                                       |
 | 160 | AT5G15780  | AT5G15780 | At5g15780                                                                                               |
 | 161 | AT4G34950  | AT4G34950 | Major facilitator superfamily protein                                                                   |
 | 162 | AT1G13930  | AT1G13930 | At1g13930/F16A14.27                                                                                     |
 | 163 | AT2G48130  | AT2G48130 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | 164 | AT5G64120  | PER71     | Peroxidase                                                                                              |
 | 165 | AT1G13520  | AT1G13520 | At1g13520                                                                                               |
 | 166 | AT5G08070  | TCP17     | Transcription factor TCP17                                                                              |
 | 167 | AT1G30700  | AT1G30700 | Berberine bridge enzyme-like 8                                                                          |
 | 168 | AT1G06000  | UGT89C1   | Glycosyltransferase (Fragment)                                                                          |
 | 169 | AT1G09310  | AT1G09310 | T31J12.3 protein                                                                                        |
 | 170 | AT1G65490  | AT1G65490 | unknown protein                                                                                         |
 | 171 | AT1G02660  | PLIP2     | Phospholipase A1 PLIP2, chloroplastic                                                                   |
 | 172 | AT3G21305  | AT3G21305 | None                                                                                                    |
 | 173 | AT1G06002  | AT1G06002 | Potential natural antisense gene, locus overlaps with AT1G06000                                         |
 | 174 | AT4G31500  | CYP83B1   | Cytochrome P450 83B1                                                                                    |
 | 175 | AT5G20230  | BCB       | SAG14                                                                                                   |
 | 176 | AT1G64160  | DIR5      | Dirigent protein 5                                                                                      |
 | 177 | AT2G27710  | RPP2B     | AT2G27710 protein                                                                                       |
 | 178 | AT5G46580  | AT5G46580 | Pentatricopeptide repeat-containing protein At5g46580, chloroplastic                                    |
 | 179 | AT3G50480  | HR4       | RPW8-like protein 4                                                                                     |
 | 180 | AT5G06860  | PGIP1     | PGIP1                                                                                                   |
 | 181 | AT4G30090  | AT4G30090 | Golgin family A protein                                                                                 |
 | 182 | AT1G79680  | WAKL10    | Wall-associated receptor kinase-like 10                                                                 |
 | 183 | AT3G54890  | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                                          |
 | 184 | AT5G66530  | AT5G66530 | Glucose-6-phosphate 1-epimerase                                                                         |
 | 185 | AT2G17740  | AT2G17740 | At2g17740                                                                                               |
 | 186 | AT1G59990  | RH22      | DEAD-box ATP-dependent RNA helicase 22                                                                  |
 | 187 | AT2G45870  | AT2G45870 | UPF0187 protein At2g45870, chloroplastic                                                                |
 | 188 | AT1G66700  | PXMT1     | Paraxanthine methyltransferase 1                                                                        |
 | 189 | AT5G49330  | MYB111    | Transcription factor MYB111                                                                             |
 | 190 | AT1G69200  | FLN2      | Fructokinase-like 2, chloroplastic                                                                      |
 | 191 | AT2G02930  | GSTF3     | Glutathione S-transferase F3                                                                            |
 | 192 | AT1G26255  | AT1G26255 | None                                                                                                    |
 | 193 | AT3G62530  | AT3G62530 | ARM repeat superfamily protein                                                                          |
 | 194 | AT4G02290  | AtGH9B13  | Endoglucanase 17                                                                                        |
 | 195 | AT4G34760  | SAUR50    | Auxin-responsive protein SAUR50                                                                         |
 | 196 | AT1G07590  | AT1G07590 | Pentatricopeptide repeat-containing protein At1g07590, mitochondrial                                    |
 | 197 | AT5G24660  | LSU2      | Protein RESPONSE TO LOW SULFUR 2                                                                        |
 | 198 | AT1G29720  | RFK1      | Probable LRR receptor-like serine/threonine-protein kinase At1g29720                                    |
 | 199 | AT1G18970  | GLP1      | Germin-like protein subfamily T member 1                                                                |
 | 200 | AT1G02730  | CSLD5     | Cellulose synthase-like protein D5                                                                      |
 | 201 | AT1G65690  | NHL6      | NDR1/HIN1-like protein 6                                                                                |
 | 202 | AT5G56870  | BGAL4     | Beta-galactosidase 4                                                                                    |
 | 203 | AT2G34180  | CIPK13    | CBL-interacting serine/threonine-protein kinase 13                                                      |
 | 204 | AT1G03220  | AT1G03220 | Eukaryotic aspartyl protease family protein                                                             |
 | 205 | AT4G09040  | AT4G09040 | At4g09040                                                                                               |
 | 206 | AT5G58350  | WNK4      | Probable serine/threonine-protein kinase WNK4                                                           |
 | 207 | AT1G51700  | DOF1.7    | Dof zinc finger protein DOF1.7                                                                          |
 | 208 | AT2G41810  | AT2G41810 | Uncharacterized protein At2g41810                                                                       |
 | 209 | AT1G02930  | GSTF6     | Glutathione S-transferase F6                                                                            |
 | 210 | AT1G71695  | PER12     | Peroxidase                                                                                              |
 | 211 | AT1G30530  | UGT78D1   | Glycosyltransferase (Fragment)                                                                          |
 | 212 | AT5G06865  | AT5G06865 | other RNA                                                                                               |
 | 213 | AT3G48500  | PDE312    | Nucleic acid-binding, OB-fold-like protein                                                              |
 | 214 | AT1G72610  | GLP1      | Germin-like protein subfamily 3 member 1                                                                |
 | 215 | AT2G26560  | PLP2      | Patatin-like protein 2                                                                                  |
 | 216 | AT1G26420  | FOX5      | Berberine bridge enzyme-like 7                                                                          |
 | 217 | AT2G46750  | GULLO2    | L-gulonolactone oxidase 2                                                                               |
 | 218 | AT1G76680  | OPR1      | 12-oxophytodienoate reductase 1                                                                         |
 | 219 | AT2G41310  | ARR8      | Two-component response regulator ARR8                                                                   |
 | 220 | AT1G62510  | AT1G62510 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | 221 | AT1G14540  | PER4      | Peroxidase                                                                                              |
 | 222 | AT2G43120  | AT2G43120 | RmlC-like cupins superfamily protein                                                                    |
 | 223 | AT4G02270  | RHS13     | At4g02270                                                                                               |
 | 224 | AT4G24240  | WRKY7     | Probable WRKY transcription factor 7                                                                    |
 | 225 | AT1G72600  | AT1G72600 | At1g72600                                                                                               |
 | 226 | AT5G47500  | PME68     | Probable pectinesterase 68                                                                              |
 | 227 | AT2G28740  | HIS4      | Histone H4                                                                                              |
 | 228 | AT4G14780  | AT4G14780 | Kinase like protein                                                                                     |
 | 229 | AT4G32260  | AT4G32260 | PDE334                                                                                                  |
 | 230 | AT1G26250  | AT1G26250 | Proline-rich extensin-like family protein                                                               |
 | 231 | AT3G48850  | MPT2      | Mitochondrial phosphate carrier protein 2, mitochondrial                                                |
 | 232 | AT2G18690  | AT2G18690 | Expressed protein                                                                                       |
 | 233 | AT5G42830  | AT5G42830 | HXXXD-type acyl-transferase family protein                                                              |
 | 234 | AT5G39110  | AT5G39110 | Germin-like protein subfamily 1 member 14                                                               |
 | 235 | AT4G23700  | CHX17     | Cation/H(+) antiporter 17                                                                               |
 | 236 | AT1G69490  | NAC029    | NAP                                                                                                     |
 | 237 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                                                                                   |
 | 238 | AT2G28000  | CPN60A1   | SLP                                                                                                     |
 | 239 | AT4G10530  | AT4G10530 | Subtilase family protein                                                                                |
 | 240 | AT5G26290  | AT5G26290 | TRAF-like family protein                                                                                |
 | 241 | AT2G27389  | AT2G27389 | unknown protein                                                                                         |
 | 242 | AT1G15260  | AT1G15260 | LOW protein: ATP-dependent RNA helicase-like protein                                                    |
 | 243 | AT2G46840  | DUF4      | DUF4                                                                                                    |
 | 244 | AT4G12320  | CYP706A6  | At4g12320                                                                                               |
 | 245 | AT2G39670  | AT2G39670 | Radical SAM superfamily protein                                                                         |
 | 246 | AT5G56670  | RPS30A    | 40S ribosomal protein S30                                                                               |
 | 247 | AT4G02510  | TOC159    | Translocase of chloroplast 159, chloroplastic                                                           |
 | 248 | AT5G38900  | AT5G38900 | Thioredoxin superfamily protein                                                                         |
 | 249 | AT3G04070  | NAC047    | NAC transcription factor 47                                                                             |
 :END:


**** Forest on this RFE

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'lym' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [200]:
 # text/org
 | gene      |   importance | name      | description                                                                                             |
 |-----------+--------------+-----------+---------------------------------------------------------------------------------------------------------|
 | AT2G17740 |      0.0056  | AT2G17740 | At2g17740                                                                                               |
 | AT2G32650 |      0.00525 | AT2G32650 | At2g32650                                                                                               |
 | AT5G58250 |      0.0052  | AT5G58250 | YCF54                                                                                                   |
 | AT5G15780 |      0.00515 | AT5G15780 | At5g15780                                                                                               |
 | AT1G02730 |      0.00515 | CSLD5     | Cellulose synthase-like protein D5                                                                      |
 | AT1G48570 |      0.0051  | AT1G48570 | T1N15.19                                                                                                |
 | AT4G02510 |      0.005   | TOC159    | Translocase of chloroplast 159, chloroplastic                                                           |
 | AT1G13520 |      0.005   | AT1G13520 | At1g13520                                                                                               |
 | AT4G30720 |      0.00495 | AT4G30720 | FAD/NAD(P)-binding oxidoreductase family protein                                                        |
 | AT4G21770 |      0.00495 | AT4G21770 | RNA pseudouridine synthase 6, chloroplastic                                                             |
 | AT4G19370 |      0.00495 | AT4G19370 | Chitin synthase, putative (DUF1218)                                                                     |
 | AT2G02930 |      0.00495 | GSTF3     | Glutathione S-transferase F3                                                                            |
 | AT1G30530 |      0.0049  | UGT78D1   | Glycosyltransferase (Fragment)                                                                          |
 | AT1G64160 |      0.00485 | DIR5      | Dirigent protein 5                                                                                      |
 | AT5G57220 |      0.00485 | CYP81F2   | Cytochrome P450 81F2                                                                                    |
 | AT1G09750 |      0.0048  | AED3      | Aspartyl protease AED3                                                                                  |
 | AT1G18250 |      0.00475 | ATLP-1    | Pathogenesis-related thaumatin superfamily protein                                                      |
 | AT4G24780 |      0.00475 | AT4G24780 | Probable pectate lyase 18                                                                               |
 | AT3G12930 |      0.00475 | IJ        | Protein Iojap, chloroplastic                                                                            |
 | AT1G26250 |      0.00475 | AT1G26250 | Proline-rich extensin-like family protein                                                               |
 | AT3G63380 |      0.0047  | ACA12     | Calcium-transporting ATPase                                                                             |
 | AT4G01700 |      0.0047  | AT4G01700 | At4g01700                                                                                               |
 | AT4G02520 |      0.0047  | GSTF2     | Glutathione S-transferase F2                                                                            |
 | AT5G07030 |      0.0047  | AT5G07030 | Eukaryotic aspartyl protease family protein                                                             |
 | AT4G25810 |      0.0047  | XTH23     | Probable xyloglucan endotransglucosylase/hydrolase protein 23                                           |
 | AT4G28420 |      0.0047  | AT4G28420 | Probable aminotransferase TAT1                                                                          |
 | AT5G08610 |      0.0047  | RH26      | PDE340                                                                                                  |
 | AT2G18690 |      0.00465 | AT2G18690 | Expressed protein                                                                                       |
 | AT1G06002 |      0.00465 | AT1G06002 | Potential natural antisense gene, locus overlaps with AT1G06000                                         |
 | AT1G09310 |      0.00465 | AT1G09310 | T31J12.3 protein                                                                                        |
 | AT4G03985 |      0.00465 | AT4G03985 | None                                                                                                    |
 | AT2G19970 |      0.0046  | AT2G19970 | At2g19970                                                                                               |
 | AT5G66530 |      0.0046  | AT5G66530 | Glucose-6-phosphate 1-epimerase                                                                         |
 | AT4G20830 |      0.0046  | AT4G20830 | Berberine bridge enzyme-like 19                                                                         |
 | AT1G26410 |      0.0046  | FOX4      | Berberine bridge enzyme-like 6                                                                          |
 | AT2G26560 |      0.0046  | PLP2      | Patatin-like protein 2                                                                                  |
 | AT1G69200 |      0.00455 | FLN2      | Fructokinase-like 2, chloroplastic                                                                      |
 | AT5G20630 |      0.00455 | GER3      | Germin-like protein subfamily 3 member 3                                                                |
 | AT1G26380 |      0.00455 | FOX1      | Berberine bridge enzyme-like 3                                                                          |
 | AT5G58350 |      0.00455 | WNK4      | Probable serine/threonine-protein kinase WNK4                                                           |
 | AT1G55020 |      0.00455 | LOX1      | Linoleate 9S-lipoxygenase 1                                                                             |
 | AT3G01970 |      0.00455 | WRKY45    | Probable WRKY transcription factor 45                                                                   |
 | AT5G06730 |      0.00455 | PER54     | Peroxidase 54                                                                                           |
 | AT3G62530 |      0.00455 | AT3G62530 | ARM repeat superfamily protein                                                                          |
 | AT5G14650 |      0.0045  | AT5G14650 | Pectin lyase-like superfamily protein                                                                   |
 | AT3G48500 |      0.0045  | PDE312    | Nucleic acid-binding, OB-fold-like protein                                                              |
 | AT1G18970 |      0.0045  | GLP1      | Germin-like protein subfamily T member 1                                                                |
 | AT1G67980 |      0.0045  | CCOAMT    | Putative caffeoyl-CoA O-methyltransferase At1g67980                                                     |
 | AT2G38870 |      0.00445 | AT2G38870 | Putative protease inhibitor                                                                             |
 | AT2G48130 |      0.00445 | AT2G48130 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | AT4G15530 |      0.00445 | PPDK      | Pyruvate, phosphate dikinase 1, chloroplastic                                                           |
 | AT5G05730 |      0.00445 | ASA1      | Anthranilate synthase alpha subunit 1                                                                   |
 | AT1G18570 |      0.00445 | MYB51     | Transcription factor MYB51                                                                              |
 | AT2G28000 |      0.00445 | CPN60A1   | SLP                                                                                                     |
 | AT4G20835 |      0.00445 | AT4G20835 | None                                                                                                    |
 | AT4G12320 |      0.00445 | CYP706A6  | At4g12320                                                                                               |
 | AT4G34950 |      0.00445 | AT4G34950 | Major facilitator superfamily protein                                                                   |
 | AT4G26150 |      0.00445 | GATA22    | Putative GATA transcription factor 22                                                                   |
 | AT5G64120 |      0.0044  | PER71     | Peroxidase                                                                                              |
 | AT5G13080 |      0.0044  | WRKY75    | WRKY75                                                                                                  |
 | AT4G14780 |      0.0044  | AT4G14780 | Kinase like protein                                                                                     |
 | AT5G51720 |      0.0044  | NEET      | NEET                                                                                                    |
 | AT3G16400 |      0.0044  | NSP1      | Nitrile-specifier protein 1                                                                             |
 | AT2G29150 |      0.0044  | AT2G29150 | Tropinone reductase homolog At2g29150                                                                   |
 | AT1G59990 |      0.0044  | RH22      | DEAD-box ATP-dependent RNA helicase 22                                                                  |
 | AT1G62510 |      0.0044  | AT1G62510 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | AT5G54810 |      0.00435 | TSB1      | Tryptophan synthase                                                                                     |
 | AT5G14330 |      0.00435 | AT5G14330 | Transmembrane protein                                                                                   |
 | AT5G11210 |      0.00435 | GLR2.5    | Glutamate receptor 2.5                                                                                  |
 | AT3G50480 |      0.00435 | HR4       | RPW8-like protein 4                                                                                     |
 | AT5G42830 |      0.00435 | AT5G42830 | HXXXD-type acyl-transferase family protein                                                              |
 | AT3G28740 |      0.00435 | CYP81D11  | Cytochrome P450 81D11                                                                                   |
 | AT5G66470 |      0.00435 | AT5G66470 | GTPase ERA-like, chloroplastic                                                                          |
 | AT1G18650 |      0.00435 | PDCB3     | PLASMODESMATA CALLOSE-BINDING PROTEIN 3                                                                 |
 | AT4G39950 |      0.00435 | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2                                                  |
 | AT5G16980 |      0.00435 | AT5G16980 | Zinc-binding dehydrogenase family protein                                                               |
 | AT5G20230 |      0.00435 | BCB       | SAG14                                                                                                   |
 | AT5G48880 |      0.00435 | KAT5      | PKT2                                                                                                    |
 | AT4G19420 |      0.0043  | AT4G19420 | Pectinacetylesterase family protein                                                                     |
 | AT1G26420 |      0.0043  | FOX5      | Berberine bridge enzyme-like 7                                                                          |
 | AT3G18420 |      0.0043  | SG1       | protein SLOW GREEN 1, chloroplastic                                                                     |
 | AT2G02100 |      0.0043  | PDF2.2    | PDF2.2                                                                                                  |
 | AT5G44380 |      0.0043  | AT5G44380 | FAD-binding Berberine family protein                                                                    |
 | AT1G67148 |      0.00425 | AT1G67148 | Putative uncharacterized protein                                                                        |
 | AT5G47500 |      0.00425 | PME68     | Probable pectinesterase 68                                                                              |
 | AT3G18250 |      0.00425 | AT3G18250 | Putative membrane lipoprotein                                                                           |
 | AT4G09040 |      0.00425 | AT4G09040 | At4g09040                                                                                               |
 | AT3G25700 |      0.00425 | AT3G25700 | At3g25700                                                                                               |
 | AT3G01420 |      0.00425 | DOX1      | Alpha-dioxygenase 1                                                                                     |
 | AT3G04070 |      0.00425 | NAC047    | NAC transcription factor 47                                                                             |
 | AT1G08757 |      0.00425 | AT1G08757 | None                                                                                                    |
 | AT4G10530 |      0.00425 | AT4G10530 | Subtilase family protein                                                                                |
 | AT5G19890 |      0.00425 | PER59     | Peroxidase 59                                                                                           |
 | AT1G02930 |      0.0042  | GSTF6     | Glutathione S-transferase F6                                                                            |
 | AT5G63140 |      0.0042  | PAP29     | Probable inactive purple acid phosphatase 29                                                            |
 | AT1G26240 |      0.0042  | AT1G26240 | Proline-rich extensin-like family protein                                                               |
 | AT1G30700 |      0.0042  | AT1G30700 | Berberine bridge enzyme-like 8                                                                          |
 | AT4G37540 |      0.0042  | LBD39     | LOB domain-containing protein 39                                                                        |
 | AT3G06145 |      0.0042  | AT3G06145 | Putative RING zinc finger protein                                                                       |
 | AT1G18975 |      0.0042  | AT1G18975 | None                                                                                                    |
 | AT5G26340 |      0.0042  | STP13     | STP13                                                                                                   |
 | AT1G65490 |      0.0042  | AT1G65490 | unknown protein                                                                                         |
 | AT3G21305 |      0.0042  | AT3G21305 | None                                                                                                    |
 | AT5G55580 |      0.00415 | MTERF9    | Transcription termination factor MTERF9, chloroplastic                                                  |
 | AT5G03390 |      0.00415 | AT5G03390 | At5g03390                                                                                               |
 | AT5G06865 |      0.00415 | AT5G06865 | other RNA                                                                                               |
 | AT2G45870 |      0.00415 | AT2G45870 | UPF0187 protein At2g45870, chloroplastic                                                                |
 | AT1G79680 |      0.00415 | WAKL10    | Wall-associated receptor kinase-like 10                                                                 |
 | AT2G39670 |      0.00415 | AT2G39670 | Radical SAM superfamily protein                                                                         |
 | AT5G44990 |      0.00415 | AT5G44990 | Glutathione S-transferase family protein                                                                |
 | AT5G39110 |      0.0041  | AT5G39110 | Germin-like protein subfamily 1 member 14                                                               |
 | AT1G26255 |      0.0041  | AT1G26255 | None                                                                                                    |
 | AT1G66700 |      0.0041  | PXMT1     | Paraxanthine methyltransferase 1                                                                        |
 | AT5G13930 |      0.0041  | CHS       | Chalcone synthase family protein                                                                        |
 | AT4G15610 |      0.0041  | AT4G15610 | CASP-like protein 1D1                                                                                   |
 | AT3G51430 |      0.00405 | SSL5      | Protein STRICTOSIDINE SYNTHASE-LIKE 5                                                                   |
 | AT5G06860 |      0.00405 | PGIP1     | PGIP1                                                                                                   |
 | AT2G27389 |      0.00405 | AT2G27389 | unknown protein                                                                                         |
 | AT2G46750 |      0.00405 | GULLO2    | L-gulonolactone oxidase 2                                                                               |
 | AT4G34760 |      0.00405 | SAUR50    | Auxin-responsive protein SAUR50                                                                         |
 | AT1G03630 |      0.00405 | PORC      | Protochlorophyllide reductase C, chloroplastic                                                          |
 | AT1G03220 |      0.00405 | AT1G03220 | Eukaryotic aspartyl protease family protein                                                             |
 | AT1G10522 |      0.004   | PRIN2     | Protein PLASTID REDOX INSENSITIVE 2, chloroplastic                                                      |
 | AT3G09405 |      0.004   | PAE4      | Pectin acetylesterase 4                                                                                 |
 | AT4G00360 |      0.004   | CYP86A2   | Cytochrome P450 86A2                                                                                    |
 | AT1G14870 |      0.004   | PCR2      | PCR2                                                                                                    |
 | AT5G55280 |      0.004   | FTSZ1     | Cell division protein FtsZ homolog 1, chloroplastic                                                     |
 | AT5G08640 |      0.004   | FLS1      | Flavonol synthase/flavanone 3-hydroxylase                                                               |
 | AT2G19990 |      0.004   | PR-1-LIKE | PR-1-like protein                                                                                       |
 | AT3G46280 |      0.004   | AT3G46280 | Kinase-like protein                                                                                     |
 | AT3G26210 |      0.004   | CYP71B23  | Cytochrome P450 71B23                                                                                   |
 | AT4G14630 |      0.004   | GLP9      | At4g14630                                                                                               |
 | AT5G19750 |      0.00395 | AT5G19750 | Peroxisomal membrane 22 kDa (Mpv17/PMP22) family protein                                                |
 | AT4G01037 |      0.00395 | WTF1      | WTF1                                                                                                    |
 | AT3G54890 |      0.00395 | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                                          |
 | AT1G06000 |      0.00395 | UGT89C1   | Glycosyltransferase (Fragment)                                                                          |
 | AT1G02660 |      0.00395 | PLIP2     | Phospholipase A1 PLIP2, chloroplastic                                                                   |
 | AT3G16420 |      0.00395 | PBP1      | PYK10-binding protein 1                                                                                 |
 | AT5G48657 |      0.00395 | AT5G48657 | defense protein-related                                                                                 |
 | AT2G15220 |      0.00395 | AT2G15220 | At2g15220/F15A23.4                                                                                      |
 | AT4G24110 |      0.00395 | AT4G24110 | NADP-specific glutamate dehydrogenase                                                                   |
 | AT3G05730 |      0.00395 | AT3G05730 | Defensin-like protein 205                                                                               |
 | AT1G02920 |      0.0039  | GSTF7     | Glutathione S-transferase F7                                                                            |
 | AT2G36690 |      0.0039  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                 |
 | AT1G15260 |      0.0039  | AT1G15260 | LOW protein: ATP-dependent RNA helicase-like protein                                                    |
 | AT5G52050 |      0.0039  | DTX50     | Protein DETOXIFICATION 50                                                                               |
 | AT5G39580 |      0.0039  | PER62     | Peroxidase 62                                                                                           |
 | AT3G18830 |      0.0039  | PLT5      | PMT5                                                                                                    |
 | AT2G24180 |      0.00385 | CYP71B6   | Cytochrome P450 71B6                                                                                    |
 | AT4G34290 |      0.00385 | AT4G34290 | SWIB/MDM2 domain superfamily protein                                                                    |
 | AT3G14900 |      0.00385 | AT3G14900 | Uncharacterized protein At3g14900                                                                       |
 | AT1G11300 |      0.00385 | AT1G11300 | G-type lectin S-receptor-like serine/threonine-protein kinase At1g11300                                 |
 | AT3G48850 |      0.00385 | MPT2      | Mitochondrial phosphate carrier protein 2, mitochondrial                                                |
 | AT5G05735 |      0.00385 | AT5G05735 | None                                                                                                    |
 | AT5G02780 |      0.0038  | GSTL1     | Glutathione S-transferase L1                                                                            |
 | AT3G50770 |      0.0038  | CML41     | Probable calcium-binding protein CML41                                                                  |
 | AT4G31500 |      0.0038  | CYP83B1   | Cytochrome P450 83B1                                                                                    |
 | AT3G52450 |      0.0038  | PUB22     | RING-type E3 ubiquitin transferase                                                                      |
 | AT5G49330 |      0.0038  | MYB111    | Transcription factor MYB111                                                                             |
 | AT2G41380 |      0.0038  | AT2G41380 | At2g41380                                                                                               |
 | AT2G27402 |      0.00375 | AT2G27402 | At2g27402                                                                                               |
 | AT1G14540 |      0.00375 | PER4      | Peroxidase                                                                                              |
 | AT5G38900 |      0.00375 | AT5G38900 | Thioredoxin superfamily protein                                                                         |
 | AT3G09260 |      0.00375 | BGLU23    | PYK10                                                                                                   |
 | AT2G25297 |      0.0037  | AT2G25297 | None                                                                                                    |
 | AT3G56090 |      0.0037  | FER3      | Ferritin-3, chloroplastic                                                                               |
 | AT3G03670 |      0.0037  | PER28     | Peroxidase 28                                                                                           |
 | AT3G26830 |      0.0037  | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase                                              |
 | AT5G67400 |      0.00365 | PER73     | Peroxidase                                                                                              |
 | AT4G26010 |      0.00365 | AT4G26010 | Peroxidase superfamily protein                                                                          |
 | AT1G69490 |      0.0036  | NAC029    | NAP                                                                                                     |
 | AT1G21120 |      0.0036  | AT1G21120 | O-methyltransferase family protein                                                                      |
 | AT5G26920 |      0.0036  | CBP60G    | Calmodulin-binding protein 60 G                                                                         |
 | AT1G71695 |      0.00355 | PER12     | Peroxidase                                                                                              |
 | AT1G78450 |      0.00355 | AT1G78450 | F3F9.4                                                                                                  |
 | AT4G37370 |      0.0035  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                                                  |
 | AT5G23310 |      0.00345 | FSD3      | Superoxide dismutase                                                                                    |
 | AT1G51890 |      0.00345 | AT1G51890 | Leucine-rich repeat protein kinase family protein                                                       |
 | AT5G46580 |      0.0034  | AT5G46580 | Pentatricopeptide repeat-containing protein At5g46580, chloroplastic                                    |
 | AT4G23700 |      0.00335 | CHX17     | Cation/H(+) antiporter 17                                                                               |
 | AT1G65690 |      0.0033  | NHL6      | NDR1/HIN1-like protein 6                                                                                |
 | AT4G21760 |      0.00325 | BGLU47    | beta-glucosidase 47                                                                                     |
 | AT5G40780 |      0.0032  | LHT1      | Lysine histidine transporter 1                                                                          |
 | AT5G24660 |      0.003   | LSU2      | Protein RESPONSE TO LOW SULFUR 2                                                                        |
 | AT1G13930 |      0.00295 | AT1G13930 | At1g13930/F16A14.27                                                                                     |
 | AT1G51700 |      0.00295 | DOF1.7    | Dof zinc finger protein DOF1.7                                                                          |
 | AT1G72600 |      0.00295 | AT1G72600 | At1g72600                                                                                               |
 | AT4G29905 |      0.0028  | AT4G29905 | Putative uncharacterized protein                                                                        |
 | AT5G57625 |      0.0027  | AT5G57625 | At5g57625                                                                                               |
 | AT1G80850 |      0.0027  | AT1G80850 | At1g80850                                                                                               |
 | AT2G36750 |      0.00265 | UGT73C1   | UDP-glycosyltransferase 73C1                                                                            |
 | AT3G26445 |      0.0026  | AT3G26445 | Beta-1,4-N-acetylglucosaminyltransferase family protein                                                 |
 | AT2G41310 |      0.00255 | ARR8      | Two-component response regulator ARR8                                                                   |
 | AT2G43120 |      0.00255 | AT2G43120 | RmlC-like cupins superfamily protein                                                                    |
 | AT2G10940 |      0.00255 | AT2G10940 | At2g10940/F15K19.1                                                                                      |
 | AT4G29740 |      0.0025  | CKX4      | Cytokinin dehydrogenase 4                                                                               |
 | AT1G18980 |      0.00245 | AT1G18980 | At1g18980                                                                                               |
 | AT4G35730 |      0.00245 | AT4G35730 | Regulator of Vps4 activity in the MVB pathway protein                                                   |
 | AT5G08070 |      0.00245 | TCP17     | Transcription factor TCP17                                                                              |
 | AT1G05523 |      0.0024  | AT1G05523 | None                                                                                                    |
 | AT3G45030 |      0.0024  | RPS20C    | 40S ribosomal protein S20-1                                                                             |
 | AT1G21400 |      0.0024  | AT1G21400 | Thiamin diphosphate-binding fold (THDP-binding) superfamily protein                                     |
 | AT2G32990 |      0.0024  | AtGH9B8   | Endoglucanase 11                                                                                        |
 | AT1G72610 |      0.00235 | GLP1      | Germin-like protein subfamily 3 member 1                                                                |
 | AT1G52245 |      0.0023  | AT1G52245 | Dynein light chain                                                                                      |
 | AT2G34180 |      0.0023  | CIPK13    | CBL-interacting serine/threonine-protein kinase 13                                                      |
 | AT1G67030 |      0.0023  | ZFP6      | Zinc finger protein 6                                                                                   |
 | AT3G56070 |      0.0023  | CYP19-3   | Peptidyl-prolyl cis-trans isomerase CYP19-3                                                             |
 | AT3G24300 |      0.00225 | AMT1-3    | Ammonium transporter 1 member 3                                                                         |
 | AT4G29390 |      0.00225 | RPS30A    | 40S ribosomal protein S30                                                                               |
 | AT2G28740 |      0.00225 | HIS4      | Histone H4                                                                                              |
 | AT3G44860 |      0.00225 | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                                             |
 | AT4G18730 |      0.00215 | RPL11C    | 60S ribosomal protein L11-2                                                                             |
 | AT2G24850 |      0.00215 | TAT3      | Probable aminotransferase TAT3                                                                          |
 | AT1G76680 |      0.00215 | OPR1      | 12-oxophytodienoate reductase 1                                                                         |
 | AT1G32350 |      0.0021  | AOX3      | AOX1D                                                                                                   |
 | AT3G54580 |      0.0021  | AT3G54580 | Proline-rich extensin-like family protein                                                               |
 | AT4G30090 |      0.0021  | AT4G30090 | Golgin family A protein                                                                                 |
 | AT5G20790 |      0.00205 | AT5G20790 | unknown protein                                                                                         |
 | AT1G21100 |      0.002   | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                              |
 | AT3G16670 |      0.002   | AT3G16670 | AT3g16670/MGL6_12                                                                                       |
 | AT5G56870 |      0.002   | BGAL4     | Beta-galactosidase 4                                                                                    |
 | AT5G26290 |      0.00195 | AT5G26290 | TRAF-like family protein                                                                                |
 | AT4G24240 |      0.00195 | WRKY7     | Probable WRKY transcription factor 7                                                                    |
 | AT1G29720 |      0.00195 | RFK1      | Probable LRR receptor-like serine/threonine-protein kinase At1g29720                                    |
 | AT4G02290 |      0.0019  | AtGH9B13  | Endoglucanase 17                                                                                        |
 | AT3G58990 |      0.0019  | IPMI1     | 3-isopropylmalate dehydratase small subunit 2                                                           |
 | AT3G13950 |      0.0019  | AT3G13950 | AT3G13950 protein                                                                                       |
 | AT1G07590 |      0.00185 | AT1G07590 | Pentatricopeptide repeat-containing protein At1g07590, mitochondrial                                    |
 | AT5G40730 |      0.00185 | AGP24     | Arabinogalactan peptide 24                                                                              |
 | AT1G15885 |      0.00185 | AT1G15885 | Putative uncharacterized protein                                                                        |
 | AT4G32260 |      0.00175 | AT4G32260 | PDE334                                                                                                  |
 | AT3G55660 |      0.00175 | ROPGEF6   | Rop guanine nucleotide exchange factor 6                                                                |
 | AT1G28290 |      0.0017  | AGP31     | Non-classical arabinogalactan protein 31                                                                |
 | AT5G11550 |      0.0017  | AT5G11550 | ARM repeat superfamily protein                                                                          |
 | AT3G25790 |      0.00165 | HHO1      | Transcription factor HHO1                                                                               |
 | AT5G42650 |      0.00165 | CYP74A    | Allene oxide synthase, chloroplastic                                                                    |
 | AT4G25740 |      0.0015  | RPS10A    | 40S ribosomal protein S10-1                                                                             |
 | AT5G64890 |      0.0015  | PEP2      | Elicitor peptide 2                                                                                      |
 | AT5G64040 |      0.00145 | PSAN      | Photosystem I reaction center subunit PSI-N, chloroplast, putative / PSI-N, putative (PSAN)             |
 | AT2G12170 |      0.00145 | AT2G12170 | BEST Arabidopsis thaliana protein match is: Transcriptional factor B3 family protein (TAIR:AT2G24645.1) |
 | AT2G27710 |      0.0014  | RPP2B     | AT2G27710 protein                                                                                       |
 | AT4G00050 |      0.0014  | UNE10     | Transcription factor UNE10                                                                              |
 | AT4G02270 |      0.00135 | RHS13     | At4g02270                                                                                               |
 | AT2G46840 |      0.0013  | DUF4      | DUF4                                                                                                    |
 | AT1G32640 |      0.00125 | MYC2      | ZBF1                                                                                                    |
 | AT2G41810 |      0.0012  | AT2G41810 | Uncharacterized protein At2g41810                                                                       |
 | AT5G56670 |      0.0011  | RPS30A    | 40S ribosomal protein S30                                                                               |
 | AT5G49480 |      0.00105 | ATCP1     | Calcium-binding protein CP1                                                                             |
 | AT1G08380 |      0.0009  | PSAO      | PSAO                                                                                                    |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [201]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/969eb331027120c73cb60050d4d3c38c5895e988.png]]
 :END:

* Selecting genes for cerk at 6hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature

   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'cer' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [202]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [203]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [3882 1168 1582 ... 3669 4982 1276]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [204]:
 # text/org
 |    | incoming   | name      | description                                                                               |
 |----+------------+-----------+-------------------------------------------------------------------------------------------|
 |  0 | AT1G62500  | AT1G62500 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 |  1 | AT4G22495  | AT4G22495 | None                                                                                      |
 |  2 | AT5G45240  | AT5G45240 | Disease resistance protein (TIR-NBS-LRR class)                                            |
 |  3 | AT4G04540  | CRK39     | Putative cysteine-rich receptor-like protein kinase 39                                    |
 |  4 | AT5G42800  | DFRA      | Dihydroflavonol reductase                                                                 |
 |  5 | AT2G19190  | SIRK      | Senescence-induced receptor-like serine/threonine-protein kinase                          |
 |  6 | AT3G01840  | LYK2      | Protein LYK2                                                                              |
 |  7 | AT2G28630  | KCS12     | 3-ketoacyl-CoA synthase 12                                                                |
 |  8 | AT4G23680  | AT4G23680 | AT4g23680/F9D16_150                                                                       |
 |  9 | AT5G40400  | AT5G40400 | Pentatricopeptide repeat (PPR) superfamily protein                                        |
 | 10 | AT5G49360  | BXL1      | Beta-D-xylosidase 1                                                                       |
 | 11 | AT2G38210  | PDX1L4    | Pyridoxal 5'-phosphate synthase PDX1-like 4                                               |
 | 12 | AT3G60415  | AT3G60415 | At3g60420                                                                                 |
 | 13 | AT2G35980  | NHL10     | NDR1/HIN1-like protein 10                                                                 |
 | 14 | AT4G04700  | CPK27     | Calcium-dependent protein kinase 27                                                       |
 | 15 | AT5G50790  | SWEET10   | Bidirectional sugar transporter SWEET10                                                   |
 | 16 | AT5G38930  | AT5G38930 | Germin-like protein subfamily 1 member 10                                                 |
 | 17 | AT4G22485  | AT4G22485 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | 18 | AT1G71030  | ATMYBL2   | At1g71030/F23N20_2                                                                        |
 | 19 | AT4G23030  | DTX49     | Protein DETOXIFICATION 49                                                                 |
 | 20 | AT3G53150  | UGT73D1   | UDP-glucosyl transferase 73D1                                                             |
 | 21 | AT4G22475  | AT4G22475 | Transmembrane protein                                                                     |
 | 22 | AT1G70175  | AT1G70175 | None                                                                                      |
 | 23 | AT5G57540  | XTH13     | Putative xyloglucan endotransglucosylase/hydrolase protein 13                             |
 | 24 | AT2G38530  | LTP2      | Non-specific lipid-transfer protein                                                       |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'cer' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [205]:
 # text/org
 | gene      |   importance | name      | description                                                                               |
 |-----------+--------------+-----------+-------------------------------------------------------------------------------------------|
 | AT5G38930 |      0.04435 | AT5G38930 | Germin-like protein subfamily 1 member 10                                                 |
 | AT5G50790 |      0.0436  | SWEET10   | Bidirectional sugar transporter SWEET10                                                   |
 | AT2G38210 |      0.04325 | PDX1L4    | Pyridoxal 5'-phosphate synthase PDX1-like 4                                               |
 | AT3G01840 |      0.04275 | LYK2      | Protein LYK2                                                                              |
 | AT2G38530 |      0.0424  | LTP2      | Non-specific lipid-transfer protein                                                       |
 | AT2G19190 |      0.0419  | SIRK      | Senescence-induced receptor-like serine/threonine-protein kinase                          |
 | AT5G45240 |      0.0419  | AT5G45240 | Disease resistance protein (TIR-NBS-LRR class)                                            |
 | AT2G35980 |      0.0419  | NHL10     | NDR1/HIN1-like protein 10                                                                 |
 | AT4G23030 |      0.0419  | DTX49     | Protein DETOXIFICATION 49                                                                 |
 | AT1G62500 |      0.04175 | AT1G62500 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | AT4G22485 |      0.04165 | AT4G22485 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | AT5G40400 |      0.0415  | AT5G40400 | Pentatricopeptide repeat (PPR) superfamily protein                                        |
 | AT3G60415 |      0.0414  | AT3G60415 | At3g60420                                                                                 |
 | AT5G57540 |      0.04105 | XTH13     | Putative xyloglucan endotransglucosylase/hydrolase protein 13                             |
 | AT4G04700 |      0.0409  | CPK27     | Calcium-dependent protein kinase 27                                                       |
 | AT1G70175 |      0.04005 | AT1G70175 | None                                                                                      |
 | AT3G53150 |      0.0399  | UGT73D1   | UDP-glucosyl transferase 73D1                                                             |
 | AT4G04540 |      0.0396  | CRK39     | Putative cysteine-rich receptor-like protein kinase 39                                    |
 | AT2G28630 |      0.0396  | KCS12     | 3-ketoacyl-CoA synthase 12                                                                |
 | AT4G22475 |      0.0244  | AT4G22475 | Transmembrane protein                                                                     |
 | AT1G71030 |      0.02245 | ATMYBL2   | At1g71030/F23N20_2                                                                        |
 | AT4G22495 |      0.0212  | AT4G22495 | None                                                                                      |
 | AT5G42800 |      0.0208  | DFRA      | Dihydroflavonol reductase                                                                 |
 | AT5G49360 |      0.0166  | BXL1      | Beta-D-xylosidase 1                                                                       |
 | AT4G23680 |      0.01615 | AT4G23680 | AT4g23680/F9D16_150                                                                       |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance', ax=ax)
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [206]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/4bf21d5ca90adc9db1d098d90a7b36686c3742c1.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'cer' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [207]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [208]:
 # output
 Num Features: 250
 Selected Features: [False False False ... False False False]
 Feature Ranking: [3657  943 1357 ... 3444 4757 1051]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [209]:
 # text/org
 |     | incoming   | name      | description                                                                               |
 |-----+------------+-----------+-------------------------------------------------------------------------------------------|
 |   0 | AT1G62500  | AT1G62500 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 |   1 | AT5G51670  | AT5G51670 | Similarity to unknown protein                                                             |
 |   2 | AT4G22495  | AT4G22495 | None                                                                                      |
 |   3 | AT3G25790  | HHO1      | Transcription factor HHO1                                                                 |
 |   4 | AT1G74930  | ERF018    | Ethylene-responsive transcription factor ERF018                                           |
 |   5 | AT5G57345  | AT5G57345 | At5g57345                                                                                 |
 |   6 | AT3G43580  | AT3G43580 | At3g43580                                                                                 |
 |   7 | AT1G56430  | NAS4      | Probable nicotianamine synthase 4                                                         |
 |   8 | AT5G45240  | AT5G45240 | Disease resistance protein (TIR-NBS-LRR class)                                            |
 |   9 | AT2G02880  | AT2G02880 | Mucin-like protein                                                                        |
 |  10 | AT4G04540  | CRK39     | Putative cysteine-rich receptor-like protein kinase 39                                    |
 |  11 | AT2G07698  | AT2G07698 | ATPase, F1 complex, alpha subunit protein                                                 |
 |  12 | AT3G48450  | AT3G48450 | At3g48450                                                                                 |
 |  13 | AT3G23120  | AtRLP38   | Receptor-like protein 38                                                                  |
 |  14 | AT5G11680  | AT5G11680 | Classical AGP protein                                                                     |
 |  15 | AT1G51860  | AT1G51860 | Probable LRR receptor-like serine/threonine-protein kinase At1g51860                      |
 |  16 | AT3G19850  | AT3G19850 | BTB/POZ domain-containing protein At3g19850                                               |
 |  17 | AT5G42800  | DFRA      | Dihydroflavonol reductase                                                                 |
 |  18 | AT1G68570  | NPF3.1    | Protein NRT1/ PTR FAMILY 3.1                                                              |
 |  19 | AT3G18950  | AT3G18950 | En/Spm-like transposon protein-like                                                       |
 |  20 | AT3G28580  | AT3G28580 | AAA-ATPase At3g28580                                                                      |
 |  21 | AT5G25250  | FLOT1     | Flotillin-like protein 1                                                                  |
 |  22 | AT4G24810  | AT4G24810 | Protein kinase superfamily protein                                                        |
 |  23 | AT1G07530  | SCL14     | AT1G07530 protein                                                                         |
 |  24 | AT1G31050  | AT1G31050 | basic helix-loop-helix (bHLH) DNA-binding superfamily protein                             |
 |  25 | AT5G45340  | CYP707A3  | Abscisic acid 8'-hydroxylase 3                                                            |
 |  26 | AT5G66000  | AT5G66000 | Uncharacterized protein At5g66000                                                         |
 |  27 | AT5G26340  | STP13     | STP13                                                                                     |
 |  28 | AT4G26560  | CBL7      | Calcineurin B-like protein 7                                                              |
 |  29 | AT4G11890  | AT4G11890 | Protein kinase superfamily protein                                                        |
 |  30 | AT1G26761  | AT1G26761 | Arabinanase/levansucrase/invertase                                                        |
 |  31 | AT5G06730  | PER54     | Peroxidase 54                                                                             |
 |  32 | AT1G51660  | MKK4      | MKK4                                                                                      |
 |  33 | AT3G21780  | UGT71B6   | UDP-glycosyltransferase 71B6                                                              |
 |  34 | AT2G21050  | LAX2      | Auxin transporter-like protein 2                                                          |
 |  35 | AT4G26800  | AT4G26800 | Pentatricopeptide repeat-containing protein At4g26800                                     |
 |  36 | AT1G17610  | CHS1      | Disease resistance protein CHS1                                                           |
 |  37 | AT1G73805  | SARD1     | Protein SAR DEFICIENT 1                                                                   |
 |  38 | AT2G22980  | SCPL13    | Serine carboxypeptidase-like 13                                                           |
 |  39 | AT3G55090  | ABCG16    | ABC transporter G family member 16                                                        |
 |  40 | AT1G55020  | LOX1      | Linoleate 9S-lipoxygenase 1                                                               |
 |  41 | AT2G37100  | AT2G37100 | Protamine P1 family protein                                                               |
 |  42 | AT3G46930  | AT3G46930 | Protein kinase superfamily protein                                                        |
 |  43 | AT2G25460  | AT2G25460 | CONTAINS InterPro DOMAIN/s: C2 calcium-dependent membrane targeting (InterPro:IPR000008)  |
 |  44 | AT1G66500  | PCFS1     | Polyadenylation and cleavage factor homolog 1                                             |
 |  45 | AT1G72910  | AT1G72910 | Similar to part of disease resistance protein                                             |
 |  46 | AT2G19190  | SIRK      | Senescence-induced receptor-like serine/threonine-protein kinase                          |
 |  47 | AT4G33720  | AT4G33720 | AT4g33720/T16L1_210                                                                       |
 |  48 | AT5G46570  | BSK2      | Serine/threonine-protein kinase BSK2                                                      |
 |  49 | AT5G46500  | AT5G46500 | Protein VARIATION IN COMPOUND TRIGGERED ROOT growth protein                               |
 |  50 | AT5G27830  | AT5G27830 | FUNCTIONS IN: molecular_function unknown                                                  |
 |  51 | AT2G23210  | AT2G23210 | UDP-Glycosyltransferase superfamily protein                                               |
 |  52 | AT3G01840  | LYK2      | Protein LYK2                                                                              |
 |  53 | AT4G33050  | EDA39     | calmodulin-binding family protein                                                         |
 |  54 | AT1G51890  | AT1G51890 | Leucine-rich repeat protein kinase family protein                                         |
 |  55 | AT1G55420  | EDA11     | Cysteine/Histidine-rich C1 domain family protein                                          |
 |  56 | AT4G05910  | AT4G05910 | None                                                                                      |
 |  57 | AT3G46280  | AT3G46280 | Kinase-like protein                                                                       |
 |  58 | AT3G46090  | ZAT7      | ZAT7                                                                                      |
 |  59 | AT1G21100  | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                |
 |  60 | AT3G10710  | PME24     | Putative pectinesterase/pectinesterase inhibitor 24                                       |
 |  61 | AT4G24110  | AT4G24110 | NADP-specific glutamate dehydrogenase                                                     |
 |  62 | AT3G21230  | 4CL4      | 4-coumarate--CoA ligase 4                                                                 |
 |  63 | AT4G17500  | ERF1A     | Ethylene-responsive transcription factor 1A                                               |
 |  64 | AT1G61610  | AT1G61610 | Serine/threonine-protein kinase                                                           |
 |  65 | AT1G54970  | PRP1      | Proline-rich protein 1                                                                    |
 |  66 | AT2G02990  | RNS1      | Ribonuclease 1                                                                            |
 |  67 | AT1G25560  | TEM1      | AP2/ERF and B3 domain-containing transcription repressor TEM1                             |
 |  68 | AT2G23120  | AT2G23120 | Expressed protein                                                                         |
 |  69 | AT5G16170  | AT5G16170 | At5g16170                                                                                 |
 |  70 | AT5G43160  | QWRF9     | Family of unknown function (DUF566)                                                       |
 |  71 | AT5G19890  | PER59     | Peroxidase 59                                                                             |
 |  72 | AT1G29460  | AT1G29460 | SAUR-like auxin-responsive protein family                                                 |
 |  73 | AT4G11000  | AT4G11000 | Ankyrin repeat family protein                                                             |
 |  74 | AT5G59070  | AT5G59070 | UDP-Glycosyltransferase superfamily protein                                               |
 |  75 | AT5G48657  | AT5G48657 | defense protein-related                                                                   |
 |  76 | AT3G52060  | AT3G52060 | GnTL                                                                                      |
 |  77 | AT3G11080  | AtRLP35   | Receptor-like protein 35                                                                  |
 |  78 | AT2G20142  | AT2G20142 | Toll-Interleukin-Resistance (TIR) domain family protein                                   |
 |  79 | AT3G15740  | AT3G15740 | RING/U-box superfamily protein                                                            |
 |  80 | AT5G43790  | PCMP-E30  | Pentatricopeptide repeat-containing protein At5g43790                                     |
 |  81 | AT3G29400  | ATEXO70E1 | Exocyst subunit Exo70 family protein                                                      |
 |  82 | AT1G22890  | AT1G22890 | AT1G22890 protein                                                                         |
 |  83 | AT5G10650  | AT5G10650 | At5g10650                                                                                 |
 |  84 | AT5G65500  | AT5G65500 | U-box domain-containing protein kinase family protein                                     |
 |  85 | AT3G63255  | AT3G63255 | None                                                                                      |
 |  86 | AT1G72645  | AT1G72645 | At1g72645                                                                                 |
 |  87 | AT5G05300  | AT5G05300 | Gb                                                                                        |
 |  88 | AT5G44578  | AT5G44578 | unknown protein                                                                           |
 |  89 | AT2G38580  | AT2G38580 | Mitochondrial ATP synthase D chain-related protein                                        |
 |  90 | AT4G01970  | AtSTS     | stachyose synthase                                                                        |
 |  91 | AT3G22886  | MIR167A   | MIR167A                                                                                   |
 |  92 | AT3G54200  | AT3G54200 | Late embryogenesis abundant (LEA) hydroxyproline-rich glycoprotein family                 |
 |  93 | AT3G16400  | NSP1      | Nitrile-specifier protein 1                                                               |
 |  94 | AT3G29170  | AT3G29170 | At3g29170                                                                                 |
 |  95 | AT2G42840  | PDF1      | Protodermal factor 1                                                                      |
 |  96 | AT1G17345  | SAUR77    | Auxin-responsive protein SAUR77                                                           |
 |  97 | AT5G65860  | AT5G65860 | Ankyrin repeat family protein                                                             |
 |  98 | AT4G11660  | HSFB2B    | Heat stress transcription factor B-2b                                                     |
 |  99 | AT3G51570  | AT3G51570 | Disease resistance protein (TIR-NBS-LRR class) family                                     |
 | 100 | AT1G69790  | PBL18     | Probable serine/threonine-protein kinase PBL18                                            |
 | 101 | AT4G23210  | CRK13     | Cysteine-rich receptor-like protein kinase 13                                             |
 | 102 | AT5G40000  | AT5G40000 | AAA-ATPase At5g40000                                                                      |
 | 103 | AT4G17490  | ERF6      | Ethylene-responsive transcription factor 6                                                |
 | 104 | AT1G23550  | SRO2      | Probable inactive poly                                                                    |
 | 105 | AT2G15220  | AT2G15220 | At2g15220/F15A23.4                                                                        |
 | 106 | AT4G19230  | CYP707A1  | Cytochrome P450, family 707, subfamily A, polypeptide 1                                   |
 | 107 | AT1G35710  | AT1G35710 | Probable leucine-rich repeat receptor-like protein kinase At1g35710                       |
 | 108 | AT2G28630  | KCS12     | 3-ketoacyl-CoA synthase 12                                                                |
 | 109 | AT1G07135  | AT1G07135 | At1g07135                                                                                 |
 | 110 | AT4G23680  | AT4G23680 | AT4g23680/F9D16_150                                                                       |
 | 111 | AT1G14870  | PCR2      | PCR2                                                                                      |
 | 112 | AT5G65207  | AT5G65207 | Uncharacterized protein At5g65207                                                         |
 | 113 | AT5G40400  | AT5G40400 | Pentatricopeptide repeat (PPR) superfamily protein                                        |
 | 114 | AT4G35070  | AT4G35070 | At4g35070                                                                                 |
 | 115 | AT1G15100  | RHA2A     | E3 ubiquitin-protein ligase RHA2A                                                         |
 | 116 | AT5G49360  | BXL1      | Beta-D-xylosidase 1                                                                       |
 | 117 | AT1G13530  | AT1G13530 | Protein of unknown function (DUF1262)                                                     |
 | 118 | AT2G46440  | CNGC11    | Cyclic nucleotide-gated ion channel 11                                                    |
 | 119 | AT2G19210  | AT2G19210 | Putative leucine-rich repeat receptor-like protein kinase At2g19210                       |
 | 120 | AT1G15010  | AT1G15010 | Mediator of RNA polymerase II transcription subunit                                       |
 | 121 | AT1G19330  | AT1G19330 | unknown protein                                                                           |
 | 122 | AT1G24147  | AT1G24147 | Transmembrane protein                                                                     |
 | 123 | AT1G67855  | AT1G67855 | unknown protein                                                                           |
 | 124 | ATCG00760  | RPL36     | 50S ribosomal protein L36, chloroplastic                                                  |
 | 125 | AT3G44860  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                               |
 | 126 | AT5G48880  | KAT5      | PKT2                                                                                      |
 | 127 | AT4G13180  | AT4G13180 | AT4g13180/F17N18_70                                                                       |
 | 128 | AT2G38210  | PDX1L4    | Pyridoxal 5'-phosphate synthase PDX1-like 4                                               |
 | 129 | AT3G60415  | AT3G60415 | At3g60420                                                                                 |
 | 130 | AT1G78460  | AT1G78460 | AT1G78460 protein                                                                         |
 | 131 | AT5G41740  | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                                     |
 | 132 | AT1G59860  | HSP17.6A  | 17.6 kDa class I heat shock protein 1                                                     |
 | 133 | AT3G05200  | ATL6      | E3 ubiquitin-protein ligase ATL6                                                          |
 | 134 | AT1G33760  | ERF022    | Ethylene-responsive transcription factor ERF022                                           |
 | 135 | AT1G51850  | AT1G51850 | Leucine-rich repeat protein kinase family protein                                         |
 | 136 | AT4G33220  | PME44     | Probable pectinesterase/pectinesterase inhibitor 44                                       |
 | 137 | AT1G66090  | AT1G66090 | Disease resistance protein (TIR-NBS class)                                                |
 | 138 | AT4G35180  | LHT7      | Lysine histidine transporter-like 7                                                       |
 | 139 | AT5G28630  | AT5G28630 | Glycine-rich protein                                                                      |
 | 140 | AT2G35980  | NHL10     | NDR1/HIN1-like protein 10                                                                 |
 | 141 | AT2G24850  | TAT3      | Probable aminotransferase TAT3                                                            |
 | 142 | AT5G20670  | AT5G20670 | At5g20670                                                                                 |
 | 143 | AT4G27980  | AT4G27980 | Domain of unknown function (DUF3444)                                                      |
 | 144 | AT2G46600  | KIC       | Calcium-binding protein KIC                                                               |
 | 145 | AT4G14860  | OFP11     | Transcription repressor OFP11                                                             |
 | 146 | AT3G55980  | SZF1      | Salt-inducible zinc finger 1                                                              |
 | 147 | AT2G22860  | PSK2      | Phytosulfokines 2                                                                         |
 | 148 | AT4G04700  | CPK27     | Calcium-dependent protein kinase 27                                                       |
 | 149 | AT1G72240  | AT1G72240 | Uncharacterized protein T9N14.5                                                           |
 | 150 | AT5G52670  | AT5G52670 | Copper transport protein family                                                           |
 | 151 | AT1G13520  | AT1G13520 | At1g13520                                                                                 |
 | 152 | AT2G39980  | AT2G39980 | At2g39980/T28M21.14                                                                       |
 | 153 | AT2G21210  | AT2G21210 | SAUR-like auxin-responsive protein family                                                 |
 | 154 | AT1G20870  | IDM3      | Increased DNA methylation 3                                                               |
 | 155 | AT1G61860  | AT1G61860 | Protein kinase superfamily protein                                                        |
 | 156 | AT3G61280  | AT3G61280 | Glycosyltransferase                                                                       |
 | 157 | AT3G50800  | AT3G50800 | Uncharacterized protein At3g50800                                                         |
 | 158 | AT4G01870  | AT4G01870 | tolB protein-related                                                                      |
 | 159 | AT5G27490  | AT5G27490 | Protein YIPF                                                                              |
 | 160 | AT4G38840  | AT4G38840 | At4g38840                                                                                 |
 | 161 | AT2G41231  | AT2G41231 | unknown protein.                                                                          |
 | 162 | AT3G01175  | AT3G01175 | Transmembrane protein                                                                     |
 | 163 | AT2G45480  | GRF9      | Growth-regulating factor 9                                                                |
 | 164 | AT1G63350  | AT1G63350 | Disease resistance protein (CC-NBS-LRR class) family                                      |
 | 165 | AT2G25125  | AT2G25125 | None                                                                                      |
 | 166 | AT5G58620  | AT5G58620 | Zinc finger CCCH domain-containing protein 66                                             |
 | 167 | AT1G14480  | AT1G14480 | Ankyrin repeat family protein                                                             |
 | 168 | AT5G40170  | AtRLP54   | Receptor-like protein 54                                                                  |
 | 169 | AT4G23670  | AT4G23670 | AT4G23670 protein                                                                         |
 | 170 | AT4G31875  | AT4G31875 | At4g31872/At4g31872                                                                       |
 | 171 | AT5G42380  | CML37     | Calcium-binding protein CML37                                                             |
 | 172 | AT1G08630  | THA1      | Probable low-specificity L-threonine aldolase 1                                           |
 | 173 | AT5G03830  | AT5G03830 | CDK inhibitor P21 binding protein                                                         |
 | 174 | AT4G35110  | AT4G35110 | Phospholipase-like protein (PEARLI 4) family protein                                      |
 | 175 | AT2G35640  | AT2G35640 | Homeodomain-like superfamily protein                                                      |
 | 176 | AT1G50750  | AT1G50750 | Plant mobile domain protein family                                                        |
 | 177 | AT5G50790  | SWEET10   | Bidirectional sugar transporter SWEET10                                                   |
 | 178 | AT2G36790  | UGT73C6   | Glycosyltransferase (Fragment)                                                            |
 | 179 | AT2G47800  | ABCC4     | ABC transporter C family member 4                                                         |
 | 180 | AT4G03600  | AT4G03600 | Pyrroline-5-carboxylate reductase                                                         |
 | 181 | AT3G54890  | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                            |
 | 182 | AT1G70190  | AT1G70190 | F20P5.9 protein                                                                           |
 | 183 | AT1G27370  | SPL10     | Squamosa promoter-binding-like protein 10                                                 |
 | 184 | AT4G30570  | AT4G30570 | Probable mannose-1-phosphate guanylyltransferase 3                                        |
 | 185 | AT1G72280  | AERO1     | Like disulfide bond formation protein                                                     |
 | 186 | AT5G16800  | AT5G16800 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                                     |
 | 187 | AT1G77640  | ERF013    | Ethylene-responsive transcription factor ERF013                                           |
 | 188 | AT2G32660  | AtRLP22   | Receptor like protein 22                                                                  |
 | 189 | AT5G38930  | AT5G38930 | Germin-like protein subfamily 1 member 10                                                 |
 | 190 | AT1G36640  | AT1G36640 | Transmembrane protein                                                                     |
 | 191 | AT5G51465  | AT5G51465 | None                                                                                      |
 | 192 | AT1G72900  | AT1G72900 | Similar to part of disease resistance protein                                             |
 | 193 | AT5G65410  | ZHD1      | Zinc-finger homeodomain protein 1                                                         |
 | 194 | AT3G08870  | AT3G08870 | Concanavalin A-like lectin protein kinase family protein                                  |
 | 195 | AT4G21903  | AT4G21903 | Protein DETOXIFICATION                                                                    |
 | 196 | AT1G75240  | ZHD5      | ZHD5                                                                                      |
 | 197 | AT4G22080  | RHS14     | Probable pectate lyase 16                                                                 |
 | 198 | AT5G56870  | BGAL4     | Beta-galactosidase 4                                                                      |
 | 199 | AT1G51270  | AT1G51270 | Vesicle-associated protein 1-4                                                            |
 | 200 | AT5G21900  | AT5G21900 | At5g21900                                                                                 |
 | 201 | AT3G13650  | DIR7      | Dirigent protein 7                                                                        |
 | 202 | AT3G47090  | AT3G47090 | Leucine-rich repeat protein kinase family protein                                         |
 | 203 | AT1G62610  | AT1G62610 | NAD(P)-binding Rossmann-fold superfamily protein                                          |
 | 204 | AT4G28490  | RLK5      | Receptor-like protein kinase 5                                                            |
 | 205 | AT4G08950  | EXO       | Protein EXORDIUM                                                                          |
 | 206 | AT4G22510  | AT4G22510 | unknown protein                                                                           |
 | 207 | AT2G26560  | PLP2      | Patatin-like protein 2                                                                    |
 | 208 | AT4G22490  | AT4G22490 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | 209 | AT4G21380  | SD18      | Receptor-like serine/threonine-protein kinase SD1-8                                       |
 | 210 | AT2G46750  | GULLO2    | L-gulonolactone oxidase 2                                                                 |
 | 211 | AT5G10520  | RBK1      | RBK1                                                                                      |
 | 212 | AT3G02130  | RPK2      | LRR receptor-like serine/threonine-protein kinase RPK2                                    |
 | 213 | AT5G57560  | XTH22     | Xyloglucan endotransglucosylase/hydrolase                                                 |
 | 214 | AT3G22600  | AT3G22600 | AT3g22600/F16J14_17                                                                       |
 | 215 | AT1G76680  | OPR1      | 12-oxophytodienoate reductase 1                                                           |
 | 216 | AT4G22485  | AT4G22485 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | 217 | AT1G71030  | ATMYBL2   | At1g71030/F23N20_2                                                                        |
 | 218 | AT5G43180  | AT5G43180 | At5g43180                                                                                 |
 | 219 | AT5G60800  | AT5G60800 | Heavy metal transport/detoxification superfamily protein                                  |
 | 220 | AT2G29720  | CTF2B     | FAD/NAD(P)-binding oxidoreductase family protein                                          |
 | 221 | AT4G23030  | DTX49     | Protein DETOXIFICATION 49                                                                 |
 | 222 | AT3G62680  | PRP3      | Proline-rich protein 3                                                                    |
 | 223 | AT4G13820  | AT4G13820 | Disease resistance like protein                                                           |
 | 224 | AT2G22790  | AT2G22790 | Uncharacterized protein At2g22790                                                         |
 | 225 | AT3G53150  | UGT73D1   | UDP-glucosyl transferase 73D1                                                             |
 | 226 | AT4G22475  | AT4G22475 | Transmembrane protein                                                                     |
 | 227 | AT1G14170  | AT1G14170 | F7A19.25 protein                                                                          |
 | 228 | AT1G05675  | UGT74E1   | Glycosyltransferase (Fragment)                                                            |
 | 229 | AT3G04210  | AT3G04210 | At3g04210/T6K12_17                                                                        |
 | 230 | AT1G70175  | AT1G70175 | None                                                                                      |
 | 231 | AT4G01390  | AT4G01390 | TRAF-like family protein                                                                  |
 | 232 | AT1G22500  | ATL15     | E3 ubiquitin-protein ligase ATL15                                                         |
 | 233 | AT3G49620  | DIN11     | Probable 2-oxoglutarate-dependent dioxygenase DIN11                                       |
 | 234 | AT4G19520  | AT4G19520 | Probable disease resistance protein At4g19520                                             |
 | 235 | AT3G56260  | AT3G56260 | At3g56260                                                                                 |
 | 236 | AT5G54569  | AT5G54569 | other RNA                                                                                 |
 | 237 | AT1G67856  | AT1G67856 | RING/U-box superfamily protein                                                            |
 | 238 | AT4G39830  | AT4G39830 | At4g39830                                                                                 |
 | 239 | AT4G23700  | CHX17     | Cation/H(+) antiporter 17                                                                 |
 | 240 | AT1G29500  | SAUR66    | Auxin-responsive protein SAUR66                                                           |
 | 241 | AT4G14450  | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                          |
 | 242 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                                                                     |
 | 243 | AT5G61570  | AT5G61570 | Protein kinase superfamily protein                                                        |
 | 244 | AT1G02310  | MAN1      | MAN1                                                                                      |
 | 245 | AT4G35770  | STR15     | SEN1                                                                                      |
 | 246 | AT1G12780  | UGE1      | Bifunctional UDP-glucose 4-epimerase and UDP-xylose 4-epimerase 1                         |
 | 247 | AT5G57540  | XTH13     | Putative xyloglucan endotransglucosylase/hydrolase protein 13                             |
 | 248 | AT1G44446  | CAO       | CH1                                                                                       |
 | 249 | AT2G38530  | LTP2      | Non-specific lipid-transfer protein                                                       |
 :END:


**** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'cer' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [210]:
 # text/org
 | gene      |   importance | name      | description                                                                               |
 |-----------+--------------+-----------+-------------------------------------------------------------------------------------------|
 | AT3G54200 |      0.00535 | AT3G54200 | Late embryogenesis abundant (LEA) hydroxyproline-rich glycoprotein family                 |
 | AT5G19890 |      0.00525 | PER59     | Peroxidase 59                                                                             |
 | AT1G72280 |      0.00525 | AERO1     | Like disulfide bond formation protein                                                     |
 | AT3G28580 |      0.0052  | AT3G28580 | AAA-ATPase At3g28580                                                                      |
 | AT4G23700 |      0.0052  | CHX17     | Cation/H(+) antiporter 17                                                                 |
 | AT5G66000 |      0.00515 | AT5G66000 | Uncharacterized protein At5g66000                                                         |
 | AT1G12780 |      0.00505 | UGE1      | Bifunctional UDP-glucose 4-epimerase and UDP-xylose 4-epimerase 1                         |
 | AT2G22980 |      0.00505 | SCPL13    | Serine carboxypeptidase-like 13                                                           |
 | AT2G37100 |      0.005   | AT2G37100 | Protamine P1 family protein                                                               |
 | AT3G49620 |      0.005   | DIN11     | Probable 2-oxoglutarate-dependent dioxygenase DIN11                                       |
 | AT2G21050 |      0.005   | LAX2      | Auxin transporter-like protein 2                                                          |
 | AT3G22886 |      0.00495 | MIR167A   | MIR167A                                                                                   |
 | AT4G33050 |      0.00495 | EDA39     | calmodulin-binding family protein                                                         |
 | AT5G38930 |      0.0049  | AT5G38930 | Germin-like protein subfamily 1 member 10                                                 |
 | AT3G01175 |      0.0049  | AT3G01175 | Transmembrane protein                                                                     |
 | AT1G27370 |      0.00485 | SPL10     | Squamosa promoter-binding-like protein 10                                                 |
 | AT3G50800 |      0.00485 | AT3G50800 | Uncharacterized protein At3g50800                                                         |
 | AT3G05200 |      0.00485 | ATL6      | E3 ubiquitin-protein ligase ATL6                                                          |
 | AT5G44578 |      0.00485 | AT5G44578 | unknown protein                                                                           |
 | AT4G38840 |      0.00485 | AT4G38840 | At4g38840                                                                                 |
 | AT4G13180 |      0.00485 | AT4G13180 | AT4g13180/F17N18_70                                                                       |
 | AT4G26800 |      0.00485 | AT4G26800 | Pentatricopeptide repeat-containing protein At4g26800                                     |
 | AT4G19520 |      0.0048  | AT4G19520 | Probable disease resistance protein At4g19520                                             |
 | AT4G01390 |      0.0048  | AT4G01390 | TRAF-like family protein                                                                  |
 | AT3G15740 |      0.0048  | AT3G15740 | RING/U-box superfamily protein                                                            |
 | AT2G39980 |      0.0048  | AT2G39980 | At2g39980/T28M21.14                                                                       |
 | AT2G38580 |      0.00475 | AT2G38580 | Mitochondrial ATP synthase D chain-related protein                                        |
 | AT2G02990 |      0.00475 | RNS1      | Ribonuclease 1                                                                            |
 | AT5G10520 |      0.00475 | RBK1      | RBK1                                                                                      |
 | AT3G48450 |      0.00475 | AT3G48450 | At3g48450                                                                                 |
 | AT5G10650 |      0.0047  | AT5G10650 | At5g10650                                                                                 |
 | AT1G55420 |      0.0047  | EDA11     | Cysteine/Histidine-rich C1 domain family protein                                          |
 | AT1G36640 |      0.0047  | AT1G36640 | Transmembrane protein                                                                     |
 | AT2G28630 |      0.0047  | KCS12     | 3-ketoacyl-CoA synthase 12                                                                |
 | AT1G78460 |      0.00465 | AT1G78460 | AT1G78460 protein                                                                         |
 | AT1G72910 |      0.00465 | AT1G72910 | Similar to part of disease resistance protein                                             |
 | AT1G70175 |      0.00465 | AT1G70175 | None                                                                                      |
 | AT5G43160 |      0.00465 | QWRF9     | Family of unknown function (DUF566)                                                       |
 | AT2G47800 |      0.00465 | ABCC4     | ABC transporter C family member 4                                                         |
 | AT1G51850 |      0.00465 | AT1G51850 | Leucine-rich repeat protein kinase family protein                                         |
 | AT5G59070 |      0.00465 | AT5G59070 | UDP-Glycosyltransferase superfamily protein                                               |
 | AT1G50750 |      0.00465 | AT1G50750 | Plant mobile domain protein family                                                        |
 | AT5G58620 |      0.00465 | AT5G58620 | Zinc finger CCCH domain-containing protein 66                                             |
 | AT5G43180 |      0.00465 | AT5G43180 | At5g43180                                                                                 |
 | AT1G75240 |      0.00465 | ZHD5      | ZHD5                                                                                      |
 | AT1G77640 |      0.0046  | ERF013    | Ethylene-responsive transcription factor ERF013                                           |
 | AT4G33220 |      0.0046  | PME44     | Probable pectinesterase/pectinesterase inhibitor 44                                       |
 | AT1G61610 |      0.0046  | AT1G61610 | Serine/threonine-protein kinase                                                           |
 | AT4G22080 |      0.0046  | RHS14     | Probable pectate lyase 16                                                                 |
 | AT4G13820 |      0.0046  | AT4G13820 | Disease resistance like protein                                                           |
 | AT5G46500 |      0.0046  | AT5G46500 | Protein VARIATION IN COMPOUND TRIGGERED ROOT growth protein                               |
 | AT2G21210 |      0.00455 | AT2G21210 | SAUR-like auxin-responsive protein family                                                 |
 | AT1G56430 |      0.00455 | NAS4      | Probable nicotianamine synthase 4                                                         |
 | AT2G35980 |      0.00455 | NHL10     | NDR1/HIN1-like protein 10                                                                 |
 | AT3G60415 |      0.00455 | AT3G60415 | At3g60420                                                                                 |
 | AT1G17345 |      0.00455 | SAUR77    | Auxin-responsive protein SAUR77                                                           |
 | AT1G19330 |      0.0045  | AT1G19330 | unknown protein                                                                           |
 | AT1G70190 |      0.0045  | AT1G70190 | F20P5.9 protein                                                                           |
 | AT1G17610 |      0.0045  | CHS1      | Disease resistance protein CHS1                                                           |
 | AT5G57560 |      0.0045  | XTH22     | Xyloglucan endotransglucosylase/hydrolase                                                 |
 | AT1G73805 |      0.0045  | SARD1     | Protein SAR DEFICIENT 1                                                                   |
 | AT4G26560 |      0.0045  | CBL7      | Calcineurin B-like protein 7                                                              |
 | AT1G62500 |      0.0045  | AT1G62500 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | AT1G33760 |      0.0045  | ERF022    | Ethylene-responsive transcription factor ERF022                                           |
 | AT4G23030 |      0.00445 | DTX49     | Protein DETOXIFICATION 49                                                                 |
 | AT4G19230 |      0.00445 | CYP707A1  | Cytochrome P450, family 707, subfamily A, polypeptide 1                                   |
 | AT2G26560 |      0.00445 | PLP2      | Patatin-like protein 2                                                                    |
 | AT5G27490 |      0.00445 | AT5G27490 | Protein YIPF                                                                              |
 | AT4G01870 |      0.00445 | AT4G01870 | tolB protein-related                                                                      |
 | AT2G19190 |      0.00445 | SIRK      | Senescence-induced receptor-like serine/threonine-protein kinase                          |
 | AT2G29720 |      0.00445 | CTF2B     | FAD/NAD(P)-binding oxidoreductase family protein                                          |
 | AT5G40400 |      0.00445 | AT5G40400 | Pentatricopeptide repeat (PPR) superfamily protein                                        |
 | AT4G35180 |      0.00445 | LHT7      | Lysine histidine transporter-like 7                                                       |
 | AT4G35110 |      0.00445 | AT4G35110 | Phospholipase-like protein (PEARLI 4) family protein                                      |
 | AT4G04540 |      0.00445 | CRK39     | Putative cysteine-rich receptor-like protein kinase 39                                    |
 | AT2G20142 |      0.0044  | AT2G20142 | Toll-Interleukin-Resistance (TIR) domain family protein                                   |
 | AT3G28740 |      0.0044  | CYP81D11  | Cytochrome P450 81D11                                                                     |
 | AT1G44446 |      0.0044  | CAO       | CH1                                                                                       |
 | AT5G48657 |      0.0044  | AT5G48657 | defense protein-related                                                                   |
 | AT4G11890 |      0.0044  | AT4G11890 | Protein kinase superfamily protein                                                        |
 | AT2G07698 |      0.0044  | AT2G07698 | ATPase, F1 complex, alpha subunit protein                                                 |
 | AT4G01970 |      0.0044  | AtSTS     | stachyose synthase                                                                        |
 | AT5G57540 |      0.00435 | XTH13     | Putative xyloglucan endotransglucosylase/hydrolase protein 13                             |
 | AT2G15220 |      0.00435 | AT2G15220 | At2g15220/F15A23.4                                                                        |
 | AT2G23120 |      0.00435 | AT2G23120 | Expressed protein                                                                         |
 | AT3G55090 |      0.00435 | ABCG16    | ABC transporter G family member 16                                                        |
 | AT3G62680 |      0.00435 | PRP3      | Proline-rich protein 3                                                                    |
 | AT1G14170 |      0.00435 | AT1G14170 | F7A19.25 protein                                                                          |
 | AT1G72900 |      0.00435 | AT1G72900 | Similar to part of disease resistance protein                                             |
 | AT5G27830 |      0.0043  | AT5G27830 | FUNCTIONS IN: molecular_function unknown                                                  |
 | AT1G68570 |      0.0043  | NPF3.1    | Protein NRT1/ PTR FAMILY 3.1                                                              |
 | AT4G22485 |      0.0043  | AT4G22485 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | AT5G42380 |      0.0043  | CML37     | Calcium-binding protein CML37                                                             |
 | AT3G55980 |      0.0043  | SZF1      | Salt-inducible zinc finger 1                                                              |
 | AT4G11660 |      0.0043  | HSFB2B    | Heat stress transcription factor B-2b                                                     |
 | AT4G03600 |      0.0043  | AT4G03600 | Pyrroline-5-carboxylate reductase                                                         |
 | AT5G45340 |      0.0043  | CYP707A3  | Abscisic acid 8'-hydroxylase 3                                                            |
 | AT4G28490 |      0.0043  | RLK5      | Receptor-like protein kinase 5                                                            |
 | AT4G17500 |      0.0043  | ERF1A     | Ethylene-responsive transcription factor 1A                                               |
 | AT4G14450 |      0.0043  | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                          |
 | AT1G15100 |      0.0043  | RHA2A     | E3 ubiquitin-protein ligase RHA2A                                                         |
 | AT3G23120 |      0.0043  | AtRLP38   | Receptor-like protein 38                                                                  |
 | AT5G61570 |      0.00425 | AT5G61570 | Protein kinase superfamily protein                                                        |
 | AT4G04700 |      0.00425 | CPK27     | Calcium-dependent protein kinase 27                                                       |
 | AT1G15010 |      0.00425 | AT1G15010 | Mediator of RNA polymerase II transcription subunit                                       |
 | AT5G40000 |      0.00425 | AT5G40000 | AAA-ATPase At5g40000                                                                      |
 | AT3G13650 |      0.00425 | DIR7      | Dirigent protein 7                                                                        |
 | AT5G51670 |      0.00425 | AT5G51670 | Similarity to unknown protein                                                             |
 | AT2G38530 |      0.00425 | LTP2      | Non-specific lipid-transfer protein                                                       |
 | AT1G26761 |      0.00425 | AT1G26761 | Arabinanase/levansucrase/invertase                                                        |
 | AT4G11000 |      0.0042  | AT4G11000 | Ankyrin repeat family protein                                                             |
 | AT1G20870 |      0.0042  | IDM3      | Increased DNA methylation 3                                                               |
 | AT4G24110 |      0.0042  | AT4G24110 | NADP-specific glutamate dehydrogenase                                                     |
 | AT3G43580 |      0.0042  | AT3G43580 | At3g43580                                                                                 |
 | AT5G21900 |      0.0042  | AT5G21900 | At5g21900                                                                                 |
 | AT5G50790 |      0.0042  | SWEET10   | Bidirectional sugar transporter SWEET10                                                   |
 | AT4G24810 |      0.0042  | AT4G24810 | Protein kinase superfamily protein                                                        |
 | AT5G48880 |      0.0042  | KAT5      | PKT2                                                                                      |
 | AT1G22890 |      0.0042  | AT1G22890 | AT1G22890 protein                                                                         |
 | AT1G29460 |      0.00415 | AT1G29460 | SAUR-like auxin-responsive protein family                                                 |
 | AT1G07530 |      0.00415 | SCL14     | AT1G07530 protein                                                                         |
 | AT2G41231 |      0.00415 | AT2G41231 | unknown protein.                                                                          |
 | AT2G38210 |      0.00415 | PDX1L4    | Pyridoxal 5'-phosphate synthase PDX1-like 4                                               |
 | AT4G08950 |      0.00415 | EXO       | Protein EXORDIUM                                                                          |
 | AT1G25560 |      0.00415 | TEM1      | AP2/ERF and B3 domain-containing transcription repressor TEM1                             |
 | AT1G72645 |      0.0041  | AT1G72645 | At1g72645                                                                                 |
 | AT2G46600 |      0.0041  | KIC       | Calcium-binding protein KIC                                                               |
 | AT5G03830 |      0.0041  | AT5G03830 | CDK inhibitor P21 binding protein                                                         |
 | AT2G46440 |      0.0041  | CNGC11    | Cyclic nucleotide-gated ion channel 11                                                    |
 | AT5G16170 |      0.0041  | AT5G16170 | At5g16170                                                                                 |
 | AT4G21903 |      0.0041  | AT4G21903 | Protein DETOXIFICATION                                                                    |
 | AT5G57345 |      0.0041  | AT5G57345 | At5g57345                                                                                 |
 | AT1G62610 |      0.0041  | AT1G62610 | NAD(P)-binding Rossmann-fold superfamily protein                                          |
 | AT4G14860 |      0.0041  | OFP11     | Transcription repressor OFP11                                                             |
 | AT1G35710 |      0.0041  | AT1G35710 | Probable leucine-rich repeat receptor-like protein kinase At1g35710                       |
 | AT5G65860 |      0.00405 | AT5G65860 | Ankyrin repeat family protein                                                             |
 | AT5G43790 |      0.00405 | PCMP-E30  | Pentatricopeptide repeat-containing protein At5g43790                                     |
 | AT4G23670 |      0.00405 | AT4G23670 | AT4G23670 protein                                                                         |
 | ATCG00760 |      0.00405 | RPL36     | 50S ribosomal protein L36, chloroplastic                                                  |
 | AT5G28630 |      0.00405 | AT5G28630 | Glycine-rich protein                                                                      |
 | AT3G18950 |      0.00405 | AT3G18950 | En/Spm-like transposon protein-like                                                       |
 | AT3G08870 |      0.00405 | AT3G08870 | Concanavalin A-like lectin protein kinase family protein                                  |
 | AT5G45240 |      0.00405 | AT5G45240 | Disease resistance protein (TIR-NBS-LRR class)                                            |
 | AT2G02880 |      0.00405 | AT2G02880 | Mucin-like protein                                                                        |
 | AT5G25250 |      0.004   | FLOT1     | Flotillin-like protein 1                                                                  |
 | AT1G67856 |      0.004   | AT1G67856 | RING/U-box superfamily protein                                                            |
 | AT3G29170 |      0.004   | AT3G29170 | At3g29170                                                                                 |
 | AT5G26340 |      0.00395 | STP13     | STP13                                                                                     |
 | AT4G35070 |      0.00395 | AT4G35070 | At4g35070                                                                                 |
 | AT2G36790 |      0.00395 | UGT73C6   | Glycosyltransferase (Fragment)                                                            |
 | AT2G45480 |      0.00395 | GRF9      | Growth-regulating factor 9                                                                |
 | AT5G54569 |      0.00395 | AT5G54569 | other RNA                                                                                 |
 | AT2G19210 |      0.00395 | AT2G19210 | Putative leucine-rich repeat receptor-like protein kinase At2g19210                       |
 | AT3G53150 |      0.0039  | UGT73D1   | UDP-glucosyl transferase 73D1                                                             |
 | AT2G23210 |      0.00385 | AT2G23210 | UDP-Glycosyltransferase superfamily protein                                               |
 | AT5G41740 |      0.00385 | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                                     |
 | AT3G25790 |      0.00385 | HHO1      | Transcription factor HHO1                                                                 |
 | AT3G11080 |      0.0038  | AtRLP35   | Receptor-like protein 35                                                                  |
 | AT1G14480 |      0.0038  | AT1G14480 | Ankyrin repeat family protein                                                             |
 | AT1G66500 |      0.0038  | PCFS1     | Polyadenylation and cleavage factor homolog 1                                             |
 | AT4G21380 |      0.0038  | SD18      | Receptor-like serine/threonine-protein kinase SD1-8                                       |
 | AT3G46930 |      0.0038  | AT3G46930 | Protein kinase superfamily protein                                                        |
 | AT3G46090 |      0.0038  | ZAT7      | ZAT7                                                                                      |
 | AT1G05675 |      0.00375 | UGT74E1   | Glycosyltransferase (Fragment)                                                            |
 | AT3G02130 |      0.00375 | RPK2      | LRR receptor-like serine/threonine-protein kinase RPK2                                    |
 | AT1G08630 |      0.0037  | THA1      | Probable low-specificity L-threonine aldolase 1                                           |
 | AT3G63255 |      0.00365 | AT3G63255 | None                                                                                      |
 | AT1G02310 |      0.00365 | MAN1      | MAN1                                                                                      |
 | AT1G07135 |      0.0036  | AT1G07135 | At1g07135                                                                                 |
 | AT2G35640 |      0.00355 | AT2G35640 | Homeodomain-like superfamily protein                                                      |
 | AT3G01840 |      0.00355 | LYK2      | Protein LYK2                                                                              |
 | AT5G11680 |      0.0035  | AT5G11680 | Classical AGP protein                                                                     |
 | AT5G65207 |      0.0035  | AT5G65207 | Uncharacterized protein At5g65207                                                         |
 | AT5G65410 |      0.0035  | ZHD1      | Zinc-finger homeodomain protein 1                                                         |
 | AT5G46570 |      0.00345 | BSK2      | Serine/threonine-protein kinase BSK2                                                      |
 | AT5G40170 |      0.0034  | AtRLP54   | Receptor-like protein 54                                                                  |
 | AT5G52670 |      0.00325 | AT5G52670 | Copper transport protein family                                                           |
 | AT3G19850 |      0.00305 | AT3G19850 | BTB/POZ domain-containing protein At3g19850                                               |
 | AT1G59860 |      0.00295 | HSP17.6A  | 17.6 kDa class I heat shock protein 1                                                     |
 | AT4G22495 |      0.0028  | AT4G22495 | None                                                                                      |
 | AT4G17490 |      0.0027  | ERF6      | Ethylene-responsive transcription factor 6                                                |
 | AT2G46750 |      0.00265 | GULLO2    | L-gulonolactone oxidase 2                                                                 |
 | AT1G76680 |      0.00265 | OPR1      | 12-oxophytodienoate reductase 1                                                           |
 | AT3G51570 |      0.00265 | AT3G51570 | Disease resistance protein (TIR-NBS-LRR class) family                                     |
 | AT5G16800 |      0.0026  | AT5G16800 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                                     |
 | AT2G22790 |      0.0026  | AT2G22790 | Uncharacterized protein At2g22790                                                         |
 | AT5G60800 |      0.00255 | AT5G60800 | Heavy metal transport/detoxification superfamily protein                                  |
 | AT3G54890 |      0.0024  | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                            |
 | AT3G04210 |      0.0024  | AT3G04210 | At3g04210/T6K12_17                                                                        |
 | AT3G16400 |      0.0024  | NSP1      | Nitrile-specifier protein 1                                                               |
 | AT1G61860 |      0.00235 | AT1G61860 | Protein kinase superfamily protein                                                        |
 | AT2G24850 |      0.00235 | TAT3      | Probable aminotransferase TAT3                                                            |
 | AT3G21230 |      0.00225 | 4CL4      | 4-coumarate--CoA ligase 4                                                                 |
 | AT5G42800 |      0.0022  | DFRA      | Dihydroflavonol reductase                                                                 |
 | AT1G54970 |      0.0022  | PRP1      | Proline-rich protein 1                                                                    |
 | AT3G10710 |      0.0022  | PME24     | Putative pectinesterase/pectinesterase inhibitor 24                                       |
 | AT1G14870 |      0.0022  | PCR2      | PCR2                                                                                      |
 | AT1G24147 |      0.00215 | AT1G24147 | Transmembrane protein                                                                     |
 | AT4G22475 |      0.00215 | AT4G22475 | Transmembrane protein                                                                     |
 | AT5G51465 |      0.0021  | AT5G51465 | None                                                                                      |
 | AT4G27980 |      0.0021  | AT4G27980 | Domain of unknown function (DUF3444)                                                      |
 | AT4G23210 |      0.0021  | CRK13     | Cysteine-rich receptor-like protein kinase 13                                             |
 | AT2G22860 |      0.0021  | PSK2      | Phytosulfokines 2                                                                         |
 | AT1G67855 |      0.00205 | AT1G67855 | unknown protein                                                                           |
 | AT4G31875 |      0.00205 | AT4G31875 | At4g31872/At4g31872                                                                       |
 | AT1G63350 |      0.00205 | AT1G63350 | Disease resistance protein (CC-NBS-LRR class) family                                      |
 | AT1G51860 |      0.00205 | AT1G51860 | Probable LRR receptor-like serine/threonine-protein kinase At1g51860                      |
 | AT2G42840 |      0.00205 | PDF1      | Protodermal factor 1                                                                      |
 | AT1G74930 |      0.002   | ERF018    | Ethylene-responsive transcription factor ERF018                                           |
 | AT5G06730 |      0.002   | PER54     | Peroxidase 54                                                                             |
 | AT2G32660 |      0.002   | AtRLP22   | Receptor like protein 22                                                                  |
 | AT2G25460 |      0.002   | AT2G25460 | CONTAINS InterPro DOMAIN/s: C2 calcium-dependent membrane targeting (InterPro:IPR000008)  |
 | AT1G21100 |      0.002   | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                |
 | AT4G35770 |      0.002   | STR15     | SEN1                                                                                      |
 | AT5G20670 |      0.002   | AT5G20670 | At5g20670                                                                                 |
 | AT1G72240 |      0.00195 | AT1G72240 | Uncharacterized protein T9N14.5                                                           |
 | AT1G66090 |      0.00195 | AT1G66090 | Disease resistance protein (TIR-NBS class)                                                |
 | AT1G51270 |      0.00195 | AT1G51270 | Vesicle-associated protein 1-4                                                            |
 | AT5G65500 |      0.0019  | AT5G65500 | U-box domain-containing protein kinase family protein                                     |
 | AT1G23550 |      0.00185 | SRO2      | Probable inactive poly                                                                    |
 | AT4G22490 |      0.00185 | AT4G22490 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | AT3G44860 |      0.00185 | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                               |
 | AT4G23680 |      0.00185 | AT4G23680 | AT4g23680/F9D16_150                                                                       |
 | AT1G69790 |      0.00185 | PBL18     | Probable serine/threonine-protein kinase PBL18                                            |
 | AT3G46280 |      0.00185 | AT3G46280 | Kinase-like protein                                                                       |
 | AT5G49360 |      0.0018  | BXL1      | Beta-D-xylosidase 1                                                                       |
 | AT5G56870 |      0.0018  | BGAL4     | Beta-galactosidase 4                                                                      |
 | AT1G31050 |      0.00175 | AT1G31050 | basic helix-loop-helix (bHLH) DNA-binding superfamily protein                             |
 | AT1G29500 |      0.00175 | SAUR66    | Auxin-responsive protein SAUR66                                                           |
 | AT1G51660 |      0.00175 | MKK4      | MKK4                                                                                      |
 | AT3G56260 |      0.0017  | AT3G56260 | At3g56260                                                                                 |
 | AT1G55020 |      0.0017  | LOX1      | Linoleate 9S-lipoxygenase 1                                                               |
 | AT1G71030 |      0.0017  | ATMYBL2   | At1g71030/F23N20_2                                                                        |
 | AT1G51890 |      0.00165 | AT1G51890 | Leucine-rich repeat protein kinase family protein                                         |
 | AT3G21780 |      0.0016  | UGT71B6   | UDP-glycosyltransferase 71B6                                                              |
 | AT1G13520 |      0.0016  | AT1G13520 | At1g13520                                                                                 |
 | AT3G22600 |      0.00155 | AT3G22600 | AT3g22600/F16J14_17                                                                       |
 | AT3G52060 |      0.00155 | AT3G52060 | GnTL                                                                                      |
 | AT1G22500 |      0.0015  | ATL15     | E3 ubiquitin-protein ligase ATL15                                                         |
 | AT4G30570 |      0.0015  | AT4G30570 | Probable mannose-1-phosphate guanylyltransferase 3                                        |
 | AT3G61280 |      0.0015  | AT3G61280 | Glycosyltransferase                                                                       |
 | AT5G05300 |      0.0015  | AT5G05300 | Gb                                                                                        |
 | AT3G47090 |      0.0015  | AT3G47090 | Leucine-rich repeat protein kinase family protein                                         |
 | AT4G05910 |      0.0015  | AT4G05910 | None                                                                                      |
 | AT1G13530 |      0.00145 | AT1G13530 | Protein of unknown function (DUF1262)                                                     |
 | AT4G39830 |      0.0014  | AT4G39830 | At4g39830                                                                                 |
 | AT4G22510 |      0.0014  | AT4G22510 | unknown protein                                                                           |
 | AT2G25125 |      0.00135 | AT2G25125 | None                                                                                      |
 | AT3G29400 |      0.00105 | ATEXO70E1 | Exocyst subunit Exo70 family protein                                                      |
 | AT4G33720 |      0.0008  | AT4G33720 | AT4g33720/T16L1_210                                                                       |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [211]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/d83306a5d5f7287e154cb2ed367acb3220decf8c.png]]
 :END:



* Selecting genes for all genotypes at all times C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.01]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if (('col' in c or 'lym' in c or 'cer' in c))]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [212]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [213]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [3745  593 1706 ... 2775 2030 2356]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [214]:
 # text/org
 |    | incoming   | name      | description                                   |
 |----+------------+-----------+-----------------------------------------------|
 |  0 | AT3G09440  | HSP70-3   | Heat shock protein 70 (Hsp 70) family protein |
 |  1 | AT5G49360  | BXL1      | Beta-D-xylosidase 1                           |
 |  2 | AT1G62740  | HOP2      | Hsp70-Hsp90 organizing protein 2              |
 |  3 | AT5G21940  | AT5G21940 | At5g21940                                     |
 |  4 | AT5G20620  | UBQ4      | Polyubiquitin 4                               |
 |  5 | AT4G24110  | AT4G24110 | NADP-specific glutamate dehydrogenase         |
 |  6 | AT3G44860  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase   |
 |  7 | AT1G62730  | AT1G62730 | At1g62730                                     |
 |  8 | AT1G02930  | GSTF6     | Glutathione S-transferase F6                  |
 |  9 | AT3G50770  | CML41     | Probable calcium-binding protein CML41        |
 | 10 | AT4G08950  | EXO       | Protein EXORDIUM                              |
 | 11 | AT4G35180  | LHT7      | Lysine histidine transporter-like 7           |
 | 12 | AT2G17120  | LYM2      | LysM domain-containing GPI-anchored protein 2 |
 | 13 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                |
 | 14 | AT3G47420  | ATPS3     | Putative glycerol-3-phosphate transporter 1   |
 | 15 | AT1G26240  | AT1G26240 | Proline-rich extensin-like family protein     |
 | 16 | AT4G24570  | PUMP4     | DIC2                                          |
 | 17 | AT1G24280  | G6PD3     | Glucose-6-phosphate 1-dehydrogenase           |
 | 18 | AT4G29780  | AT4G29780 | Nuclease                                      |
 | 19 | AT1G56660  | AT1G56660 | F25P12.91 protein                             |
 | 20 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                         |
 | 21 | AT5G63160  | BT1       | BTB/POZ and TAZ domain-containing protein 1   |
 | 22 | AT5G24110  | WRKY30    | Probable WRKY transcription factor 30         |
 | 23 | AT4G23680  | AT4G23680 | AT4g23680/F9D16_150                           |
 | 24 | AT3G06355  | AT3G06355 | None                                          |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('col' in c or 'lym' in c or 'cer' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=200000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [215]:
 # text/org
 | gene      |   importance | name      | description                                   |
 |-----------+--------------+-----------+-----------------------------------------------|
 | AT5G20620 |    0.0597047 | UBQ4      | Polyubiquitin 4                               |
 | AT4G08950 |    0.0537518 | EXO       | Protein EXORDIUM                              |
 | AT3G06355 |    0.0523239 | AT3G06355 | None                                          |
 | AT4G24110 |    0.050203  | AT4G24110 | NADP-specific glutamate dehydrogenase         |
 | AT3G28740 |    0.0500793 | CYP81D11  | Cytochrome P450 81D11                         |
 | AT5G21940 |    0.0497868 | AT5G21940 | At5g21940                                     |
 | AT3G09440 |    0.0488543 | HSP70-3   | Heat shock protein 70 (Hsp 70) family protein |
 | AT1G02930 |    0.0474558 | GSTF6     | Glutathione S-transferase F6                  |
 | AT5G63160 |    0.0452281 | BT1       | BTB/POZ and TAZ domain-containing protein 1   |
 | AT1G24280 |    0.0446611 | G6PD3     | Glucose-6-phosphate 1-dehydrogenase           |
 | AT3G50770 |    0.0424266 | CML41     | Probable calcium-binding protein CML41        |
 | AT2G17120 |    0.0422194 | LYM2      | LysM domain-containing GPI-anchored protein 2 |
 | AT5G49360 |    0.042113  | BXL1      | Beta-D-xylosidase 1                           |
 | AT1G62740 |    0.0403225 | HOP2      | Hsp70-Hsp90 organizing protein 2              |
 | AT4G35180 |    0.039032  | LHT7      | Lysine histidine transporter-like 7           |
 | AT4G29780 |    0.0352248 | AT4G29780 | Nuclease                                      |
 | AT3G47420 |    0.0331851 | ATPS3     | Putative glycerol-3-phosphate transporter 1   |
 | AT1G62730 |    0.0326117 | AT1G62730 | At1g62730                                     |
 | AT1G26380 |    0.0320114 | FOX1      | Berberine bridge enzyme-like 3                |
 | AT4G24570 |    0.031677  | PUMP4     | DIC2                                          |
 | AT1G56660 |    0.0298262 | AT1G56660 | F25P12.91 protein                             |
 | AT1G26240 |    0.0285357 | AT1G26240 | Proline-rich extensin-like family protein     |
 | AT5G24110 |    0.0254376 | WRKY30    | Probable WRKY transcription factor 30         |
 | AT3G44860 |    0.0226285 | FAMT      | Farnesoic acid carboxyl-O-methyltransferase   |
 | AT4G23680 |    0.0206998 | AT4G23680 | AT4g23680/F9D16_150                           |
 :END:


 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance', ax=ax)
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [216]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/8aa424957eacd474a32a28b58ec1f9611cea8fbf/bfd42b0e29d645657c3f4b8fa65f1ca9a646de33.png]]
 :END:




**** C45 Decision tree

#+BEGIN_SRC ipython :session
from sklearn.tree import DecisionTreeClassifier
rfe_forest = counts.loc[genes][[c for c in counts.columns if ('col' in c or 'lym' in c or 'cer' in c)]].T
rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

feat_labels = rfe_forest.columns.values
y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
gnb = DecisionTreeClassifier()
gnb = gnb.fit(X_train, y_train)

# Export as dot file
export_graphviz(gnb, out_file='./workbooks/tree.dot',
                feature_names = get_gene_names(list(feat_labels))['description'].values,
                class_names = list(set(y)),
                rounded = True, proportion = False,
                precision = 2, filled = True)
# Convert to png using system command (requires Graphviz)
from subprocess import call
_=call(['dot', '-Tpng', './workbooks/tree.dot', '-o', './workbooks/tree.png', '-Gdpi=50'])
print('[[./tree.png]]')

#+END_SRC

#+RESULTS:
:RESULTS:
# Out [259]:
# output
[[./tree.png]]

:END:
