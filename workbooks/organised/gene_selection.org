* Selecting genes for Col0 at 05hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [123]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [124]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [1128  570 2984 ...   84  210 4723]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [125]:
 # text/org
 |    | incoming   | name      | description                                          |
 |----+------------+-----------+------------------------------------------------------|
 |  0 | AT5G60390  | A1        | Elongation factor 1-alpha 4                          |
 |  1 | AT3G59940  | SKIP20    | F-box/kelch-repeat protein SKIP20                    |
 |  2 | AT1G14540  | PER4      | Peroxidase                                           |
 |  3 | AT5G59780  | MYB59     | Transcription factor MYB59                           |
 |  4 | AT5G61590  | ERF107    | Ethylene-responsive transcription factor ERF107      |
 |  5 | AT1G68520  | COL6      | Zinc finger protein CONSTANS-LIKE 6                  |
 |  6 | AT2G37430  | ZAT11     | ZAT11                                                |
 |  7 | AT5G27420  | ATL31     | E3 ubiquitin-protein ligase ATL31                    |
 |  8 | AT5G24110  | WRKY30    | Probable WRKY transcription factor 30                |
 |  9 | AT3G02840  | AT3G02840 | ARM repeat superfamily protein                       |
 | 10 | AT1G66090  | AT1G66090 | Disease resistance protein (TIR-NBS class)           |
 | 11 | AT3G09275  | AT3G09275 | None                                                 |
 | 12 | AT4G19700  | BOI       | E3 ubiquitin-protein ligase BOI                      |
 | 13 | AT1G25440  | COL16     | Zinc finger protein CONSTANS-LIKE 16                 |
 | 14 | AT5G47230  | ERF5      | ERF5                                                 |
 | 15 | AT1G72520  | LOX4      | Lipoxygenase 4, chloroplastic                        |
 | 16 | AT1G56242  | AT1G56242 | other RNA                                            |
 | 17 | AT5G11140  | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein |
 | 18 | AT5G37260  | RVE2      | Protein REVEILLE 2                                   |
 | 19 | AT2G21210  | AT2G21210 | SAUR-like auxin-responsive protein family            |
 | 20 | AT2G18440  | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)             |
 | 21 | AT1G56240  | PP2B13    | F-box protein PP2-B13                                |
 | 22 | AT1G07160  | AT1G07160 | PP2C-type phosphatase AP2C2                          |
 | 23 | AT4G38840  | AT4G38840 | At4g38840                                            |
 | 24 | AT5G25350  | EBF2      | EIN3-binding F-box protein 2                         |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'col' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [126]:
 # text/org
 | gene      |   importance | name      | description                                          |
 |-----------+--------------+-----------+------------------------------------------------------|
 | AT2G21210 |      0.0405  | AT2G21210 | SAUR-like auxin-responsive protein family            |
 | AT1G56242 |      0.03945 | AT1G56242 | other RNA                                            |
 | AT5G47230 |      0.03905 | ERF5      | ERF5                                                 |
 | AT3G59940 |      0.0385  | SKIP20    | F-box/kelch-repeat protein SKIP20                    |
 | AT1G25440 |      0.0382  | COL16     | Zinc finger protein CONSTANS-LIKE 16                 |
 | AT5G59780 |      0.03815 | MYB59     | Transcription factor MYB59                           |
 | AT3G09275 |      0.0378  | AT3G09275 | None                                                 |
 | AT4G38840 |      0.03765 | AT4G38840 | At4g38840                                            |
 | AT4G19700 |      0.0376  | BOI       | E3 ubiquitin-protein ligase BOI                      |
 | AT5G11140 |      0.03745 | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein |
 | AT1G72520 |      0.03745 | LOX4      | Lipoxygenase 4, chloroplastic                        |
 | AT1G66090 |      0.0372  | AT1G66090 | Disease resistance protein (TIR-NBS class)           |
 | AT3G02840 |      0.037   | AT3G02840 | ARM repeat superfamily protein                       |
 | AT2G18440 |      0.03695 | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)             |
 | AT5G27420 |      0.0369  | ATL31     | E3 ubiquitin-protein ligase ATL31                    |
 | AT1G07160 |      0.0369  | AT1G07160 | PP2C-type phosphatase AP2C2                          |
 | AT5G37260 |      0.03675 | RVE2      | Protein REVEILLE 2                                   |
 | AT2G37430 |      0.0366  | ZAT11     | ZAT11                                                |
 | AT5G25350 |      0.0362  | EBF2      | EIN3-binding F-box protein 2                         |
 | AT1G68520 |      0.03585 | COL6      | Zinc finger protein CONSTANS-LIKE 6                  |
 | AT5G61590 |      0.03585 | ERF107    | Ethylene-responsive transcription factor ERF107      |
 | AT1G14540 |      0.03555 | PER4      | Peroxidase                                           |
 | AT1G56240 |      0.03485 | PP2B13    | F-box protein PP2-B13                                |
 | AT5G24110 |      0.0345  | WRKY30    | Probable WRKY transcription factor 30                |
 | AT5G60390 |      0.02005 | A1        | Elongation factor 1-alpha 4                          |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance', ax=ax)
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [127]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/632b536b1900f336a7c3395fa110131ed5a5980a.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [128]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [129]:
 # output
 Num Features: 250
 Selected Features: [False False False ...  True  True False]
 Feature Ranking: [ 903  345 2759 ...    1    1 4498]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [130]:
 # text/org
 |     | incoming   | name      | description                                                                       |
 |-----+------------+-----------+-----------------------------------------------------------------------------------|
 |   0 | AT5G59820  | ZAT12     | Zinc finger protein ZAT12                                                         |
 |   1 | AT5G44130  | FLA13     | Fasciclin-like arabinogalactan protein 13                                         |
 |   2 | AT1G79110  | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                                |
 |   3 | AT4G15975  | AT4G15975 | RING/U-box superfamily protein                                                    |
 |   4 | AT5G57760  | AT5G57760 | At5g57760                                                                         |
 |   5 | AT4G14365  | XBAT34    | Putative E3 ubiquitin-protein ligase XBAT34                                       |
 |   6 | AT1G78100  | AT1G78100 | AUF1                                                                              |
 |   7 | AT1G78080  | RAP2-4    | Ethylene-responsive transcription factor RAP2-4                                   |
 |   8 | AT3G16420  | PBP1      | PYK10-binding protein 1                                                           |
 |   9 | AT3G58120  | BZIP61    | BZIP61                                                                            |
 |  10 | AT3G22121  | AT3G22121 | other RNA                                                                         |
 |  11 | AT2G10940  | AT2G10940 | At2g10940/F15K19.1                                                                |
 |  12 | AT1G74470  | CHLP      | Geranylgeranyl diphosphate reductase, chloroplastic                               |
 |  13 | AT3G04400  | RPL23A    | 60S ribosomal protein L23                                                         |
 |  14 | AT5G25250  | FLOT1     | Flotillin-like protein 1                                                          |
 |  15 | AT5G60390  | A1        | Elongation factor 1-alpha 4                                                       |
 |  16 | AT5G01540  | LECRK62   | L-type lectin-domain containing receptor kinase VI.2                              |
 |  17 | AT5G49910  | HSP70-7   | Heat shock 70 kDa protein 7, chloroplastic                                        |
 |  18 | AT4G14450  | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                  |
 |  19 | AT5G15870  | AT5G15870 | Glycosyl hydrolase family 81 protein                                              |
 |  20 | AT5G61570  | AT5G61570 | Protein kinase superfamily protein                                                |
 |  21 | AT3G09260  | BGLU23    | PYK10                                                                             |
 |  22 | AT1G80840  | WRKY40    | Probable WRKY transcription factor 40                                             |
 |  23 | AT5G57220  | CYP81F2   | Cytochrome P450 81F2                                                              |
 |  24 | AT2G25735  | AT2G25735 | Expressed protein                                                                 |
 |  25 | AT5G51190  | ERF105    | Ethylene-responsive transcription factor ERF105                                   |
 |  26 | AT5G41750  | AT5G41750 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 |  27 | AT2G27660  | AT2G27660 | Cysteine/Histidine-rich C1 domain family protein                                  |
 |  28 | AT5G56030  | HSP81-2   | Heat shock protein 81-2                                                           |
 |  29 | AT1G72910  | AT1G72910 | Similar to part of disease resistance protein                                     |
 |  30 | AT3G59940  | SKIP20    | F-box/kelch-repeat protein SKIP20                                                 |
 |  31 | AT4G24570  | PUMP4     | DIC2                                                                              |
 |  32 | AT1G79680  | WAKL10    | Wall-associated receptor kinase-like 10                                           |
 |  33 | AT3G04840  | RPS3AA    | 40S ribosomal protein S3a-1                                                       |
 |  34 | AT4G16370  | ATOPT3    | oligopeptide transporter                                                          |
 |  35 | AT2G35935  | AT2G35935 | None                                                                              |
 |  36 | AT5G64905  | PEP3      | Elicitor peptide 3                                                                |
 |  37 | AT1G17147  | VQ1       | VQ motif-containing protein 1                                                     |
 |  38 | AT5G25340  | AT5G25340 | Ubiquitin-like superfamily protein                                                |
 |  39 | AT4G34760  | SAUR50    | Auxin-responsive protein SAUR50                                                   |
 |  40 | AT1G24140  | 3MMP      | Metalloendoproteinase 3-MMP                                                       |
 |  41 | AT1G14540  | PER4      | Peroxidase                                                                        |
 |  42 | AT3G23250  | MYB15     | Transcription factor MYB15                                                        |
 |  43 | AT2G36530  | ENO2      | LOS2                                                                              |
 |  44 | AT4G23810  | WRKY53    | Probable WRKY transcription factor 53                                             |
 |  45 | AT2G01180  | ATPAP1    | phosphatidic acid phosphatase 1                                                   |
 |  46 | AT5G59780  | MYB59     | Transcription factor MYB59                                                        |
 |  47 | AT2G45180  | AT2G45180 | At2g45180/T14P1.1                                                                 |
 |  48 | AT3G07195  | AT3G07195 | RPM1-interacting protein 4 (RIN4) family protein                                  |
 |  49 | AT1G48300  | AT1G48300 | unknown protein                                                                   |
 |  50 | AT5G28610  | AT5G28610 | LOW protein: ATP-dependent RNA helicase DRS1-like protein                         |
 |  51 | AT3G63200  | PLP9      | Probable inactive patatin-like protein 9                                          |
 |  52 | AT1G07135  | AT1G07135 | At1g07135                                                                         |
 |  53 | AT1G09780  | PGM1      | IPGAM1                                                                            |
 |  54 | AT3G25520  | ATL5      | RPL5A                                                                             |
 |  55 | AT4G38860  | AT4G38860 | At4g38860                                                                         |
 |  56 | AT1G12090  | ELP       | ELP                                                                               |
 |  57 | AT4G29780  | AT4G29780 | Nuclease                                                                          |
 |  58 | AT3G49010  | RPL13B    | 60S ribosomal protein L13-1                                                       |
 |  59 | AT4G02410  | LECRK43   | L-type lectin-domain containing receptor kinase IV.3                              |
 |  60 | AT2G36690  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein           |
 |  61 | AT4G14370  | AT4G14370 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 |  62 | AT4G38620  | MYB4      | Transcription repressor MYB4                                                      |
 |  63 | AT5G61590  | ERF107    | Ethylene-responsive transcription factor ERF107                                   |
 |  64 | AT2G41840  | RPS2C     | 40S ribosomal protein S2-3                                                        |
 |  65 | AT2G44670  | FLZ3      | FCS-Like Zinc finger 3                                                            |
 |  66 | AT1G05675  | UGT74E1   | Glycosyltransferase (Fragment)                                                    |
 |  67 | AT1G65390  | PP2A5     | Protein PHLOEM PROTEIN 2-LIKE A5                                                  |
 |  68 | AT4G34950  | AT4G34950 | Major facilitator superfamily protein                                             |
 |  69 | AT5G02500  | MED37E    | Probable mediator of RNA polymerase II transcription subunit 37e                  |
 |  70 | AT1G68520  | COL6      | Zinc finger protein CONSTANS-LIKE 6                                               |
 |  71 | AT1G56250  | VBF       | F-box protein VBF                                                                 |
 |  72 | AT4G18197  | PUP7      | Probable purine permease 7                                                        |
 |  73 | AT5G52050  | DTX50     | Protein DETOXIFICATION 50                                                         |
 |  74 | AT5G20290  | RPS8A     | 40S ribosomal protein S8                                                          |
 |  75 | AT1G27730  | ZAT10     | Zinc finger protein ZAT10                                                         |
 |  76 | AT4G13930  | SHM4      | Serine hydroxymethyltransferase 4                                                 |
 |  77 | AT3G44260  | CAF1-9    | Probable CCR4-associated factor 1 homolog 9                                       |
 |  78 | AT2G37430  | ZAT11     | ZAT11                                                                             |
 |  79 | AT5G02870  | RPL4D     | 60S ribosomal protein L4-2                                                        |
 |  80 | AT3G09630  | RPL4A     | 60S ribosomal protein L4-1                                                        |
 |  81 | AT5G03240  | UBQ3      | Ubiquitin 4                                                                       |
 |  82 | AT5G65310  | ATHB-5    | Homeobox-leucine zipper protein ATHB-5                                            |
 |  83 | AT5G27420  | ATL31     | E3 ubiquitin-protein ligase ATL31                                                 |
 |  84 | AT4G27280  | KRP1      | Calcium-binding protein KRP1                                                      |
 |  85 | AT3G29000  | CML45     | Probable calcium-binding protein CML45                                            |
 |  86 | AT5G24110  | WRKY30    | Probable WRKY transcription factor 30                                             |
 |  87 | AT5G61600  | ERF104    | Ethylene-responsive transcription factor ERF104                                   |
 |  88 | AT5G15845  | AT5G15845 | other RNA                                                                         |
 |  89 | AT4G16720  | RPL15A    | Ribosomal protein L15                                                             |
 |  90 | AT3G02840  | AT3G02840 | ARM repeat superfamily protein                                                    |
 |  91 | AT5G17920  | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1           |
 |  92 | AT3G53870  | RPS3B     | 40S ribosomal protein S3-2                                                        |
 |  93 | AT1G66090  | AT1G66090 | Disease resistance protein (TIR-NBS class)                                        |
 |  94 | AT1G67430  | RPL17B    | 60S ribosomal protein L17-2                                                       |
 |  95 | AT5G19240  | AT5G19240 | Uncharacterized GPI-anchored protein At5g19240                                    |
 |  96 | AT3G09275  | AT3G09275 | None                                                                              |
 |  97 | AT3G18710  | PUB29     | RING-type E3 ubiquitin transferase                                                |
 |  98 | AT4G37540  | LBD39     | LOB domain-containing protein 39                                                  |
 |  99 | AT2G02950  | PKS1      | Protein PHYTOCHROME KINASE SUBSTRATE 1                                            |
 | 100 | AT2G26560  | PLP2      | Patatin-like protein 2                                                            |
 | 101 | AT1G50040  | AT1G50040 | F2J10.8 protein                                                                   |
 | 102 | AT1G18540  | RPL6A     | 60S ribosomal protein L6-1                                                        |
 | 103 | AT3G05590  | RPL18B    | RPL18                                                                             |
 | 104 | AT3G62870  | RPL7AB    | 60S ribosomal protein L7a-2                                                       |
 | 105 | AT4G01250  | WRKY22    | WRKY transcription factor 22                                                      |
 | 106 | AT2G27820  | ADT3      | Arogenate dehydratase 3, chloroplastic                                            |
 | 107 | AT1G05575  | AT1G05575 | Transmembrane protein                                                             |
 | 108 | AT1G61360  | AT1G61360 | Serine/threonine-protein kinase                                                   |
 | 109 | AT5G18380  | RPS16C    | 40S ribosomal protein S16-3                                                       |
 | 110 | AT1G30370  | AT1G30370 | DLAH                                                                              |
 | 111 | AT3G09500  | RPL35A    | 60S ribosomal protein L35-1                                                       |
 | 112 | AT2G40000  | HSPRO2    | Nematode resistance protein-like HSPRO2                                           |
 | 113 | AT1G78170  | AT1G78170 | E3 ubiquitin-protein ligase                                                       |
 | 114 | AT1G59590  | ZCF37     | At1g59590                                                                         |
 | 115 | AT4G19700  | BOI       | E3 ubiquitin-protein ligase BOI                                                   |
 | 116 | AT5G05300  | AT5G05300 | Gb                                                                                |
 | 117 | AT3G53460  | CP29      | Chloroplast RNA-binding protein 29                                                |
 | 118 | AT1G18080  | RACK1A    | RACK1A_AT                                                                         |
 | 119 | AT2G22880  | AT2G22880 | At2g22880                                                                         |
 | 120 | AT5G26742  | RH3       | RH3                                                                               |
 | 121 | AT2G08475  | AT2G08475 | None                                                                              |
 | 122 | AT4G22030  | AT4G22030 | F-box family protein with a domain of unknown function (DUF295)                   |
 | 123 | AT1G25440  | COL16     | Zinc finger protein CONSTANS-LIKE 16                                              |
 | 124 | AT2G32030  | AT2G32030 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                             |
 | 125 | AT3G09200  | RPP0B     | 60S acidic ribosomal protein P0-2                                                 |
 | 126 | AT1G68550  | ERF118    | Ethylene-responsive transcription factor ERF118                                   |
 | 127 | AT4G22710  | CYP706A2  | Cytochrome P450 - like protein                                                    |
 | 128 | AT3G22120  | CWLP      | Cell wall-plasma membrane linker protein                                          |
 | 129 | AT3G21150  | BBX32     | B-box zinc finger protein 32                                                      |
 | 130 | AT5G56010  | HSP90-3   | Heat shock protein 90-3                                                           |
 | 131 | AT1G57990  | PUP18     | PUP18                                                                             |
 | 132 | AT1G80080  | TMM       | TMM                                                                               |
 | 133 | AT2G02630  | AT2G02630 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | 134 | AT4G23220  | CRK14     | Cysteine-rich receptor-like protein kinase 14                                     |
 | 135 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                                                    |
 | 136 | AT3G46130  | ATMYB48   | myb domain protein 48                                                             |
 | 137 | AT5G47230  | ERF5      | ERF5                                                                              |
 | 138 | AT1G13930  | AT1G13930 | At1g13930/F16A14.27                                                               |
 | 139 | AT1G24145  | AT1G24145 | At1g24145                                                                         |
 | 140 | AT1G50750  | AT1G50750 | Plant mobile domain protein family                                                |
 | 141 | AT5G25280  | AT5G25280 | AT5g25280/F18G18_20                                                               |
 | 142 | AT5G47850  | CCR4      | Serine/threonine-protein kinase-like protein CCR4                                 |
 | 143 | AT1G72520  | LOX4      | Lipoxygenase 4, chloroplastic                                                     |
 | 144 | AT5G41740  | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | 145 | AT5G44680  | AT5G44680 | DNA glycosylase superfamily protein                                               |
 | 146 | AT3G03125  | AT3G03125 | None                                                                              |
 | 147 | AT1G19020  | AT1G19020 | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                 |
 | 148 | AT5G52750  | HIPP13    | Heavy metal-associated isoprenylated plant protein 13                             |
 | 149 | AT5G20230  | BCB       | SAG14                                                                             |
 | 150 | AT1G56242  | AT1G56242 | other RNA                                                                         |
 | 151 | AT2G31345  | AT2G31345 | Transmembrane protein                                                             |
 | 152 | AT1G10020  | AT1G10020 | At1g10020                                                                         |
 | 153 | AT4G11470  | CRK31     | cysteine-rich RLK (RECEPTOR-like protein kinase) 31                               |
 | 154 | AT2G38310  | PYL4      | Abscisic acid receptor PYL4                                                       |
 | 155 | AT5G22250  | CAF1-11   | Probable CCR4-associated factor 1 homolog 11                                      |
 | 156 | AT5G14700  | AT5G14700 | Cinnamoyl CoA reductase-like protein                                              |
 | 157 | AT1G61340  | AT1G61340 | F-box protein At1g61340                                                           |
 | 158 | AT1G69530  | ATEXPA1   | Expansin                                                                          |
 | 159 | AT4G37370  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                            |
 | 160 | AT2G18020  | RPL8A     | EMB2296                                                                           |
 | 161 | AT2G34480  | AT2G34480 | Ribosomal protein L18ae/LX family protein                                         |
 | 162 | AT1G20310  | AT1G20310 | Syringolide-induced protein                                                       |
 | 163 | AT5G11140  | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                              |
 | 164 | AT2G18160  | BZIP2     | bZIP transcription factor 2                                                       |
 | 165 | AT1G72370  | RPSAA     | 40S ribosomal protein SA                                                          |
 | 166 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3                                          |
 | 167 | AT3G19680  | AT3G19680 | Uncharacterized protein At3g19680                                                 |
 | 168 | AT3G22970  | AT3G22970 | At3g22970                                                                         |
 | 169 | AT5G37260  | RVE2      | Protein REVEILLE 2                                                                |
 | 170 | AT5G04340  | ZAT6      | Zinc finger protein ZAT6                                                          |
 | 171 | AT5G67480  | BT4       | BTB and TAZ domain protein 4                                                      |
 | 172 | AT2G44840  | ERF13     | Ethylene-responsive transcription factor 13                                       |
 | 173 | AT4G36648  | AT4G36648 | other RNA                                                                         |
 | 174 | AT4G17390  | RPL15B    | 60S ribosomal protein L15-2                                                       |
 | 175 | AT2G21210  | AT2G21210 | SAUR-like auxin-responsive protein family                                         |
 | 176 | AT1G73540  | NUDT21    | Nudix hydrolase 21, chloroplastic                                                 |
 | 177 | AT3G01165  | AT3G01165 | None                                                                              |
 | 178 | AT3G28340  | GATL10    | Hexosyltransferase (Fragment)                                                     |
 | 179 | AT2G36090  | AT2G36090 | Probable F-box protein At2g36090                                                  |
 | 180 | AT1G61560  | MLO6      | MLO-like protein 6                                                                |
 | 181 | AT2G30520  | RPT2      | Root phototropism protein 2                                                       |
 | 182 | AT1G58420  | AT1G58420 | At1g58420                                                                         |
 | 183 | AT3G53430  | RPL12B    | 60S ribosomal Protein L12-like                                                    |
 | 184 | AT1G17420  | LOX3      | Lipoxygenase 3, chloroplastic                                                     |
 | 185 | AT1G12820  | AFB3      | Protein AUXIN SIGNALING F-BOX 3                                                   |
 | 186 | AT1G56070  | LOS1      | Elongation factor 2                                                               |
 | 187 | AT2G21660  | RBG7      | Glycine-rich RNA-binding protein 7                                                |
 | 188 | AT2G18440  | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)                                          |
 | 189 | AT5G15200  | RPS9B     | 40S ribosomal protein S9-1                                                        |
 | 190 | AT3G50930  | HSR4      | Protein HYPER-SENSITIVITY-RELATED 4                                               |
 | 191 | AT4G23180  | CRK10     | Cysteine-rich receptor-like protein kinase 10                                     |
 | 192 | AT1G19770  | PUP14     | PUP14                                                                             |
 | 193 | AT5G26920  | CBP60G    | Calmodulin-binding protein 60 G                                                   |
 | 194 | AT5G02760  | AT5G02760 | Probable protein phosphatase 2C 67                                                |
 | 195 | AT5G47210  | RGGC      | RGG repeats nuclear RNA binding protein C                                         |
 | 196 | AT2G40330  | PYL6      | Abscisic acid receptor PYL6                                                       |
 | 197 | AT1G70600  | RPL27AC   | 60S ribosomal protein L27a-3                                                      |
 | 198 | AT2G28000  | CPN60A1   | SLP                                                                               |
 | 199 | AT2G31880  | SOBIR1    | Leucine-rich repeat receptor-like serine/threonine/tyrosine-protein kinase SOBIR1 |
 | 200 | AT4G18100  | RPL32A    | 60S ribosomal protein L32-1                                                       |
 | 201 | AT4G31550  | WRKY11    | Probable WRKY transcription factor 11                                             |
 | 202 | AT2G47440  | AT2G47440 | Tetratricopeptide repeat (TPR)-like superfamily protein                           |
 | 203 | AT2G23270  | AT2G23270 | At2g23270                                                                         |
 | 204 | AT1G76600  | AT1G76600 | Poly polymerase                                                                   |
 | 205 | AT2G29110  | ATGLR2.8  | Glutamate receptor                                                                |
 | 206 | AT1G14320  | RPL10A    | 60S ribosomal protein L10-1                                                       |
 | 207 | AT1G09690  | RPL21A    | 60S ribosomal protein L21-1                                                       |
 | 208 | AT5G59732  | AT5G59732 | other RNA                                                                         |
 | 209 | AT1G56240  | PP2B13    | F-box protein PP2-B13                                                             |
 | 210 | AT5G13930  | CHS       | Chalcone synthase family protein                                                  |
 | 211 | AT4G31950  | CYP82C3   | CYP82C3                                                                           |
 | 212 | AT4G36500  | AT4G36500 | Uncharacterized protein At4g36500                                                 |
 | 213 | AT2G33580  | LYK5      | Protein LYK5                                                                      |
 | 214 | AT5G65630  | GTE7      | Transcription factor GTE7                                                         |
 | 215 | AT1G07160  | AT1G07160 | PP2C-type phosphatase AP2C2                                                       |
 | 216 | AT2G38470  | WRKY33    | WRKY33                                                                            |
 | 217 | AT4G39260  | RBG8      | GRP8                                                                              |
 | 218 | AT4G17490  | ERF6      | Ethylene-responsive transcription factor 6                                        |
 | 219 | AT2G40140  | CZF1      | Zinc finger CCCH domain-containing protein 29                                     |
 | 220 | AT5G01542  | AT5G01542 | Potential natural antisense gene, locus overlaps with AT5G01540                   |
 | 221 | AT1G43170  | ARP1      | 60S ribosomal protein L3-1                                                        |
 | 222 | AT1G15690  | AVP1      | VHP1                                                                              |
 | 223 | AT1G69890  | AT1G69890 | Actin cross-linking protein (DUF569)                                              |
 | 224 | AT4G38840  | AT4G38840 | At4g38840                                                                         |
 | 225 | AT2G17040  | anac036   | NAC domain containing protein 36                                                  |
 | 226 | AT3G10930  | AT3G10930 | Uncharacterized protein At3g10930                                                 |
 | 227 | AT5G25350  | EBF2      | EIN3-binding F-box protein 2                                                      |
 | 228 | AT3G62980  | TIR1      | TIR1                                                                              |
 | 229 | AT1G21120  | AT1G21120 | O-methyltransferase family protein                                                |
 | 230 | AT1G72600  | AT1G72600 | At1g72600                                                                         |
 | 231 | AT1G69760  | AT1G69760 | At1g69760                                                                         |
 | 232 | AT1G72610  | GLP1      | Germin-like protein subfamily 3 member 1                                          |
 | 233 | AT4G13940  | SAHH1     | Adenosylhomocysteinase 1                                                          |
 | 234 | AT3G55980  | SZF1      | Salt-inducible zinc finger 1                                                      |
 | 235 | AT5G59730  | ATEXO70H7 | Exocyst subunit Exo70 family protein                                              |
 | 236 | AT1G72430  | SAUR78    | Auxin-responsive protein SAUR78                                                   |
 | 237 | AT5G42380  | CML37     | Calcium-binding protein CML37                                                     |
 | 238 | AT1G21326  | AT1G21326 | F16F4.1 protein                                                                   |
 | 239 | AT3G60245  | RPL37AC   | 60S ribosomal protein L37a-2                                                      |
 | 240 | AT2G26530  | AR781     | AR781                                                                             |
 | 241 | AT2G24600  | AT2G24600 | Ankyrin repeat family protein                                                     |
 | 242 | AT3G23810  | SAHH2     | Adenosylhomocysteinase                                                            |
 | 243 | AT2G43340  | AT2G43340 | At2g43340                                                                         |
 | 244 | AT1G74850  | PTAC2     | PTAC2                                                                             |
 | 245 | AT2G35930  | PUB23     | E3 ubiquitin-protein ligase PUB23                                                 |
 | 246 | AT2G23130  | AGP17     | Lysine-rich arabinogalactan protein 17                                            |
 | 247 | AT4G28460  | PIP1      | PAMP-induced secreted peptide 1                                                   |
 | 248 | AT1G02780  | RPL19A    | 60S ribosomal protein L19-1                                                       |
 | 249 | AT3G52400  | SYP122    | Syntaxin-122                                                                      |
 :END:


**** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'col' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [131]:
 # text/org
 | gene      |   importance | name      | description                                                                       |
 |-----------+--------------+-----------+-----------------------------------------------------------------------------------|
 | AT2G45180 |      0.0048  | AT2G45180 | At2g45180/T14P1.1                                                                 |
 | AT2G32030 |      0.00475 | AT2G32030 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                             |
 | AT1G72430 |      0.00465 | SAUR78    | Auxin-responsive protein SAUR78                                                   |
 | AT1G56240 |      0.00465 | PP2B13    | F-box protein PP2-B13                                                             |
 | AT2G27820 |      0.00455 | ADT3      | Arogenate dehydratase 3, chloroplastic                                            |
 | AT2G40330 |      0.0045  | PYL6      | Abscisic acid receptor PYL6                                                       |
 | AT5G51190 |      0.0045  | ERF105    | Ethylene-responsive transcription factor ERF105                                   |
 | AT1G12090 |      0.00445 | ELP       | ELP                                                                               |
 | AT4G23220 |      0.00445 | CRK14     | Cysteine-rich receptor-like protein kinase 14                                     |
 | AT5G26920 |      0.00445 | CBP60G    | Calmodulin-binding protein 60 G                                                   |
 | AT1G43170 |      0.00445 | ARP1      | 60S ribosomal protein L3-1                                                        |
 | AT5G02870 |      0.0044  | RPL4D     | 60S ribosomal protein L4-2                                                        |
 | AT1G07135 |      0.00435 | AT1G07135 | At1g07135                                                                         |
 | AT3G23250 |      0.00435 | MYB15     | Transcription factor MYB15                                                        |
 | AT2G38470 |      0.00435 | WRKY33    | WRKY33                                                                            |
 | AT4G18100 |      0.00435 | RPL32A    | 60S ribosomal protein L32-1                                                       |
 | AT1G24145 |      0.00435 | AT1G24145 | At1g24145                                                                         |
 | AT3G01165 |      0.0043  | AT3G01165 | None                                                                              |
 | AT5G15870 |      0.0043  | AT5G15870 | Glycosyl hydrolase family 81 protein                                              |
 | AT1G70600 |      0.0043  | RPL27AC   | 60S ribosomal protein L27a-3                                                      |
 | AT1G27730 |      0.0043  | ZAT10     | Zinc finger protein ZAT10                                                         |
 | AT3G23810 |      0.0043  | SAHH2     | Adenosylhomocysteinase                                                            |
 | AT5G59732 |      0.0043  | AT5G59732 | other RNA                                                                         |
 | AT4G18197 |      0.00425 | PUP7      | Probable purine permease 7                                                        |
 | AT5G59780 |      0.00425 | MYB59     | Transcription factor MYB59                                                        |
 | AT5G57220 |      0.00425 | CYP81F2   | Cytochrome P450 81F2                                                              |
 | AT5G44130 |      0.00425 | FLA13     | Fasciclin-like arabinogalactan protein 13                                         |
 | AT5G03240 |      0.0042  | UBQ3      | Ubiquitin 4                                                                       |
 | AT2G44670 |      0.0042  | FLZ3      | FCS-Like Zinc finger 3                                                            |
 | AT1G09780 |      0.0042  | PGM1      | IPGAM1                                                                            |
 | AT4G13930 |      0.0042  | SHM4      | Serine hydroxymethyltransferase 4                                                 |
 | AT3G29000 |      0.0042  | CML45     | Probable calcium-binding protein CML45                                            |
 | AT1G68550 |      0.0042  | ERF118    | Ethylene-responsive transcription factor ERF118                                   |
 | AT1G72600 |      0.0042  | AT1G72600 | At1g72600                                                                         |
 | AT4G22030 |      0.0042  | AT4G22030 | F-box family protein with a domain of unknown function (DUF295)                   |
 | AT4G23180 |      0.00415 | CRK10     | Cysteine-rich receptor-like protein kinase 10                                     |
 | AT4G16720 |      0.00415 | RPL15A    | Ribosomal protein L15                                                             |
 | AT2G28000 |      0.00415 | CPN60A1   | SLP                                                                               |
 | AT1G57990 |      0.00415 | PUP18     | PUP18                                                                             |
 | AT3G09500 |      0.00415 | RPL35A    | 60S ribosomal protein L35-1                                                       |
 | AT1G10020 |      0.00415 | AT1G10020 | At1g10020                                                                         |
 | AT2G25735 |      0.00415 | AT2G25735 | Expressed protein                                                                 |
 | AT2G44840 |      0.00415 | ERF13     | Ethylene-responsive transcription factor 13                                       |
 | AT3G22121 |      0.0041  | AT3G22121 | other RNA                                                                         |
 | AT2G17040 |      0.0041  | anac036   | NAC domain containing protein 36                                                  |
 | AT5G22250 |      0.0041  | CAF1-11   | Probable CCR4-associated factor 1 homolog 11                                      |
 | AT4G36648 |      0.0041  | AT4G36648 | other RNA                                                                         |
 | AT1G56070 |      0.0041  | LOS1      | Elongation factor 2                                                               |
 | AT3G04400 |      0.00405 | RPL23A    | 60S ribosomal protein L23                                                         |
 | AT1G58420 |      0.00405 | AT1G58420 | At1g58420                                                                         |
 | AT2G02950 |      0.00405 | PKS1      | Protein PHYTOCHROME KINASE SUBSTRATE 1                                            |
 | AT5G02500 |      0.00405 | MED37E    | Probable mediator of RNA polymerase II transcription subunit 37e                  |
 | AT2G40000 |      0.00405 | HSPRO2    | Nematode resistance protein-like HSPRO2                                           |
 | AT1G72610 |      0.00405 | GLP1      | Germin-like protein subfamily 3 member 1                                          |
 | AT1G14540 |      0.00405 | PER4      | Peroxidase                                                                        |
 | AT1G72910 |      0.004   | AT1G72910 | Similar to part of disease resistance protein                                     |
 | AT2G18440 |      0.004   | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)                                          |
 | AT5G47210 |      0.004   | RGGC      | RGG repeats nuclear RNA binding protein C                                         |
 | AT2G41840 |      0.004   | RPS2C     | 40S ribosomal protein S2-3                                                        |
 | AT5G57760 |      0.004   | AT5G57760 | At5g57760                                                                         |
 | AT3G09200 |      0.004   | RPP0B     | 60S acidic ribosomal protein P0-2                                                 |
 | AT1G50040 |      0.004   | AT1G50040 | F2J10.8 protein                                                                   |
 | AT5G20290 |      0.004   | RPS8A     | 40S ribosomal protein S8                                                          |
 | AT2G38310 |      0.004   | PYL4      | Abscisic acid receptor PYL4                                                       |
 | AT4G22710 |      0.004   | CYP706A2  | Cytochrome P450 - like protein                                                    |
 | AT3G22120 |      0.004   | CWLP      | Cell wall-plasma membrane linker protein                                          |
 | AT1G69530 |      0.004   | ATEXPA1   | Expansin                                                                          |
 | AT2G18160 |      0.00395 | BZIP2     | bZIP transcription factor 2                                                       |
 | AT5G59730 |      0.00395 | ATEXO70H7 | Exocyst subunit Exo70 family protein                                              |
 | AT4G34760 |      0.00395 | SAUR50    | Auxin-responsive protein SAUR50                                                   |
 | AT2G36690 |      0.00395 | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein           |
 | AT3G07195 |      0.00395 | AT3G07195 | RPM1-interacting protein 4 (RIN4) family protein                                  |
 | AT2G10940 |      0.00395 | AT2G10940 | At2g10940/F15K19.1                                                                |
 | AT1G80840 |      0.0039  | WRKY40    | Probable WRKY transcription factor 40                                             |
 | AT4G31550 |      0.0039  | WRKY11    | Probable WRKY transcription factor 11                                             |
 | AT5G67480 |      0.0039  | BT4       | BTB and TAZ domain protein 4                                                      |
 | AT1G48300 |      0.0039  | AT1G48300 | unknown protein                                                                   |
 | AT2G37430 |      0.0039  | ZAT11     | ZAT11                                                                             |
 | AT4G14365 |      0.0039  | XBAT34    | Putative E3 ubiquitin-protein ligase XBAT34                                       |
 | AT5G24110 |      0.0039  | WRKY30    | Probable WRKY transcription factor 30                                             |
 | AT2G43340 |      0.0039  | AT2G43340 | At2g43340                                                                         |
 | AT1G72370 |      0.0039  | RPSAA     | 40S ribosomal protein SA                                                          |
 | AT4G13940 |      0.00385 | SAHH1     | Adenosylhomocysteinase 1                                                          |
 | AT2G47440 |      0.00385 | AT2G47440 | Tetratricopeptide repeat (TPR)-like superfamily protein                           |
 | AT3G18710 |      0.00385 | PUB29     | RING-type E3 ubiquitin transferase                                                |
 | AT1G73540 |      0.00385 | NUDT21    | Nudix hydrolase 21, chloroplastic                                                 |
 | AT1G80080 |      0.00385 | TMM       | TMM                                                                               |
 | AT3G59940 |      0.00385 | SKIP20    | F-box/kelch-repeat protein SKIP20                                                 |
 | AT5G14700 |      0.00385 | AT5G14700 | Cinnamoyl CoA reductase-like protein                                              |
 | AT2G31345 |      0.00385 | AT2G31345 | Transmembrane protein                                                             |
 | AT2G36090 |      0.00385 | AT2G36090 | Probable F-box protein At2g36090                                                  |
 | AT1G25440 |      0.00385 | COL16     | Zinc finger protein CONSTANS-LIKE 16                                              |
 | AT4G19700 |      0.00385 | BOI       | E3 ubiquitin-protein ligase BOI                                                   |
 | AT1G19020 |      0.00385 | AT1G19020 | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                 |
 | AT5G13930 |      0.00385 | CHS       | Chalcone synthase family protein                                                  |
 | AT5G61590 |      0.00385 | ERF107    | Ethylene-responsive transcription factor ERF107                                   |
 | AT5G19240 |      0.0038  | AT5G19240 | Uncharacterized GPI-anchored protein At5g19240                                    |
 | AT1G24140 |      0.0038  | 3MMP      | Metalloendoproteinase 3-MMP                                                       |
 | AT5G25280 |      0.0038  | AT5G25280 | AT5g25280/F18G18_20                                                               |
 | AT1G69760 |      0.0038  | AT1G69760 | At1g69760                                                                         |
 | AT5G56010 |      0.0038  | HSP90-3   | Heat shock protein 90-3                                                           |
 | AT5G20630 |      0.0038  | GER3      | Germin-like protein subfamily 3 member 3                                          |
 | AT2G33580 |      0.0038  | LYK5      | Protein LYK5                                                                      |
 | AT2G29110 |      0.0038  | ATGLR2.8  | Glutamate receptor                                                                |
 | AT2G26560 |      0.0038  | PLP2      | Patatin-like protein 2                                                            |
 | AT5G52050 |      0.0038  | DTX50     | Protein DETOXIFICATION 50                                                         |
 | AT4G27280 |      0.0038  | KRP1      | Calcium-binding protein KRP1                                                      |
 | AT1G21120 |      0.0038  | AT1G21120 | O-methyltransferase family protein                                                |
 | AT1G74470 |      0.00375 | CHLP      | Geranylgeranyl diphosphate reductase, chloroplastic                               |
 | AT1G61360 |      0.00375 | AT1G61360 | Serine/threonine-protein kinase                                                   |
 | AT5G27420 |      0.00375 | ATL31     | E3 ubiquitin-protein ligase ATL31                                                 |
 | AT3G28340 |      0.00375 | GATL10    | Hexosyltransferase (Fragment)                                                     |
 | AT1G50750 |      0.00375 | AT1G50750 | Plant mobile domain protein family                                                |
 | AT5G02760 |      0.00375 | AT5G02760 | Probable protein phosphatase 2C 67                                                |
 | AT2G36530 |      0.00375 | ENO2      | LOS2                                                                              |
 | AT3G52400 |      0.00375 | SYP122    | Syntaxin-122                                                                      |
 | AT4G14450 |      0.0037  | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                  |
 | AT5G59820 |      0.0037  | ZAT12     | Zinc finger protein ZAT12                                                         |
 | AT1G78170 |      0.0037  | AT1G78170 | E3 ubiquitin-protein ligase                                                       |
 | AT1G68520 |      0.0037  | COL6      | Zinc finger protein CONSTANS-LIKE 6                                               |
 | AT1G26380 |      0.0037  | FOX1      | Berberine bridge enzyme-like 3                                                    |
 | AT3G10930 |      0.0037  | AT3G10930 | Uncharacterized protein At3g10930                                                 |
 | AT5G18380 |      0.0037  | RPS16C    | 40S ribosomal protein S16-3                                                       |
 | AT1G76600 |      0.0037  | AT1G76600 | Poly polymerase                                                                   |
 | AT2G24600 |      0.0037  | AT2G24600 | Ankyrin repeat family protein                                                     |
 | AT3G50930 |      0.0037  | HSR4      | Protein HYPER-SENSITIVITY-RELATED 4                                               |
 | AT3G55980 |      0.0037  | SZF1      | Salt-inducible zinc finger 1                                                      |
 | AT3G53870 |      0.0037  | RPS3B     | 40S ribosomal protein S3-2                                                        |
 | AT3G19680 |      0.00365 | AT3G19680 | Uncharacterized protein At3g19680                                                 |
 | AT1G61560 |      0.00365 | MLO6      | MLO-like protein 6                                                                |
 | AT3G05590 |      0.00365 | RPL18B    | RPL18                                                                             |
 | AT4G38860 |      0.00365 | AT4G38860 | At4g38860                                                                         |
 | AT3G53430 |      0.00365 | RPL12B    | 60S ribosomal Protein L12-like                                                    |
 | AT1G05575 |      0.00365 | AT1G05575 | Transmembrane protein                                                             |
 | AT4G14370 |      0.00365 | AT4G14370 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT5G65630 |      0.00365 | GTE7      | Transcription factor GTE7                                                         |
 | AT1G13930 |      0.00365 | AT1G13930 | At1g13930/F16A14.27                                                               |
 | AT1G09690 |      0.00365 | RPL21A    | 60S ribosomal protein L21-1                                                       |
 | AT1G79110 |      0.00365 | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                                |
 | AT1G02780 |      0.0036  | RPL19A    | 60S ribosomal protein L19-1                                                       |
 | AT2G01180 |      0.0036  | ATPAP1    | phosphatidic acid phosphatase 1                                                   |
 | AT1G18540 |      0.0036  | RPL6A     | 60S ribosomal protein L6-1                                                        |
 | AT2G23130 |      0.0036  | AGP17     | Lysine-rich arabinogalactan protein 17                                            |
 | AT3G21150 |      0.0036  | BBX32     | B-box zinc finger protein 32                                                      |
 | AT1G78080 |      0.0036  | RAP2-4    | Ethylene-responsive transcription factor RAP2-4                                   |
 | AT1G19770 |      0.0036  | PUP14     | PUP14                                                                             |
 | AT1G12820 |      0.0036  | AFB3      | Protein AUXIN SIGNALING F-BOX 3                                                   |
 | AT1G59590 |      0.0036  | ZCF37     | At1g59590                                                                         |
 | AT1G78100 |      0.00355 | AT1G78100 | AUF1                                                                              |
 | AT1G74850 |      0.00355 | PTAC2     | PTAC2                                                                             |
 | AT5G15200 |      0.00355 | RPS9B     | 40S ribosomal protein S9-1                                                        |
 | AT4G23810 |      0.00355 | WRKY53    | Probable WRKY transcription factor 53                                             |
 | AT4G34950 |      0.00355 | AT4G34950 | Major facilitator superfamily protein                                             |
 | AT3G02840 |      0.00355 | AT3G02840 | ARM repeat superfamily protein                                                    |
 | AT1G17147 |      0.00355 | VQ1       | VQ motif-containing protein 1                                                     |
 | AT2G02630 |      0.00355 | AT2G02630 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | AT2G08475 |      0.00355 | AT2G08475 | None                                                                              |
 | AT1G05675 |      0.00355 | UGT74E1   | Glycosyltransferase (Fragment)                                                    |
 | AT5G64905 |      0.00355 | PEP3      | Elicitor peptide 3                                                                |
 | AT5G05300 |      0.0035  | AT5G05300 | Gb                                                                                |
 | AT1G61340 |      0.0035  | AT1G61340 | F-box protein At1g61340                                                           |
 | AT1G21326 |      0.0035  | AT1G21326 | F16F4.1 protein                                                                   |
 | AT1G07160 |      0.0035  | AT1G07160 | PP2C-type phosphatase AP2C2                                                       |
 | AT5G25350 |      0.0035  | EBF2      | EIN3-binding F-box protein 2                                                      |
 | AT5G20230 |      0.0035  | BCB       | SAG14                                                                             |
 | AT5G56030 |      0.0035  | HSP81-2   | Heat shock protein 81-2                                                           |
 | AT5G37260 |      0.0035  | RVE2      | Protein REVEILLE 2                                                                |
 | AT5G01542 |      0.0035  | AT5G01542 | Potential natural antisense gene, locus overlaps with AT5G01540                   |
 | AT4G28460 |      0.0035  | PIP1      | PAMP-induced secreted peptide 1                                                   |
 | AT4G02410 |      0.0035  | LECRK43   | L-type lectin-domain containing receptor kinase IV.3                              |
 | AT4G01250 |      0.0035  | WRKY22    | WRKY transcription factor 22                                                      |
 | AT4G15975 |      0.0035  | AT4G15975 | RING/U-box superfamily protein                                                    |
 | AT5G61570 |      0.0035  | AT5G61570 | Protein kinase superfamily protein                                                |
 | AT4G31950 |      0.0035  | CYP82C3   | CYP82C3                                                                           |
 | AT2G40140 |      0.0035  | CZF1      | Zinc finger CCCH domain-containing protein 29                                     |
 | AT4G16370 |      0.00345 | ATOPT3    | oligopeptide transporter                                                          |
 | AT5G42380 |      0.00345 | CML37     | Calcium-binding protein CML37                                                     |
 | AT5G15845 |      0.00345 | AT5G15845 | other RNA                                                                         |
 | AT5G65310 |      0.00345 | ATHB-5    | Homeobox-leucine zipper protein ATHB-5                                            |
 | AT2G31880 |      0.00345 | SOBIR1    | Leucine-rich repeat receptor-like serine/threonine/tyrosine-protein kinase SOBIR1 |
 | AT4G24570 |      0.00345 | PUMP4     | DIC2                                                                              |
 | AT1G14320 |      0.00345 | RPL10A    | 60S ribosomal protein L10-1                                                       |
 | AT1G17420 |      0.00345 | LOX3      | Lipoxygenase 3, chloroplastic                                                     |
 | AT5G04340 |      0.00345 | ZAT6      | Zinc finger protein ZAT6                                                          |
 | AT5G17920 |      0.00345 | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1           |
 | AT3G58120 |      0.0034  | BZIP61    | BZIP61                                                                            |
 | AT1G30370 |      0.0034  | AT1G30370 | DLAH                                                                              |
 | AT1G79680 |      0.0034  | WAKL10    | Wall-associated receptor kinase-like 10                                           |
 | AT1G56242 |      0.0034  | AT1G56242 | other RNA                                                                         |
 | AT4G17390 |      0.0034  | RPL15B    | 60S ribosomal protein L15-2                                                       |
 | AT5G26742 |      0.0034  | RH3       | RH3                                                                               |
 | AT5G52750 |      0.0034  | HIPP13    | Heavy metal-associated isoprenylated plant protein 13                             |
 | AT3G49010 |      0.0034  | RPL13B    | 60S ribosomal protein L13-1                                                       |
 | AT4G39260 |      0.0034  | RBG8      | GRP8                                                                              |
 | AT4G36500 |      0.0034  | AT4G36500 | Uncharacterized protein At4g36500                                                 |
 | AT5G11140 |      0.0034  | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                              |
 | AT4G17490 |      0.0034  | ERF6      | Ethylene-responsive transcription factor 6                                        |
 | AT1G56250 |      0.00335 | VBF       | F-box protein VBF                                                                 |
 | AT3G03125 |      0.00335 | AT3G03125 | None                                                                              |
 | AT3G46130 |      0.00335 | ATMYB48   | myb domain protein 48                                                             |
 | AT3G22970 |      0.00335 | AT3G22970 | At3g22970                                                                         |
 | AT1G20310 |      0.00335 | AT1G20310 | Syringolide-induced protein                                                       |
 | AT4G38840 |      0.00335 | AT4G38840 | At4g38840                                                                         |
 | AT5G25340 |      0.00335 | AT5G25340 | Ubiquitin-like superfamily protein                                                |
 | AT1G72520 |      0.00335 | LOX4      | Lipoxygenase 4, chloroplastic                                                     |
 | AT2G23270 |      0.00335 | AT2G23270 | At2g23270                                                                         |
 | AT2G22880 |      0.0033  | AT2G22880 | At2g22880                                                                         |
 | AT5G47230 |      0.0033  | ERF5      | ERF5                                                                              |
 | AT3G53460 |      0.0033  | CP29      | Chloroplast RNA-binding protein 29                                                |
 | AT5G25250 |      0.0033  | FLOT1     | Flotillin-like protein 1                                                          |
 | AT5G28610 |      0.0033  | AT5G28610 | LOW protein: ATP-dependent RNA helicase DRS1-like protein                         |
 | AT3G09630 |      0.0033  | RPL4A     | 60S ribosomal protein L4-1                                                        |
 | AT1G67430 |      0.0033  | RPL17B    | 60S ribosomal protein L17-2                                                       |
 | AT3G62980 |      0.0033  | TIR1      | TIR1                                                                              |
 | AT5G47850 |      0.00325 | CCR4      | Serine/threonine-protein kinase-like protein CCR4                                 |
 | AT1G66090 |      0.00325 | AT1G66090 | Disease resistance protein (TIR-NBS class)                                        |
 | AT4G29780 |      0.00325 | AT4G29780 | Nuclease                                                                          |
 | AT2G35935 |      0.00325 | AT2G35935 | None                                                                              |
 | AT3G09275 |      0.00325 | AT3G09275 | None                                                                              |
 | AT5G44680 |      0.00325 | AT5G44680 | DNA glycosylase superfamily protein                                               |
 | AT4G38620 |      0.00325 | MYB4      | Transcription repressor MYB4                                                      |
 | AT5G41740 |      0.0032  | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT3G25520 |      0.0032  | ATL5      | RPL5A                                                                             |
 | AT2G27660 |      0.0032  | AT2G27660 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | AT4G37370 |      0.0032  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                            |
 | AT1G69890 |      0.00315 | AT1G69890 | Actin cross-linking protein (DUF569)                                              |
 | AT1G65390 |      0.00315 | PP2A5     | Protein PHLOEM PROTEIN 2-LIKE A5                                                  |
 | AT5G61600 |      0.00315 | ERF104    | Ethylene-responsive transcription factor ERF104                                   |
 | AT5G41750 |      0.0031  | AT5G41750 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT3G63200 |      0.0031  | PLP9      | Probable inactive patatin-like protein 9                                          |
 | AT2G21210 |      0.0031  | AT2G21210 | SAUR-like auxin-responsive protein family                                         |
 | AT4G37540 |      0.00305 | LBD39     | LOB domain-containing protein 39                                                  |
 | AT5G01540 |      0.00305 | LECRK62   | L-type lectin-domain containing receptor kinase VI.2                              |
 | AT3G60245 |      0.00305 | RPL37AC   | 60S ribosomal protein L37a-2                                                      |
 | AT4G11470 |      0.003   | CRK31     | cysteine-rich RLK (RECEPTOR-like protein kinase) 31                               |
 | AT5G49910 |      0.00295 | HSP70-7   | Heat shock 70 kDa protein 7, chloroplastic                                        |
 | AT3G44260 |      0.00295 | CAF1-9    | Probable CCR4-associated factor 1 homolog 9                                       |
 | AT2G30520 |      0.00285 | RPT2      | Root phototropism protein 2                                                       |
 | AT2G26530 |      0.00265 | AR781     | AR781                                                                             |
 | AT2G35930 |      0.0026  | PUB23     | E3 ubiquitin-protein ligase PUB23                                                 |
 | AT1G15690 |      0.0026  | AVP1      | VHP1                                                                              |
 | AT3G04840 |      0.00225 | RPS3AA    | 40S ribosomal protein S3a-1                                                       |
 | AT3G62870 |      0.00215 | RPL7AB    | 60S ribosomal protein L7a-2                                                       |
 | AT5G60390 |      0.00185 | A1        | Elongation factor 1-alpha 4                                                       |
 | AT2G34480 |      0.0018  | AT2G34480 | Ribosomal protein L18ae/LX family protein                                         |
 | AT1G18080 |      0.00175 | RACK1A    | RACK1A_AT                                                                         |
 | AT2G21660 |      0.0017  | RBG7      | Glycine-rich RNA-binding protein 7                                                |
 | AT2G18020 |      0.00155 | RPL8A     | EMB2296                                                                           |
 | AT3G09260 |      0.001   | BGLU23    | PYK10                                                                             |
 | AT3G16420 |      0.0009  | PBP1      | PYK10-binding protein 1                                                           |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [132]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/0fe823d68e2a9c626a5ce7da16dc55177a13d590.png]]
 :END:

* Selecting genes for Lym2 at 05hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'lym' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [133]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [134]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [3245 1674 3616 ...   40  172 5357]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [135]:
 # text/org
 |    | incoming   | name      | description                                                             |
 |----+------------+-----------+-------------------------------------------------------------------------|
 |  0 | AT1G79110  | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                      |
 |  1 | AT5G60390  | A1        | Elongation factor 1-alpha 4                                             |
 |  2 | AT1G14540  | PER4      | Peroxidase                                                              |
 |  3 | AT5G61590  | ERF107    | Ethylene-responsive transcription factor ERF107                         |
 |  4 | AT1G68520  | COL6      | Zinc finger protein CONSTANS-LIKE 6                                     |
 |  5 | AT1G56250  | VBF       | F-box protein VBF                                                       |
 |  6 | AT2G37430  | ZAT11     | ZAT11                                                                   |
 |  7 | AT5G27420  | ATL31     | E3 ubiquitin-protein ligase ATL31                                       |
 |  8 | AT5G24110  | WRKY30    | Probable WRKY transcription factor 30                                   |
 |  9 | AT3G02840  | AT3G02840 | ARM repeat superfamily protein                                          |
 | 10 | AT5G17920  | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1 |
 | 11 | AT3G09275  | AT3G09275 | None                                                                    |
 | 12 | AT4G19700  | BOI       | E3 ubiquitin-protein ligase BOI                                         |
 | 13 | AT3G53460  | CP29      | Chloroplast RNA-binding protein 29                                      |
 | 14 | AT1G25440  | COL16     | Zinc finger protein CONSTANS-LIKE 16                                    |
 | 15 | AT5G47230  | ERF5      | ERF5                                                                    |
 | 16 | AT1G72520  | LOX4      | Lipoxygenase 4, chloroplastic                                           |
 | 17 | AT1G56242  | AT1G56242 | other RNA                                                               |
 | 18 | AT5G11140  | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                    |
 | 19 | AT5G37260  | RVE2      | Protein REVEILLE 2                                                      |
 | 20 | AT2G21660  | RBG7      | Glycine-rich RNA-binding protein 7                                      |
 | 21 | AT1G56240  | PP2B13    | F-box protein PP2-B13                                                   |
 | 22 | AT1G07160  | AT1G07160 | PP2C-type phosphatase AP2C2                                             |
 | 23 | AT5G25350  | EBF2      | EIN3-binding F-box protein 2                                            |
 | 24 | AT1G21120  | AT1G21120 | O-methyltransferase family protein                                      |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'lym' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [136]:
 # text/org
 | gene      |   importance | name      | description                                                             |
 |-----------+--------------+-----------+-------------------------------------------------------------------------|
 | AT2G21660 |      0.03965 | RBG7      | Glycine-rich RNA-binding protein 7                                      |
 | AT2G37430 |      0.039   | ZAT11     | ZAT11                                                                   |
 | AT1G14540 |      0.03815 | PER4      | Peroxidase                                                              |
 | AT1G25440 |      0.03755 | COL16     | Zinc finger protein CONSTANS-LIKE 16                                    |
 | AT1G21120 |      0.0375  | AT1G21120 | O-methyltransferase family protein                                      |
 | AT4G19700 |      0.03745 | BOI       | E3 ubiquitin-protein ligase BOI                                         |
 | AT1G07160 |      0.03725 | AT1G07160 | PP2C-type phosphatase AP2C2                                             |
 | AT3G09275 |      0.03705 | AT3G09275 | None                                                                    |
 | AT5G37260 |      0.037   | RVE2      | Protein REVEILLE 2                                                      |
 | AT5G25350 |      0.0369  | EBF2      | EIN3-binding F-box protein 2                                            |
 | AT1G56242 |      0.03675 | AT1G56242 | other RNA                                                               |
 | AT5G11140 |      0.0366  | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                    |
 | AT3G53460 |      0.03635 | CP29      | Chloroplast RNA-binding protein 29                                      |
 | AT1G56250 |      0.03625 | VBF       | F-box protein VBF                                                       |
 | AT5G17920 |      0.0362  | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1 |
 | AT1G72520 |      0.0362  | LOX4      | Lipoxygenase 4, chloroplastic                                           |
 | AT3G02840 |      0.0361  | AT3G02840 | ARM repeat superfamily protein                                          |
 | AT5G60390 |      0.03585 | A1        | Elongation factor 1-alpha 4                                             |
 | AT5G47230 |      0.0358  | ERF5      | ERF5                                                                    |
 | AT5G27420 |      0.0356  | ATL31     | E3 ubiquitin-protein ligase ATL31                                       |
 | AT5G61590 |      0.03545 | ERF107    | Ethylene-responsive transcription factor ERF107                         |
 | AT1G79110 |      0.035   | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                      |
 | AT1G68520 |      0.03495 | COL6      | Zinc finger protein CONSTANS-LIKE 6                                     |
 | AT1G56240 |      0.03425 | PP2B13    | F-box protein PP2-B13                                                   |
 | AT5G24110 |      0.0341  | WRKY30    | Probable WRKY transcription factor 30                                   |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance')
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [137]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/6c6e3438472c5becb4dd5927f01def5d25fd9d41.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [138]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [139]:
 # output
 Num Features: 250
 Selected Features: [False False False ...  True  True False]
 Feature Ranking: [ 903  345 2759 ...    1    1 4498]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [140]:
 # text/org
 |     | incoming   | name      | description                                                                       |
 |-----+------------+-----------+-----------------------------------------------------------------------------------|
 |   0 | AT5G59820  | ZAT12     | Zinc finger protein ZAT12                                                         |
 |   1 | AT5G44130  | FLA13     | Fasciclin-like arabinogalactan protein 13                                         |
 |   2 | AT1G79110  | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                                |
 |   3 | AT4G15975  | AT4G15975 | RING/U-box superfamily protein                                                    |
 |   4 | AT5G57760  | AT5G57760 | At5g57760                                                                         |
 |   5 | AT4G14365  | XBAT34    | Putative E3 ubiquitin-protein ligase XBAT34                                       |
 |   6 | AT1G78100  | AT1G78100 | AUF1                                                                              |
 |   7 | AT1G78080  | RAP2-4    | Ethylene-responsive transcription factor RAP2-4                                   |
 |   8 | AT3G16420  | PBP1      | PYK10-binding protein 1                                                           |
 |   9 | AT3G58120  | BZIP61    | BZIP61                                                                            |
 |  10 | AT3G22121  | AT3G22121 | other RNA                                                                         |
 |  11 | AT2G10940  | AT2G10940 | At2g10940/F15K19.1                                                                |
 |  12 | AT1G74470  | CHLP      | Geranylgeranyl diphosphate reductase, chloroplastic                               |
 |  13 | AT3G04400  | RPL23A    | 60S ribosomal protein L23                                                         |
 |  14 | AT5G25250  | FLOT1     | Flotillin-like protein 1                                                          |
 |  15 | AT5G60390  | A1        | Elongation factor 1-alpha 4                                                       |
 |  16 | AT5G01540  | LECRK62   | L-type lectin-domain containing receptor kinase VI.2                              |
 |  17 | AT5G49910  | HSP70-7   | Heat shock 70 kDa protein 7, chloroplastic                                        |
 |  18 | AT4G14450  | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                  |
 |  19 | AT5G15870  | AT5G15870 | Glycosyl hydrolase family 81 protein                                              |
 |  20 | AT5G61570  | AT5G61570 | Protein kinase superfamily protein                                                |
 |  21 | AT3G09260  | BGLU23    | PYK10                                                                             |
 |  22 | AT1G80840  | WRKY40    | Probable WRKY transcription factor 40                                             |
 |  23 | AT5G57220  | CYP81F2   | Cytochrome P450 81F2                                                              |
 |  24 | AT2G25735  | AT2G25735 | Expressed protein                                                                 |
 |  25 | AT5G51190  | ERF105    | Ethylene-responsive transcription factor ERF105                                   |
 |  26 | AT5G41750  | AT5G41750 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 |  27 | AT2G27660  | AT2G27660 | Cysteine/Histidine-rich C1 domain family protein                                  |
 |  28 | AT5G56030  | HSP81-2   | Heat shock protein 81-2                                                           |
 |  29 | AT1G72910  | AT1G72910 | Similar to part of disease resistance protein                                     |
 |  30 | AT3G59940  | SKIP20    | F-box/kelch-repeat protein SKIP20                                                 |
 |  31 | AT4G24570  | PUMP4     | DIC2                                                                              |
 |  32 | AT1G79680  | WAKL10    | Wall-associated receptor kinase-like 10                                           |
 |  33 | AT3G04840  | RPS3AA    | 40S ribosomal protein S3a-1                                                       |
 |  34 | AT4G16370  | ATOPT3    | oligopeptide transporter                                                          |
 |  35 | AT2G35935  | AT2G35935 | None                                                                              |
 |  36 | AT5G64905  | PEP3      | Elicitor peptide 3                                                                |
 |  37 | AT1G17147  | VQ1       | VQ motif-containing protein 1                                                     |
 |  38 | AT5G25340  | AT5G25340 | Ubiquitin-like superfamily protein                                                |
 |  39 | AT4G34760  | SAUR50    | Auxin-responsive protein SAUR50                                                   |
 |  40 | AT1G24140  | 3MMP      | Metalloendoproteinase 3-MMP                                                       |
 |  41 | AT1G14540  | PER4      | Peroxidase                                                                        |
 |  42 | AT3G23250  | MYB15     | Transcription factor MYB15                                                        |
 |  43 | AT2G36530  | ENO2      | LOS2                                                                              |
 |  44 | AT4G23810  | WRKY53    | Probable WRKY transcription factor 53                                             |
 |  45 | AT2G01180  | ATPAP1    | phosphatidic acid phosphatase 1                                                   |
 |  46 | AT5G59780  | MYB59     | Transcription factor MYB59                                                        |
 |  47 | AT2G45180  | AT2G45180 | At2g45180/T14P1.1                                                                 |
 |  48 | AT3G07195  | AT3G07195 | RPM1-interacting protein 4 (RIN4) family protein                                  |
 |  49 | AT1G48300  | AT1G48300 | unknown protein                                                                   |
 |  50 | AT5G28610  | AT5G28610 | LOW protein: ATP-dependent RNA helicase DRS1-like protein                         |
 |  51 | AT3G63200  | PLP9      | Probable inactive patatin-like protein 9                                          |
 |  52 | AT1G07135  | AT1G07135 | At1g07135                                                                         |
 |  53 | AT1G09780  | PGM1      | IPGAM1                                                                            |
 |  54 | AT3G25520  | ATL5      | RPL5A                                                                             |
 |  55 | AT4G38860  | AT4G38860 | At4g38860                                                                         |
 |  56 | AT1G12090  | ELP       | ELP                                                                               |
 |  57 | AT4G29780  | AT4G29780 | Nuclease                                                                          |
 |  58 | AT3G49010  | RPL13B    | 60S ribosomal protein L13-1                                                       |
 |  59 | AT4G02410  | LECRK43   | L-type lectin-domain containing receptor kinase IV.3                              |
 |  60 | AT2G36690  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein           |
 |  61 | AT4G14370  | AT4G14370 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 |  62 | AT4G38620  | MYB4      | Transcription repressor MYB4                                                      |
 |  63 | AT5G61590  | ERF107    | Ethylene-responsive transcription factor ERF107                                   |
 |  64 | AT2G41840  | RPS2C     | 40S ribosomal protein S2-3                                                        |
 |  65 | AT2G44670  | FLZ3      | FCS-Like Zinc finger 3                                                            |
 |  66 | AT1G05675  | UGT74E1   | Glycosyltransferase (Fragment)                                                    |
 |  67 | AT1G65390  | PP2A5     | Protein PHLOEM PROTEIN 2-LIKE A5                                                  |
 |  68 | AT4G34950  | AT4G34950 | Major facilitator superfamily protein                                             |
 |  69 | AT5G02500  | MED37E    | Probable mediator of RNA polymerase II transcription subunit 37e                  |
 |  70 | AT1G68520  | COL6      | Zinc finger protein CONSTANS-LIKE 6                                               |
 |  71 | AT1G56250  | VBF       | F-box protein VBF                                                                 |
 |  72 | AT4G18197  | PUP7      | Probable purine permease 7                                                        |
 |  73 | AT5G52050  | DTX50     | Protein DETOXIFICATION 50                                                         |
 |  74 | AT5G20290  | RPS8A     | 40S ribosomal protein S8                                                          |
 |  75 | AT1G27730  | ZAT10     | Zinc finger protein ZAT10                                                         |
 |  76 | AT4G13930  | SHM4      | Serine hydroxymethyltransferase 4                                                 |
 |  77 | AT3G44260  | CAF1-9    | Probable CCR4-associated factor 1 homolog 9                                       |
 |  78 | AT2G37430  | ZAT11     | ZAT11                                                                             |
 |  79 | AT5G02870  | RPL4D     | 60S ribosomal protein L4-2                                                        |
 |  80 | AT3G09630  | RPL4A     | 60S ribosomal protein L4-1                                                        |
 |  81 | AT5G03240  | UBQ3      | Ubiquitin 4                                                                       |
 |  82 | AT5G65310  | ATHB-5    | Homeobox-leucine zipper protein ATHB-5                                            |
 |  83 | AT5G27420  | ATL31     | E3 ubiquitin-protein ligase ATL31                                                 |
 |  84 | AT4G27280  | KRP1      | Calcium-binding protein KRP1                                                      |
 |  85 | AT3G29000  | CML45     | Probable calcium-binding protein CML45                                            |
 |  86 | AT5G24110  | WRKY30    | Probable WRKY transcription factor 30                                             |
 |  87 | AT5G61600  | ERF104    | Ethylene-responsive transcription factor ERF104                                   |
 |  88 | AT5G15845  | AT5G15845 | other RNA                                                                         |
 |  89 | AT4G16720  | RPL15A    | Ribosomal protein L15                                                             |
 |  90 | AT3G02840  | AT3G02840 | ARM repeat superfamily protein                                                    |
 |  91 | AT5G17920  | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1           |
 |  92 | AT3G53870  | RPS3B     | 40S ribosomal protein S3-2                                                        |
 |  93 | AT1G66090  | AT1G66090 | Disease resistance protein (TIR-NBS class)                                        |
 |  94 | AT1G67430  | RPL17B    | 60S ribosomal protein L17-2                                                       |
 |  95 | AT5G19240  | AT5G19240 | Uncharacterized GPI-anchored protein At5g19240                                    |
 |  96 | AT3G09275  | AT3G09275 | None                                                                              |
 |  97 | AT3G18710  | PUB29     | RING-type E3 ubiquitin transferase                                                |
 |  98 | AT4G37540  | LBD39     | LOB domain-containing protein 39                                                  |
 |  99 | AT2G02950  | PKS1      | Protein PHYTOCHROME KINASE SUBSTRATE 1                                            |
 | 100 | AT2G26560  | PLP2      | Patatin-like protein 2                                                            |
 | 101 | AT1G50040  | AT1G50040 | F2J10.8 protein                                                                   |
 | 102 | AT1G18540  | RPL6A     | 60S ribosomal protein L6-1                                                        |
 | 103 | AT3G05590  | RPL18B    | RPL18                                                                             |
 | 104 | AT3G62870  | RPL7AB    | 60S ribosomal protein L7a-2                                                       |
 | 105 | AT4G01250  | WRKY22    | WRKY transcription factor 22                                                      |
 | 106 | AT2G27820  | ADT3      | Arogenate dehydratase 3, chloroplastic                                            |
 | 107 | AT1G05575  | AT1G05575 | Transmembrane protein                                                             |
 | 108 | AT1G61360  | AT1G61360 | Serine/threonine-protein kinase                                                   |
 | 109 | AT5G18380  | RPS16C    | 40S ribosomal protein S16-3                                                       |
 | 110 | AT1G30370  | AT1G30370 | DLAH                                                                              |
 | 111 | AT3G09500  | RPL35A    | 60S ribosomal protein L35-1                                                       |
 | 112 | AT2G40000  | HSPRO2    | Nematode resistance protein-like HSPRO2                                           |
 | 113 | AT1G78170  | AT1G78170 | E3 ubiquitin-protein ligase                                                       |
 | 114 | AT1G59590  | ZCF37     | At1g59590                                                                         |
 | 115 | AT4G19700  | BOI       | E3 ubiquitin-protein ligase BOI                                                   |
 | 116 | AT5G05300  | AT5G05300 | Gb                                                                                |
 | 117 | AT3G53460  | CP29      | Chloroplast RNA-binding protein 29                                                |
 | 118 | AT1G18080  | RACK1A    | RACK1A_AT                                                                         |
 | 119 | AT2G22880  | AT2G22880 | At2g22880                                                                         |
 | 120 | AT5G26742  | RH3       | RH3                                                                               |
 | 121 | AT2G08475  | AT2G08475 | None                                                                              |
 | 122 | AT4G22030  | AT4G22030 | F-box family protein with a domain of unknown function (DUF295)                   |
 | 123 | AT1G25440  | COL16     | Zinc finger protein CONSTANS-LIKE 16                                              |
 | 124 | AT2G32030  | AT2G32030 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                             |
 | 125 | AT3G09200  | RPP0B     | 60S acidic ribosomal protein P0-2                                                 |
 | 126 | AT1G68550  | ERF118    | Ethylene-responsive transcription factor ERF118                                   |
 | 127 | AT4G22710  | CYP706A2  | Cytochrome P450 - like protein                                                    |
 | 128 | AT3G22120  | CWLP      | Cell wall-plasma membrane linker protein                                          |
 | 129 | AT3G21150  | BBX32     | B-box zinc finger protein 32                                                      |
 | 130 | AT5G56010  | HSP90-3   | Heat shock protein 90-3                                                           |
 | 131 | AT1G57990  | PUP18     | PUP18                                                                             |
 | 132 | AT1G80080  | TMM       | TMM                                                                               |
 | 133 | AT2G02630  | AT2G02630 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | 134 | AT4G23220  | CRK14     | Cysteine-rich receptor-like protein kinase 14                                     |
 | 135 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                                                    |
 | 136 | AT3G46130  | ATMYB48   | myb domain protein 48                                                             |
 | 137 | AT5G47230  | ERF5      | ERF5                                                                              |
 | 138 | AT1G13930  | AT1G13930 | At1g13930/F16A14.27                                                               |
 | 139 | AT1G24145  | AT1G24145 | At1g24145                                                                         |
 | 140 | AT1G50750  | AT1G50750 | Plant mobile domain protein family                                                |
 | 141 | AT5G25280  | AT5G25280 | AT5g25280/F18G18_20                                                               |
 | 142 | AT5G47850  | CCR4      | Serine/threonine-protein kinase-like protein CCR4                                 |
 | 143 | AT1G72520  | LOX4      | Lipoxygenase 4, chloroplastic                                                     |
 | 144 | AT5G41740  | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | 145 | AT5G44680  | AT5G44680 | DNA glycosylase superfamily protein                                               |
 | 146 | AT3G03125  | AT3G03125 | None                                                                              |
 | 147 | AT1G19020  | AT1G19020 | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                 |
 | 148 | AT5G52750  | HIPP13    | Heavy metal-associated isoprenylated plant protein 13                             |
 | 149 | AT5G20230  | BCB       | SAG14                                                                             |
 | 150 | AT1G56242  | AT1G56242 | other RNA                                                                         |
 | 151 | AT2G31345  | AT2G31345 | Transmembrane protein                                                             |
 | 152 | AT1G10020  | AT1G10020 | At1g10020                                                                         |
 | 153 | AT4G11470  | CRK31     | cysteine-rich RLK (RECEPTOR-like protein kinase) 31                               |
 | 154 | AT2G38310  | PYL4      | Abscisic acid receptor PYL4                                                       |
 | 155 | AT5G22250  | CAF1-11   | Probable CCR4-associated factor 1 homolog 11                                      |
 | 156 | AT5G14700  | AT5G14700 | Cinnamoyl CoA reductase-like protein                                              |
 | 157 | AT1G61340  | AT1G61340 | F-box protein At1g61340                                                           |
 | 158 | AT1G69530  | ATEXPA1   | Expansin                                                                          |
 | 159 | AT4G37370  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                            |
 | 160 | AT2G18020  | RPL8A     | EMB2296                                                                           |
 | 161 | AT2G34480  | AT2G34480 | Ribosomal protein L18ae/LX family protein                                         |
 | 162 | AT1G20310  | AT1G20310 | Syringolide-induced protein                                                       |
 | 163 | AT5G11140  | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                              |
 | 164 | AT2G18160  | BZIP2     | bZIP transcription factor 2                                                       |
 | 165 | AT1G72370  | RPSAA     | 40S ribosomal protein SA                                                          |
 | 166 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3                                          |
 | 167 | AT3G19680  | AT3G19680 | Uncharacterized protein At3g19680                                                 |
 | 168 | AT3G22970  | AT3G22970 | At3g22970                                                                         |
 | 169 | AT5G37260  | RVE2      | Protein REVEILLE 2                                                                |
 | 170 | AT5G04340  | ZAT6      | Zinc finger protein ZAT6                                                          |
 | 171 | AT5G67480  | BT4       | BTB and TAZ domain protein 4                                                      |
 | 172 | AT2G44840  | ERF13     | Ethylene-responsive transcription factor 13                                       |
 | 173 | AT4G36648  | AT4G36648 | other RNA                                                                         |
 | 174 | AT4G17390  | RPL15B    | 60S ribosomal protein L15-2                                                       |
 | 175 | AT2G21210  | AT2G21210 | SAUR-like auxin-responsive protein family                                         |
 | 176 | AT1G73540  | NUDT21    | Nudix hydrolase 21, chloroplastic                                                 |
 | 177 | AT3G01165  | AT3G01165 | None                                                                              |
 | 178 | AT3G28340  | GATL10    | Hexosyltransferase (Fragment)                                                     |
 | 179 | AT2G36090  | AT2G36090 | Probable F-box protein At2g36090                                                  |
 | 180 | AT1G61560  | MLO6      | MLO-like protein 6                                                                |
 | 181 | AT2G30520  | RPT2      | Root phototropism protein 2                                                       |
 | 182 | AT1G58420  | AT1G58420 | At1g58420                                                                         |
 | 183 | AT3G53430  | RPL12B    | 60S ribosomal Protein L12-like                                                    |
 | 184 | AT1G17420  | LOX3      | Lipoxygenase 3, chloroplastic                                                     |
 | 185 | AT1G12820  | AFB3      | Protein AUXIN SIGNALING F-BOX 3                                                   |
 | 186 | AT1G56070  | LOS1      | Elongation factor 2                                                               |
 | 187 | AT2G21660  | RBG7      | Glycine-rich RNA-binding protein 7                                                |
 | 188 | AT2G18440  | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)                                          |
 | 189 | AT5G15200  | RPS9B     | 40S ribosomal protein S9-1                                                        |
 | 190 | AT3G50930  | HSR4      | Protein HYPER-SENSITIVITY-RELATED 4                                               |
 | 191 | AT4G23180  | CRK10     | Cysteine-rich receptor-like protein kinase 10                                     |
 | 192 | AT1G19770  | PUP14     | PUP14                                                                             |
 | 193 | AT5G26920  | CBP60G    | Calmodulin-binding protein 60 G                                                   |
 | 194 | AT5G02760  | AT5G02760 | Probable protein phosphatase 2C 67                                                |
 | 195 | AT5G47210  | RGGC      | RGG repeats nuclear RNA binding protein C                                         |
 | 196 | AT2G40330  | PYL6      | Abscisic acid receptor PYL6                                                       |
 | 197 | AT1G70600  | RPL27AC   | 60S ribosomal protein L27a-3                                                      |
 | 198 | AT2G28000  | CPN60A1   | SLP                                                                               |
 | 199 | AT2G31880  | SOBIR1    | Leucine-rich repeat receptor-like serine/threonine/tyrosine-protein kinase SOBIR1 |
 | 200 | AT4G18100  | RPL32A    | 60S ribosomal protein L32-1                                                       |
 | 201 | AT4G31550  | WRKY11    | Probable WRKY transcription factor 11                                             |
 | 202 | AT2G47440  | AT2G47440 | Tetratricopeptide repeat (TPR)-like superfamily protein                           |
 | 203 | AT2G23270  | AT2G23270 | At2g23270                                                                         |
 | 204 | AT1G76600  | AT1G76600 | Poly polymerase                                                                   |
 | 205 | AT2G29110  | ATGLR2.8  | Glutamate receptor                                                                |
 | 206 | AT1G14320  | RPL10A    | 60S ribosomal protein L10-1                                                       |
 | 207 | AT1G09690  | RPL21A    | 60S ribosomal protein L21-1                                                       |
 | 208 | AT5G59732  | AT5G59732 | other RNA                                                                         |
 | 209 | AT1G56240  | PP2B13    | F-box protein PP2-B13                                                             |
 | 210 | AT5G13930  | CHS       | Chalcone synthase family protein                                                  |
 | 211 | AT4G31950  | CYP82C3   | CYP82C3                                                                           |
 | 212 | AT4G36500  | AT4G36500 | Uncharacterized protein At4g36500                                                 |
 | 213 | AT2G33580  | LYK5      | Protein LYK5                                                                      |
 | 214 | AT5G65630  | GTE7      | Transcription factor GTE7                                                         |
 | 215 | AT1G07160  | AT1G07160 | PP2C-type phosphatase AP2C2                                                       |
 | 216 | AT2G38470  | WRKY33    | WRKY33                                                                            |
 | 217 | AT4G39260  | RBG8      | GRP8                                                                              |
 | 218 | AT4G17490  | ERF6      | Ethylene-responsive transcription factor 6                                        |
 | 219 | AT2G40140  | CZF1      | Zinc finger CCCH domain-containing protein 29                                     |
 | 220 | AT5G01542  | AT5G01542 | Potential natural antisense gene, locus overlaps with AT5G01540                   |
 | 221 | AT1G43170  | ARP1      | 60S ribosomal protein L3-1                                                        |
 | 222 | AT1G15690  | AVP1      | VHP1                                                                              |
 | 223 | AT1G69890  | AT1G69890 | Actin cross-linking protein (DUF569)                                              |
 | 224 | AT4G38840  | AT4G38840 | At4g38840                                                                         |
 | 225 | AT2G17040  | anac036   | NAC domain containing protein 36                                                  |
 | 226 | AT3G10930  | AT3G10930 | Uncharacterized protein At3g10930                                                 |
 | 227 | AT5G25350  | EBF2      | EIN3-binding F-box protein 2                                                      |
 | 228 | AT3G62980  | TIR1      | TIR1                                                                              |
 | 229 | AT1G21120  | AT1G21120 | O-methyltransferase family protein                                                |
 | 230 | AT1G72600  | AT1G72600 | At1g72600                                                                         |
 | 231 | AT1G69760  | AT1G69760 | At1g69760                                                                         |
 | 232 | AT1G72610  | GLP1      | Germin-like protein subfamily 3 member 1                                          |
 | 233 | AT4G13940  | SAHH1     | Adenosylhomocysteinase 1                                                          |
 | 234 | AT3G55980  | SZF1      | Salt-inducible zinc finger 1                                                      |
 | 235 | AT5G59730  | ATEXO70H7 | Exocyst subunit Exo70 family protein                                              |
 | 236 | AT1G72430  | SAUR78    | Auxin-responsive protein SAUR78                                                   |
 | 237 | AT5G42380  | CML37     | Calcium-binding protein CML37                                                     |
 | 238 | AT1G21326  | AT1G21326 | F16F4.1 protein                                                                   |
 | 239 | AT3G60245  | RPL37AC   | 60S ribosomal protein L37a-2                                                      |
 | 240 | AT2G26530  | AR781     | AR781                                                                             |
 | 241 | AT2G24600  | AT2G24600 | Ankyrin repeat family protein                                                     |
 | 242 | AT3G23810  | SAHH2     | Adenosylhomocysteinase                                                            |
 | 243 | AT2G43340  | AT2G43340 | At2g43340                                                                         |
 | 244 | AT1G74850  | PTAC2     | PTAC2                                                                             |
 | 245 | AT2G35930  | PUB23     | E3 ubiquitin-protein ligase PUB23                                                 |
 | 246 | AT2G23130  | AGP17     | Lysine-rich arabinogalactan protein 17                                            |
 | 247 | AT4G28460  | PIP1      | PAMP-induced secreted peptide 1                                                   |
 | 248 | AT1G02780  | RPL19A    | 60S ribosomal protein L19-1                                                       |
 | 249 | AT3G52400  | SYP122    | Syntaxin-122                                                                      |
 :END:


**** Forest on this RFE

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'lym' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [141]:
 # text/org
 | gene      |   importance | name      | description                                                                       |
 |-----------+--------------+-----------+-----------------------------------------------------------------------------------|
 | AT2G32030 |      0.0047  | AT2G32030 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                             |
 | AT1G72430 |      0.0046  | SAUR78    | Auxin-responsive protein SAUR78                                                   |
 | AT1G56240 |      0.00455 | PP2B13    | F-box protein PP2-B13                                                             |
 | AT5G26920 |      0.00445 | CBP60G    | Calmodulin-binding protein 60 G                                                   |
 | AT2G40330 |      0.00445 | PYL6      | Abscisic acid receptor PYL6                                                       |
 | AT4G23220 |      0.0044  | CRK14     | Cysteine-rich receptor-like protein kinase 14                                     |
 | AT2G27820 |      0.0044  | ADT3      | Arogenate dehydratase 3, chloroplastic                                            |
 | AT1G27730 |      0.00435 | ZAT10     | Zinc finger protein ZAT10                                                         |
 | AT1G43170 |      0.00435 | ARP1      | 60S ribosomal protein L3-1                                                        |
 | AT2G21660 |      0.00435 | RBG7      | Glycine-rich RNA-binding protein 7                                                |
 | AT5G51190 |      0.00435 | ERF105    | Ethylene-responsive transcription factor ERF105                                   |
 | AT5G02870 |      0.0043  | RPL4D     | 60S ribosomal protein L4-2                                                        |
 | AT1G24145 |      0.0043  | AT1G24145 | At1g24145                                                                         |
 | AT2G38470 |      0.0043  | WRKY33    | WRKY33                                                                            |
 | AT5G15870 |      0.0043  | AT5G15870 | Glycosyl hydrolase family 81 protein                                              |
 | AT3G01165 |      0.0043  | AT3G01165 | None                                                                              |
 | AT5G59780 |      0.0043  | MYB59     | Transcription factor MYB59                                                        |
 | AT5G59732 |      0.00425 | AT5G59732 | other RNA                                                                         |
 | AT3G23250 |      0.00425 | MYB15     | Transcription factor MYB15                                                        |
 | AT4G18100 |      0.00425 | RPL32A    | 60S ribosomal protein L32-1                                                       |
 | AT1G07135 |      0.00425 | AT1G07135 | At1g07135                                                                         |
 | AT3G23810 |      0.00425 | SAHH2     | Adenosylhomocysteinase                                                            |
 | AT1G70600 |      0.00425 | RPL27AC   | 60S ribosomal protein L27a-3                                                      |
 | AT1G12090 |      0.00425 | ELP       | ELP                                                                               |
 | AT4G18197 |      0.00425 | PUP7      | Probable purine permease 7                                                        |
 | AT1G72600 |      0.0042  | AT1G72600 | At1g72600                                                                         |
 | AT3G04840 |      0.0042  | RPS3AA    | 40S ribosomal protein S3a-1                                                       |
 | AT5G57220 |      0.0042  | CYP81F2   | Cytochrome P450 81F2                                                              |
 | AT5G44130 |      0.0042  | FLA13     | Fasciclin-like arabinogalactan protein 13                                         |
 | AT1G09780 |      0.0042  | PGM1      | IPGAM1                                                                            |
 | AT4G13930 |      0.00415 | SHM4      | Serine hydroxymethyltransferase 4                                                 |
 | AT2G25735 |      0.00415 | AT2G25735 | Expressed protein                                                                 |
 | AT4G23180 |      0.00415 | CRK10     | Cysteine-rich receptor-like protein kinase 10                                     |
 | AT1G68550 |      0.00415 | ERF118    | Ethylene-responsive transcription factor ERF118                                   |
 | AT1G58420 |      0.0041  | AT1G58420 | At1g58420                                                                         |
 | AT3G29000 |      0.0041  | CML45     | Probable calcium-binding protein CML45                                            |
 | AT3G09500 |      0.0041  | RPL35A    | 60S ribosomal protein L35-1                                                       |
 | AT2G44840 |      0.0041  | ERF13     | Ethylene-responsive transcription factor 13                                       |
 | AT4G22030 |      0.0041  | AT4G22030 | F-box family protein with a domain of unknown function (DUF295)                   |
 | AT2G36690 |      0.00405 | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein           |
 | AT1G69530 |      0.00405 | ATEXPA1   | Expansin                                                                          |
 | AT4G36648 |      0.00405 | AT4G36648 | other RNA                                                                         |
 | AT2G28000 |      0.00405 | CPN60A1   | SLP                                                                               |
 | AT2G44670 |      0.00405 | FLZ3      | FCS-Like Zinc finger 3                                                            |
 | AT2G41840 |      0.004   | RPS2C     | 40S ribosomal protein S2-3                                                        |
 | AT2G40000 |      0.004   | HSPRO2    | Nematode resistance protein-like HSPRO2                                           |
 | AT1G57990 |      0.004   | PUP18     | PUP18                                                                             |
 | AT1G72610 |      0.004   | GLP1      | Germin-like protein subfamily 3 member 1                                          |
 | AT1G14540 |      0.004   | PER4      | Peroxidase                                                                        |
 | AT3G09200 |      0.004   | RPP0B     | 60S acidic ribosomal protein P0-2                                                 |
 | AT1G10020 |      0.004   | AT1G10020 | At1g10020                                                                         |
 | AT4G16720 |      0.004   | RPL15A    | Ribosomal protein L15                                                             |
 | AT5G02500 |      0.004   | MED37E    | Probable mediator of RNA polymerase II transcription subunit 37e                  |
 | AT3G22121 |      0.004   | AT3G22121 | other RNA                                                                         |
 | AT3G22120 |      0.004   | CWLP      | Cell wall-plasma membrane linker protein                                          |
 | AT2G02950 |      0.004   | PKS1      | Protein PHYTOCHROME KINASE SUBSTRATE 1                                            |
 | AT2G38310 |      0.004   | PYL4      | Abscisic acid receptor PYL4                                                       |
 | AT1G72910 |      0.00395 | AT1G72910 | Similar to part of disease resistance protein                                     |
 | AT2G18440 |      0.00395 | GUT15     | GUT15 (GENE WITH UNSTABLE TRANSCRIPT 15)                                          |
 | AT2G17040 |      0.00395 | anac036   | NAC domain containing protein 36                                                  |
 | AT2G10940 |      0.00395 | AT2G10940 | At2g10940/F15K19.1                                                                |
 | AT1G80080 |      0.00395 | TMM       | TMM                                                                               |
 | AT5G47210 |      0.00395 | RGGC      | RGG repeats nuclear RNA binding protein C                                         |
 | AT1G50040 |      0.00395 | AT1G50040 | F2J10.8 protein                                                                   |
 | AT3G62870 |      0.00395 | RPL7AB    | 60S ribosomal protein L7a-2                                                       |
 | AT5G59730 |      0.00395 | ATEXO70H7 | Exocyst subunit Exo70 family protein                                              |
 | AT5G22250 |      0.00395 | CAF1-11   | Probable CCR4-associated factor 1 homolog 11                                      |
 | AT5G20290 |      0.00395 | RPS8A     | 40S ribosomal protein S8                                                          |
 | AT3G04400 |      0.00395 | RPL23A    | 60S ribosomal protein L23                                                         |
 | AT1G25440 |      0.0039  | COL16     | Zinc finger protein CONSTANS-LIKE 16                                              |
 | AT1G48300 |      0.0039  | AT1G48300 | unknown protein                                                                   |
 | AT5G57760 |      0.0039  | AT5G57760 | At5g57760                                                                         |
 | AT1G80840 |      0.0039  | WRKY40    | Probable WRKY transcription factor 40                                             |
 | AT4G22710 |      0.0039  | CYP706A2  | Cytochrome P450 - like protein                                                    |
 | AT1G56070 |      0.0039  | LOS1      | Elongation factor 2                                                               |
 | AT1G72370 |      0.0039  | RPSAA     | 40S ribosomal protein SA                                                          |
 | AT4G14365 |      0.0039  | XBAT34    | Putative E3 ubiquitin-protein ligase XBAT34                                       |
 | AT4G31550 |      0.00385 | WRKY11    | Probable WRKY transcription factor 11                                             |
 | AT5G67480 |      0.00385 | BT4       | BTB and TAZ domain protein 4                                                      |
 | AT2G37430 |      0.00385 | ZAT11     | ZAT11                                                                             |
 | AT2G47440 |      0.00385 | AT2G47440 | Tetratricopeptide repeat (TPR)-like superfamily protein                           |
 | AT3G18710 |      0.00385 | PUB29     | RING-type E3 ubiquitin transferase                                                |
 | AT2G18160 |      0.00385 | BZIP2     | bZIP transcription factor 2                                                       |
 | AT3G59940 |      0.00385 | SKIP20    | F-box/kelch-repeat protein SKIP20                                                 |
 | AT5G24110 |      0.00385 | WRKY30    | Probable WRKY transcription factor 30                                             |
 | AT2G36090 |      0.00385 | AT2G36090 | Probable F-box protein At2g36090                                                  |
 | AT4G34760 |      0.00385 | SAUR50    | Auxin-responsive protein SAUR50                                                   |
 | AT5G52050 |      0.00385 | DTX50     | Protein DETOXIFICATION 50                                                         |
 | AT5G25280 |      0.0038  | AT5G25280 | AT5g25280/F18G18_20                                                               |
 | AT3G52400 |      0.0038  | SYP122    | Syntaxin-122                                                                      |
 | AT1G73540 |      0.0038  | NUDT21    | Nudix hydrolase 21, chloroplastic                                                 |
 | AT1G24140 |      0.0038  | 3MMP      | Metalloendoproteinase 3-MMP                                                       |
 | AT2G31345 |      0.0038  | AT2G31345 | Transmembrane protein                                                             |
 | AT5G61590 |      0.0038  | ERF107    | Ethylene-responsive transcription factor ERF107                                   |
 | AT5G27420 |      0.0038  | ATL31     | E3 ubiquitin-protein ligase ATL31                                                 |
 | AT5G13930 |      0.0038  | CHS       | Chalcone synthase family protein                                                  |
 | AT1G50750 |      0.00375 | AT1G50750 | Plant mobile domain protein family                                                |
 | AT3G10930 |      0.00375 | AT3G10930 | Uncharacterized protein At3g10930                                                 |
 | AT2G43340 |      0.00375 | AT2G43340 | At2g43340                                                                         |
 | AT3G07195 |      0.00375 | AT3G07195 | RPM1-interacting protein 4 (RIN4) family protein                                  |
 | AT2G36530 |      0.00375 | ENO2      | LOS2                                                                              |
 | AT1G68520 |      0.00375 | COL6      | Zinc finger protein CONSTANS-LIKE 6                                               |
 | AT2G33580 |      0.00375 | LYK5      | Protein LYK5                                                                      |
 | AT3G28340 |      0.00375 | GATL10    | Hexosyltransferase (Fragment)                                                     |
 | AT1G79110 |      0.00375 | BRG2      | Probable BOI-related E3 ubiquitin-protein ligase 2                                |
 | AT4G27280 |      0.00375 | KRP1      | Calcium-binding protein KRP1                                                      |
 | AT1G19020 |      0.00375 | AT1G19020 | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                 |
 | AT1G21120 |      0.00375 | AT1G21120 | O-methyltransferase family protein                                                |
 | AT4G13940 |      0.0037  | SAHH1     | Adenosylhomocysteinase 1                                                          |
 | AT1G61560 |      0.0037  | MLO6      | MLO-like protein 6                                                                |
 | AT5G19240 |      0.0037  | AT5G19240 | Uncharacterized GPI-anchored protein At5g19240                                    |
 | AT5G65630 |      0.0037  | GTE7      | Transcription factor GTE7                                                         |
 | AT5G59820 |      0.0037  | ZAT12     | Zinc finger protein ZAT12                                                         |
 | AT2G26560 |      0.0037  | PLP2      | Patatin-like protein 2                                                            |
 | AT4G19700 |      0.0037  | BOI       | E3 ubiquitin-protein ligase BOI                                                   |
 | AT1G61360 |      0.0037  | AT1G61360 | Serine/threonine-protein kinase                                                   |
 | AT1G69760 |      0.00365 | AT1G69760 | At1g69760                                                                         |
 | AT1G78170 |      0.00365 | AT1G78170 | E3 ubiquitin-protein ligase                                                       |
 | AT5G14700 |      0.00365 | AT5G14700 | Cinnamoyl CoA reductase-like protein                                              |
 | AT2G29110 |      0.00365 | ATGLR2.8  | Glutamate receptor                                                                |
 | AT3G21150 |      0.00365 | BBX32     | B-box zinc finger protein 32                                                      |
 | AT5G02760 |      0.00365 | AT5G02760 | Probable protein phosphatase 2C 67                                                |
 | AT4G14450 |      0.00365 | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                  |
 | AT5G18380 |      0.00365 | RPS16C    | 40S ribosomal protein S16-3                                                       |
 | AT2G24600 |      0.00365 | AT2G24600 | Ankyrin repeat family protein                                                     |
 | AT3G50930 |      0.00365 | HSR4      | Protein HYPER-SENSITIVITY-RELATED 4                                               |
 | AT3G55980 |      0.00365 | SZF1      | Salt-inducible zinc finger 1                                                      |
 | AT1G74470 |      0.00365 | CHLP      | Geranylgeranyl diphosphate reductase, chloroplastic                               |
 | AT3G53870 |      0.00365 | RPS3B     | 40S ribosomal protein S3-2                                                        |
 | AT4G14370 |      0.0036  | AT4G14370 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT1G02780 |      0.0036  | RPL19A    | 60S ribosomal protein L19-1                                                       |
 | AT1G18540 |      0.0036  | RPL6A     | 60S ribosomal protein L6-1                                                        |
 | AT5G56010 |      0.0036  | HSP90-3   | Heat shock protein 90-3                                                           |
 | AT1G26380 |      0.0036  | FOX1      | Berberine bridge enzyme-like 3                                                    |
 | AT1G76600 |      0.0036  | AT1G76600 | Poly polymerase                                                                   |
 | AT1G12820 |      0.0036  | AFB3      | Protein AUXIN SIGNALING F-BOX 3                                                   |
 | AT3G19680 |      0.00355 | AT3G19680 | Uncharacterized protein At3g19680                                                 |
 | AT2G01180 |      0.00355 | ATPAP1    | phosphatidic acid phosphatase 1                                                   |
 | AT1G05575 |      0.00355 | AT1G05575 | Transmembrane protein                                                             |
 | AT3G02840 |      0.00355 | AT3G02840 | ARM repeat superfamily protein                                                    |
 | AT3G05590 |      0.00355 | RPL18B    | RPL18                                                                             |
 | AT4G38860 |      0.00355 | AT4G38860 | At4g38860                                                                         |
 | AT3G53430 |      0.00355 | RPL12B    | 60S ribosomal Protein L12-like                                                    |
 | AT1G78100 |      0.00355 | AT1G78100 | AUF1                                                                              |
 | AT5G20630 |      0.00355 | GER3      | Germin-like protein subfamily 3 member 3                                          |
 | AT5G01542 |      0.00355 | AT5G01542 | Potential natural antisense gene, locus overlaps with AT5G01540                   |
 | AT1G78080 |      0.00355 | RAP2-4    | Ethylene-responsive transcription factor RAP2-4                                   |
 | AT1G19770 |      0.00355 | PUP14     | PUP14                                                                             |
 | AT1G13930 |      0.00355 | AT1G13930 | At1g13930/F16A14.27                                                               |
 | AT5G64905 |      0.00355 | PEP3      | Elicitor peptide 3                                                                |
 | AT1G59590 |      0.00355 | ZCF37     | At1g59590                                                                         |
 | AT5G65310 |      0.0035  | ATHB-5    | Homeobox-leucine zipper protein ATHB-5                                            |
 | AT1G07160 |      0.0035  | AT1G07160 | PP2C-type phosphatase AP2C2                                                       |
 | AT5G25350 |      0.0035  | EBF2      | EIN3-binding F-box protein 2                                                      |
 | AT2G23130 |      0.0035  | AGP17     | Lysine-rich arabinogalactan protein 17                                            |
 | AT5G56030 |      0.0035  | HSP81-2   | Heat shock protein 81-2                                                           |
 | AT1G05675 |      0.0035  | UGT74E1   | Glycosyltransferase (Fragment)                                                    |
 | AT4G01250 |      0.0035  | WRKY22    | WRKY transcription factor 22                                                      |
 | AT5G61570 |      0.0035  | AT5G61570 | Protein kinase superfamily protein                                                |
 | AT1G09690 |      0.0035  | RPL21A    | 60S ribosomal protein L21-1                                                       |
 | AT1G17147 |      0.0035  | VQ1       | VQ motif-containing protein 1                                                     |
 | AT2G02630 |      0.0035  | AT2G02630 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | AT1G74850 |      0.00345 | PTAC2     | PTAC2                                                                             |
 | AT1G61340 |      0.00345 | AT1G61340 | F-box protein At1g61340                                                           |
 | AT1G21326 |      0.00345 | AT1G21326 | F16F4.1 protein                                                                   |
 | AT5G37260 |      0.00345 | RVE2      | Protein REVEILLE 2                                                                |
 | AT5G42380 |      0.00345 | CML37     | Calcium-binding protein CML37                                                     |
 | AT4G23810 |      0.00345 | WRKY53    | Probable WRKY transcription factor 53                                             |
 | AT5G20230 |      0.00345 | BCB       | SAG14                                                                             |
 | AT2G34480 |      0.00345 | AT2G34480 | Ribosomal protein L18ae/LX family protein                                         |
 | AT4G28460 |      0.00345 | PIP1      | PAMP-induced secreted peptide 1                                                   |
 | AT1G30370 |      0.00345 | AT1G30370 | DLAH                                                                              |
 | AT4G16370 |      0.00345 | ATOPT3    | oligopeptide transporter                                                          |
 | AT4G39260 |      0.00345 | RBG8      | GRP8                                                                              |
 | AT4G31950 |      0.00345 | CYP82C3   | CYP82C3                                                                           |
 | AT2G08475 |      0.00345 | AT2G08475 | None                                                                              |
 | AT4G34950 |      0.0034  | AT4G34950 | Major facilitator superfamily protein                                             |
 | AT5G15200 |      0.0034  | RPS9B     | 40S ribosomal protein S9-1                                                        |
 | AT3G58120 |      0.0034  | BZIP61    | BZIP61                                                                            |
 | AT5G15845 |      0.0034  | AT5G15845 | other RNA                                                                         |
 | AT1G56242 |      0.0034  | AT1G56242 | other RNA                                                                         |
 | AT3G03125 |      0.0034  | AT3G03125 | None                                                                              |
 | AT2G40140 |      0.0034  | CZF1      | Zinc finger CCCH domain-containing protein 29                                     |
 | AT5G04340 |      0.0034  | ZAT6      | Zinc finger protein ZAT6                                                          |
 | AT5G11140 |      0.0034  | AT5G11140 | Phospholipase-like protein (PEARLI 4) family protein                              |
 | AT5G17920 |      0.0034  | MS1       | 5-methyltetrahydropteroyltriglutamate--homocysteine methyltransferase 1           |
 | AT5G52750 |      0.0034  | HIPP13    | Heavy metal-associated isoprenylated plant protein 13                             |
 | AT5G05300 |      0.00335 | AT5G05300 | Gb                                                                                |
 | AT3G46130 |      0.00335 | ATMYB48   | myb domain protein 48                                                             |
 | AT5G25250 |      0.00335 | FLOT1     | Flotillin-like protein 1                                                          |
 | AT1G79680 |      0.00335 | WAKL10    | Wall-associated receptor kinase-like 10                                           |
 | AT5G26742 |      0.00335 | RH3       | RH3                                                                               |
 | AT2G31880 |      0.00335 | SOBIR1    | Leucine-rich repeat receptor-like serine/threonine/tyrosine-protein kinase SOBIR1 |
 | AT4G02410 |      0.00335 | LECRK43   | L-type lectin-domain containing receptor kinase IV.3                              |
 | AT3G49010 |      0.00335 | RPL13B    | 60S ribosomal protein L13-1                                                       |
 | AT4G17490 |      0.00335 | ERF6      | Ethylene-responsive transcription factor 6                                        |
 | AT1G14320 |      0.00335 | RPL10A    | 60S ribosomal protein L10-1                                                       |
 | AT1G17420 |      0.00335 | LOX3      | Lipoxygenase 3, chloroplastic                                                     |
 | AT3G62980 |      0.00335 | TIR1      | TIR1                                                                              |
 | AT4G17390 |      0.0033  | RPL15B    | 60S ribosomal protein L15-2                                                       |
 | AT5G47230 |      0.0033  | ERF5      | ERF5                                                                              |
 | AT3G22970 |      0.0033  | AT3G22970 | At3g22970                                                                         |
 | AT1G56250 |      0.0033  | VBF       | F-box protein VBF                                                                 |
 | AT1G20310 |      0.0033  | AT1G20310 | Syringolide-induced protein                                                       |
 | AT3G09275 |      0.0033  | AT3G09275 | None                                                                              |
 | AT1G67430 |      0.0033  | RPL17B    | 60S ribosomal protein L17-2                                                       |
 | AT4G24570 |      0.0033  | PUMP4     | DIC2                                                                              |
 | AT4G15975 |      0.0033  | AT4G15975 | RING/U-box superfamily protein                                                    |
 | AT4G38840 |      0.0033  | AT4G38840 | At4g38840                                                                         |
 | AT4G36500 |      0.0033  | AT4G36500 | Uncharacterized protein At4g36500                                                 |
 | AT1G72520 |      0.0033  | LOX4      | Lipoxygenase 4, chloroplastic                                                     |
 | AT5G47850 |      0.0033  | CCR4      | Serine/threonine-protein kinase-like protein CCR4                                 |
 | AT5G28610 |      0.00325 | AT5G28610 | LOW protein: ATP-dependent RNA helicase DRS1-like protein                         |
 | AT1G66090 |      0.00325 | AT1G66090 | Disease resistance protein (TIR-NBS class)                                        |
 | AT5G25340 |      0.00325 | AT5G25340 | Ubiquitin-like superfamily protein                                                |
 | AT4G38620 |      0.00325 | MYB4      | Transcription repressor MYB4                                                      |
 | AT4G29780 |      0.0032  | AT4G29780 | Nuclease                                                                          |
 | AT5G44680 |      0.0032  | AT5G44680 | DNA glycosylase superfamily protein                                               |
 | AT2G22880 |      0.0032  | AT2G22880 | At2g22880                                                                         |
 | AT3G09260 |      0.0032  | BGLU23    | PYK10                                                                             |
 | AT5G60390 |      0.0032  | A1        | Elongation factor 1-alpha 4                                                       |
 | AT3G09630 |      0.0032  | RPL4A     | 60S ribosomal protein L4-1                                                        |
 | AT2G27660 |      0.0032  | AT2G27660 | Cysteine/Histidine-rich C1 domain family protein                                  |
 | AT2G23270 |      0.0032  | AT2G23270 | At2g23270                                                                         |
 | AT2G18020 |      0.00315 | RPL8A     | EMB2296                                                                           |
 | AT1G65390 |      0.00315 | PP2A5     | Protein PHLOEM PROTEIN 2-LIKE A5                                                  |
 | AT5G41740 |      0.00315 | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT4G37370 |      0.0031  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                            |
 | AT2G35935 |      0.0031  | AT2G35935 | None                                                                              |
 | AT3G60245 |      0.0031  | RPL37AC   | 60S ribosomal protein L37a-2                                                      |
 | AT2G21210 |      0.0031  | AT2G21210 | SAUR-like auxin-responsive protein family                                         |
 | AT5G61600 |      0.0031  | ERF104    | Ethylene-responsive transcription factor ERF104                                   |
 | AT3G53460 |      0.0031  | CP29      | Chloroplast RNA-binding protein 29                                                |
 | AT3G25520 |      0.00305 | ATL5      | RPL5A                                                                             |
 | AT5G01540 |      0.00305 | LECRK62   | L-type lectin-domain containing receptor kinase VI.2                              |
 | AT3G63200 |      0.00305 | PLP9      | Probable inactive patatin-like protein 9                                          |
 | AT5G41750 |      0.00305 | AT5G41750 | Disease resistance protein (TIR-NBS-LRR class) family                             |
 | AT1G69890 |      0.003   | AT1G69890 | Actin cross-linking protein (DUF569)                                              |
 | AT4G37540 |      0.003   | LBD39     | LOB domain-containing protein 39                                                  |
 | AT4G11470 |      0.00295 | CRK31     | cysteine-rich RLK (RECEPTOR-like protein kinase) 31                               |
 | AT1G18080 |      0.00295 | RACK1A    | RACK1A_AT                                                                         |
 | AT3G16420 |      0.00295 | PBP1      | PYK10-binding protein 1                                                           |
 | AT5G49910 |      0.0029  | HSP70-7   | Heat shock 70 kDa protein 7, chloroplastic                                        |
 | AT3G44260 |      0.00285 | CAF1-9    | Probable CCR4-associated factor 1 homolog 9                                       |
 | AT2G30520 |      0.00285 | RPT2      | Root phototropism protein 2                                                       |
 | AT2G35930 |      0.0027  | PUB23     | E3 ubiquitin-protein ligase PUB23                                                 |
 | AT2G26530 |      0.0027  | AR781     | AR781                                                                             |
 | AT1G15690 |      0.0026  | AVP1      | VHP1                                                                              |
 | AT2G45180 |      0.00245 | AT2G45180 | At2g45180/T14P1.1                                                                 |
 | AT5G03240 |      0.00195 | UBQ3      | Ubiquitin 4                                                                       |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [142]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/247f3a8ca81edfa728b6d12c14378ecb5bd32480.png]]
 :END:

* Selecting genes for cerk at 05hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.#+BEGIN_SRC ipython :session

   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'cer' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [143]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [144]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [4396 2028 2192 ... 6054  220 3792]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [145]:
 # text/org
 |    | incoming   | name      | description                                                             |
 |----+------------+-----------+-------------------------------------------------------------------------|
 |  0 | AT2G44578  | AT2G44578 | RING/U-box superfamily protein                                          |
 |  1 | AT1G48740  | AT1G48740 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein |
 |  2 | AT5G42800  | DFRA      | Dihydroflavonol reductase                                               |
 |  3 | AT3G13020  | AT3G13020 | HAT transposon superfamily protein                                      |
 |  4 | AT1G07135  | AT1G07135 | At1g07135                                                               |
 |  5 | AT3G63095  | AT3G63095 | Tetratricopeptide repeat (TPR)-like superfamily protein                 |
 |  6 | AT4G01360  | AT4G01360 | BPS1-like protein                                                       |
 |  7 | AT5G05250  | AT5G05250 | AT5g05250/K18I23_5                                                      |
 |  8 | AT4G23680  | AT4G23680 | AT4g23680/F9D16_150                                                     |
 |  9 | AT5G59320  | LTP3      | Non-specific lipid-transfer protein 3                                   |
 | 10 | AT3G21080  | AT3G21080 | ABC transporter-like protein                                            |
 | 11 | AT5G05300  | AT5G05300 | Gb                                                                      |
 | 12 | AT1G30135  | TIFY5A    | Protein TIFY 5A                                                         |
 | 13 | AT1G56242  | AT1G56242 | other RNA                                                               |
 | 14 | AT3G60415  | AT3G60415 | At3g60420                                                               |
 | 15 | AT3G09440  | HSP70-3   | Heat shock protein 70 (Hsp 70) family protein                           |
 | 16 | AT5G50790  | SWEET10   | Bidirectional sugar transporter SWEET10                                 |
 | 17 | AT2G22860  | PSK2      | Phytosulfokines 2                                                       |
 | 18 | AT3G60690  | AT3G60690 | AT3g60690/T4C21_100                                                     |
 | 19 | AT4G17490  | ERF6      | Ethylene-responsive transcription factor 6                              |
 | 20 | AT3G48080  | EDS1B     | Protein EDS1B                                                           |
 | 21 | AT4G35180  | LHT7      | Lysine histidine transporter-like 7                                     |
 | 22 | AT3G49900  | AT3G49900 | Phototropic-responsive NPH3 family protein                              |
 | 23 | AT5G47500  | PME68     | Probable pectinesterase 68                                              |
 | 24 | AT5G24530  | DMR6      | Protein DOWNY MILDEW RESISTANCE 6                                       |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'cer' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [146]:
 # text/org
 | gene      |   importance | name      | description                                                             |
 |-----------+--------------+-----------+-------------------------------------------------------------------------|
 | AT4G35180 |      0.0426  | LHT7      | Lysine histidine transporter-like 7                                     |
 | AT5G05250 |      0.0412  | AT5G05250 | AT5g05250/K18I23_5                                                      |
 | AT4G01360 |      0.0406  | AT4G01360 | BPS1-like protein                                                       |
 | AT1G30135 |      0.0404  | TIFY5A    | Protein TIFY 5A                                                         |
 | AT5G47500 |      0.04035 | PME68     | Probable pectinesterase 68                                              |
 | AT5G59320 |      0.0403  | LTP3      | Non-specific lipid-transfer protein 3                                   |
 | AT3G13020 |      0.04005 | AT3G13020 | HAT transposon superfamily protein                                      |
 | AT1G56242 |      0.0398  | AT1G56242 | other RNA                                                               |
 | AT5G24530 |      0.03975 | DMR6      | Protein DOWNY MILDEW RESISTANCE 6                                       |
 | AT4G17490 |      0.0394  | ERF6      | Ethylene-responsive transcription factor 6                              |
 | AT5G50790 |      0.03935 | SWEET10   | Bidirectional sugar transporter SWEET10                                 |
 | AT4G23680 |      0.03925 | AT4G23680 | AT4g23680/F9D16_150                                                     |
 | AT1G48740 |      0.039   | AT1G48740 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein |
 | AT2G22860 |      0.039   | PSK2      | Phytosulfokines 2                                                       |
 | AT1G07135 |      0.03895 | AT1G07135 | At1g07135                                                               |
 | AT3G60690 |      0.03845 | AT3G60690 | AT3g60690/T4C21_100                                                     |
 | AT5G05300 |      0.03815 | AT5G05300 | Gb                                                                      |
 | AT3G09440 |      0.038   | HSP70-3   | Heat shock protein 70 (Hsp 70) family protein                           |
 | AT2G44578 |      0.0377  | AT2G44578 | RING/U-box superfamily protein                                          |
 | AT3G49900 |      0.0376  | AT3G49900 | Phototropic-responsive NPH3 family protein                              |
 | AT3G48080 |      0.0365  | EDS1B     | Protein EDS1B                                                           |
 | AT3G60415 |      0.0227  | AT3G60415 | At3g60420                                                               |
 | AT5G42800 |      0.0217  | DFRA      | Dihydroflavonol reductase                                               |
 | AT3G63095 |      0.0216  | AT3G63095 | Tetratricopeptide repeat (TPR)-like superfamily protein                 |
 | AT3G21080 |      0.02055 | AT3G21080 | ABC transporter-like protein                                            |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance', ax=ax)
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [147]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/230825c3322afad31088260ce8154336b50a612e.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('_05h' in c and 'cer' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [148]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [149]:
 # output
 Num Features: 250
 Selected Features: [False False False ... False  True False]
 Feature Ranking: [4171 1803 1967 ... 5829    1 3567]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [150]:
 # text/org
 |     | incoming   | name       | description                                                                                                                  |
 |-----+------------+------------+------------------------------------------------------------------------------------------------------------------------------|
 |   0 | AT2G19150  | PME10      | Putative pectinesterase 10                                                                                                   |
 |   1 | AT3G47430  | PEX11B     | Peroxisomal membrane protein 11B                                                                                             |
 |   2 | AT3G01970  | WRKY45     | Probable WRKY transcription factor 45                                                                                        |
 |   3 | AT3G18915  | AT3G18915  | Transmembrane protein                                                                                                        |
 |   4 | AT3G57910  | AT3G57910  | At3g57910                                                                                                                    |
 |   5 | AT3G51330  | AT3G51330  | Eukaryotic aspartyl protease family protein                                                                                  |
 |   6 | AT5G57760  | AT5G57760  | At5g57760                                                                                                                    |
 |   7 | AT2G44700  | AT2G44700  | F-box/kelch-repeat protein At2g44700                                                                                         |
 |   8 | AT3G30460  | AT3G30460  | RING/U-box superfamily protein                                                                                               |
 |   9 | AT2G17780  | MCA2       | Protein MID1-COMPLEMENTING ACTIVITY 2                                                                                        |
 |  10 | AT3G47780  | ABCA7      | ABC transporter A family member 7                                                                                            |
 |  11 | AT3G52525  | OFP6       | Transcription repressor OFP6                                                                                                 |
 |  12 | AT2G33815  | AT2G33815  | other RNA                                                                                                                    |
 |  13 | AT4G01450  | AT4G01450  | WAT1-related protein At4g01450                                                                                               |
 |  14 | AT1G23830  | AT1G23830  | At1g23830/F5O8_36                                                                                                            |
 |  15 | AT1G19397  | AT1G19397  | unknown protein                                                                                                              |
 |  16 | AT2G02680  | AT2G02680  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 |  17 | AT1G02390  | GPAT2      | Probable glycerol-3-phosphate acyltransferase 2                                                                              |
 |  18 | AT1G18300  | NUDT4      | Nudix hydrolase 4                                                                                                            |
 |  19 | AT2G22890  | FAD4L2     | Fatty acid desaturase 4-like 2, chloroplastic                                                                                |
 |  20 | AT4G22467  | AT4G22467  | None                                                                                                                         |
 |  21 | AT2G44578  | AT2G44578  | RING/U-box superfamily protein                                                                                               |
 |  22 | AT4G26790  | AT4G26790  | GDSL esterase/lipase At4g26790                                                                                               |
 |  23 | AT4G03210  | XTH9       | Xyloglucan endotransglucosylase/hydrolase (Fragment)                                                                         |
 |  24 | AT1G17240  | AtRLP2     | receptor like protein 2                                                                                                      |
 |  25 | AT5G49680  | KIP        | Protein KINKY POLLEN                                                                                                         |
 |  26 | AT1G48740  | AT1G48740  | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                                      |
 |  27 | AT5G22794  | AT5G22794  | FUNCTIONS IN: molecular_function unknown                                                                                     |
 |  28 | AT5G42800  | DFRA       | Dihydroflavonol reductase                                                                                                    |
 |  29 | AT3G13020  | AT3G13020  | HAT transposon superfamily protein                                                                                           |
 |  30 | AT1G28230  | PUP1       | Purine permease 1                                                                                                            |
 |  31 | AT1G80160  | AT1G80160  | F18B13.24 protein                                                                                                            |
 |  32 | AT1G16830  | AT1G16830  | Putative pentatricopeptide repeat-containing protein At1g16830                                                               |
 |  33 | AT4G11910  | SGR2       | Protein STAY-GREEN 2, chloroplastic                                                                                          |
 |  34 | AT5G51190  | ERF105     | Ethylene-responsive transcription factor ERF105                                                                              |
 |  35 | AT3G15060  | RABA1G     | Ras-related protein RABA1g                                                                                                   |
 |  36 | AT5G56030  | HSP81-2    | Heat shock protein 81-2                                                                                                      |
 |  37 | AT4G24570  | PUMP4      | DIC2                                                                                                                         |
 |  38 | AT1G79680  | WAKL10     | Wall-associated receptor kinase-like 10                                                                                      |
 |  39 | AT3G23170  | AT3G23170  | At3g23170                                                                                                                    |
 |  40 | AT1G48930  | AtGH9C1    | Endoglucanase 5                                                                                                              |
 |  41 | AT1G29500  | SAUR66     | Auxin-responsive protein SAUR66                                                                                              |
 |  42 | AT4G02290  | AtGH9B13   | Endoglucanase 17                                                                                                             |
 |  43 | AT3G53270  | AT3G53270  | Small nuclear RNA activating complex (SNAPc), subunit SNAP43 protein                                                         |
 |  44 | AT1G15890  | AT1G15890  | Probable disease resistance protein At1g15890                                                                                |
 |  45 | AT3G56790  | AT3G56790  | RNA splicing factor-like protein                                                                                             |
 |  46 | AT5G26310  | UGT72E3    | Glycosyltransferase (Fragment)                                                                                               |
 |  47 | AT1G08592  | AT1G08592  | Potential natural antisense gene, locus overlaps with AT1G08590                                                              |
 |  48 | AT1G19025  | AT1G19025  | DNA repair metallo-beta-lactamase family protein                                                                             |
 |  49 | AT3G19390  | RD21C      | Probable cysteine protease RD21C                                                                                             |
 |  50 | AT1G49200  | ATL75      | RING-H2 finger protein ATL75                                                                                                 |
 |  51 | AT2G18560  | AT2G18560  | UDP-Glycosyltransferase superfamily protein                                                                                  |
 |  52 | AT2G04240  | XERICO     | Probable E3 ubiquitin-protein ligase XERICO                                                                                  |
 |  53 | AT2G29460  | GSTU4      | Glutathione S-transferase U4                                                                                                 |
 |  54 | AT4G25220  | RHS15      | Putative glycerol-3-phosphate transporter 2                                                                                  |
 |  55 | AT3G46320  | AT3G46320  | Histone H4                                                                                                                   |
 |  56 | AT1G54970  | PRP1       | Proline-rich protein 1                                                                                                       |
 |  57 | AT1G55365  | AT1G55365  | Putative uncharacterized protein                                                                                             |
 |  58 | AT4G17500  | ERF1A      | Ethylene-responsive transcription factor 1A                                                                                  |
 |  59 | AT4G26470  | AT4G26470  | Calcium-binding EF-hand family protein                                                                                       |
 |  60 | AT4G28550  | AT4G28550  | At4g28550                                                                                                                    |
 |  61 | AT3G48640  | AT3G48640  | Transmembrane protein                                                                                                        |
 |  62 | AT1G07135  | AT1G07135  | At1g07135                                                                                                                    |
 |  63 | AT5G24910  | CYP714A1   | Cytochrome P450 714A1                                                                                                        |
 |  64 | AT2G04050  | DTX3       | Protein DETOXIFICATION 3                                                                                                     |
 |  65 | AT5G21940  | AT5G21940  | At5g21940                                                                                                                    |
 |  66 | AT1G75295  | AT1G75295  | other RNA                                                                                                                    |
 |  67 | AT1G32920  | AT1G32920  | At1g32920/F9L11_25                                                                                                           |
 |  68 | AT2G36690  | AT2G36690  | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                                      |
 |  69 | AT3G63095  | AT3G63095  | Tetratricopeptide repeat (TPR)-like superfamily protein                                                                      |
 |  70 | AT3G61760  | DRP1B      | DL1B                                                                                                                         |
 |  71 | AT4G08985  | AT4G08985  | None                                                                                                                         |
 |  72 | AT5G59020  | AT5G59020  | Gb                                                                                                                           |
 |  73 | AT1G21100  | IGMT1      | Indole glucosinolate O-methyltransferase 1                                                                                   |
 |  74 | AT1G35710  | AT1G35710  | Probable leucine-rich repeat receptor-like protein kinase At1g35710                                                          |
 |  75 | AT5G17780  | AT5G17780  | alpha/beta-Hydrolases superfamily protein                                                                                    |
 |  76 | AT4G01360  | AT4G01360  | BPS1-like protein                                                                                                            |
 |  77 | AT5G02500  | MED37E     | Probable mediator of RNA polymerase II transcription subunit 37e                                                             |
 |  78 | AT1G68520  | COL6       | Zinc finger protein CONSTANS-LIKE 6                                                                                          |
 |  79 | AT4G18197  | PUP7       | Probable purine permease 7                                                                                                   |
 |  80 | AT1G02400  | GA2OX6     | Gibberellin 2-beta-dioxygenase 6                                                                                             |
 |  81 | AT1G27730  | ZAT10      | Zinc finger protein ZAT10                                                                                                    |
 |  82 | AT3G44260  | CAF1-9     | Probable CCR4-associated factor 1 homolog 9                                                                                  |
 |  83 | AT2G37430  | ZAT11      | ZAT11                                                                                                                        |
 |  84 | AT2G30760  | AT2G30760  | Uncharacterized protein At2g30760                                                                                            |
 |  85 | AT2G47750  | GH3.9      | Putative indole-3-acetic acid-amido synthetase GH3.9                                                                         |
 |  86 | AT5G27420  | ATL31      | E3 ubiquitin-protein ligase ATL31                                                                                            |
 |  87 | AT3G29000  | CML45      | Probable calcium-binding protein CML45                                                                                       |
 |  88 | AT4G37100  | AT4G37100  | Pyridoxal phosphate (PLP)-dependent transferases superfamily protein                                                         |
 |  89 | AT2G36650  | AT2G36650  | CHUP1-like protein                                                                                                           |
 |  90 | AT2G41010  | CAMBP25    | Calmodulin-binding protein 25                                                                                                |
 |  91 | AT1G68450  | VQ8        | VQ motif-containing protein 8, chloroplastic                                                                                 |
 |  92 | AT1G16510  | SAUR41     | Auxin-responsive protein SAUR41                                                                                              |
 |  93 | AT5G61600  | ERF104     | Ethylene-responsive transcription factor ERF104                                                                              |
 |  94 | AT1G61080  | AT1G61080  | Hydroxyproline-rich glycoprotein family protein                                                                              |
 |  95 | AT5G23350  | AT5G23350  | GEM-like protein 6                                                                                                           |
 |  96 | AT4G31805  | POLAR      | Protein POLAR LOCALIZATION DURING ASYMMETRIC DIVISION AND REDISTRIBUTION                                                     |
 |  97 | AT5G54860  | AT5G54860  | Probable folate-biopterin transporter 4                                                                                      |
 |  98 | AT5G35753  | AT5G35753  | Domain of unknown function (DUF3444)                                                                                         |
 |  99 | AT3G21700  | SGP2       | Monomeric G-protein                                                                                                          |
 | 100 | AT2G18193  | AT2G18193  | AAA-ATPase At2g18193                                                                                                         |
 | 101 | AT4G18880  | HSFA4A     | HSF A4A                                                                                                                      |
 | 102 | AT2G36800  | UGT73C5    | Glycosyltransferase (Fragment)                                                                                               |
 | 103 | AT3G43840  | AT3G43840  | 3-oxo-5-alpha-steroid 4-dehydrogenase family protein                                                                         |
 | 104 | AT5G05250  | AT5G05250  | AT5g05250/K18I23_5                                                                                                           |
 | 105 | AT4G21830  | MSRB7      | Peptide methionine sulfoxide reductase B7                                                                                    |
 | 106 | AT4G23680  | AT4G23680  | AT4g23680/F9D16_150                                                                                                          |
 | 107 | AT3G16860  | COBL8      | COBRA-like protein 8                                                                                                         |
 | 108 | AT1G76240  | AT1G76240  | At1g76240                                                                                                                    |
 | 109 | AT1G32970  | SBT3.2     | Subtilisin-like protease SBT3.2                                                                                              |
 | 110 | AT5G59220  | SAG113     | Probable protein phosphatase 2C 78                                                                                           |
 | 111 | AT4G18205  | PUP22      | Probable purine permease 22                                                                                                  |
 | 112 | AT4G16350  | CBL6       | Calcineurin B-like protein 6                                                                                                 |
 | 113 | AT5G59320  | LTP3       | Non-specific lipid-transfer protein 3                                                                                        |
 | 114 | AT5G62470  | MYB96      | Transcription factor MYB96                                                                                                   |
 | 115 | AT4G24380  | AT4G24380  | INVOLVED IN: 10-formyltetrahydrofolate biosynthetic process, folic acid and derivative biosynthetic process                  |
 | 116 | AT3G52780  | PAP20      | Probable purple acid phosphatase 20                                                                                          |
 | 117 | AT5G43420  | ATL16      | RING-H2 finger protein ATL16                                                                                                 |
 | 118 | AT3G21080  | AT3G21080  | ABC transporter-like protein                                                                                                 |
 | 119 | AT5G64810  | WRKY51     | Probable WRKY transcription factor 51                                                                                        |
 | 120 | AT5G55840  | AT5G55840  | Pentatricopeptide repeat (PPR) superfamily protein                                                                           |
 | 121 | AT1G72300  | PSY1R      | Leucine-rich repeat receptor-like protein kinase (Fragment)                                                                  |
 | 122 | AT4G15270  | AT4G15270  | Glucosyltransferase-like protein (Fragment)                                                                                  |
 | 123 | AT4G31510  | AT4G31510  | Major centromere autoantigen B-like protein                                                                                  |
 | 124 | AT5G52545  | AT5G52545  | unknown protein                                                                                                              |
 | 125 | AT4G21865  | AT4G21865  | At4g21865                                                                                                                    |
 | 126 | AT5G05300  | AT5G05300  | Gb                                                                                                                           |
 | 127 | AT5G20710  | BGAL7      | Beta-galactosidase 7                                                                                                         |
 | 128 | AT1G24260  | SEP3       | At1g24260                                                                                                                    |
 | 129 | AT5G66080  | AT5G66080  | Probable protein phosphatase 2C 79                                                                                           |
 | 130 | AT2G45760  | BAP2       | BON1-associated protein 2                                                                                                    |
 | 131 | AT1G11050  | AT1G11050  | Probable receptor-like protein kinase At1g11050                                                                              |
 | 132 | AT4G35730  | AT4G35730  | Regulator of Vps4 activity in the MVB pathway protein                                                                        |
 | 133 | AT2G32030  | AT2G32030  | Acyl-CoA N-acyltransferases (NAT) superfamily protein                                                                        |
 | 134 | AT5G57560  | XTH22      | Xyloglucan endotransglucosylase/hydrolase                                                                                    |
 | 135 | AT4G22710  | CYP706A2   | Cytochrome P450 - like protein                                                                                               |
 | 136 | AT4G05910  | AT4G05910  | None                                                                                                                         |
 | 137 | AT1G30135  | TIFY5A     | Protein TIFY 5A                                                                                                              |
 | 138 | AT3G54590  | EXT2       | Extensin-2                                                                                                                   |
 | 139 | AT5G56010  | HSP90-3    | Heat shock protein 90-3                                                                                                      |
 | 140 | AT5G19070  | AT5G19070  | At5g19070                                                                                                                    |
 | 141 | AT5G57770  | AT5G57770  | Plant protein of unknown function (DUF828) with plant pleckstrin homology-like region                                        |
 | 142 | AT3G03000  | CML18      | Probable calcium-binding protein CML18                                                                                       |
 | 143 | AT5G21960  | ERF016     | Ethylene-responsive transcription factor ERF016                                                                              |
 | 144 | AT5G41080  | GDPD2      | Glycerophosphodiester phosphodiesterase GDPD2                                                                                |
 | 145 | AT1G69790  | PBL18      | Probable serine/threonine-protein kinase PBL18                                                                               |
 | 146 | AT2G18210  | AT2G18210  | At2g18210                                                                                                                    |
 | 147 | AT4G11280  | ACS6       | 1-aminocyclopropane-1-carboxylate synthase 6                                                                                 |
 | 148 | AT3G02210  | COBL1      | COBRA-like protein                                                                                                           |
 | 149 | AT5G17220  | GSTF12     | Glutathione S-transferase F12                                                                                                |
 | 150 | AT1G31290  | AGO3       | Protein argonaute 3                                                                                                          |
 | 151 | AT5G25280  | AT5G25280  | AT5g25280/F18G18_20                                                                                                          |
 | 152 | AT1G55430  | AT1G55430  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | 153 | AT5G19080  | LUL3       | Probable E3 ubiquitin-protein ligase LUL3                                                                                    |
 | 154 | AT1G69910  | LRK10L-1.5 | LEAF RUST 10 DISEASE-RESISTANCE LOCUS RECEPTOR-LIKE PROTEIN KINASE-like 1.5                                                  |
 | 155 | AT1G78090  | TPPB       | Trehalose-phosphate phosphatase B                                                                                            |
 | 156 | AT5G40780  | LHT1       | Lysine histidine transporter 1                                                                                               |
 | 157 | AT3G61800  | AT3G61800  | UV-stimulated scaffold protein A homolog                                                                                     |
 | 158 | AT1G72520  | LOX4       | Lipoxygenase 4, chloroplastic                                                                                                |
 | 159 | AT4G08935  | AT4G08935  | None                                                                                                                         |
 | 160 | AT1G66500  | PCFS1      | Polyadenylation and cleavage factor homolog 1                                                                                |
 | 161 | AT3G43580  | AT3G43580  | At3g43580                                                                                                                    |
 | 162 | AT1G19020  | AT1G19020  | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                                                            |
 | 163 | AT1G76650  | CML38      | CML38                                                                                                                        |
 | 164 | AT1G77000  | SKP2B      | F-box protein SKP2B                                                                                                          |
 | 165 | AT1G56242  | AT1G56242  | other RNA                                                                                                                    |
 | 166 | AT5G23990  | ATFRO5     | ferric reduction oxidase 5                                                                                                   |
 | 167 | AT5G22250  | CAF1-11    | Probable CCR4-associated factor 1 homolog 11                                                                                 |
 | 168 | AT2G16870  | AT2G16870  | Disease resistance protein (TIR-NBS-LRR class) family                                                                        |
 | 169 | AT3G49620  | DIN11      | Probable 2-oxoglutarate-dependent dioxygenase DIN11                                                                          |
 | 170 | AT3G55090  | ABCG16     | ABC transporter G family member 16                                                                                           |
 | 171 | AT3G60415  | AT3G60415  | At3g60420                                                                                                                    |
 | 172 | AT1G33170  | AT1G33170  | Probable methyltransferase PMT18                                                                                             |
 | 173 | AT5G51720  | NEET       | NEET                                                                                                                         |
 | 174 | AT1G48500  | TIFY6A     | Protein TIFY 6A                                                                                                              |
 | 175 | AT3G57630  | AT3G57630  | At3g57630                                                                                                                    |
 | 176 | AT2G35980  | NHL10      | NDR1/HIN1-like protein 10                                                                                                    |
 | 177 | AT1G73740  | AT1G73740  | Putative UDP-N-acetylglucosamine--N-acetylmuramyl-(Pentapeptide)-pyrophosphoryl-undecaprenol N-acetylglucosamine transferase |
 | 178 | AT3G09440  | HSP70-3    | Heat shock protein 70 (Hsp 70) family protein                                                                                |
 | 179 | AT1G24148  | AT1G24148  | unknown protein                                                                                                              |
 | 180 | AT1G27370  | SPL10      | Squamosa promoter-binding-like protein 10                                                                                    |
 | 181 | AT3G50770  | CML41      | Probable calcium-binding protein CML41                                                                                       |
 | 182 | AT1G02405  | AT1G02405  | At1g02405                                                                                                                    |
 | 183 | AT1G05950  | AT1G05950  | unknown protein                                                                                                              |
 | 184 | AT2G01900  | AT2G01900  | DNAse I-like superfamily protein                                                                                             |
 | 185 | AT5G06839  | TGA10      | Transcription factor TGA10                                                                                                   |
 | 186 | AT2G21210  | AT2G21210  | SAUR-like auxin-responsive protein family                                                                                    |
 | 187 | AT1G63580  | CRRSP6     | Probable cysteine-rich repeat secretory protein 6                                                                            |
 | 188 | AT5G51465  | AT5G51465  | None                                                                                                                         |
 | 189 | AT2G39370  | MAKR4      | Probable membrane-associated kinase regulator 4                                                                              |
 | 190 | AT5G56220  | AT5G56220  | P-loop containing nucleoside triphosphate hydrolases superfamily protein                                                     |
 | 191 | AT3G56880  | AT3G56880  | VQ motif-containing protein                                                                                                  |
 | 192 | AT2G09975  | AT2G09975  | None                                                                                                                         |
 | 193 | AT5G53450  | PAP14      | Probable plastid-lipid-associated protein 14, chloroplastic                                                                  |
 | 194 | AT1G17420  | LOX3       | Lipoxygenase 3, chloroplastic                                                                                                |
 | 195 | AT3G14475  | AT3G14475  | snoRNA                                                                                                                       |
 | 196 | AT2G36430  | AT2G36430  | Transmembrane protein, putative (DUF247)                                                                                     |
 | 197 | AT4G31330  | AT4G31330  | Uncharacterized protein At4g31330                                                                                            |
 | 198 | AT4G29180  | RHS16      | RHS16                                                                                                                        |
 | 199 | AT5G56750  | NDL1       | Protein NDL1                                                                                                                 |
 | 200 | AT3G07900  | OFUT24     | O-fucosyltransferase 24                                                                                                      |
 | 201 | AT5G66000  | AT5G66000  | Uncharacterized protein At5g66000                                                                                            |
 | 202 | AT1G60080  | AT1G60080  | 3'-5'-exoribonuclease family protein                                                                                         |
 | 203 | AT4G31550  | WRKY11     | Probable WRKY transcription factor 11                                                                                        |
 | 204 | AT1G80640  | AT1G80640  | Probable receptor-like protein kinase At1g80640                                                                              |
 | 205 | AT5G50790  | SWEET10    | Bidirectional sugar transporter SWEET10                                                                                      |
 | 206 | AT3G60550  | CYCU2-2    | Cyclin-U2-2                                                                                                                  |
 | 207 | AT2G22860  | PSK2       | Phytosulfokines 2                                                                                                            |
 | 208 | AT2G15390  | FUT4       | Probable fucosyltransferase 4                                                                                                |
 | 209 | AT1G60590  | AT1G60590  | Pectin lyase-like superfamily protein                                                                                        |
 | 210 | AT1G69930  | GSTU11     | Glutathione S-transferase U11                                                                                                |
 | 211 | AT3G60690  | AT3G60690  | AT3g60690/T4C21_100                                                                                                          |
 | 212 | AT2G45870  | AT2G45870  | UPF0187 protein At2g45870, chloroplastic                                                                                     |
 | 213 | AT1G07143  | AT1G07143  | None                                                                                                                         |
 | 214 | AT2G32150  | AT2G32150  | At2g32150/F22D22.10                                                                                                          |
 | 215 | AT5G60310  | LECRK110   | Putative L-type lectin-domain containing receptor kinase I.10                                                                |
 | 216 | AT1G63350  | AT1G63350  | Disease resistance protein (CC-NBS-LRR class) family                                                                         |
 | 217 | AT4G17490  | ERF6       | Ethylene-responsive transcription factor 6                                                                                   |
 | 218 | AT3G48080  | EDS1B      | Protein EDS1B                                                                                                                |
 | 219 | AT1G69890  | AT1G69890  | Actin cross-linking protein (DUF569)                                                                                         |
 | 220 | AT4G35180  | LHT7       | Lysine histidine transporter-like 7                                                                                          |
 | 221 | AT1G61840  | AT1G61840  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | 222 | AT2G02635  | AT2G02635  | None                                                                                                                         |
 | 223 | AT1G21120  | AT1G21120  | O-methyltransferase family protein                                                                                           |
 | 224 | AT5G08070  | TCP17      | Transcription factor TCP17                                                                                                   |
 | 225 | AT4G35770  | STR15      | SEN1                                                                                                                         |
 | 226 | AT4G15070  | AT4G15070  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | 227 | AT5G57625  | AT5G57625  | At5g57625                                                                                                                    |
 | 228 | AT3G49900  | AT3G49900  | Phototropic-responsive NPH3 family protein                                                                                   |
 | 229 | AT5G24210  | AT5G24210  | Alpha/beta-Hydrolases superfamily protein                                                                                    |
 | 230 | AT3G55980  | SZF1       | Salt-inducible zinc finger 1                                                                                                 |
 | 231 | AT5G47500  | PME68      | Probable pectinesterase 68                                                                                                   |
 | 232 | AT4G27657  | AT4G27657  | At4g27657                                                                                                                    |
 | 233 | AT3G61280  | AT3G61280  | Glycosyltransferase                                                                                                          |
 | 234 | AT4G38950  | KIN7F      | Kinesin-like protein KIN-7F                                                                                                  |
 | 235 | AT1G21110  | IGMT3      | Indole glucosinolate O-methyltransferase 3                                                                                   |
 | 236 | AT5G36970  | NHL25      | NHL25                                                                                                                        |
 | 237 | AT5G46350  | WRKY8      | WRKY transcription factor 8                                                                                                  |
 | 238 | AT2G26530  | AR781      | AR781                                                                                                                        |
 | 239 | AT2G35000  | ATL9       | E3 ubiquitin-protein ligase ATL9                                                                                             |
 | 240 | AT4G19230  | CYP707A1   | Cytochrome P450, family 707, subfamily A, polypeptide 1                                                                      |
 | 241 | AT3G22830  | HSFA6B     | Heat stress transcription factor A-6b                                                                                        |
 | 242 | AT4G04540  | CRK39      | Putative cysteine-rich receptor-like protein kinase 39                                                                       |
 | 243 | AT4G24110  | AT4G24110  | NADP-specific glutamate dehydrogenase                                                                                        |
 | 244 | AT5G24530  | DMR6       | Protein DOWNY MILDEW RESISTANCE 6                                                                                            |
 | 245 | AT1G54650  | AT1G54650  | Methyltransferase family protein                                                                                             |
 | 246 | AT3G05600  | AT3G05600  | Alpha/beta-Hydrolases superfamily protein                                                                                    |
 | 247 | AT1G51660  | MKK4       | MKK4                                                                                                                         |
 | 248 | AT2G47190  | ATMYB2     | ATMYB2                                                                                                                       |
 | 249 | AT3G52400  | SYP122     | Syntaxin-122                                                                                                                 |
 :END:


**** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('_05h' in c and 'cer' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [151]:
 # text/org
 | gene      |   importance | name       | description                                                                                                                  |
 |-----------+--------------+------------+------------------------------------------------------------------------------------------------------------------------------|
 | AT3G61280 |      0.0055  | AT3G61280  | Glycosyltransferase                                                                                                          |
 | AT4G15070 |      0.0054  | AT4G15070  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | AT1G60590 |      0.0053  | AT1G60590  | Pectin lyase-like superfamily protein                                                                                        |
 | AT1G17420 |      0.0052  | LOX3       | Lipoxygenase 3, chloroplastic                                                                                                |
 | AT5G59020 |      0.0052  | AT5G59020  | Gb                                                                                                                           |
 | AT1G02390 |      0.00515 | GPAT2      | Probable glycerol-3-phosphate acyltransferase 2                                                                              |
 | AT1G18300 |      0.00505 | NUDT4      | Nudix hydrolase 4                                                                                                            |
 | AT5G51720 |      0.005   | NEET       | NEET                                                                                                                         |
 | AT3G52400 |      0.005   | SYP122     | Syntaxin-122                                                                                                                 |
 | AT5G22250 |      0.00495 | CAF1-11    | Probable CCR4-associated factor 1 homolog 11                                                                                 |
 | AT4G01360 |      0.00495 | AT4G01360  | BPS1-like protein                                                                                                            |
 | AT4G02290 |      0.00495 | AtGH9B13   | Endoglucanase 17                                                                                                             |
 | AT3G05600 |      0.00495 | AT3G05600  | Alpha/beta-Hydrolases superfamily protein                                                                                    |
 | AT3G55090 |      0.0049  | ABCG16     | ABC transporter G family member 16                                                                                           |
 | AT4G29180 |      0.00485 | RHS16      | RHS16                                                                                                                        |
 | AT4G08935 |      0.00485 | AT4G08935  | None                                                                                                                         |
 | AT4G18197 |      0.0048  | PUP7       | Probable purine permease 7                                                                                                   |
 | AT3G18915 |      0.0048  | AT3G18915  | Transmembrane protein                                                                                                        |
 | AT4G24110 |      0.0048  | AT4G24110  | NADP-specific glutamate dehydrogenase                                                                                        |
 | AT5G08070 |      0.0048  | TCP17      | Transcription factor TCP17                                                                                                   |
 | AT4G22710 |      0.0048  | CYP706A2   | Cytochrome P450 - like protein                                                                                               |
 | AT4G05910 |      0.0048  | AT4G05910  | None                                                                                                                         |
 | AT5G22794 |      0.0048  | AT5G22794  | FUNCTIONS IN: molecular_function unknown                                                                                     |
 | AT3G47430 |      0.0048  | PEX11B     | Peroxisomal membrane protein 11B                                                                                             |
 | AT2G04240 |      0.0048  | XERICO     | Probable E3 ubiquitin-protein ligase XERICO                                                                                  |
 | AT3G61800 |      0.00475 | AT3G61800  | UV-stimulated scaffold protein A homolog                                                                                     |
 | AT3G29000 |      0.00475 | CML45      | Probable calcium-binding protein CML45                                                                                       |
 | AT5G57760 |      0.00475 | AT5G57760  | At5g57760                                                                                                                    |
 | AT2G32030 |      0.0047  | AT2G32030  | Acyl-CoA N-acyltransferases (NAT) superfamily protein                                                                        |
 | AT2G36800 |      0.0047  | UGT73C5    | Glycosyltransferase (Fragment)                                                                                               |
 | AT5G02500 |      0.0047  | MED37E     | Probable mediator of RNA polymerase II transcription subunit 37e                                                             |
 | AT2G16870 |      0.0047  | AT2G16870  | Disease resistance protein (TIR-NBS-LRR class) family                                                                        |
 | AT2G36650 |      0.0047  | AT2G36650  | CHUP1-like protein                                                                                                           |
 | AT4G01450 |      0.00465 | AT4G01450  | WAT1-related protein At4g01450                                                                                               |
 | AT1G69890 |      0.00465 | AT1G69890  | Actin cross-linking protein (DUF569)                                                                                         |
 | AT4G31510 |      0.00465 | AT4G31510  | Major centromere autoantigen B-like protein                                                                                  |
 | AT1G32970 |      0.00465 | SBT3.2     | Subtilisin-like protease SBT3.2                                                                                              |
 | AT3G03000 |      0.00465 | CML18      | Probable calcium-binding protein CML18                                                                                       |
 | AT5G55840 |      0.00465 | AT5G55840  | Pentatricopeptide repeat (PPR) superfamily protein                                                                           |
 | AT4G19230 |      0.00465 | CYP707A1   | Cytochrome P450, family 707, subfamily A, polypeptide 1                                                                      |
 | AT1G07135 |      0.00465 | AT1G07135  | At1g07135                                                                                                                    |
 | AT2G45870 |      0.0046  | AT2G45870  | UPF0187 protein At2g45870, chloroplastic                                                                                     |
 | AT5G59320 |      0.0046  | LTP3       | Non-specific lipid-transfer protein 3                                                                                        |
 | AT2G22890 |      0.0046  | FAD4L2     | Fatty acid desaturase 4-like 2, chloroplastic                                                                                |
 | AT2G02680 |      0.0046  | AT2G02680  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | AT5G57560 |      0.0046  | XTH22      | Xyloglucan endotransglucosylase/hydrolase                                                                                    |
 | AT4G03210 |      0.00455 | XTH9       | Xyloglucan endotransglucosylase/hydrolase (Fragment)                                                                         |
 | AT3G56880 |      0.00455 | AT3G56880  | VQ motif-containing protein                                                                                                  |
 | AT5G24530 |      0.00455 | DMR6       | Protein DOWNY MILDEW RESISTANCE 6                                                                                            |
 | AT5G62470 |      0.00455 | MYB96      | Transcription factor MYB96                                                                                                   |
 | AT5G47500 |      0.00455 | PME68      | Probable pectinesterase 68                                                                                                   |
 | AT1G49200 |      0.00455 | ATL75      | RING-H2 finger protein ATL75                                                                                                 |
 | AT5G52545 |      0.00455 | AT5G52545  | unknown protein                                                                                                              |
 | AT5G59220 |      0.00455 | SAG113     | Probable protein phosphatase 2C 78                                                                                           |
 | AT2G01900 |      0.0045  | AT2G01900  | DNAse I-like superfamily protein                                                                                             |
 | AT4G35730 |      0.0045  | AT4G35730  | Regulator of Vps4 activity in the MVB pathway protein                                                                        |
 | AT2G22860 |      0.0045  | PSK2       | Phytosulfokines 2                                                                                                            |
 | AT4G31550 |      0.0045  | WRKY11     | Probable WRKY transcription factor 11                                                                                        |
 | AT5G56220 |      0.0045  | AT5G56220  | P-loop containing nucleoside triphosphate hydrolases superfamily protein                                                     |
 | AT1G80640 |      0.0045  | AT1G80640  | Probable receptor-like protein kinase At1g80640                                                                              |
 | AT4G18880 |      0.00445 | HSFA4A     | HSF A4A                                                                                                                      |
 | AT3G61760 |      0.00445 | DRP1B      | DL1B                                                                                                                         |
 | AT1G75295 |      0.00445 | AT1G75295  | other RNA                                                                                                                    |
 | AT5G40780 |      0.00445 | LHT1       | Lysine histidine transporter 1                                                                                               |
 | AT1G21120 |      0.00445 | AT1G21120  | O-methyltransferase family protein                                                                                           |
 | AT3G56790 |      0.0044  | AT3G56790  | RNA splicing factor-like protein                                                                                             |
 | AT1G33170 |      0.0044  | AT1G33170  | Probable methyltransferase PMT18                                                                                             |
 | AT3G51330 |      0.0044  | AT3G51330  | Eukaryotic aspartyl protease family protein                                                                                  |
 | AT5G61600 |      0.0044  | ERF104     | Ethylene-responsive transcription factor ERF104                                                                              |
 | AT2G18560 |      0.0044  | AT2G18560  | UDP-Glycosyltransferase superfamily protein                                                                                  |
 | AT2G36430 |      0.00435 | AT2G36430  | Transmembrane protein, putative (DUF247)                                                                                     |
 | AT4G25220 |      0.00435 | RHS15      | Putative glycerol-3-phosphate transporter 2                                                                                  |
 | AT1G15890 |      0.00435 | AT1G15890  | Probable disease resistance protein At1g15890                                                                                |
 | AT3G44260 |      0.00435 | CAF1-9     | Probable CCR4-associated factor 1 homolog 9                                                                                  |
 | AT1G68520 |      0.00435 | COL6       | Zinc finger protein CONSTANS-LIKE 6                                                                                          |
 | AT2G44700 |      0.00435 | AT2G44700  | F-box/kelch-repeat protein At2g44700                                                                                         |
 | AT3G49900 |      0.00435 | AT3G49900  | Phototropic-responsive NPH3 family protein                                                                                   |
 | AT5G49680 |      0.00435 | KIP        | Protein KINKY POLLEN                                                                                                         |
 | AT1G02400 |      0.00435 | GA2OX6     | Gibberellin 2-beta-dioxygenase 6                                                                                             |
 | AT1G02405 |      0.00435 | AT1G02405  | At1g02405                                                                                                                    |
 | AT2G18210 |      0.00435 | AT2G18210  | At2g18210                                                                                                                    |
 | AT1G55365 |      0.0043  | AT1G55365  | Putative uncharacterized protein                                                                                             |
 | AT5G25280 |      0.0043  | AT5G25280  | AT5g25280/F18G18_20                                                                                                          |
 | AT1G69930 |      0.0043  | GSTU11     | Glutathione S-transferase U11                                                                                                |
 | AT4G31805 |      0.0043  | POLAR      | Protein POLAR LOCALIZATION DURING ASYMMETRIC DIVISION AND REDISTRIBUTION                                                     |
 | AT3G13020 |      0.0043  | AT3G13020  | HAT transposon superfamily protein                                                                                           |
 | AT5G23350 |      0.0043  | AT5G23350  | GEM-like protein 6                                                                                                           |
 | AT2G35980 |      0.0043  | NHL10      | NDR1/HIN1-like protein 10                                                                                                    |
 | AT2G17780 |      0.0043  | MCA2       | Protein MID1-COMPLEMENTING ACTIVITY 2                                                                                        |
 | AT3G60690 |      0.0043  | AT3G60690  | AT3g60690/T4C21_100                                                                                                          |
 | AT2G18193 |      0.00425 | AT2G18193  | AAA-ATPase At2g18193                                                                                                         |
 | AT5G20710 |      0.00425 | BGAL7      | Beta-galactosidase 7                                                                                                         |
 | AT1G56242 |      0.00425 | AT1G56242  | other RNA                                                                                                                    |
 | AT4G15270 |      0.00425 | AT4G15270  | Glucosyltransferase-like protein (Fragment)                                                                                  |
 | AT4G38950 |      0.00425 | KIN7F      | Kinesin-like protein KIN-7F                                                                                                  |
 | AT4G27657 |      0.00425 | AT4G27657  | At4g27657                                                                                                                    |
 | AT5G35753 |      0.00425 | AT5G35753  | Domain of unknown function (DUF3444)                                                                                         |
 | AT1G17240 |      0.00425 | AtRLP2     | receptor like protein 2                                                                                                      |
 | AT1G19025 |      0.0042  | AT1G19025  | DNA repair metallo-beta-lactamase family protein                                                                             |
 | AT1G61080 |      0.0042  | AT1G61080  | Hydroxyproline-rich glycoprotein family protein                                                                              |
 | AT4G23680 |      0.0042  | AT4G23680  | AT4g23680/F9D16_150                                                                                                          |
 | AT1G77000 |      0.0042  | SKP2B      | F-box protein SKP2B                                                                                                          |
 | AT5G56030 |      0.0042  | HSP81-2    | Heat shock protein 81-2                                                                                                      |
 | AT4G16350 |      0.0042  | CBL6       | Calcineurin B-like protein 6                                                                                                 |
 | AT1G60080 |      0.0042  | AT1G60080  | 3'-5'-exoribonuclease family protein                                                                                         |
 | AT2G47190 |      0.00415 | ATMYB2     | ATMYB2                                                                                                                       |
 | AT1G48500 |      0.00415 | TIFY6A     | Protein TIFY 6A                                                                                                              |
 | AT2G29460 |      0.00415 | GSTU4      | Glutathione S-transferase U4                                                                                                 |
 | AT3G48080 |      0.00415 | EDS1B      | Protein EDS1B                                                                                                                |
 | AT1G27370 |      0.00415 | SPL10      | Squamosa promoter-binding-like protein 10                                                                                    |
 | AT4G26470 |      0.00415 | AT4G26470  | Calcium-binding EF-hand family protein                                                                                       |
 | AT5G50790 |      0.0041  | SWEET10    | Bidirectional sugar transporter SWEET10                                                                                      |
 | AT1G19020 |      0.0041  | AT1G19020  | CDP-diacylglycerol-glycerol-3-phosphate 3-phosphatidyltransferase                                                            |
 | AT2G35000 |      0.0041  | ATL9       | E3 ubiquitin-protein ligase ATL9                                                                                             |
 | AT4G26790 |      0.0041  | AT4G26790  | GDSL esterase/lipase At4g26790                                                                                               |
 | AT5G51190 |      0.0041  | ERF105     | Ethylene-responsive transcription factor ERF105                                                                              |
 | AT4G17500 |      0.0041  | ERF1A      | Ethylene-responsive transcription factor 1A                                                                                  |
 | AT4G24380 |      0.0041  | AT4G24380  | INVOLVED IN: 10-formyltetrahydrofolate biosynthetic process, folic acid and derivative biosynthetic process                  |
 | AT1G66500 |      0.00405 | PCFS1      | Polyadenylation and cleavage factor homolog 1                                                                                |
 | AT2G02635 |      0.00405 | AT2G02635  | None                                                                                                                         |
 | AT1G54970 |      0.00405 | PRP1       | Proline-rich protein 1                                                                                                       |
 | AT5G21960 |      0.00405 | ERF016     | Ethylene-responsive transcription factor ERF016                                                                              |
 | AT3G23170 |      0.00405 | AT3G23170  | At3g23170                                                                                                                    |
 | AT1G29500 |      0.00405 | SAUR66     | Auxin-responsive protein SAUR66                                                                                              |
 | AT5G46350 |      0.00405 | WRKY8      | WRKY transcription factor 8                                                                                                  |
 | AT2G44578 |      0.00405 | AT2G44578  | RING/U-box superfamily protein                                                                                               |
 | AT1G32920 |      0.00405 | AT1G32920  | At1g32920/F9L11_25                                                                                                           |
 | AT4G21865 |      0.00405 | AT4G21865  | At4g21865                                                                                                                    |
 | AT5G05250 |      0.004   | AT5G05250  | AT5g05250/K18I23_5                                                                                                           |
 | AT1G24260 |      0.004   | SEP3       | At1g24260                                                                                                                    |
 | AT1G30135 |      0.004   | TIFY5A     | Protein TIFY 5A                                                                                                              |
 | AT2G47750 |      0.004   | GH3.9      | Putative indole-3-acetic acid-amido synthetase GH3.9                                                                         |
 | AT4G31330 |      0.004   | AT4G31330  | Uncharacterized protein At4g31330                                                                                            |
 | AT2G21210 |      0.004   | AT2G21210  | SAUR-like auxin-responsive protein family                                                                                    |
 | AT3G01970 |      0.00395 | WRKY45     | Probable WRKY transcription factor 45                                                                                        |
 | AT5G21940 |      0.00395 | AT5G21940  | At5g21940                                                                                                                    |
 | AT1G79680 |      0.00395 | WAKL10     | Wall-associated receptor kinase-like 10                                                                                      |
 | AT5G05300 |      0.00395 | AT5G05300  | Gb                                                                                                                           |
 | AT5G17780 |      0.00395 | AT5G17780  | alpha/beta-Hydrolases superfamily protein                                                                                    |
 | AT3G14475 |      0.00395 | AT3G14475  | snoRNA                                                                                                                       |
 | AT4G21830 |      0.00395 | MSRB7      | Peptide methionine sulfoxide reductase B7                                                                                    |
 | AT1G31290 |      0.00395 | AGO3       | Protein argonaute 3                                                                                                          |
 | AT3G46320 |      0.0039  | AT3G46320  | Histone H4                                                                                                                   |
 | AT5G19080 |      0.0039  | LUL3       | Probable E3 ubiquitin-protein ligase LUL3                                                                                    |
 | AT3G21700 |      0.0039  | SGP2       | Monomeric G-protein                                                                                                          |
 | AT1G07143 |      0.0039  | AT1G07143  | None                                                                                                                         |
 | AT1G16510 |      0.0039  | SAUR41     | Auxin-responsive protein SAUR41                                                                                              |
 | AT5G56010 |      0.0039  | HSP90-3    | Heat shock protein 90-3                                                                                                      |
 | AT4G17490 |      0.00385 | ERF6       | Ethylene-responsive transcription factor 6                                                                                   |
 | AT3G54590 |      0.00385 | EXT2       | Extensin-2                                                                                                                   |
 | AT2G37430 |      0.00385 | ZAT11      | ZAT11                                                                                                                        |
 | AT3G09440 |      0.0038  | HSP70-3    | Heat shock protein 70 (Hsp 70) family protein                                                                                |
 | AT4G11910 |      0.0038  | SGR2       | Protein STAY-GREEN 2, chloroplastic                                                                                          |
 | AT1G76650 |      0.0038  | CML38      | CML38                                                                                                                        |
 | AT5G26310 |      0.0038  | UGT72E3    | Glycosyltransferase (Fragment)                                                                                               |
 | AT5G27420 |      0.0038  | ATL31      | E3 ubiquitin-protein ligase ATL31                                                                                            |
 | AT5G19070 |      0.0038  | AT5G19070  | At5g19070                                                                                                                    |
 | AT1G11050 |      0.00375 | AT1G11050  | Probable receptor-like protein kinase At1g11050                                                                              |
 | AT5G56750 |      0.00375 | NDL1       | Protein NDL1                                                                                                                 |
 | AT3G60550 |      0.00375 | CYCU2-2    | Cyclin-U2-2                                                                                                                  |
 | AT5G06839 |      0.00375 | TGA10      | Transcription factor TGA10                                                                                                   |
 | AT3G19390 |      0.00375 | RD21C      | Probable cysteine protease RD21C                                                                                             |
 | AT1G28230 |      0.00375 | PUP1       | Purine permease 1                                                                                                            |
 | AT3G22830 |      0.00375 | HSFA6B     | Heat stress transcription factor A-6b                                                                                        |
 | AT1G55430 |      0.0037  | AT1G55430  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | AT1G54650 |      0.0037  | AT1G54650  | Methyltransferase family protein                                                                                             |
 | AT5G57770 |      0.00365 | AT5G57770  | Plant protein of unknown function (DUF828) with plant pleckstrin homology-like region                                        |
 | AT4G35180 |      0.00365 | LHT7       | Lysine histidine transporter-like 7                                                                                          |
 | AT5G66000 |      0.0036  | AT5G66000  | Uncharacterized protein At5g66000                                                                                            |
 | AT1G16830 |      0.0036  | AT1G16830  | Putative pentatricopeptide repeat-containing protein At1g16830                                                               |
 | AT1G05950 |      0.0036  | AT1G05950  | unknown protein                                                                                                              |
 | AT4G37100 |      0.00355 | AT4G37100  | Pyridoxal phosphate (PLP)-dependent transferases superfamily protein                                                         |
 | AT2G32150 |      0.0035  | AT2G32150  | At2g32150/F22D22.10                                                                                                          |
 | AT4G18205 |      0.00345 | PUP22      | Probable purine permease 22                                                                                                  |
 | AT5G41080 |      0.00345 | GDPD2      | Glycerophosphodiester phosphodiesterase GDPD2                                                                                |
 | AT2G41010 |      0.0034  | CAMBP25    | Calmodulin-binding protein 25                                                                                                |
 | AT4G28550 |      0.0034  | AT4G28550  | At4g28550                                                                                                                    |
 | AT2G45760 |      0.0034  | BAP2       | BON1-associated protein 2                                                                                                    |
 | AT1G48740 |      0.0033  | AT1G48740  | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                                      |
 | AT2G39370 |      0.0032  | MAKR4      | Probable membrane-associated kinase regulator 4                                                                              |
 | AT5G42800 |      0.0031  | DFRA       | Dihydroflavonol reductase                                                                                                    |
 | AT4G11280 |      0.0031  | ACS6       | 1-aminocyclopropane-1-carboxylate synthase 6                                                                                 |
 | AT3G53270 |      0.0031  | AT3G53270  | Small nuclear RNA activating complex (SNAPc), subunit SNAP43 protein                                                         |
 | AT3G57630 |      0.00285 | AT3G57630  | At3g57630                                                                                                                    |
 | AT2G15390 |      0.00275 | FUT4       | Probable fucosyltransferase 4                                                                                                |
 | AT2G04050 |      0.00275 | DTX3       | Protein DETOXIFICATION 3                                                                                                     |
 | AT4G24570 |      0.00275 | PUMP4      | DIC2                                                                                                                         |
 | AT3G21080 |      0.00275 | AT3G21080  | ABC transporter-like protein                                                                                                 |
 | AT1G24148 |      0.00275 | AT1G24148  | unknown protein                                                                                                              |
 | AT1G23830 |      0.00265 | AT1G23830  | At1g23830/F5O8_36                                                                                                            |
 | AT2G30760 |      0.00265 | AT2G30760  | Uncharacterized protein At2g30760                                                                                            |
 | AT3G57910 |      0.0026  | AT3G57910  | At3g57910                                                                                                                    |
 | AT2G26530 |      0.0026  | AR781      | AR781                                                                                                                        |
 | AT3G43580 |      0.00255 | AT3G43580  | At3g43580                                                                                                                    |
 | AT4G04540 |      0.0025  | CRK39      | Putative cysteine-rich receptor-like protein kinase 39                                                                       |
 | AT1G69910 |      0.00245 | LRK10L-1.5 | LEAF RUST 10 DISEASE-RESISTANCE LOCUS RECEPTOR-LIKE PROTEIN KINASE-like 1.5                                                  |
 | AT1G63350 |      0.0024  | AT1G63350  | Disease resistance protein (CC-NBS-LRR class) family                                                                         |
 | AT3G60415 |      0.0024  | AT3G60415  | At3g60420                                                                                                                    |
 | AT2G09975 |      0.0024  | AT2G09975  | None                                                                                                                         |
 | AT3G16860 |      0.0024  | COBL8      | COBRA-like protein 8                                                                                                         |
 | AT3G43840 |      0.00235 | AT3G43840  | 3-oxo-5-alpha-steroid 4-dehydrogenase family protein                                                                         |
 | AT5G24210 |      0.0023  | AT5G24210  | Alpha/beta-Hydrolases superfamily protein                                                                                    |
 | AT1G08592 |      0.0023  | AT1G08592  | Potential natural antisense gene, locus overlaps with AT1G08590                                                              |
 | AT3G48640 |      0.0023  | AT3G48640  | Transmembrane protein                                                                                                        |
 | AT1G27730 |      0.00225 | ZAT10      | Zinc finger protein ZAT10                                                                                                    |
 | AT5G66080 |      0.00225 | AT5G66080  | Probable protein phosphatase 2C 79                                                                                           |
 | AT3G63095 |      0.00225 | AT3G63095  | Tetratricopeptide repeat (TPR)-like superfamily protein                                                                      |
 | AT5G43420 |      0.0022  | ATL16      | RING-H2 finger protein ATL16                                                                                                 |
 | AT5G64810 |      0.00215 | WRKY51     | Probable WRKY transcription factor 51                                                                                        |
 | AT1G72300 |      0.00215 | PSY1R      | Leucine-rich repeat receptor-like protein kinase (Fragment)                                                                  |
 | AT3G02210 |      0.00215 | COBL1      | COBRA-like protein                                                                                                           |
 | AT3G07900 |      0.0021  | OFUT24     | O-fucosyltransferase 24                                                                                                      |
 | AT5G54860 |      0.0021  | AT5G54860  | Probable folate-biopterin transporter 4                                                                                      |
 | AT1G19397 |      0.0021  | AT1G19397  | unknown protein                                                                                                              |
 | AT5G53450 |      0.00205 | PAP14      | Probable plastid-lipid-associated protein 14, chloroplastic                                                                  |
 | AT2G19150 |      0.00205 | PME10      | Putative pectinesterase 10                                                                                                   |
 | AT1G80160 |      0.002   | AT1G80160  | F18B13.24 protein                                                                                                            |
 | AT5G17220 |      0.002   | GSTF12     | Glutathione S-transferase F12                                                                                                |
 | AT4G08985 |      0.002   | AT4G08985  | None                                                                                                                         |
 | AT3G30460 |      0.00195 | AT3G30460  | RING/U-box superfamily protein                                                                                               |
 | AT1G21100 |      0.0019  | IGMT1      | Indole glucosinolate O-methyltransferase 1                                                                                   |
 | AT1G72520 |      0.0019  | LOX4       | Lipoxygenase 4, chloroplastic                                                                                                |
 | AT4G35770 |      0.0019  | STR15      | SEN1                                                                                                                         |
 | AT2G36690 |      0.0019  | AT2G36690  | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                                      |
 | AT1G61840 |      0.0019  | AT1G61840  | Cysteine/Histidine-rich C1 domain family protein                                                                             |
 | AT5G23990 |      0.00185 | ATFRO5     | ferric reduction oxidase 5                                                                                                   |
 | AT1G35710 |      0.0018  | AT1G35710  | Probable leucine-rich repeat receptor-like protein kinase At1g35710                                                          |
 | AT3G55980 |      0.0018  | SZF1       | Salt-inducible zinc finger 1                                                                                                 |
 | AT3G52525 |      0.00175 | OFP6       | Transcription repressor OFP6                                                                                                 |
 | AT5G24910 |      0.00175 | CYP714A1   | Cytochrome P450 714A1                                                                                                        |
 | AT1G76240 |      0.00175 | AT1G76240  | At1g76240                                                                                                                    |
 | AT1G48930 |      0.0017  | AtGH9C1    | Endoglucanase 5                                                                                                              |
 | AT5G57625 |      0.0017  | AT5G57625  | At5g57625                                                                                                                    |
 | AT5G51465 |      0.0017  | AT5G51465  | None                                                                                                                         |
 | AT3G50770 |      0.00165 | CML41      | Probable calcium-binding protein CML41                                                                                       |
 | AT3G52780 |      0.00165 | PAP20      | Probable purple acid phosphatase 20                                                                                          |
 | AT4G22467 |      0.0016  | AT4G22467  | None                                                                                                                         |
 | AT1G51660 |      0.00155 | MKK4       | MKK4                                                                                                                         |
 | AT1G73740 |      0.00155 | AT1G73740  | Putative UDP-N-acetylglucosamine--N-acetylmuramyl-(Pentapeptide)-pyrophosphoryl-undecaprenol N-acetylglucosamine transferase |
 | AT1G69790 |      0.0015  | PBL18      | Probable serine/threonine-protein kinase PBL18                                                                               |
 | AT3G47780 |      0.0015  | ABCA7      | ABC transporter A family member 7                                                                                            |
 | AT1G21110 |      0.00135 | IGMT3      | Indole glucosinolate O-methyltransferase 3                                                                                   |
 | AT1G63580 |      0.00135 | CRRSP6     | Probable cysteine-rich repeat secretory protein 6                                                                            |
 | AT1G68450 |      0.0013  | VQ8        | VQ motif-containing protein 8, chloroplastic                                                                                 |
 | AT1G78090 |      0.00125 | TPPB       | Trehalose-phosphate phosphatase B                                                                                            |
 | AT2G33815 |      0.0012  | AT2G33815  | other RNA                                                                                                                    |
 | AT5G60310 |      0.00115 | LECRK110   | Putative L-type lectin-domain containing receptor kinase I.10                                                                |
 | AT3G49620 |      0.001   | DIN11      | Probable 2-oxoglutarate-dependent dioxygenase DIN11                                                                          |
 | AT5G36970 |      0.00095 | NHL25      | NHL25                                                                                                                        |
 | AT3G15060 |      0.0008  | RABA1G     | Ras-related protein RABA1g                                                                                                   |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [152]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/86df1a6105cefefdce9f5d320820d0043bf1133c.png]]
 :END:





* Selecting genes for Col0 at 6hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [153]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [154]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [ 182 1895 5202 ...  807  973 4321]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [155]:
 # text/org
 |    | incoming   | name      | description                                                |
 |----+------------+-----------+------------------------------------------------------------|
 |  0 | AT1G18970  | GLP1      | Germin-like protein subfamily T member 1                   |
 |  1 | AT3G16420  | PBP1      | PYK10-binding protein 1                                    |
 |  2 | AT4G39950  | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2     |
 |  3 | AT2G19970  | AT2G19970 | At2g19970                                                  |
 |  4 | AT1G76680  | OPR1      | 12-oxophytodienoate reductase 1                            |
 |  5 | AT3G09260  | BGLU23    | PYK10                                                      |
 |  6 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                                      |
 |  7 | AT2G15220  | AT2G15220 | At2g15220/F15A23.4                                         |
 |  8 | AT1G02930  | GSTF6     | Glutathione S-transferase F6                               |
 |  9 | AT5G39580  | PER62     | Peroxidase 62                                              |
 | 10 | AT2G26560  | PLP2      | Patatin-like protein 2                                     |
 | 11 | AT5G14650  | AT5G14650 | Pectin lyase-like superfamily protein                      |
 | 12 | AT1G26240  | AT1G26240 | Proline-rich extensin-like family protein                  |
 | 13 | AT1G09310  | AT1G09310 | T31J12.3 protein                                           |
 | 14 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                             |
 | 15 | AT1G02920  | GSTF7     | Glutathione S-transferase F7                               |
 | 16 | AT3G16400  | NSP1      | Nitrile-specifier protein 1                                |
 | 17 | AT2G27402  | AT2G27402 | At2g27402                                                  |
 | 18 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3                   |
 | 19 | AT1G66700  | PXMT1     | Paraxanthine methyltransferase 1                           |
 | 20 | AT5G13930  | CHS       | Chalcone synthase family protein                           |
 | 21 | AT3G26830  | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase |
 | 22 | AT5G06730  | PER54     | Peroxidase 54                                              |
 | 23 | AT5G47500  | PME68     | Probable pectinesterase 68                                 |
 | 24 | AT5G39110  | AT5G39110 | Germin-like protein subfamily 1 member 14                  |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'col' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [156]:
 # text/org
 | gene      |   importance | name      | description                                                |
 |-----------+--------------+-----------+------------------------------------------------------------|
 | AT2G26560 |      0.03965 | PLP2      | Patatin-like protein 2                                     |
 | AT3G16400 |      0.039   | NSP1      | Nitrile-specifier protein 1                                |
 | AT5G06730 |      0.03815 | PER54     | Peroxidase 54                                              |
 | AT2G19970 |      0.03755 | AT2G19970 | At2g19970                                                  |
 | AT5G47500 |      0.0375  | PME68     | Probable pectinesterase 68                                 |
 | AT4G39950 |      0.03745 | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2     |
 | AT3G28740 |      0.03725 | CYP81D11  | Cytochrome P450 81D11                                      |
 | AT1G18970 |      0.03705 | GLP1      | Germin-like protein subfamily T member 1                   |
 | AT1G76680 |      0.037   | OPR1      | 12-oxophytodienoate reductase 1                            |
 | AT1G26380 |      0.0369  | FOX1      | Berberine bridge enzyme-like 3                             |
 | AT1G02920 |      0.03675 | GSTF7     | Glutathione S-transferase F7                               |
 | AT5G39580 |      0.0366  | PER62     | Peroxidase 62                                              |
 | AT3G16420 |      0.03635 | PBP1      | PYK10-binding protein 1                                    |
 | AT2G15220 |      0.03625 | AT2G15220 | At2g15220/F15A23.4                                         |
 | AT1G09310 |      0.0362  | AT1G09310 | T31J12.3 protein                                           |
 | AT5G20630 |      0.0362  | GER3      | Germin-like protein subfamily 3 member 3                   |
 | AT1G66700 |      0.0361  | PXMT1     | Paraxanthine methyltransferase 1                           |
 | AT1G26240 |      0.03585 | AT1G26240 | Proline-rich extensin-like family protein                  |
 | AT1G02930 |      0.0358  | GSTF6     | Glutathione S-transferase F6                               |
 | AT5G13930 |      0.0356  | CHS       | Chalcone synthase family protein                           |
 | AT2G27402 |      0.03545 | AT2G27402 | At2g27402                                                  |
 | AT3G09260 |      0.035   | BGLU23    | PYK10                                                      |
 | AT5G39110 |      0.03495 | AT5G39110 | Germin-like protein subfamily 1 member 14                  |
 | AT3G26830 |      0.03425 | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase |
 | AT5G14650 |      0.0341  | AT5G14650 | Pectin lyase-like superfamily protein                      |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance', ax=ax)
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [157]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/fc0850005c3f274f6f9419db2a2819926e16f06e.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [158]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [159]:
 # output
 Num Features: 250
 Selected Features: [ True False False ... False False False]
 Feature Ranking: [   1 1670 4977 ...  582  748 4096]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [160]:
 # text/org
 |     | incoming   | name      | description                                                                                             |
 |-----+------------+-----------+---------------------------------------------------------------------------------------------------------|
 |   0 | AT1G59990  | RH22      | DEAD-box ATP-dependent RNA helicase 22                                                                  |
 |   1 | AT1G18970  | GLP1      | Germin-like protein subfamily T member 1                                                                |
 |   2 | AT4G26010  | AT4G26010 | Peroxidase superfamily protein                                                                          |
 |   3 | AT1G06002  | AT1G06002 | Potential natural antisense gene, locus overlaps with AT1G06000                                         |
 |   4 | AT3G01970  | WRKY45    | Probable WRKY transcription factor 45                                                                   |
 |   5 | AT5G05735  | AT5G05735 | None                                                                                                    |
 |   6 | AT4G20830  | AT4G20830 | Berberine bridge enzyme-like 19                                                                         |
 |   7 | AT5G06865  | AT5G06865 | other RNA                                                                                               |
 |   8 | AT3G16420  | PBP1      | PYK10-binding protein 1                                                                                 |
 |   9 | AT4G29390  | RPS30A    | 40S ribosomal protein S30                                                                               |
 |  10 | AT5G24660  | LSU2      | Protein RESPONSE TO LOW SULFUR 2                                                                        |
 |  11 | AT5G58350  | WNK4      | Probable serine/threonine-protein kinase WNK4                                                           |
 |  12 | AT2G24180  | CYP71B6   | Cytochrome P450 71B6                                                                                    |
 |  13 | AT4G39950  | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2                                                  |
 |  14 | AT5G19890  | PER59     | Peroxidase 59                                                                                           |
 |  15 | AT2G10940  | AT2G10940 | At2g10940/F15K19.1                                                                                      |
 |  16 | AT2G36750  | UGT73C1   | UDP-glycosyltransferase 73C1                                                                            |
 |  17 | AT3G04070  | NAC047    | NAC transcription factor 47                                                                             |
 |  18 | AT3G21305  | AT3G21305 | None                                                                                                    |
 |  19 | AT3G25700  | AT3G25700 | At3g25700                                                                                               |
 |  20 | AT2G19970  | AT2G19970 | At2g19970                                                                                               |
 |  21 | AT1G30530  | UGT78D1   | Glycosyltransferase (Fragment)                                                                          |
 |  22 | AT1G76680  | OPR1      | 12-oxophytodienoate reductase 1                                                                         |
 |  23 | AT1G18975  | AT1G18975 | None                                                                                                    |
 |  24 | AT3G09260  | BGLU23    | PYK10                                                                                                   |
 |  25 | AT5G57220  | CYP81F2   | Cytochrome P450 81F2                                                                                    |
 |  26 | AT1G18650  | PDCB3     | PLASMODESMATA CALLOSE-BINDING PROTEIN 3                                                                 |
 |  27 | AT5G49480  | ATCP1     | Calcium-binding protein CP1                                                                             |
 |  28 | AT4G23700  | CHX17     | Cation/H(+) antiporter 17                                                                               |
 |  29 | AT5G64120  | PER71     | Peroxidase                                                                                              |
 |  30 | AT5G64890  | PEP2      | Elicitor peptide 2                                                                                      |
 |  31 | AT3G03670  | PER28     | Peroxidase 28                                                                                           |
 |  32 | AT1G15885  | AT1G15885 | Putative uncharacterized protein                                                                        |
 |  33 | AT3G18830  | PLT5      | PMT5                                                                                                    |
 |  34 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                                                                                   |
 |  35 | AT3G50480  | HR4       | RPW8-like protein 4                                                                                     |
 |  36 | AT1G79680  | WAKL10    | Wall-associated receptor kinase-like 10                                                                 |
 |  37 | AT1G09750  | AED3      | Aspartyl protease AED3                                                                                  |
 |  38 | AT2G15220  | AT2G15220 | At2g15220/F15A23.4                                                                                      |
 |  39 | AT4G02290  | AtGH9B13  | Endoglucanase 17                                                                                        |
 |  40 | AT1G03220  | AT1G03220 | Eukaryotic aspartyl protease family protein                                                             |
 |  41 | AT1G26410  | FOX4      | Berberine bridge enzyme-like 6                                                                          |
 |  42 | AT4G34760  | SAUR50    | Auxin-responsive protein SAUR50                                                                         |
 |  43 | AT5G38900  | AT5G38900 | Thioredoxin superfamily protein                                                                         |
 |  44 | AT1G14540  | PER4      | Peroxidase                                                                                              |
 |  45 | AT3G01420  | DOX1      | Alpha-dioxygenase 1                                                                                     |
 |  46 | AT3G55660  | ROPGEF6   | Rop guanine nucleotide exchange factor 6                                                                |
 |  47 | AT3G51430  | SSL5      | Protein STRICTOSIDINE SYNTHASE-LIKE 5                                                                   |
 |  48 | AT1G02930  | GSTF6     | Glutathione S-transferase F6                                                                            |
 |  49 | AT2G41810  | AT2G41810 | Uncharacterized protein At2g41810                                                                       |
 |  50 | AT1G28290  | AGP31     | Non-classical arabinogalactan protein 31                                                                |
 |  51 | AT4G19420  | AT4G19420 | Pectinacetylesterase family protein                                                                     |
 |  52 | AT5G44380  | AT5G44380 | FAD-binding Berberine family protein                                                                    |
 |  53 | AT1G26250  | AT1G26250 | Proline-rich extensin-like family protein                                                               |
 |  54 | AT1G02730  | CSLD5     | Cellulose synthase-like protein D5                                                                      |
 |  55 | AT4G30720  | AT4G30720 | FAD/NAD(P)-binding oxidoreductase family protein                                                        |
 |  56 | AT2G36690  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                 |
 |  57 | AT1G62510  | AT1G62510 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 |  58 | AT5G46580  | AT5G46580 | Pentatricopeptide repeat-containing protein At5g46580, chloroplastic                                    |
 |  59 | AT1G15260  | AT1G15260 | LOW protein: ATP-dependent RNA helicase-like protein                                                    |
 |  60 | AT1G21100  | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                              |
 |  61 | AT4G34950  | AT4G34950 | Major facilitator superfamily protein                                                                   |
 |  62 | AT3G09405  | PAE4      | Pectin acetylesterase 4                                                                                 |
 |  63 | AT5G03390  | AT5G03390 | At5g03390                                                                                               |
 |  64 | AT2G43120  | AT2G43120 | RmlC-like cupins superfamily protein                                                                    |
 |  65 | AT1G21400  | AT1G21400 | Thiamin diphosphate-binding fold (THDP-binding) superfamily protein                                     |
 |  66 | AT5G42830  | AT5G42830 | HXXXD-type acyl-transferase family protein                                                              |
 |  67 | AT1G67148  | AT1G67148 | Putative uncharacterized protein                                                                        |
 |  68 | AT5G52050  | DTX50     | Protein DETOXIFICATION 50                                                                               |
 |  69 | AT3G06145  | AT3G06145 | Putative RING zinc finger protein                                                                       |
 |  70 | AT3G26210  | CYP71B23  | Cytochrome P450 71B23                                                                                   |
 |  71 | AT1G65490  | AT1G65490 | unknown protein                                                                                         |
 |  72 | AT5G48880  | KAT5      | PKT2                                                                                                    |
 |  73 | AT4G25810  | XTH23     | Probable xyloglucan endotransglucosylase/hydrolase protein 23                                           |
 |  74 | AT2G27389  | AT2G27389 | unknown protein                                                                                         |
 |  75 | AT5G67400  | PER73     | Peroxidase                                                                                              |
 |  76 | AT5G55580  | MTERF9    | Transcription termination factor MTERF9, chloroplastic                                                  |
 |  77 | AT5G05730  | ASA1      | Anthranilate synthase alpha subunit 1                                                                   |
 |  78 | AT5G26340  | STP13     | STP13                                                                                                   |
 |  79 | AT4G21760  | BGLU47    | beta-glucosidase 47                                                                                     |
 |  80 | AT1G48570  | AT1G48570 | T1N15.19                                                                                                |
 |  81 | AT5G54810  | TSB1      | Tryptophan synthase                                                                                     |
 |  82 | AT1G67980  | CCOAMT    | Putative caffeoyl-CoA O-methyltransferase At1g67980                                                     |
 |  83 | AT5G14330  | AT5G14330 | Transmembrane protein                                                                                   |
 |  84 | AT4G19370  | AT4G19370 | Chitin synthase, putative (DUF1218)                                                                     |
 |  85 | AT5G13080  | WRKY75    | WRKY75                                                                                                  |
 |  86 | AT1G03630  | PORC      | Protochlorophyllide reductase C, chloroplastic                                                          |
 |  87 | AT2G27710  | RPP2B     | AT2G27710 protein                                                                                       |
 |  88 | AT4G21770  | AT4G21770 | RNA pseudouridine synthase 6, chloroplastic                                                             |
 |  89 | AT1G69490  | NAC029    | NAP                                                                                                     |
 |  90 | AT5G39580  | PER62     | Peroxidase 62                                                                                           |
 |  91 | AT3G54580  | AT3G54580 | Proline-rich extensin-like family protein                                                               |
 |  92 | AT5G11550  | AT5G11550 | ARM repeat superfamily protein                                                                          |
 |  93 | AT4G15610  | AT4G15610 | CASP-like protein 1D1                                                                                   |
 |  94 | AT1G64160  | DIR5      | Dirigent protein 5                                                                                      |
 |  95 | AT5G49330  | MYB111    | Transcription factor MYB111                                                                             |
 |  96 | AT3G48850  | MPT2      | Mitochondrial phosphate carrier protein 2, mitochondrial                                                |
 |  97 | AT4G37540  | LBD39     | LOB domain-containing protein 39                                                                        |
 |  98 | AT2G26560  | PLP2      | Patatin-like protein 2                                                                                  |
 |  99 | AT5G58250  | AT5G58250 | YCF54                                                                                                   |
 | 100 | AT4G01037  | WTF1      | WTF1                                                                                                    |
 | 101 | AT3G48500  | PDE312    | Nucleic acid-binding, OB-fold-like protein                                                              |
 | 102 | AT3G13950  | AT3G13950 | AT3G13950 protein                                                                                       |
 | 103 | AT4G09040  | AT4G09040 | At4g09040                                                                                               |
 | 104 | AT2G19990  | PR-1-LIKE | PR-1-like protein                                                                                       |
 | 105 | AT2G12170  | AT2G12170 | BEST Arabidopsis thaliana protein match is: Transcriptional factor B3 family protein (TAIR:AT2G24645.1) |
 | 106 | AT5G14650  | AT5G14650 | Pectin lyase-like superfamily protein                                                                   |
 | 107 | AT3G52450  | PUB22     | RING-type E3 ubiquitin transferase                                                                      |
 | 108 | AT5G56670  | RPS30A    | 40S ribosomal protein S30                                                                               |
 | 109 | AT1G26240  | AT1G26240 | Proline-rich extensin-like family protein                                                               |
 | 110 | AT3G63380  | ACA12     | Calcium-transporting ATPase                                                                             |
 | 111 | AT2G38870  | AT2G38870 | Putative protease inhibitor                                                                             |
 | 112 | AT5G23310  | FSD3      | Superoxide dismutase                                                                                    |
 | 113 | AT4G24780  | AT4G24780 | Probable pectate lyase 18                                                                               |
 | 114 | AT1G10522  | PRIN2     | Protein PLASTID REDOX INSENSITIVE 2, chloroplastic                                                      |
 | 115 | AT3G14900  | AT3G14900 | Uncharacterized protein At3g14900                                                                       |
 | 116 | AT4G28420  | AT4G28420 | Probable aminotransferase TAT1                                                                          |
 | 117 | AT2G24850  | TAT3      | Probable aminotransferase TAT3                                                                          |
 | 118 | AT2G46840  | DUF4      | DUF4                                                                                                    |
 | 119 | AT4G02520  | GSTF2     | Glutathione S-transferase F2                                                                            |
 | 120 | AT1G09310  | AT1G09310 | T31J12.3 protein                                                                                        |
 | 121 | AT4G35730  | AT4G35730 | Regulator of Vps4 activity in the MVB pathway protein                                                   |
 | 122 | AT1G51700  | DOF1.7    | Dof zinc finger protein DOF1.7                                                                          |
 | 123 | AT1G05523  | AT1G05523 | None                                                                                                    |
 | 124 | AT3G24300  | AMT1-3    | Ammonium transporter 1 member 3                                                                         |
 | 125 | AT4G14630  | GLP9      | At4g14630                                                                                               |
 | 126 | AT4G00050  | UNE10     | Transcription factor UNE10                                                                              |
 | 127 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                                                                          |
 | 128 | AT1G02920  | GSTF7     | Glutathione S-transferase F7                                                                            |
 | 129 | AT5G15780  | AT5G15780 | At5g15780                                                                                               |
 | 130 | AT3G25790  | HHO1      | Transcription factor HHO1                                                                               |
 | 131 | AT3G18420  | SG1       | protein SLOW GREEN 1, chloroplastic                                                                     |
 | 132 | AT4G02510  | TOC159    | Translocase of chloroplast 159, chloroplastic                                                           |
 | 133 | AT4G18730  | RPL11C    | 60S ribosomal protein L11-2                                                                             |
 | 134 | AT3G58990  | IPMI1     | 3-isopropylmalate dehydratase small subunit 2                                                           |
 | 135 | AT5G02780  | GSTL1     | Glutathione S-transferase L1                                                                            |
 | 136 | AT1G13930  | AT1G13930 | At1g13930/F16A14.27                                                                                     |
 | 137 | AT1G69200  | FLN2      | Fructokinase-like 2, chloroplastic                                                                      |
 | 138 | AT4G25740  | RPS10A    | 40S ribosomal protein S10-1                                                                             |
 | 139 | AT5G55280  | FTSZ1     | Cell division protein FtsZ homolog 1, chloroplastic                                                     |
 | 140 | AT1G29720  | RFK1      | Probable LRR receptor-like serine/threonine-protein kinase At1g29720                                    |
 | 141 | AT5G40780  | LHT1      | Lysine histidine transporter 1                                                                          |
 | 142 | AT5G66530  | AT5G66530 | Glucose-6-phosphate 1-epimerase                                                                         |
 | 143 | AT5G06860  | PGIP1     | PGIP1                                                                                                   |
 | 144 | AT3G16400  | NSP1      | Nitrile-specifier protein 1                                                                             |
 | 145 | AT3G56090  | FER3      | Ferritin-3, chloroplastic                                                                               |
 | 146 | AT2G27402  | AT2G27402 | At2g27402                                                                                               |
 | 147 | AT5G40730  | AGP24     | Arabinogalactan peptide 24                                                                              |
 | 148 | AT5G20230  | BCB       | SAG14                                                                                                   |
 | 149 | AT1G30700  | AT1G30700 | Berberine bridge enzyme-like 8                                                                          |
 | 150 | AT5G20790  | AT5G20790 | unknown protein                                                                                         |
 | 151 | AT3G62530  | AT3G62530 | ARM repeat superfamily protein                                                                          |
 | 152 | AT2G17740  | AT2G17740 | At2g17740                                                                                               |
 | 153 | AT2G41310  | ARR8      | Two-component response regulator ARR8                                                                   |
 | 154 | AT4G37370  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                                                  |
 | 155 | AT5G51720  | NEET      | NEET                                                                                                    |
 | 156 | AT1G55020  | LOX1      | Linoleate 9S-lipoxygenase 1                                                                             |
 | 157 | AT1G08757  | AT1G08757 | None                                                                                                    |
 | 158 | AT1G52245  | AT1G52245 | Dynein light chain                                                                                      |
 | 159 | AT1G71695  | PER12     | Peroxidase                                                                                              |
 | 160 | AT5G44990  | AT5G44990 | Glutathione S-transferase family protein                                                                |
 | 161 | AT3G45030  | RPS20C    | 40S ribosomal protein S20-1                                                                             |
 | 162 | AT1G65690  | NHL6      | NDR1/HIN1-like protein 6                                                                                |
 | 163 | AT1G26255  | AT1G26255 | None                                                                                                    |
 | 164 | AT4G02270  | RHS13     | At4g02270                                                                                               |
 | 165 | AT4G00360  | CYP86A2   | Cytochrome P450 86A2                                                                                    |
 | 166 | AT2G02100  | PDF2.2    | PDF2.2                                                                                                  |
 | 167 | AT3G50770  | CML41     | Probable calcium-binding protein CML41                                                                  |
 | 168 | AT4G26150  | GATA22    | Putative GATA transcription factor 22                                                                   |
 | 169 | AT2G29150  | AT2G29150 | Tropinone reductase homolog At2g29150                                                                   |
 | 170 | AT2G32990  | AtGH9B8   | Endoglucanase 11                                                                                        |
 | 171 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3                                                                |
 | 172 | AT5G08610  | RH26      | PDE340                                                                                                  |
 | 173 | AT3G05730  | AT3G05730 | Defensin-like protein 205                                                                               |
 | 174 | AT3G44860  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                                             |
 | 175 | AT1G13520  | AT1G13520 | At1g13520                                                                                               |
 | 176 | AT1G08380  | PSAO      | PSAO                                                                                                    |
 | 177 | AT5G63140  | PAP29     | Probable inactive purple acid phosphatase 29                                                            |
 | 178 | AT5G66470  | AT5G66470 | GTPase ERA-like, chloroplastic                                                                          |
 | 179 | AT1G02660  | PLIP2     | Phospholipase A1 PLIP2, chloroplastic                                                                   |
 | 180 | AT1G78450  | AT1G78450 | F3F9.4                                                                                                  |
 | 181 | AT5G19750  | AT5G19750 | Peroxisomal membrane 22 kDa (Mpv17/PMP22) family protein                                                |
 | 182 | AT5G64040  | PSAN      | Photosystem I reaction center subunit PSI-N, chloroplast, putative / PSI-N, putative (PSAN)             |
 | 183 | AT4G29740  | CKX4      | Cytokinin dehydrogenase 4                                                                               |
 | 184 | AT1G18250  | ATLP-1    | Pathogenesis-related thaumatin superfamily protein                                                      |
 | 185 | AT3G18250  | AT3G18250 | Putative membrane lipoprotein                                                                           |
 | 186 | AT3G16670  | AT3G16670 | AT3g16670/MGL6_12                                                                                       |
 | 187 | AT1G18980  | AT1G18980 | At1g18980                                                                                               |
 | 188 | AT4G34290  | AT4G34290 | SWIB/MDM2 domain superfamily protein                                                                    |
 | 189 | AT3G46280  | AT3G46280 | Kinase-like protein                                                                                     |
 | 190 | AT4G20835  | AT4G20835 | None                                                                                                    |
 | 191 | AT1G66700  | PXMT1     | Paraxanthine methyltransferase 1                                                                        |
 | 192 | AT3G26445  | AT3G26445 | Beta-1,4-N-acetylglucosaminyltransferase family protein                                                 |
 | 193 | AT5G26920  | CBP60G    | Calmodulin-binding protein 60 G                                                                         |
 | 194 | AT5G16980  | AT5G16980 | Zinc-binding dehydrogenase family protein                                                               |
 | 195 | AT4G10530  | AT4G10530 | Subtilase family protein                                                                                |
 | 196 | AT3G54890  | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                                          |
 | 197 | AT2G28000  | CPN60A1   | SLP                                                                                                     |
 | 198 | AT4G24240  | WRKY7     | Probable WRKY transcription factor 7                                                                    |
 | 199 | AT2G41380  | AT2G41380 | At2g41380                                                                                               |
 | 200 | AT1G18570  | MYB51     | Transcription factor MYB51                                                                              |
 | 201 | AT3G56070  | CYP19-3   | Peptidyl-prolyl cis-trans isomerase CYP19-3                                                             |
 | 202 | AT5G08640  | FLS1      | Flavonol synthase/flavanone 3-hydroxylase                                                               |
 | 203 | AT1G06000  | UGT89C1   | Glycosyltransferase (Fragment)                                                                          |
 | 204 | AT4G30090  | AT4G30090 | Golgin family A protein                                                                                 |
 | 205 | AT5G56870  | BGAL4     | Beta-galactosidase 4                                                                                    |
 | 206 | AT5G42650  | CYP74A    | Allene oxide synthase, chloroplastic                                                                    |
 | 207 | AT4G29905  | AT4G29905 | Putative uncharacterized protein                                                                        |
 | 208 | AT2G46750  | GULLO2    | L-gulonolactone oxidase 2                                                                               |
 | 209 | AT5G13930  | CHS       | Chalcone synthase family protein                                                                        |
 | 210 | AT3G26830  | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase                                              |
 | 211 | AT2G45870  | AT2G45870 | UPF0187 protein At2g45870, chloroplastic                                                                |
 | 212 | AT1G32640  | MYC2      | ZBF1                                                                                                    |
 | 213 | AT4G03985  | AT4G03985 | None                                                                                                    |
 | 214 | AT4G12320  | CYP706A6  | At4g12320                                                                                               |
 | 215 | AT2G28740  | HIS4      | Histone H4                                                                                              |
 | 216 | AT2G25297  | AT2G25297 | None                                                                                                    |
 | 217 | AT5G06730  | PER54     | Peroxidase 54                                                                                           |
 | 218 | AT1G26420  | FOX5      | Berberine bridge enzyme-like 7                                                                          |
 | 219 | AT5G48657  | AT5G48657 | defense protein-related                                                                                 |
 | 220 | AT1G11300  | AT1G11300 | G-type lectin S-receptor-like serine/threonine-protein kinase At1g11300                                 |
 | 221 | AT4G32260  | AT4G32260 | PDE334                                                                                                  |
 | 222 | AT2G32650  | AT2G32650 | At2g32650                                                                                               |
 | 223 | AT1G21120  | AT1G21120 | O-methyltransferase family protein                                                                      |
 | 224 | AT1G72600  | AT1G72600 | At1g72600                                                                                               |
 | 225 | AT5G08070  | TCP17     | Transcription factor TCP17                                                                              |
 | 226 | AT5G57625  | AT5G57625 | At5g57625                                                                                               |
 | 227 | AT1G67030  | ZFP6      | Zinc finger protein 6                                                                                   |
 | 228 | AT1G72610  | GLP1      | Germin-like protein subfamily 3 member 1                                                                |
 | 229 | AT2G02930  | GSTF3     | Glutathione S-transferase F3                                                                            |
 | 230 | AT5G47500  | PME68     | Probable pectinesterase 68                                                                              |
 | 231 | AT5G07030  | AT5G07030 | Eukaryotic aspartyl protease family protein                                                             |
 | 232 | AT1G80850  | AT1G80850 | At1g80850                                                                                               |
 | 233 | AT1G51890  | AT1G51890 | Leucine-rich repeat protein kinase family protein                                                       |
 | 234 | AT2G18690  | AT2G18690 | Expressed protein                                                                                       |
 | 235 | AT2G48130  | AT2G48130 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | 236 | AT4G14780  | AT4G14780 | Kinase like protein                                                                                     |
 | 237 | AT2G34180  | CIPK13    | CBL-interacting serine/threonine-protein kinase 13                                                      |
 | 238 | AT4G15530  | PPDK      | Pyruvate, phosphate dikinase 1, chloroplastic                                                           |
 | 239 | AT1G32350  | AOX3      | AOX1D                                                                                                   |
 | 240 | AT1G07590  | AT1G07590 | Pentatricopeptide repeat-containing protein At1g07590, mitochondrial                                    |
 | 241 | AT5G26290  | AT5G26290 | TRAF-like family protein                                                                                |
 | 242 | AT5G11210  | GLR2.5    | Glutamate receptor 2.5                                                                                  |
 | 243 | AT4G24110  | AT4G24110 | NADP-specific glutamate dehydrogenase                                                                   |
 | 244 | AT4G01700  | AT4G01700 | At4g01700                                                                                               |
 | 245 | AT4G31500  | CYP83B1   | Cytochrome P450 83B1                                                                                    |
 | 246 | AT1G14870  | PCR2      | PCR2                                                                                                    |
 | 247 | AT2G39670  | AT2G39670 | Radical SAM superfamily protein                                                                         |
 | 248 | AT3G12930  | IJ        | Protein Iojap, chloroplastic                                                                            |
 | 249 | AT5G39110  | AT5G39110 | Germin-like protein subfamily 1 member 14                                                               |
 :END:


**** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'col' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [161]:
 # text/org
 | gene      |   importance | name      | description                                                                                             |
 |-----------+--------------+-----------+---------------------------------------------------------------------------------------------------------|
 | AT1G32640 |      0.0049  | MYC2      | ZBF1                                                                                                    |
 | AT1G18250 |      0.0048  | ATLP-1    | Pathogenesis-related thaumatin superfamily protein                                                      |
 | AT4G03985 |      0.0046  | AT4G03985 | None                                                                                                    |
 | AT2G36690 |      0.0045  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                 |
 | AT1G07590 |      0.0045  | AT1G07590 | Pentatricopeptide repeat-containing protein At1g07590, mitochondrial                                    |
 | AT2G27389 |      0.0045  | AT2G27389 | unknown protein                                                                                         |
 | AT2G45870 |      0.00445 | AT2G45870 | UPF0187 protein At2g45870, chloroplastic                                                                |
 | AT4G26010 |      0.00445 | AT4G26010 | Peroxidase superfamily protein                                                                          |
 | AT4G00360 |      0.0044  | CYP86A2   | Cytochrome P450 86A2                                                                                    |
 | AT3G01970 |      0.0044  | WRKY45    | Probable WRKY transcription factor 45                                                                   |
 | AT3G06145 |      0.00435 | AT3G06145 | Putative RING zinc finger protein                                                                       |
 | AT5G56670 |      0.00435 | RPS30A    | 40S ribosomal protein S30                                                                               |
 | AT4G34950 |      0.00435 | AT4G34950 | Major facilitator superfamily protein                                                                   |
 | AT5G63140 |      0.00435 | PAP29     | Probable inactive purple acid phosphatase 29                                                            |
 | AT5G56870 |      0.00435 | BGAL4     | Beta-galactosidase 4                                                                                    |
 | AT5G11550 |      0.00435 | AT5G11550 | ARM repeat superfamily protein                                                                          |
 | AT1G67148 |      0.00435 | AT1G67148 | Putative uncharacterized protein                                                                        |
 | AT5G49330 |      0.0043  | MYB111    | Transcription factor MYB111                                                                             |
 | AT2G19990 |      0.0043  | PR-1-LIKE | PR-1-like protein                                                                                       |
 | AT3G05730 |      0.0043  | AT3G05730 | Defensin-like protein 205                                                                               |
 | AT1G67030 |      0.0043  | ZFP6      | Zinc finger protein 6                                                                                   |
 | AT3G56090 |      0.0043  | FER3      | Ferritin-3, chloroplastic                                                                               |
 | AT3G52450 |      0.00425 | PUB22     | RING-type E3 ubiquitin transferase                                                                      |
 | AT2G32990 |      0.00425 | AtGH9B8   | Endoglucanase 11                                                                                        |
 | AT2G19970 |      0.00425 | AT2G19970 | At2g19970                                                                                               |
 | AT4G37370 |      0.00425 | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                                                  |
 | AT1G72600 |      0.00425 | AT1G72600 | At1g72600                                                                                               |
 | AT1G51700 |      0.00425 | DOF1.7    | Dof zinc finger protein DOF1.7                                                                          |
 | AT3G26830 |      0.0042  | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase                                              |
 | AT3G28740 |      0.0042  | CYP81D11  | Cytochrome P450 81D11                                                                                   |
 | AT2G18690 |      0.0042  | AT2G18690 | Expressed protein                                                                                       |
 | AT3G50480 |      0.0042  | HR4       | RPW8-like protein 4                                                                                     |
 | AT5G06730 |      0.0042  | PER54     | Peroxidase 54                                                                                           |
 | AT4G25810 |      0.00415 | XTH23     | Probable xyloglucan endotransglucosylase/hydrolase protein 23                                           |
 | AT3G24300 |      0.0041  | AMT1-3    | Ammonium transporter 1 member 3                                                                         |
 | AT4G02510 |      0.0041  | TOC159    | Translocase of chloroplast 159, chloroplastic                                                           |
 | AT1G65490 |      0.0041  | AT1G65490 | unknown protein                                                                                         |
 | AT2G27402 |      0.0041  | AT2G27402 | At2g27402                                                                                               |
 | AT1G55020 |      0.0041  | LOX1      | Linoleate 9S-lipoxygenase 1                                                                             |
 | AT4G23700 |      0.0041  | CHX17     | Cation/H(+) antiporter 17                                                                               |
 | AT5G08070 |      0.0041  | TCP17     | Transcription factor TCP17                                                                              |
 | AT4G00050 |      0.0041  | UNE10     | Transcription factor UNE10                                                                              |
 | AT5G47500 |      0.0041  | PME68     | Probable pectinesterase 68                                                                              |
 | AT2G15220 |      0.00405 | AT2G15220 | At2g15220/F15A23.4                                                                                      |
 | AT4G25740 |      0.00405 | RPS10A    | 40S ribosomal protein S10-1                                                                             |
 | AT4G14630 |      0.00405 | GLP9      | At4g14630                                                                                               |
 | AT3G18250 |      0.00405 | AT3G18250 | Putative membrane lipoprotein                                                                           |
 | AT1G02930 |      0.00405 | GSTF6     | Glutathione S-transferase F6                                                                            |
 | AT3G56070 |      0.004   | CYP19-3   | Peptidyl-prolyl cis-trans isomerase CYP19-3                                                             |
 | AT3G04070 |      0.004   | NAC047    | NAC transcription factor 47                                                                             |
 | AT4G02520 |      0.004   | GSTF2     | Glutathione S-transferase F2                                                                            |
 | AT3G25790 |      0.004   | HHO1      | Transcription factor HHO1                                                                               |
 | AT5G16980 |      0.004   | AT5G16980 | Zinc-binding dehydrogenase family protein                                                               |
 | AT1G18650 |      0.004   | PDCB3     | PLASMODESMATA CALLOSE-BINDING PROTEIN 3                                                                 |
 | AT2G29150 |      0.004   | AT2G29150 | Tropinone reductase homolog At2g29150                                                                   |
 | AT1G18570 |      0.004   | MYB51     | Transcription factor MYB51                                                                              |
 | AT3G09405 |      0.004   | PAE4      | Pectin acetylesterase 4                                                                                 |
 | AT5G64890 |      0.004   | PEP2      | Elicitor peptide 2                                                                                      |
 | AT2G25297 |      0.004   | AT2G25297 | None                                                                                                    |
 | AT1G26410 |      0.004   | FOX4      | Berberine bridge enzyme-like 6                                                                          |
 | AT3G26445 |      0.004   | AT3G26445 | Beta-1,4-N-acetylglucosaminyltransferase family protein                                                 |
 | AT3G48850 |      0.004   | MPT2      | Mitochondrial phosphate carrier protein 2, mitochondrial                                                |
 | AT1G59990 |      0.004   | RH22      | DEAD-box ATP-dependent RNA helicase 22                                                                  |
 | AT2G34180 |      0.004   | CIPK13    | CBL-interacting serine/threonine-protein kinase 13                                                      |
 | AT5G40780 |      0.00395 | LHT1      | Lysine histidine transporter 1                                                                          |
 | AT4G21770 |      0.00395 | AT4G21770 | RNA pseudouridine synthase 6, chloroplastic                                                             |
 | AT1G02660 |      0.00395 | PLIP2     | Phospholipase A1 PLIP2, chloroplastic                                                                   |
 | AT5G44380 |      0.00395 | AT5G44380 | FAD-binding Berberine family protein                                                                    |
 | AT3G58990 |      0.00395 | IPMI1     | 3-isopropylmalate dehydratase small subunit 2                                                           |
 | AT1G18980 |      0.00395 | AT1G18980 | At1g18980                                                                                               |
 | AT1G48570 |      0.00395 | AT1G48570 | T1N15.19                                                                                                |
 | AT5G23310 |      0.00395 | FSD3      | Superoxide dismutase                                                                                    |
 | AT2G39670 |      0.0039  | AT2G39670 | Radical SAM superfamily protein                                                                         |
 | AT1G13520 |      0.0039  | AT1G13520 | At1g13520                                                                                               |
 | AT5G49480 |      0.0039  | ATCP1     | Calcium-binding protein CP1                                                                             |
 | AT3G48500 |      0.0039  | PDE312    | Nucleic acid-binding, OB-fold-like protein                                                              |
 | AT1G72610 |      0.0039  | GLP1      | Germin-like protein subfamily 3 member 1                                                                |
 | AT1G30700 |      0.0039  | AT1G30700 | Berberine bridge enzyme-like 8                                                                          |
 | AT5G19890 |      0.0039  | PER59     | Peroxidase 59                                                                                           |
 | AT1G64160 |      0.0039  | DIR5      | Dirigent protein 5                                                                                      |
 | AT4G29905 |      0.0039  | AT4G29905 | Putative uncharacterized protein                                                                        |
 | AT3G14900 |      0.0039  | AT3G14900 | Uncharacterized protein At3g14900                                                                       |
 | AT2G26560 |      0.0039  | PLP2      | Patatin-like protein 2                                                                                  |
 | AT4G18730 |      0.0039  | RPL11C    | 60S ribosomal protein L11-2                                                                             |
 | AT5G08610 |      0.0039  | RH26      | PDE340                                                                                                  |
 | AT2G28740 |      0.0039  | HIS4      | Histone H4                                                                                              |
 | AT5G06865 |      0.00385 | AT5G06865 | other RNA                                                                                               |
 | AT1G26250 |      0.00385 | AT1G26250 | Proline-rich extensin-like family protein                                                               |
 | AT3G16420 |      0.00385 | PBP1      | PYK10-binding protein 1                                                                                 |
 | AT4G39950 |      0.0038  | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2                                                  |
 | AT5G48880 |      0.0038  | KAT5      | PKT2                                                                                                    |
 | AT1G09750 |      0.0038  | AED3      | Aspartyl protease AED3                                                                                  |
 | AT4G10530 |      0.0038  | AT4G10530 | Subtilase family protein                                                                                |
 | AT5G20630 |      0.0038  | GER3      | Germin-like protein subfamily 3 member 3                                                                |
 | AT1G69200 |      0.0038  | FLN2      | Fructokinase-like 2, chloroplastic                                                                      |
 | AT5G66470 |      0.0038  | AT5G66470 | GTPase ERA-like, chloroplastic                                                                          |
 | AT3G21305 |      0.0038  | AT3G21305 | None                                                                                                    |
 | AT2G41310 |      0.0038  | ARR8      | Two-component response regulator ARR8                                                                   |
 | AT1G26255 |      0.0038  | AT1G26255 | None                                                                                                    |
 | AT4G26150 |      0.0038  | GATA22    | Putative GATA transcription factor 22                                                                   |
 | AT4G14780 |      0.00375 | AT4G14780 | Kinase like protein                                                                                     |
 | AT1G08757 |      0.00375 | AT1G08757 | None                                                                                                    |
 | AT2G12170 |      0.00375 | AT2G12170 | BEST Arabidopsis thaliana protein match is: Transcriptional factor B3 family protein (TAIR:AT2G24645.1) |
 | AT5G26290 |      0.00375 | AT5G26290 | TRAF-like family protein                                                                                |
 | AT2G02930 |      0.00375 | GSTF3     | Glutathione S-transferase F3                                                                            |
 | AT2G38870 |      0.00375 | AT2G38870 | Putative protease inhibitor                                                                             |
 | AT4G15610 |      0.00375 | AT4G15610 | CASP-like protein 1D1                                                                                   |
 | AT4G21760 |      0.00375 | BGLU47    | beta-glucosidase 47                                                                                     |
 | AT3G62530 |      0.00375 | AT3G62530 | ARM repeat superfamily protein                                                                          |
 | AT1G52245 |      0.00375 | AT1G52245 | Dynein light chain                                                                                      |
 | AT4G12320 |      0.0037  | CYP706A6  | At4g12320                                                                                               |
 | AT3G51430 |      0.0037  | SSL5      | Protein STRICTOSIDINE SYNTHASE-LIKE 5                                                                   |
 | AT5G11210 |      0.0037  | GLR2.5    | Glutamate receptor 2.5                                                                                  |
 | AT1G02920 |      0.0037  | GSTF7     | Glutathione S-transferase F7                                                                            |
 | AT5G26920 |      0.0037  | CBP60G    | Calmodulin-binding protein 60 G                                                                         |
 | AT5G58250 |      0.0037  | AT5G58250 | YCF54                                                                                                   |
 | AT4G37540 |      0.0037  | LBD39     | LOB domain-containing protein 39                                                                        |
 | AT2G17740 |      0.0037  | AT2G17740 | At2g17740                                                                                               |
 | AT1G26420 |      0.00365 | FOX5      | Berberine bridge enzyme-like 7                                                                          |
 | AT4G24240 |      0.00365 | WRKY7     | Probable WRKY transcription factor 7                                                                    |
 | AT3G12930 |      0.00365 | IJ        | Protein Iojap, chloroplastic                                                                            |
 | AT1G79680 |      0.00365 | WAKL10    | Wall-associated receptor kinase-like 10                                                                 |
 | AT5G51720 |      0.00365 | NEET      | NEET                                                                                                    |
 | AT5G14330 |      0.00365 | AT5G14330 | Transmembrane protein                                                                                   |
 | AT3G26210 |      0.00365 | CYP71B23  | Cytochrome P450 71B23                                                                                   |
 | AT1G14870 |      0.00365 | PCR2      | PCR2                                                                                                    |
 | AT1G71695 |      0.00365 | PER12     | Peroxidase                                                                                              |
 | AT5G52050 |      0.00365 | DTX50     | Protein DETOXIFICATION 50                                                                               |
 | AT1G76680 |      0.00365 | OPR1      | 12-oxophytodienoate reductase 1                                                                         |
 | AT3G16670 |      0.00365 | AT3G16670 | AT3g16670/MGL6_12                                                                                       |
 | AT2G32650 |      0.00365 | AT2G32650 | At2g32650                                                                                               |
 | AT3G46280 |      0.00365 | AT3G46280 | Kinase-like protein                                                                                     |
 | AT1G32350 |      0.0036  | AOX3      | AOX1D                                                                                                   |
 | AT1G69490 |      0.0036  | NAC029    | NAP                                                                                                     |
 | AT5G20790 |      0.0036  | AT5G20790 | unknown protein                                                                                         |
 | AT5G38900 |      0.0036  | AT5G38900 | Thioredoxin superfamily protein                                                                         |
 | AT3G18830 |      0.0036  | PLT5      | PMT5                                                                                                    |
 | AT1G03630 |      0.0036  | PORC      | Protochlorophyllide reductase C, chloroplastic                                                          |
 | AT2G27710 |      0.0036  | RPP2B     | AT2G27710 protein                                                                                       |
 | AT5G02780 |      0.0036  | GSTL1     | Glutathione S-transferase L1                                                                            |
 | AT4G24110 |      0.0036  | AT4G24110 | NADP-specific glutamate dehydrogenase                                                                   |
 | AT1G06000 |      0.0036  | UGT89C1   | Glycosyltransferase (Fragment)                                                                          |
 | AT1G29720 |      0.0036  | RFK1      | Probable LRR receptor-like serine/threonine-protein kinase At1g29720                                    |
 | AT1G30530 |      0.0036  | UGT78D1   | Glycosyltransferase (Fragment)                                                                          |
 | AT5G67400 |      0.0036  | PER73     | Peroxidase                                                                                              |
 | AT1G10522 |      0.0036  | PRIN2     | Protein PLASTID REDOX INSENSITIVE 2, chloroplastic                                                      |
 | AT4G02290 |      0.00355 | AtGH9B13  | Endoglucanase 17                                                                                        |
 | AT4G29390 |      0.00355 | RPS30A    | 40S ribosomal protein S30                                                                               |
 | AT1G78450 |      0.00355 | AT1G78450 | F3F9.4                                                                                                  |
 | AT5G05730 |      0.00355 | ASA1      | Anthranilate synthase alpha subunit 1                                                                   |
 | AT5G20230 |      0.00355 | BCB       | SAG14                                                                                                   |
 | AT5G03390 |      0.00355 | AT5G03390 | At5g03390                                                                                               |
 | AT1G67980 |      0.00355 | CCOAMT    | Putative caffeoyl-CoA O-methyltransferase At1g67980                                                     |
 | AT2G24180 |      0.00355 | CYP71B6   | Cytochrome P450 71B6                                                                                    |
 | AT4G30720 |      0.0035  | AT4G30720 | FAD/NAD(P)-binding oxidoreductase family protein                                                        |
 | AT1G14540 |      0.0035  | PER4      | Peroxidase                                                                                              |
 | AT5G42830 |      0.0035  | AT5G42830 | HXXXD-type acyl-transferase family protein                                                              |
 | AT1G21400 |      0.0035  | AT1G21400 | Thiamin diphosphate-binding fold (THDP-binding) superfamily protein                                     |
 | AT5G48657 |      0.0035  | AT5G48657 | defense protein-related                                                                                 |
 | AT5G08640 |      0.0035  | FLS1      | Flavonol synthase/flavanone 3-hydroxylase                                                               |
 | AT1G18970 |      0.0035  | GLP1      | Germin-like protein subfamily T member 1                                                                |
 | AT1G80850 |      0.0035  | AT1G80850 | At1g80850                                                                                               |
 | AT2G46840 |      0.0035  | DUF4      | DUF4                                                                                                    |
 | AT4G34290 |      0.0035  | AT4G34290 | SWIB/MDM2 domain superfamily protein                                                                    |
 | AT5G39580 |      0.0035  | PER62     | Peroxidase 62                                                                                           |
 | AT1G06002 |      0.00345 | AT1G06002 | Potential natural antisense gene, locus overlaps with AT1G06000                                         |
 | AT1G51890 |      0.00345 | AT1G51890 | Leucine-rich repeat protein kinase family protein                                                       |
 | AT2G43120 |      0.00345 | AT2G43120 | RmlC-like cupins superfamily protein                                                                    |
 | AT1G65690 |      0.00345 | NHL6      | NDR1/HIN1-like protein 6                                                                                |
 | AT3G63380 |      0.00345 | ACA12     | Calcium-transporting ATPase                                                                             |
 | AT4G34760 |      0.00345 | SAUR50    | Auxin-responsive protein SAUR50                                                                         |
 | AT5G06860 |      0.00345 | PGIP1     | PGIP1                                                                                                   |
 | AT5G07030 |      0.00345 | AT5G07030 | Eukaryotic aspartyl protease family protein                                                             |
 | AT2G02100 |      0.00345 | PDF2.2    | PDF2.2                                                                                                  |
 | AT1G03220 |      0.00345 | AT1G03220 | Eukaryotic aspartyl protease family protein                                                             |
 | AT1G21100 |      0.00345 | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                              |
 | AT1G66700 |      0.00345 | PXMT1     | Paraxanthine methyltransferase 1                                                                        |
 | AT1G21120 |      0.00345 | AT1G21120 | O-methyltransferase family protein                                                                      |
 | AT3G13950 |      0.00345 | AT3G13950 | AT3G13950 protein                                                                                       |
 | AT5G13930 |      0.00345 | CHS       | Chalcone synthase family protein                                                                        |
 | AT2G10940 |      0.0034  | AT2G10940 | At2g10940/F15K19.1                                                                                      |
 | AT5G14650 |      0.0034  | AT5G14650 | Pectin lyase-like superfamily protein                                                                   |
 | AT1G02730 |      0.0034  | CSLD5     | Cellulose synthase-like protein D5                                                                      |
 | AT5G57220 |      0.0034  | CYP81F2   | Cytochrome P450 81F2                                                                                    |
 | AT3G54890 |      0.0034  | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                                          |
 | AT2G28000 |      0.0034  | CPN60A1   | SLP                                                                                                     |
 | AT4G19370 |      0.0034  | AT4G19370 | Chitin synthase, putative (DUF1218)                                                                     |
 | AT4G35730 |      0.0034  | AT4G35730 | Regulator of Vps4 activity in the MVB pathway protein                                                   |
 | AT3G54580 |      0.0034  | AT3G54580 | Proline-rich extensin-like family protein                                                               |
 | AT1G26380 |      0.00335 | FOX1      | Berberine bridge enzyme-like 3                                                                          |
 | AT5G13080 |      0.00335 | WRKY75    | WRKY75                                                                                                  |
 | AT2G46750 |      0.00335 | GULLO2    | L-gulonolactone oxidase 2                                                                               |
 | AT2G36750 |      0.00335 | UGT73C1   | UDP-glycosyltransferase 73C1                                                                            |
 | AT4G01700 |      0.00335 | AT4G01700 | At4g01700                                                                                               |
 | AT4G19420 |      0.00335 | AT4G19420 | Pectinacetylesterase family protein                                                                     |
 | AT1G11300 |      0.00335 | AT1G11300 | G-type lectin S-receptor-like serine/threonine-protein kinase At1g11300                                 |
 | AT3G09260 |      0.00335 | BGLU23    | PYK10                                                                                                   |
 | AT5G44990 |      0.00335 | AT5G44990 | Glutathione S-transferase family protein                                                                |
 | AT5G64120 |      0.00335 | PER71     | Peroxidase                                                                                              |
 | AT1G18975 |      0.00335 | AT1G18975 | None                                                                                                    |
 | AT2G41810 |      0.00335 | AT2G41810 | Uncharacterized protein At2g41810                                                                       |
 | AT3G45030 |      0.00335 | RPS20C    | 40S ribosomal protein S20-1                                                                             |
 | AT3G25700 |      0.0033  | AT3G25700 | At3g25700                                                                                               |
 | AT5G26340 |      0.0033  | STP13     | STP13                                                                                                   |
 | AT1G05523 |      0.0033  | AT1G05523 | None                                                                                                    |
 | AT5G66530 |      0.0033  | AT5G66530 | Glucose-6-phosphate 1-epimerase                                                                         |
 | AT4G29740 |      0.0033  | CKX4      | Cytokinin dehydrogenase 4                                                                               |
 | AT5G54810 |      0.0033  | TSB1      | Tryptophan synthase                                                                                     |
 | AT4G09040 |      0.0033  | AT4G09040 | At4g09040                                                                                               |
 | AT5G46580 |      0.0033  | AT5G46580 | Pentatricopeptide repeat-containing protein At5g46580, chloroplastic                                    |
 | AT4G20830 |      0.00325 | AT4G20830 | Berberine bridge enzyme-like 19                                                                         |
 | AT3G01420 |      0.00325 | DOX1      | Alpha-dioxygenase 1                                                                                     |
 | AT1G13930 |      0.00325 | AT1G13930 | At1g13930/F16A14.27                                                                                     |
 | AT1G26240 |      0.00325 | AT1G26240 | Proline-rich extensin-like family protein                                                               |
 | AT2G48130 |      0.00325 | AT2G48130 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | AT1G09310 |      0.00325 | AT1G09310 | T31J12.3 protein                                                                                        |
 | AT1G15885 |      0.0032  | AT1G15885 | Putative uncharacterized protein                                                                        |
 | AT1G15260 |      0.0032  | AT1G15260 | LOW protein: ATP-dependent RNA helicase-like protein                                                    |
 | AT1G28290 |      0.0032  | AGP31     | Non-classical arabinogalactan protein 31                                                                |
 | AT5G19750 |      0.0032  | AT5G19750 | Peroxisomal membrane 22 kDa (Mpv17/PMP22) family protein                                                |
 | AT5G40730 |      0.00315 | AGP24     | Arabinogalactan peptide 24                                                                              |
 | AT2G24850 |      0.00315 | TAT3      | Probable aminotransferase TAT3                                                                          |
 | AT3G03670 |      0.00315 | PER28     | Peroxidase 28                                                                                           |
 | AT3G55660 |      0.00315 | ROPGEF6   | Rop guanine nucleotide exchange factor 6                                                                |
 | AT5G15780 |      0.00315 | AT5G15780 | At5g15780                                                                                               |
 | AT3G18420 |      0.00315 | SG1       | protein SLOW GREEN 1, chloroplastic                                                                     |
 | AT5G58350 |      0.00315 | WNK4      | Probable serine/threonine-protein kinase WNK4                                                           |
 | AT3G50770 |      0.0031  | CML41     | Probable calcium-binding protein CML41                                                                  |
 | AT3G16400 |      0.0031  | NSP1      | Nitrile-specifier protein 1                                                                             |
 | AT4G20835 |      0.0031  | AT4G20835 | None                                                                                                    |
 | AT2G41380 |      0.0031  | AT2G41380 | At2g41380                                                                                               |
 | AT4G28420 |      0.00305 | AT4G28420 | Probable aminotransferase TAT1                                                                          |
 | AT4G24780 |      0.00305 | AT4G24780 | Probable pectate lyase 18                                                                               |
 | AT1G62510 |      0.003   | AT1G62510 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | AT5G39110 |      0.003   | AT5G39110 | Germin-like protein subfamily 1 member 14                                                               |
 | AT5G24660 |      0.003   | LSU2      | Protein RESPONSE TO LOW SULFUR 2                                                                        |
 | AT5G55280 |      0.003   | FTSZ1     | Cell division protein FtsZ homolog 1, chloroplastic                                                     |
 | AT5G55580 |      0.00295 | MTERF9    | Transcription termination factor MTERF9, chloroplastic                                                  |
 | AT3G44860 |      0.0029  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                                             |
 | AT4G01037 |      0.00285 | WTF1      | WTF1                                                                                                    |
 | AT4G15530 |      0.0027  | PPDK      | Pyruvate, phosphate dikinase 1, chloroplastic                                                           |
 | AT5G05735 |      0.00265 | AT5G05735 | None                                                                                                    |
 | AT4G31500 |      0.0026  | CYP83B1   | Cytochrome P450 83B1                                                                                    |
 | AT5G42650 |      0.00245 | CYP74A    | Allene oxide synthase, chloroplastic                                                                    |
 | AT1G08380 |      0.00225 | PSAO      | PSAO                                                                                                    |
 | AT4G30090 |      0.0022  | AT4G30090 | Golgin family A protein                                                                                 |
 | AT5G57625 |      0.0022  | AT5G57625 | At5g57625                                                                                               |
 | AT5G64040 |      0.0021  | PSAN      | Photosystem I reaction center subunit PSI-N, chloroplast, putative / PSI-N, putative (PSAN)             |
 | AT4G32260 |      0.0019  | AT4G32260 | PDE334                                                                                                  |
 | AT4G02270 |      0.00175 | RHS13     | At4g02270                                                                                               |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [162]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/69bf10916878bd9338319e6d6934a10bcca2934b.png]]
 :END:

* Selecting genes for Lym2 at 6hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'lym' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [163]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [164]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [  54 2703 2480 ... 3084 4681 4184]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [165]:
 # text/org
 |    | incoming   | name      | description                                 |
 |----+------------+-----------+---------------------------------------------|
 |  0 | AT1G18970  | GLP1      | Germin-like protein subfamily T member 1    |
 |  1 | AT3G16420  | PBP1      | PYK10-binding protein 1                     |
 |  2 | AT2G19970  | AT2G19970 | At2g19970                                   |
 |  3 | AT3G09260  | BGLU23    | PYK10                                       |
 |  4 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                       |
 |  5 | AT2G15220  | AT2G15220 | At2g15220/F15A23.4                          |
 |  6 | AT3G01420  | DOX1      | Alpha-dioxygenase 1                         |
 |  7 | AT1G02930  | GSTF6     | Glutathione S-transferase F6                |
 |  8 | AT4G25220  | RHS15     | Putative glycerol-3-phosphate transporter 2 |
 |  9 | AT5G14330  | AT5G14330 | Transmembrane protein                       |
 | 10 | AT2G26560  | PLP2      | Patatin-like protein 2                      |
 | 11 | AT1G26240  | AT1G26240 | Proline-rich extensin-like family protein   |
 | 12 | AT2G38870  | AT2G38870 | Putative protease inhibitor                 |
 | 13 | AT1G09310  | AT1G09310 | T31J12.3 protein                            |
 | 14 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3              |
 | 15 | AT1G02920  | GSTF7     | Glutathione S-transferase F7                |
 | 16 | AT3G16400  | NSP1      | Nitrile-specifier protein 1                 |
 | 17 | AT2G27402  | AT2G27402 | At2g27402                                   |
 | 18 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3    |
 | 19 | AT1G66700  | PXMT1     | Paraxanthine methyltransferase 1            |
 | 20 | AT5G08640  | FLS1      | Flavonol synthase/flavanone 3-hydroxylase   |
 | 21 | AT5G13930  | CHS       | Chalcone synthase family protein            |
 | 22 | AT1G21120  | AT1G21120 | O-methyltransferase family protein          |
 | 23 | AT5G47500  | PME68     | Probable pectinesterase 68                  |
 | 24 | AT5G39110  | AT5G39110 | Germin-like protein subfamily 1 member 14   |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'lym' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [166]:
 # text/org
 | gene      |   importance | name      | description                                 |
 |-----------+--------------+-----------+---------------------------------------------|
 | AT4G25220 |      0.03965 | RHS15     | Putative glycerol-3-phosphate transporter 2 |
 | AT1G02930 |      0.039   | GSTF6     | Glutathione S-transferase F6                |
 | AT3G09260 |      0.03815 | BGLU23    | PYK10                                       |
 | AT2G19970 |      0.03755 | AT2G19970 | At2g19970                                   |
 | AT1G21120 |      0.0375  | AT1G21120 | O-methyltransferase family protein          |
 | AT3G28740 |      0.03745 | CYP81D11  | Cytochrome P450 81D11                       |
 | AT2G15220 |      0.03725 | AT2G15220 | At2g15220/F15A23.4                          |
 | AT1G18970 |      0.03705 | GLP1      | Germin-like protein subfamily T member 1    |
 | AT5G20630 |      0.037   | GER3      | Germin-like protein subfamily 3 member 3    |
 | AT5G13930 |      0.0369  | CHS       | Chalcone synthase family protein            |
 | AT3G16400 |      0.03675 | NSP1      | Nitrile-specifier protein 1                 |
 | AT1G26380 |      0.0366  | FOX1      | Berberine bridge enzyme-like 3              |
 | AT3G16420 |      0.03635 | PBP1      | PYK10-binding protein 1                     |
 | AT1G66700 |      0.03625 | PXMT1     | Paraxanthine methyltransferase 1            |
 | AT1G09310 |      0.0362  | AT1G09310 | T31J12.3 protein                            |
 | AT1G02920 |      0.0362  | GSTF7     | Glutathione S-transferase F7                |
 | AT2G27402 |      0.0361  | AT2G27402 | At2g27402                                   |
 | AT1G26240 |      0.03585 | AT1G26240 | Proline-rich extensin-like family protein   |
 | AT2G38870 |      0.0358  | AT2G38870 | Putative protease inhibitor                 |
 | AT5G47500 |      0.0356  | PME68     | Probable pectinesterase 68                  |
 | AT5G39110 |      0.03545 | AT5G39110 | Germin-like protein subfamily 1 member 14   |
 | AT2G26560 |      0.035   | PLP2      | Patatin-like protein 2                      |
 | AT5G14330 |      0.03495 | AT5G14330 | Transmembrane protein                       |
 | AT3G01420 |      0.03425 | DOX1      | Alpha-dioxygenase 1                         |
 | AT5G08640 |      0.0341  | FLS1      | Flavonol synthase/flavanone 3-hydroxylase   |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance')
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [167]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/21f33ed725c0b0940b60e1588a12604820f36aa7.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'col' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [168]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [169]:
 # output
 Num Features: 250
 Selected Features: [ True False False ... False False False]
 Feature Ranking: [   1 1670 4977 ...  582  748 4096]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [170]:
 # text/org
 |     | incoming   | name      | description                                                                                             |
 |-----+------------+-----------+---------------------------------------------------------------------------------------------------------|
 |   0 | AT1G59990  | RH22      | DEAD-box ATP-dependent RNA helicase 22                                                                  |
 |   1 | AT1G18970  | GLP1      | Germin-like protein subfamily T member 1                                                                |
 |   2 | AT4G26010  | AT4G26010 | Peroxidase superfamily protein                                                                          |
 |   3 | AT1G06002  | AT1G06002 | Potential natural antisense gene, locus overlaps with AT1G06000                                         |
 |   4 | AT3G01970  | WRKY45    | Probable WRKY transcription factor 45                                                                   |
 |   5 | AT5G05735  | AT5G05735 | None                                                                                                    |
 |   6 | AT4G20830  | AT4G20830 | Berberine bridge enzyme-like 19                                                                         |
 |   7 | AT5G06865  | AT5G06865 | other RNA                                                                                               |
 |   8 | AT3G16420  | PBP1      | PYK10-binding protein 1                                                                                 |
 |   9 | AT4G29390  | RPS30A    | 40S ribosomal protein S30                                                                               |
 |  10 | AT5G24660  | LSU2      | Protein RESPONSE TO LOW SULFUR 2                                                                        |
 |  11 | AT5G58350  | WNK4      | Probable serine/threonine-protein kinase WNK4                                                           |
 |  12 | AT2G24180  | CYP71B6   | Cytochrome P450 71B6                                                                                    |
 |  13 | AT4G39950  | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2                                                  |
 |  14 | AT5G19890  | PER59     | Peroxidase 59                                                                                           |
 |  15 | AT2G10940  | AT2G10940 | At2g10940/F15K19.1                                                                                      |
 |  16 | AT2G36750  | UGT73C1   | UDP-glycosyltransferase 73C1                                                                            |
 |  17 | AT3G04070  | NAC047    | NAC transcription factor 47                                                                             |
 |  18 | AT3G21305  | AT3G21305 | None                                                                                                    |
 |  19 | AT3G25700  | AT3G25700 | At3g25700                                                                                               |
 |  20 | AT2G19970  | AT2G19970 | At2g19970                                                                                               |
 |  21 | AT1G30530  | UGT78D1   | Glycosyltransferase (Fragment)                                                                          |
 |  22 | AT1G76680  | OPR1      | 12-oxophytodienoate reductase 1                                                                         |
 |  23 | AT1G18975  | AT1G18975 | None                                                                                                    |
 |  24 | AT3G09260  | BGLU23    | PYK10                                                                                                   |
 |  25 | AT5G57220  | CYP81F2   | Cytochrome P450 81F2                                                                                    |
 |  26 | AT1G18650  | PDCB3     | PLASMODESMATA CALLOSE-BINDING PROTEIN 3                                                                 |
 |  27 | AT5G49480  | ATCP1     | Calcium-binding protein CP1                                                                             |
 |  28 | AT4G23700  | CHX17     | Cation/H(+) antiporter 17                                                                               |
 |  29 | AT5G64120  | PER71     | Peroxidase                                                                                              |
 |  30 | AT5G64890  | PEP2      | Elicitor peptide 2                                                                                      |
 |  31 | AT3G03670  | PER28     | Peroxidase 28                                                                                           |
 |  32 | AT1G15885  | AT1G15885 | Putative uncharacterized protein                                                                        |
 |  33 | AT3G18830  | PLT5      | PMT5                                                                                                    |
 |  34 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                                                                                   |
 |  35 | AT3G50480  | HR4       | RPW8-like protein 4                                                                                     |
 |  36 | AT1G79680  | WAKL10    | Wall-associated receptor kinase-like 10                                                                 |
 |  37 | AT1G09750  | AED3      | Aspartyl protease AED3                                                                                  |
 |  38 | AT2G15220  | AT2G15220 | At2g15220/F15A23.4                                                                                      |
 |  39 | AT4G02290  | AtGH9B13  | Endoglucanase 17                                                                                        |
 |  40 | AT1G03220  | AT1G03220 | Eukaryotic aspartyl protease family protein                                                             |
 |  41 | AT1G26410  | FOX4      | Berberine bridge enzyme-like 6                                                                          |
 |  42 | AT4G34760  | SAUR50    | Auxin-responsive protein SAUR50                                                                         |
 |  43 | AT5G38900  | AT5G38900 | Thioredoxin superfamily protein                                                                         |
 |  44 | AT1G14540  | PER4      | Peroxidase                                                                                              |
 |  45 | AT3G01420  | DOX1      | Alpha-dioxygenase 1                                                                                     |
 |  46 | AT3G55660  | ROPGEF6   | Rop guanine nucleotide exchange factor 6                                                                |
 |  47 | AT3G51430  | SSL5      | Protein STRICTOSIDINE SYNTHASE-LIKE 5                                                                   |
 |  48 | AT1G02930  | GSTF6     | Glutathione S-transferase F6                                                                            |
 |  49 | AT2G41810  | AT2G41810 | Uncharacterized protein At2g41810                                                                       |
 |  50 | AT1G28290  | AGP31     | Non-classical arabinogalactan protein 31                                                                |
 |  51 | AT4G19420  | AT4G19420 | Pectinacetylesterase family protein                                                                     |
 |  52 | AT5G44380  | AT5G44380 | FAD-binding Berberine family protein                                                                    |
 |  53 | AT1G26250  | AT1G26250 | Proline-rich extensin-like family protein                                                               |
 |  54 | AT1G02730  | CSLD5     | Cellulose synthase-like protein D5                                                                      |
 |  55 | AT4G30720  | AT4G30720 | FAD/NAD(P)-binding oxidoreductase family protein                                                        |
 |  56 | AT2G36690  | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                 |
 |  57 | AT1G62510  | AT1G62510 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 |  58 | AT5G46580  | AT5G46580 | Pentatricopeptide repeat-containing protein At5g46580, chloroplastic                                    |
 |  59 | AT1G15260  | AT1G15260 | LOW protein: ATP-dependent RNA helicase-like protein                                                    |
 |  60 | AT1G21100  | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                              |
 |  61 | AT4G34950  | AT4G34950 | Major facilitator superfamily protein                                                                   |
 |  62 | AT3G09405  | PAE4      | Pectin acetylesterase 4                                                                                 |
 |  63 | AT5G03390  | AT5G03390 | At5g03390                                                                                               |
 |  64 | AT2G43120  | AT2G43120 | RmlC-like cupins superfamily protein                                                                    |
 |  65 | AT1G21400  | AT1G21400 | Thiamin diphosphate-binding fold (THDP-binding) superfamily protein                                     |
 |  66 | AT5G42830  | AT5G42830 | HXXXD-type acyl-transferase family protein                                                              |
 |  67 | AT1G67148  | AT1G67148 | Putative uncharacterized protein                                                                        |
 |  68 | AT5G52050  | DTX50     | Protein DETOXIFICATION 50                                                                               |
 |  69 | AT3G06145  | AT3G06145 | Putative RING zinc finger protein                                                                       |
 |  70 | AT3G26210  | CYP71B23  | Cytochrome P450 71B23                                                                                   |
 |  71 | AT1G65490  | AT1G65490 | unknown protein                                                                                         |
 |  72 | AT5G48880  | KAT5      | PKT2                                                                                                    |
 |  73 | AT4G25810  | XTH23     | Probable xyloglucan endotransglucosylase/hydrolase protein 23                                           |
 |  74 | AT2G27389  | AT2G27389 | unknown protein                                                                                         |
 |  75 | AT5G67400  | PER73     | Peroxidase                                                                                              |
 |  76 | AT5G55580  | MTERF9    | Transcription termination factor MTERF9, chloroplastic                                                  |
 |  77 | AT5G05730  | ASA1      | Anthranilate synthase alpha subunit 1                                                                   |
 |  78 | AT5G26340  | STP13     | STP13                                                                                                   |
 |  79 | AT4G21760  | BGLU47    | beta-glucosidase 47                                                                                     |
 |  80 | AT1G48570  | AT1G48570 | T1N15.19                                                                                                |
 |  81 | AT5G54810  | TSB1      | Tryptophan synthase                                                                                     |
 |  82 | AT1G67980  | CCOAMT    | Putative caffeoyl-CoA O-methyltransferase At1g67980                                                     |
 |  83 | AT5G14330  | AT5G14330 | Transmembrane protein                                                                                   |
 |  84 | AT4G19370  | AT4G19370 | Chitin synthase, putative (DUF1218)                                                                     |
 |  85 | AT5G13080  | WRKY75    | WRKY75                                                                                                  |
 |  86 | AT1G03630  | PORC      | Protochlorophyllide reductase C, chloroplastic                                                          |
 |  87 | AT2G27710  | RPP2B     | AT2G27710 protein                                                                                       |
 |  88 | AT4G21770  | AT4G21770 | RNA pseudouridine synthase 6, chloroplastic                                                             |
 |  89 | AT1G69490  | NAC029    | NAP                                                                                                     |
 |  90 | AT5G39580  | PER62     | Peroxidase 62                                                                                           |
 |  91 | AT3G54580  | AT3G54580 | Proline-rich extensin-like family protein                                                               |
 |  92 | AT5G11550  | AT5G11550 | ARM repeat superfamily protein                                                                          |
 |  93 | AT4G15610  | AT4G15610 | CASP-like protein 1D1                                                                                   |
 |  94 | AT1G64160  | DIR5      | Dirigent protein 5                                                                                      |
 |  95 | AT5G49330  | MYB111    | Transcription factor MYB111                                                                             |
 |  96 | AT3G48850  | MPT2      | Mitochondrial phosphate carrier protein 2, mitochondrial                                                |
 |  97 | AT4G37540  | LBD39     | LOB domain-containing protein 39                                                                        |
 |  98 | AT2G26560  | PLP2      | Patatin-like protein 2                                                                                  |
 |  99 | AT5G58250  | AT5G58250 | YCF54                                                                                                   |
 | 100 | AT4G01037  | WTF1      | WTF1                                                                                                    |
 | 101 | AT3G48500  | PDE312    | Nucleic acid-binding, OB-fold-like protein                                                              |
 | 102 | AT3G13950  | AT3G13950 | AT3G13950 protein                                                                                       |
 | 103 | AT4G09040  | AT4G09040 | At4g09040                                                                                               |
 | 104 | AT2G19990  | PR-1-LIKE | PR-1-like protein                                                                                       |
 | 105 | AT2G12170  | AT2G12170 | BEST Arabidopsis thaliana protein match is: Transcriptional factor B3 family protein (TAIR:AT2G24645.1) |
 | 106 | AT5G14650  | AT5G14650 | Pectin lyase-like superfamily protein                                                                   |
 | 107 | AT3G52450  | PUB22     | RING-type E3 ubiquitin transferase                                                                      |
 | 108 | AT5G56670  | RPS30A    | 40S ribosomal protein S30                                                                               |
 | 109 | AT1G26240  | AT1G26240 | Proline-rich extensin-like family protein                                                               |
 | 110 | AT3G63380  | ACA12     | Calcium-transporting ATPase                                                                             |
 | 111 | AT2G38870  | AT2G38870 | Putative protease inhibitor                                                                             |
 | 112 | AT5G23310  | FSD3      | Superoxide dismutase                                                                                    |
 | 113 | AT4G24780  | AT4G24780 | Probable pectate lyase 18                                                                               |
 | 114 | AT1G10522  | PRIN2     | Protein PLASTID REDOX INSENSITIVE 2, chloroplastic                                                      |
 | 115 | AT3G14900  | AT3G14900 | Uncharacterized protein At3g14900                                                                       |
 | 116 | AT4G28420  | AT4G28420 | Probable aminotransferase TAT1                                                                          |
 | 117 | AT2G24850  | TAT3      | Probable aminotransferase TAT3                                                                          |
 | 118 | AT2G46840  | DUF4      | DUF4                                                                                                    |
 | 119 | AT4G02520  | GSTF2     | Glutathione S-transferase F2                                                                            |
 | 120 | AT1G09310  | AT1G09310 | T31J12.3 protein                                                                                        |
 | 121 | AT4G35730  | AT4G35730 | Regulator of Vps4 activity in the MVB pathway protein                                                   |
 | 122 | AT1G51700  | DOF1.7    | Dof zinc finger protein DOF1.7                                                                          |
 | 123 | AT1G05523  | AT1G05523 | None                                                                                                    |
 | 124 | AT3G24300  | AMT1-3    | Ammonium transporter 1 member 3                                                                         |
 | 125 | AT4G14630  | GLP9      | At4g14630                                                                                               |
 | 126 | AT4G00050  | UNE10     | Transcription factor UNE10                                                                              |
 | 127 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                                                                          |
 | 128 | AT1G02920  | GSTF7     | Glutathione S-transferase F7                                                                            |
 | 129 | AT5G15780  | AT5G15780 | At5g15780                                                                                               |
 | 130 | AT3G25790  | HHO1      | Transcription factor HHO1                                                                               |
 | 131 | AT3G18420  | SG1       | protein SLOW GREEN 1, chloroplastic                                                                     |
 | 132 | AT4G02510  | TOC159    | Translocase of chloroplast 159, chloroplastic                                                           |
 | 133 | AT4G18730  | RPL11C    | 60S ribosomal protein L11-2                                                                             |
 | 134 | AT3G58990  | IPMI1     | 3-isopropylmalate dehydratase small subunit 2                                                           |
 | 135 | AT5G02780  | GSTL1     | Glutathione S-transferase L1                                                                            |
 | 136 | AT1G13930  | AT1G13930 | At1g13930/F16A14.27                                                                                     |
 | 137 | AT1G69200  | FLN2      | Fructokinase-like 2, chloroplastic                                                                      |
 | 138 | AT4G25740  | RPS10A    | 40S ribosomal protein S10-1                                                                             |
 | 139 | AT5G55280  | FTSZ1     | Cell division protein FtsZ homolog 1, chloroplastic                                                     |
 | 140 | AT1G29720  | RFK1      | Probable LRR receptor-like serine/threonine-protein kinase At1g29720                                    |
 | 141 | AT5G40780  | LHT1      | Lysine histidine transporter 1                                                                          |
 | 142 | AT5G66530  | AT5G66530 | Glucose-6-phosphate 1-epimerase                                                                         |
 | 143 | AT5G06860  | PGIP1     | PGIP1                                                                                                   |
 | 144 | AT3G16400  | NSP1      | Nitrile-specifier protein 1                                                                             |
 | 145 | AT3G56090  | FER3      | Ferritin-3, chloroplastic                                                                               |
 | 146 | AT2G27402  | AT2G27402 | At2g27402                                                                                               |
 | 147 | AT5G40730  | AGP24     | Arabinogalactan peptide 24                                                                              |
 | 148 | AT5G20230  | BCB       | SAG14                                                                                                   |
 | 149 | AT1G30700  | AT1G30700 | Berberine bridge enzyme-like 8                                                                          |
 | 150 | AT5G20790  | AT5G20790 | unknown protein                                                                                         |
 | 151 | AT3G62530  | AT3G62530 | ARM repeat superfamily protein                                                                          |
 | 152 | AT2G17740  | AT2G17740 | At2g17740                                                                                               |
 | 153 | AT2G41310  | ARR8      | Two-component response regulator ARR8                                                                   |
 | 154 | AT4G37370  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                                                  |
 | 155 | AT5G51720  | NEET      | NEET                                                                                                    |
 | 156 | AT1G55020  | LOX1      | Linoleate 9S-lipoxygenase 1                                                                             |
 | 157 | AT1G08757  | AT1G08757 | None                                                                                                    |
 | 158 | AT1G52245  | AT1G52245 | Dynein light chain                                                                                      |
 | 159 | AT1G71695  | PER12     | Peroxidase                                                                                              |
 | 160 | AT5G44990  | AT5G44990 | Glutathione S-transferase family protein                                                                |
 | 161 | AT3G45030  | RPS20C    | 40S ribosomal protein S20-1                                                                             |
 | 162 | AT1G65690  | NHL6      | NDR1/HIN1-like protein 6                                                                                |
 | 163 | AT1G26255  | AT1G26255 | None                                                                                                    |
 | 164 | AT4G02270  | RHS13     | At4g02270                                                                                               |
 | 165 | AT4G00360  | CYP86A2   | Cytochrome P450 86A2                                                                                    |
 | 166 | AT2G02100  | PDF2.2    | PDF2.2                                                                                                  |
 | 167 | AT3G50770  | CML41     | Probable calcium-binding protein CML41                                                                  |
 | 168 | AT4G26150  | GATA22    | Putative GATA transcription factor 22                                                                   |
 | 169 | AT2G29150  | AT2G29150 | Tropinone reductase homolog At2g29150                                                                   |
 | 170 | AT2G32990  | AtGH9B8   | Endoglucanase 11                                                                                        |
 | 171 | AT5G20630  | GER3      | Germin-like protein subfamily 3 member 3                                                                |
 | 172 | AT5G08610  | RH26      | PDE340                                                                                                  |
 | 173 | AT3G05730  | AT3G05730 | Defensin-like protein 205                                                                               |
 | 174 | AT3G44860  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                                             |
 | 175 | AT1G13520  | AT1G13520 | At1g13520                                                                                               |
 | 176 | AT1G08380  | PSAO      | PSAO                                                                                                    |
 | 177 | AT5G63140  | PAP29     | Probable inactive purple acid phosphatase 29                                                            |
 | 178 | AT5G66470  | AT5G66470 | GTPase ERA-like, chloroplastic                                                                          |
 | 179 | AT1G02660  | PLIP2     | Phospholipase A1 PLIP2, chloroplastic                                                                   |
 | 180 | AT1G78450  | AT1G78450 | F3F9.4                                                                                                  |
 | 181 | AT5G19750  | AT5G19750 | Peroxisomal membrane 22 kDa (Mpv17/PMP22) family protein                                                |
 | 182 | AT5G64040  | PSAN      | Photosystem I reaction center subunit PSI-N, chloroplast, putative / PSI-N, putative (PSAN)             |
 | 183 | AT4G29740  | CKX4      | Cytokinin dehydrogenase 4                                                                               |
 | 184 | AT1G18250  | ATLP-1    | Pathogenesis-related thaumatin superfamily protein                                                      |
 | 185 | AT3G18250  | AT3G18250 | Putative membrane lipoprotein                                                                           |
 | 186 | AT3G16670  | AT3G16670 | AT3g16670/MGL6_12                                                                                       |
 | 187 | AT1G18980  | AT1G18980 | At1g18980                                                                                               |
 | 188 | AT4G34290  | AT4G34290 | SWIB/MDM2 domain superfamily protein                                                                    |
 | 189 | AT3G46280  | AT3G46280 | Kinase-like protein                                                                                     |
 | 190 | AT4G20835  | AT4G20835 | None                                                                                                    |
 | 191 | AT1G66700  | PXMT1     | Paraxanthine methyltransferase 1                                                                        |
 | 192 | AT3G26445  | AT3G26445 | Beta-1,4-N-acetylglucosaminyltransferase family protein                                                 |
 | 193 | AT5G26920  | CBP60G    | Calmodulin-binding protein 60 G                                                                         |
 | 194 | AT5G16980  | AT5G16980 | Zinc-binding dehydrogenase family protein                                                               |
 | 195 | AT4G10530  | AT4G10530 | Subtilase family protein                                                                                |
 | 196 | AT3G54890  | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                                          |
 | 197 | AT2G28000  | CPN60A1   | SLP                                                                                                     |
 | 198 | AT4G24240  | WRKY7     | Probable WRKY transcription factor 7                                                                    |
 | 199 | AT2G41380  | AT2G41380 | At2g41380                                                                                               |
 | 200 | AT1G18570  | MYB51     | Transcription factor MYB51                                                                              |
 | 201 | AT3G56070  | CYP19-3   | Peptidyl-prolyl cis-trans isomerase CYP19-3                                                             |
 | 202 | AT5G08640  | FLS1      | Flavonol synthase/flavanone 3-hydroxylase                                                               |
 | 203 | AT1G06000  | UGT89C1   | Glycosyltransferase (Fragment)                                                                          |
 | 204 | AT4G30090  | AT4G30090 | Golgin family A protein                                                                                 |
 | 205 | AT5G56870  | BGAL4     | Beta-galactosidase 4                                                                                    |
 | 206 | AT5G42650  | CYP74A    | Allene oxide synthase, chloroplastic                                                                    |
 | 207 | AT4G29905  | AT4G29905 | Putative uncharacterized protein                                                                        |
 | 208 | AT2G46750  | GULLO2    | L-gulonolactone oxidase 2                                                                               |
 | 209 | AT5G13930  | CHS       | Chalcone synthase family protein                                                                        |
 | 210 | AT3G26830  | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase                                              |
 | 211 | AT2G45870  | AT2G45870 | UPF0187 protein At2g45870, chloroplastic                                                                |
 | 212 | AT1G32640  | MYC2      | ZBF1                                                                                                    |
 | 213 | AT4G03985  | AT4G03985 | None                                                                                                    |
 | 214 | AT4G12320  | CYP706A6  | At4g12320                                                                                               |
 | 215 | AT2G28740  | HIS4      | Histone H4                                                                                              |
 | 216 | AT2G25297  | AT2G25297 | None                                                                                                    |
 | 217 | AT5G06730  | PER54     | Peroxidase 54                                                                                           |
 | 218 | AT1G26420  | FOX5      | Berberine bridge enzyme-like 7                                                                          |
 | 219 | AT5G48657  | AT5G48657 | defense protein-related                                                                                 |
 | 220 | AT1G11300  | AT1G11300 | G-type lectin S-receptor-like serine/threonine-protein kinase At1g11300                                 |
 | 221 | AT4G32260  | AT4G32260 | PDE334                                                                                                  |
 | 222 | AT2G32650  | AT2G32650 | At2g32650                                                                                               |
 | 223 | AT1G21120  | AT1G21120 | O-methyltransferase family protein                                                                      |
 | 224 | AT1G72600  | AT1G72600 | At1g72600                                                                                               |
 | 225 | AT5G08070  | TCP17     | Transcription factor TCP17                                                                              |
 | 226 | AT5G57625  | AT5G57625 | At5g57625                                                                                               |
 | 227 | AT1G67030  | ZFP6      | Zinc finger protein 6                                                                                   |
 | 228 | AT1G72610  | GLP1      | Germin-like protein subfamily 3 member 1                                                                |
 | 229 | AT2G02930  | GSTF3     | Glutathione S-transferase F3                                                                            |
 | 230 | AT5G47500  | PME68     | Probable pectinesterase 68                                                                              |
 | 231 | AT5G07030  | AT5G07030 | Eukaryotic aspartyl protease family protein                                                             |
 | 232 | AT1G80850  | AT1G80850 | At1g80850                                                                                               |
 | 233 | AT1G51890  | AT1G51890 | Leucine-rich repeat protein kinase family protein                                                       |
 | 234 | AT2G18690  | AT2G18690 | Expressed protein                                                                                       |
 | 235 | AT2G48130  | AT2G48130 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | 236 | AT4G14780  | AT4G14780 | Kinase like protein                                                                                     |
 | 237 | AT2G34180  | CIPK13    | CBL-interacting serine/threonine-protein kinase 13                                                      |
 | 238 | AT4G15530  | PPDK      | Pyruvate, phosphate dikinase 1, chloroplastic                                                           |
 | 239 | AT1G32350  | AOX3      | AOX1D                                                                                                   |
 | 240 | AT1G07590  | AT1G07590 | Pentatricopeptide repeat-containing protein At1g07590, mitochondrial                                    |
 | 241 | AT5G26290  | AT5G26290 | TRAF-like family protein                                                                                |
 | 242 | AT5G11210  | GLR2.5    | Glutamate receptor 2.5                                                                                  |
 | 243 | AT4G24110  | AT4G24110 | NADP-specific glutamate dehydrogenase                                                                   |
 | 244 | AT4G01700  | AT4G01700 | At4g01700                                                                                               |
 | 245 | AT4G31500  | CYP83B1   | Cytochrome P450 83B1                                                                                    |
 | 246 | AT1G14870  | PCR2      | PCR2                                                                                                    |
 | 247 | AT2G39670  | AT2G39670 | Radical SAM superfamily protein                                                                         |
 | 248 | AT3G12930  | IJ        | Protein Iojap, chloroplastic                                                                            |
 | 249 | AT5G39110  | AT5G39110 | Germin-like protein subfamily 1 member 14                                                               |
 :END:


**** Forest on this RFE

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'lym' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [171]:
 # text/org
 | gene      |   importance | name      | description                                                                                             |
 |-----------+--------------+-----------+---------------------------------------------------------------------------------------------------------|
 | AT1G18250 |      0.0052  | ATLP-1    | Pathogenesis-related thaumatin superfamily protein                                                      |
 | AT2G27389 |      0.0052  | AT2G27389 | unknown protein                                                                                         |
 | AT4G26010 |      0.0051  | AT4G26010 | Peroxidase superfamily protein                                                                          |
 | AT2G45870 |      0.005   | AT2G45870 | UPF0187 protein At2g45870, chloroplastic                                                                |
 | AT4G00360 |      0.005   | CYP86A2   | Cytochrome P450 86A2                                                                                    |
 | AT2G36690 |      0.005   | AT2G36690 | 2-oxoglutarate (2OG) and Fe(II)-dependent oxygenase superfamily protein                                 |
 | AT5G49330 |      0.00495 | MYB111    | Transcription factor MYB111                                                                             |
 | AT1G67148 |      0.0049  | AT1G67148 | Putative uncharacterized protein                                                                        |
 | AT4G03985 |      0.0049  | AT4G03985 | None                                                                                                    |
 | AT3G26830 |      0.00485 | CYP71B15  | Bifunctional dihydrocamalexate synthase/camalexin synthase                                              |
 | AT4G23700 |      0.00485 | CHX17     | Cation/H(+) antiporter 17                                                                               |
 | AT3G06145 |      0.00485 | AT3G06145 | Putative RING zinc finger protein                                                                       |
 | AT4G34950 |      0.00485 | AT4G34950 | Major facilitator superfamily protein                                                                   |
 | AT3G01970 |      0.00485 | WRKY45    | Probable WRKY transcription factor 45                                                                   |
 | AT1G55020 |      0.0048  | LOX1      | Linoleate 9S-lipoxygenase 1                                                                             |
 | AT5G40780 |      0.0048  | LHT1      | Lysine histidine transporter 1                                                                          |
 | AT2G19990 |      0.00475 | PR-1-LIKE | PR-1-like protein                                                                                       |
 | AT5G63140 |      0.00475 | PAP29     | Probable inactive purple acid phosphatase 29                                                            |
 | AT3G50480 |      0.00475 | HR4       | RPW8-like protein 4                                                                                     |
 | AT4G02520 |      0.00475 | GSTF2     | Glutathione S-transferase F2                                                                            |
 | AT4G02510 |      0.00475 | TOC159    | Translocase of chloroplast 159, chloroplastic                                                           |
 | AT5G47500 |      0.0047  | PME68     | Probable pectinesterase 68                                                                              |
 | AT2G38870 |      0.0047  | AT2G38870 | Putative protease inhibitor                                                                             |
 | AT4G37370 |      0.0047  | CYP81D8   | Cytochrome P450, family 81, subfamily D, polypeptide 8                                                  |
 | AT1G64160 |      0.0047  | DIR5      | Dirigent protein 5                                                                                      |
 | AT2G26560 |      0.0047  | PLP2      | Patatin-like protein 2                                                                                  |
 | AT3G52450 |      0.0047  | PUB22     | RING-type E3 ubiquitin transferase                                                                      |
 | AT3G56090 |      0.0047  | FER3      | Ferritin-3, chloroplastic                                                                               |
 | AT5G66470 |      0.00465 | AT5G66470 | GTPase ERA-like, chloroplastic                                                                          |
 | AT2G29150 |      0.00465 | AT2G29150 | Tropinone reductase homolog At2g29150                                                                   |
 | AT3G28740 |      0.00465 | CYP81D11  | Cytochrome P450 81D11                                                                                   |
 | AT2G25297 |      0.00465 | AT2G25297 | None                                                                                                    |
 | AT2G15220 |      0.0046  | AT2G15220 | At2g15220/F15A23.4                                                                                      |
 | AT1G48570 |      0.0046  | AT1G48570 | T1N15.19                                                                                                |
 | AT3G04070 |      0.0046  | NAC047    | NAC transcription factor 47                                                                             |
 | AT1G18650 |      0.0046  | PDCB3     | PLASMODESMATA CALLOSE-BINDING PROTEIN 3                                                                 |
 | AT5G06730 |      0.0046  | PER54     | Peroxidase 54                                                                                           |
 | AT1G79680 |      0.0046  | WAKL10    | Wall-associated receptor kinase-like 10                                                                 |
 | AT2G19970 |      0.0046  | AT2G19970 | At2g19970                                                                                               |
 | AT3G48500 |      0.0046  | PDE312    | Nucleic acid-binding, OB-fold-like protein                                                              |
 | AT4G26150 |      0.00455 | GATA22    | Putative GATA transcription factor 22                                                                   |
 | AT4G14630 |      0.00455 | GLP9      | At4g14630                                                                                               |
 | AT4G10530 |      0.00455 | AT4G10530 | Subtilase family protein                                                                                |
 | AT3G05730 |      0.00455 | AT3G05730 | Defensin-like protein 205                                                                               |
 | AT4G21770 |      0.00455 | AT4G21770 | RNA pseudouridine synthase 6, chloroplastic                                                             |
 | AT3G14900 |      0.00455 | AT3G14900 | Uncharacterized protein At3g14900                                                                       |
 | AT4G14780 |      0.00455 | AT4G14780 | Kinase like protein                                                                                     |
 | AT2G18690 |      0.00455 | AT2G18690 | Expressed protein                                                                                       |
 | AT2G27402 |      0.00455 | AT2G27402 | At2g27402                                                                                               |
 | AT3G16420 |      0.0045  | PBP1      | PYK10-binding protein 1                                                                                 |
 | AT4G25810 |      0.0045  | XTH23     | Probable xyloglucan endotransglucosylase/hydrolase protein 23                                           |
 | AT3G51430 |      0.0045  | SSL5      | Protein STRICTOSIDINE SYNTHASE-LIKE 5                                                                   |
 | AT3G18250 |      0.0045  | AT3G18250 | Putative membrane lipoprotein                                                                           |
 | AT1G65490 |      0.0045  | AT1G65490 | unknown protein                                                                                         |
 | AT5G51720 |      0.0045  | NEET      | NEET                                                                                                    |
 | AT3G21305 |      0.0045  | AT3G21305 | None                                                                                                    |
 | AT1G69200 |      0.0045  | FLN2      | Fructokinase-like 2, chloroplastic                                                                      |
 | AT5G08610 |      0.0045  | RH26      | PDE340                                                                                                  |
 | AT1G59990 |      0.0045  | RH22      | DEAD-box ATP-dependent RNA helicase 22                                                                  |
 | AT1G26250 |      0.00445 | AT1G26250 | Proline-rich extensin-like family protein                                                               |
 | AT1G18570 |      0.00445 | MYB51     | Transcription factor MYB51                                                                              |
 | AT1G30700 |      0.00445 | AT1G30700 | Berberine bridge enzyme-like 8                                                                          |
 | AT5G11210 |      0.00445 | GLR2.5    | Glutamate receptor 2.5                                                                                  |
 | AT5G16980 |      0.00445 | AT5G16980 | Zinc-binding dehydrogenase family protein                                                               |
 | AT5G20230 |      0.00445 | BCB       | SAG14                                                                                                   |
 | AT5G58250 |      0.00445 | AT5G58250 | YCF54                                                                                                   |
 | AT1G26410 |      0.00445 | FOX4      | Berberine bridge enzyme-like 6                                                                          |
 | AT4G21760 |      0.00445 | BGLU47    | beta-glucosidase 47                                                                                     |
 | AT5G23310 |      0.0044  | FSD3      | Superoxide dismutase                                                                                    |
 | AT1G14870 |      0.0044  | PCR2      | PCR2                                                                                                    |
 | AT2G39670 |      0.0044  | AT2G39670 | Radical SAM superfamily protein                                                                         |
 | AT1G09750 |      0.0044  | AED3      | Aspartyl protease AED3                                                                                  |
 | AT1G13520 |      0.0044  | AT1G13520 | At1g13520                                                                                               |
 | AT2G02930 |      0.0044  | GSTF3     | Glutathione S-transferase F3                                                                            |
 | AT1G26255 |      0.00435 | AT1G26255 | None                                                                                                    |
 | AT1G02660 |      0.00435 | PLIP2     | Phospholipase A1 PLIP2, chloroplastic                                                                   |
 | AT3G09405 |      0.00435 | PAE4      | Pectin acetylesterase 4                                                                                 |
 | AT1G02920 |      0.00435 | GSTF7     | Glutathione S-transferase F7                                                                            |
 | AT3G48850 |      0.00435 | MPT2      | Mitochondrial phosphate carrier protein 2, mitochondrial                                                |
 | AT5G08640 |      0.00435 | FLS1      | Flavonol synthase/flavanone 3-hydroxylase                                                               |
 | AT3G62530 |      0.00435 | AT3G62530 | ARM repeat superfamily protein                                                                          |
 | AT2G17740 |      0.0043  | AT2G17740 | At2g17740                                                                                               |
 | AT4G15610 |      0.0043  | AT4G15610 | CASP-like protein 1D1                                                                                   |
 | AT5G20630 |      0.0043  | GER3      | Germin-like protein subfamily 3 member 3                                                                |
 | AT3G12930 |      0.0043  | IJ        | Protein Iojap, chloroplastic                                                                            |
 | AT5G05730 |      0.0043  | ASA1      | Anthranilate synthase alpha subunit 1                                                                   |
 | AT1G02930 |      0.0043  | GSTF6     | Glutathione S-transferase F6                                                                            |
 | AT5G03390 |      0.00425 | AT5G03390 | At5g03390                                                                                               |
 | AT5G48657 |      0.00425 | AT5G48657 | defense protein-related                                                                                 |
 | AT5G19890 |      0.00425 | PER59     | Peroxidase 59                                                                                           |
 | AT1G66700 |      0.00425 | PXMT1     | Paraxanthine methyltransferase 1                                                                        |
 | AT5G06865 |      0.00425 | AT5G06865 | other RNA                                                                                               |
 | AT2G24180 |      0.00425 | CYP71B6   | Cytochrome P450 71B6                                                                                    |
 | AT5G52050 |      0.00425 | DTX50     | Protein DETOXIFICATION 50                                                                               |
 | AT5G48880 |      0.00425 | KAT5      | PKT2                                                                                                    |
 | AT5G42830 |      0.0042  | AT5G42830 | HXXXD-type acyl-transferase family protein                                                              |
 | AT4G12320 |      0.0042  | CYP706A6  | At4g12320                                                                                               |
 | AT5G64120 |      0.0042  | PER71     | Peroxidase                                                                                              |
 | AT2G32650 |      0.0042  | AT2G32650 | At2g32650                                                                                               |
 | AT5G26920 |      0.00415 | CBP60G    | Calmodulin-binding protein 60 G                                                                         |
 | AT5G14330 |      0.00415 | AT5G14330 | Transmembrane protein                                                                                   |
 | AT5G44380 |      0.00415 | AT5G44380 | FAD-binding Berberine family protein                                                                    |
 | AT4G39950 |      0.00415 | CYP79B2   | cytochrome P450, family 79, subfamily B, polypeptide 2                                                  |
 | AT4G24110 |      0.00415 | AT4G24110 | NADP-specific glutamate dehydrogenase                                                                   |
 | AT1G10522 |      0.0041  | PRIN2     | Protein PLASTID REDOX INSENSITIVE 2, chloroplastic                                                      |
 | AT4G30720 |      0.0041  | AT4G30720 | FAD/NAD(P)-binding oxidoreductase family protein                                                        |
 | AT3G26210 |      0.0041  | CYP71B23  | Cytochrome P450 71B23                                                                                   |
 | AT1G71695 |      0.0041  | PER12     | Peroxidase                                                                                              |
 | AT3G46280 |      0.0041  | AT3G46280 | Kinase-like protein                                                                                     |
 | AT1G30530 |      0.0041  | UGT78D1   | Glycosyltransferase (Fragment)                                                                          |
 | AT5G67400 |      0.0041  | PER73     | Peroxidase                                                                                              |
 | AT5G19750 |      0.0041  | AT5G19750 | Peroxisomal membrane 22 kDa (Mpv17/PMP22) family protein                                                |
 | AT5G13930 |      0.0041  | CHS       | Chalcone synthase family protein                                                                        |
 | AT4G19370 |      0.0041  | AT4G19370 | Chitin synthase, putative (DUF1218)                                                                     |
 | AT4G37540 |      0.00405 | LBD39     | LOB domain-containing protein 39                                                                        |
 | AT4G34290 |      0.00405 | AT4G34290 | SWIB/MDM2 domain superfamily protein                                                                    |
 | AT5G07030 |      0.00405 | AT5G07030 | Eukaryotic aspartyl protease family protein                                                             |
 | AT1G67980 |      0.00405 | CCOAMT    | Putative caffeoyl-CoA O-methyltransferase At1g67980                                                     |
 | AT1G18970 |      0.00405 | GLP1      | Germin-like protein subfamily T member 1                                                                |
 | AT3G63380 |      0.00405 | ACA12     | Calcium-transporting ATPase                                                                             |
 | AT1G08757 |      0.00405 | AT1G08757 | None                                                                                                    |
 | AT3G54890 |      0.00405 | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                                          |
 | AT5G26340 |      0.00405 | STP13     | STP13                                                                                                   |
 | AT1G78450 |      0.00405 | AT1G78450 | F3F9.4                                                                                                  |
 | AT1G65690 |      0.004   | NHL6      | NDR1/HIN1-like protein 6                                                                                |
 | AT1G03630 |      0.004   | PORC      | Protochlorophyllide reductase C, chloroplastic                                                          |
 | AT5G38900 |      0.004   | AT5G38900 | Thioredoxin superfamily protein                                                                         |
 | AT3G18830 |      0.004   | PLT5      | PMT5                                                                                                    |
 | AT1G03220 |      0.004   | AT1G03220 | Eukaryotic aspartyl protease family protein                                                             |
 | AT1G26380 |      0.004   | FOX1      | Berberine bridge enzyme-like 3                                                                          |
 | AT5G39580 |      0.004   | PER62     | Peroxidase 62                                                                                           |
 | AT5G02780 |      0.004   | GSTL1     | Glutathione S-transferase L1                                                                            |
 | AT4G09040 |      0.00395 | AT4G09040 | At4g09040                                                                                               |
 | AT5G57220 |      0.00395 | CYP81F2   | Cytochrome P450 81F2                                                                                    |
 | AT5G13080 |      0.00395 | WRKY75    | WRKY75                                                                                                  |
 | AT1G14540 |      0.00395 | PER4      | Peroxidase                                                                                              |
 | AT1G69490 |      0.00395 | NAC029    | NAP                                                                                                     |
 | AT5G66530 |      0.00395 | AT5G66530 | Glucose-6-phosphate 1-epimerase                                                                         |
 | AT1G26420 |      0.00395 | FOX5      | Berberine bridge enzyme-like 7                                                                          |
 | AT5G14650 |      0.00395 | AT5G14650 | Pectin lyase-like superfamily protein                                                                   |
 | AT5G06860 |      0.00395 | PGIP1     | PGIP1                                                                                                   |
 | AT2G02100 |      0.00395 | PDF2.2    | PDF2.2                                                                                                  |
 | AT2G28000 |      0.00395 | CPN60A1   | SLP                                                                                                     |
 | AT3G25700 |      0.00395 | AT3G25700 | At3g25700                                                                                               |
 | AT2G48130 |      0.0039  | AT2G48130 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | AT1G51890 |      0.0039  | AT1G51890 | Leucine-rich repeat protein kinase family protein                                                       |
 | AT1G11300 |      0.0039  | AT1G11300 | G-type lectin S-receptor-like serine/threonine-protein kinase At1g11300                                 |
 | AT1G09310 |      0.0039  | AT1G09310 | T31J12.3 protein                                                                                        |
 | AT1G02730 |      0.0039  | CSLD5     | Cellulose synthase-like protein D5                                                                      |
 | AT3G09260 |      0.0039  | BGLU23    | PYK10                                                                                                   |
 | AT1G06000 |      0.0039  | UGT89C1   | Glycosyltransferase (Fragment)                                                                          |
 | AT1G18975 |      0.0039  | AT1G18975 | None                                                                                                    |
 | AT5G46580 |      0.0039  | AT5G46580 | Pentatricopeptide repeat-containing protein At5g46580, chloroplastic                                    |
 | AT5G58350 |      0.0039  | WNK4      | Probable serine/threonine-protein kinase WNK4                                                           |
 | AT4G20830 |      0.0039  | AT4G20830 | Berberine bridge enzyme-like 19                                                                         |
 | AT1G21120 |      0.0039  | AT1G21120 | O-methyltransferase family protein                                                                      |
 | AT1G06002 |      0.0039  | AT1G06002 | Potential natural antisense gene, locus overlaps with AT1G06000                                         |
 | AT4G34760 |      0.00385 | SAUR50    | Auxin-responsive protein SAUR50                                                                         |
 | AT3G01420 |      0.00385 | DOX1      | Alpha-dioxygenase 1                                                                                     |
 | AT1G15260 |      0.0038  | AT1G15260 | LOW protein: ATP-dependent RNA helicase-like protein                                                    |
 | AT5G54810 |      0.00375 | TSB1      | Tryptophan synthase                                                                                     |
 | AT3G03670 |      0.00375 | PER28     | Peroxidase 28                                                                                           |
 | AT2G46750 |      0.00375 | GULLO2    | L-gulonolactone oxidase 2                                                                               |
 | AT5G44990 |      0.0037  | AT5G44990 | Glutathione S-transferase family protein                                                                |
 | AT4G01700 |      0.0037  | AT4G01700 | At4g01700                                                                                               |
 | AT3G16400 |      0.0037  | NSP1      | Nitrile-specifier protein 1                                                                             |
 | AT4G24780 |      0.00365 | AT4G24780 | Probable pectate lyase 18                                                                               |
 | AT2G41380 |      0.0036  | AT2G41380 | At2g41380                                                                                               |
 | AT4G28420 |      0.00355 | AT4G28420 | Probable aminotransferase TAT1                                                                          |
 | AT4G19420 |      0.00355 | AT4G19420 | Pectinacetylesterase family protein                                                                     |
 | AT3G18420 |      0.0035  | SG1       | protein SLOW GREEN 1, chloroplastic                                                                     |
 | AT4G20835 |      0.00345 | AT4G20835 | None                                                                                                    |
 | AT5G15780 |      0.00345 | AT5G15780 | At5g15780                                                                                               |
 | AT3G50770 |      0.00345 | CML41     | Probable calcium-binding protein CML41                                                                  |
 | AT1G26240 |      0.00345 | AT1G26240 | Proline-rich extensin-like family protein                                                               |
 | AT5G55280 |      0.00345 | FTSZ1     | Cell division protein FtsZ homolog 1, chloroplastic                                                     |
 | AT5G39110 |      0.0034  | AT5G39110 | Germin-like protein subfamily 1 member 14                                                               |
 | AT4G01037 |      0.00335 | WTF1      | WTF1                                                                                                    |
 | AT1G62510 |      0.0033  | AT1G62510 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein               |
 | AT5G55580 |      0.0033  | MTERF9    | Transcription termination factor MTERF9, chloroplastic                                                  |
 | AT4G15530 |      0.0033  | PPDK      | Pyruvate, phosphate dikinase 1, chloroplastic                                                           |
 | AT4G31500 |      0.0032  | CYP83B1   | Cytochrome P450 83B1                                                                                    |
 | AT5G05735 |      0.003   | AT5G05735 | None                                                                                                    |
 | AT4G18730 |      0.0029  | RPL11C    | 60S ribosomal protein L11-2                                                                             |
 | AT1G72600 |      0.00285 | AT1G72600 | At1g72600                                                                                               |
 | AT3G24300 |      0.0028  | AMT1-3    | Ammonium transporter 1 member 3                                                                         |
 | AT1G72610 |      0.00265 | GLP1      | Germin-like protein subfamily 3 member 1                                                                |
 | AT3G25790 |      0.0026  | HHO1      | Transcription factor HHO1                                                                               |
 | AT3G56070 |      0.0026  | CYP19-3   | Peptidyl-prolyl cis-trans isomerase CYP19-3                                                             |
 | AT4G35730 |      0.0026  | AT4G35730 | Regulator of Vps4 activity in the MVB pathway protein                                                   |
 | AT5G08070 |      0.00255 | TCP17     | Transcription factor TCP17                                                                              |
 | AT3G58990 |      0.00255 | IPMI1     | 3-isopropylmalate dehydratase small subunit 2                                                           |
 | AT5G26290 |      0.00255 | AT5G26290 | TRAF-like family protein                                                                                |
 | AT2G32990 |      0.00255 | AtGH9B8   | Endoglucanase 11                                                                                        |
 | AT2G28740 |      0.0025  | HIS4      | Histone H4                                                                                              |
 | AT1G51700 |      0.0025  | DOF1.7    | Dof zinc finger protein DOF1.7                                                                          |
 | AT2G43120 |      0.0025  | AT2G43120 | RmlC-like cupins superfamily protein                                                                    |
 | AT1G18980 |      0.00245 | AT1G18980 | At1g18980                                                                                               |
 | AT5G11550 |      0.0024  | AT5G11550 | ARM repeat superfamily protein                                                                          |
 | AT1G80850 |      0.0024  | AT1G80850 | At1g80850                                                                                               |
 | AT1G67030 |      0.0024  | ZFP6      | Zinc finger protein 6                                                                                   |
 | AT4G30090 |      0.00235 | AT4G30090 | Golgin family A protein                                                                                 |
 | AT3G45030 |      0.00235 | RPS20C    | 40S ribosomal protein S20-1                                                                             |
 | AT5G57625 |      0.00235 | AT5G57625 | At5g57625                                                                                               |
 | AT1G05523 |      0.0023  | AT1G05523 | None                                                                                                    |
 | AT1G52245 |      0.0023  | AT1G52245 | Dynein light chain                                                                                      |
 | AT3G26445 |      0.00225 | AT3G26445 | Beta-1,4-N-acetylglucosaminyltransferase family protein                                                 |
 | AT2G34180 |      0.00225 | CIPK13    | CBL-interacting serine/threonine-protein kinase 13                                                      |
 | AT4G02290 |      0.00225 | AtGH9B13  | Endoglucanase 17                                                                                        |
 | AT1G32640 |      0.0022  | MYC2      | ZBF1                                                                                                    |
 | AT2G12170 |      0.0022  | AT2G12170 | BEST Arabidopsis thaliana protein match is: Transcriptional factor B3 family protein (TAIR:AT2G24645.1) |
 | AT5G56870 |      0.0021  | BGAL4     | Beta-galactosidase 4                                                                                    |
 | AT4G29905 |      0.0021  | AT4G29905 | Putative uncharacterized protein                                                                        |
 | AT4G29390 |      0.0021  | RPS30A    | 40S ribosomal protein S30                                                                               |
 | AT3G16670 |      0.00205 | AT3G16670 | AT3g16670/MGL6_12                                                                                       |
 | AT5G64040 |      0.00205 | PSAN      | Photosystem I reaction center subunit PSI-N, chloroplast, putative / PSI-N, putative (PSAN)             |
 | AT1G13930 |      0.00205 | AT1G13930 | At1g13930/F16A14.27                                                                                     |
 | AT1G07590 |      0.00205 | AT1G07590 | Pentatricopeptide repeat-containing protein At1g07590, mitochondrial                                    |
 | AT2G41310 |      0.002   | ARR8      | Two-component response regulator ARR8                                                                   |
 | AT1G21400 |      0.002   | AT1G21400 | Thiamin diphosphate-binding fold (THDP-binding) superfamily protein                                     |
 | AT4G32260 |      0.002   | AT4G32260 | PDE334                                                                                                  |
 | AT1G32350 |      0.002   | AOX3      | AOX1D                                                                                                   |
 | AT2G24850 |      0.002   | TAT3      | Probable aminotransferase TAT3                                                                          |
 | AT3G54580 |      0.002   | AT3G54580 | Proline-rich extensin-like family protein                                                               |
 | AT5G24660 |      0.00195 | LSU2      | Protein RESPONSE TO LOW SULFUR 2                                                                        |
 | AT4G29740 |      0.00195 | CKX4      | Cytokinin dehydrogenase 4                                                                               |
 | AT2G36750 |      0.00195 | UGT73C1   | UDP-glycosyltransferase 73C1                                                                            |
 | AT5G64890 |      0.00185 | PEP2      | Elicitor peptide 2                                                                                      |
 | AT5G49480 |      0.00185 | ATCP1     | Calcium-binding protein CP1                                                                             |
 | AT4G00050 |      0.0018  | UNE10     | Transcription factor UNE10                                                                              |
 | AT1G76680 |      0.0018  | OPR1      | 12-oxophytodienoate reductase 1                                                                         |
 | AT4G25740 |      0.0018  | RPS10A    | 40S ribosomal protein S10-1                                                                             |
 | AT5G20790 |      0.0018  | AT5G20790 | unknown protein                                                                                         |
 | AT2G41810 |      0.00175 | AT2G41810 | Uncharacterized protein At2g41810                                                                       |
 | AT3G44860 |      0.00175 | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                                             |
 | AT2G10940 |      0.0017  | AT2G10940 | At2g10940/F15K19.1                                                                                      |
 | AT5G56670 |      0.0017  | RPS30A    | 40S ribosomal protein S30                                                                               |
 | AT1G15885 |      0.00165 | AT1G15885 | Putative uncharacterized protein                                                                        |
 | AT1G29720 |      0.00155 | RFK1      | Probable LRR receptor-like serine/threonine-protein kinase At1g29720                                    |
 | AT3G55660 |      0.00155 | ROPGEF6   | Rop guanine nucleotide exchange factor 6                                                                |
 | AT2G46840 |      0.00155 | DUF4      | DUF4                                                                                                    |
 | AT4G24240 |      0.00155 | WRKY7     | Probable WRKY transcription factor 7                                                                    |
 | AT1G21100 |      0.0015  | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                              |
 | AT1G28290 |      0.0015  | AGP31     | Non-classical arabinogalactan protein 31                                                                |
 | AT3G13950 |      0.00145 | AT3G13950 | AT3G13950 protein                                                                                       |
 | AT5G42650 |      0.00145 | CYP74A    | Allene oxide synthase, chloroplastic                                                                    |
 | AT4G02270 |      0.00135 | RHS13     | At4g02270                                                                                               |
 | AT5G40730 |      0.00135 | AGP24     | Arabinogalactan peptide 24                                                                              |
 | AT2G27710 |      0.00135 | RPP2B     | AT2G27710 protein                                                                                       |
 | AT1G08380 |      0.0011  | PSAO      | PSAO                                                                                                    |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [172]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/1b47b6aac6dd71371ddfe0c230d6ff5c321ce636.png]]
 :END:

* Selecting genes for cerk at 6hr C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature

   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'cer' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [173]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [174]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [1495 3444 1024 ... 3880 3146  939]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [175]:
 # text/org
 |    | incoming   | name      | description                                                                               |
 |----+------------+-----------+-------------------------------------------------------------------------------------------|
 |  0 | AT5G57540  | XTH13     | Putative xyloglucan endotransglucosylase/hydrolase protein 13                             |
 |  1 | AT4G22475  | AT4G22475 | Transmembrane protein                                                                     |
 |  2 | AT3G53150  | UGT73D1   | UDP-glucosyl transferase 73D1                                                             |
 |  3 | AT5G42800  | DFRA      | Dihydroflavonol reductase                                                                 |
 |  4 | AT3G01840  | LYK2      | Protein LYK2                                                                              |
 |  5 | AT1G71030  | ATMYBL2   | At1g71030/F23N20_2                                                                        |
 |  6 | AT5G38930  | AT5G38930 | Germin-like protein subfamily 1 member 10                                                 |
 |  7 | AT4G23680  | AT4G23680 | AT4g23680/F9D16_150                                                                       |
 |  8 | AT4G23030  | DTX49     | Protein DETOXIFICATION 49                                                                 |
 |  9 | AT5G45240  | AT5G45240 | Disease resistance protein (TIR-NBS-LRR class)                                            |
 | 10 | AT5G49360  | BXL1      | Beta-D-xylosidase 1                                                                       |
 | 11 | AT2G19190  | SIRK      | Senescence-induced receptor-like serine/threonine-protein kinase                          |
 | 12 | AT2G28630  | KCS12     | 3-ketoacyl-CoA synthase 12                                                                |
 | 13 | AT1G62500  | AT1G62500 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | 14 | AT5G40400  | AT5G40400 | Pentatricopeptide repeat (PPR) superfamily protein                                        |
 | 15 | AT4G22485  | AT4G22485 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | 16 | AT4G22495  | AT4G22495 | None                                                                                      |
 | 17 | AT3G60415  | AT3G60415 | At3g60420                                                                                 |
 | 18 | AT2G35980  | NHL10     | NDR1/HIN1-like protein 10                                                                 |
 | 19 | AT2G38530  | LTP2      | Non-specific lipid-transfer protein                                                       |
 | 20 | AT4G04700  | CPK27     | Calcium-dependent protein kinase 27                                                       |
 | 21 | AT2G38210  | PDX1L4    | Pyridoxal 5'-phosphate synthase PDX1-like 4                                               |
 | 22 | AT5G50790  | SWEET10   | Bidirectional sugar transporter SWEET10                                                   |
 | 23 | AT4G04540  | CRK39     | Putative cysteine-rich receptor-like protein kinase 39                                    |
 | 24 | AT1G70175  | AT1G70175 | None                                                                                      |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'cer' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [176]:
 # text/org
 | gene      |   importance | name      | description                                                                               |
 |-----------+--------------+-----------+-------------------------------------------------------------------------------------------|
 | AT5G38930 |      0.04515 | AT5G38930 | Germin-like protein subfamily 1 member 10                                                 |
 | AT4G04540 |      0.04435 | CRK39     | Putative cysteine-rich receptor-like protein kinase 39                                    |
 | AT5G40400 |      0.04295 | AT5G40400 | Pentatricopeptide repeat (PPR) superfamily protein                                        |
 | AT3G60415 |      0.0426  | AT3G60415 | At3g60420                                                                                 |
 | AT1G70175 |      0.04245 | AT1G70175 | None                                                                                      |
 | AT4G23030 |      0.04215 | DTX49     | Protein DETOXIFICATION 49                                                                 |
 | AT5G50790 |      0.04195 | SWEET10   | Bidirectional sugar transporter SWEET10                                                   |
 | AT4G22485 |      0.0419  | AT4G22485 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | AT5G45240 |      0.0418  | AT5G45240 | Disease resistance protein (TIR-NBS-LRR class)                                            |
 | AT2G28630 |      0.04175 | KCS12     | 3-ketoacyl-CoA synthase 12                                                                |
 | AT2G38530 |      0.04165 | LTP2      | Non-specific lipid-transfer protein                                                       |
 | AT2G19190 |      0.04165 | SIRK      | Senescence-induced receptor-like serine/threonine-protein kinase                          |
 | AT1G62500 |      0.0416  | AT1G62500 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | AT5G57540 |      0.04145 | XTH13     | Putative xyloglucan endotransglucosylase/hydrolase protein 13                             |
 | AT4G04700 |      0.04115 | CPK27     | Calcium-dependent protein kinase 27                                                       |
 | AT2G38210 |      0.04025 | PDX1L4    | Pyridoxal 5'-phosphate synthase PDX1-like 4                                               |
 | AT2G35980 |      0.04    | NHL10     | NDR1/HIN1-like protein 10                                                                 |
 | AT3G01840 |      0.0397  | LYK2      | Protein LYK2                                                                              |
 | AT3G53150 |      0.0392  | UGT73D1   | UDP-glucosyl transferase 73D1                                                             |
 | AT5G42800 |      0.0222  | DFRA      | Dihydroflavonol reductase                                                                 |
 | AT4G22475 |      0.0217  | AT4G22475 | Transmembrane protein                                                                     |
 | AT4G22495 |      0.021   | AT4G22495 | None                                                                                      |
 | AT1G71030 |      0.02055 | ATMYBL2   | At1g71030/F23N20_2                                                                        |
 | AT5G49360 |      0.01745 | BXL1      | Beta-D-xylosidase 1                                                                       |
 | AT4G23680 |      0.01635 | AT4G23680 | AT4g23680/F9D16_150                                                                       |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance', ax=ax)
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [177]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/823bb9a59b4378bbd61f075dc9aba91fb69f829f.png]]
 :END:


** RFE selecting 250 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_6hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_6hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.05]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if ('6h' in c and 'cer' in c)]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [178]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=250)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [179]:
 # output
 Num Features: 250
 Selected Features: [False False False ... False False False]
 Feature Ranking: [1270 3219  799 ... 3655 2921  714]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC



 #+RESULTS:
 :RESULTS:
 # Out [180]:
 # text/org
 |     | incoming   | name      | description                                                                               |
 |-----+------------+-----------+-------------------------------------------------------------------------------------------|
 |   0 | AT4G26560  | CBL7      | Calcineurin B-like protein 7                                                              |
 |   1 | AT1G73805  | SARD1     | Protein SAR DEFICIENT 1                                                                   |
 |   2 | AT1G08630  | THA1      | Probable low-specificity L-threonine aldolase 1                                           |
 |   3 | AT1G19330  | AT1G19330 | unknown protein                                                                           |
 |   4 | AT5G58620  | AT5G58620 | Zinc finger CCCH domain-containing protein 66                                             |
 |   5 | AT3G22600  | AT3G22600 | AT3g22600/F16J14_17                                                                       |
 |   6 | AT4G23670  | AT4G23670 | AT4G23670 protein                                                                         |
 |   7 | AT1G13530  | AT1G13530 | Protein of unknown function (DUF1262)                                                     |
 |   8 | AT5G40170  | AtRLP54   | Receptor-like protein 54                                                                  |
 |   9 | AT3G22886  | MIR167A   | MIR167A                                                                                   |
 |  10 | AT5G45340  | CYP707A3  | Abscisic acid 8'-hydroxylase 3                                                            |
 |  11 | AT5G57540  | XTH13     | Putative xyloglucan endotransglucosylase/hydrolase protein 13                             |
 |  12 | AT5G52670  | AT5G52670 | Copper transport protein family                                                           |
 |  13 | AT4G03600  | AT4G03600 | Pyrroline-5-carboxylate reductase                                                         |
 |  14 | AT1G29460  | AT1G29460 | SAUR-like auxin-responsive protein family                                                 |
 |  15 | AT1G72240  | AT1G72240 | Uncharacterized protein T9N14.5                                                           |
 |  16 | AT1G67856  | AT1G67856 | RING/U-box superfamily protein                                                            |
 |  17 | AT1G23550  | SRO2      | Probable inactive poly                                                                    |
 |  18 | AT2G47800  | ABCC4     | ABC transporter C family member 4                                                         |
 |  19 | AT4G13820  | AT4G13820 | Disease resistance like protein                                                           |
 |  20 | AT4G22475  | AT4G22475 | Transmembrane protein                                                                     |
 |  21 | AT4G14860  | OFP11     | Transcription repressor OFP11                                                             |
 |  22 | AT5G19890  | PER59     | Peroxidase 59                                                                             |
 |  23 | AT5G44578  | AT5G44578 | unknown protein                                                                           |
 |  24 | AT3G53150  | UGT73D1   | UDP-glucosyl transferase 73D1                                                             |
 |  25 | AT4G22490  | AT4G22490 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 |  26 | AT2G02880  | AT2G02880 | Mucin-like protein                                                                        |
 |  27 | AT5G25250  | FLOT1     | Flotillin-like protein 1                                                                  |
 |  28 | AT3G52060  | AT3G52060 | GnTL                                                                                      |
 |  29 | AT5G57345  | AT5G57345 | At5g57345                                                                                 |
 |  30 | AT1G77640  | ERF013    | Ethylene-responsive transcription factor ERF013                                           |
 |  31 | AT4G14450  | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                          |
 |  32 | AT1G76680  | OPR1      | 12-oxophytodienoate reductase 1                                                           |
 |  33 | AT5G61570  | AT5G61570 | Protein kinase superfamily protein                                                        |
 |  34 | AT5G42800  | DFRA      | Dihydroflavonol reductase                                                                 |
 |  35 | AT2G02990  | RNS1      | Ribonuclease 1                                                                            |
 |  36 | AT5G43160  | QWRF9     | Family of unknown function (DUF566)                                                       |
 |  37 | AT1G55420  | EDA11     | Cysteine/Histidine-rich C1 domain family protein                                          |
 |  38 | AT4G23700  | CHX17     | Cation/H(+) antiporter 17                                                                 |
 |  39 | AT3G29170  | AT3G29170 | At3g29170                                                                                 |
 |  40 | AT1G72910  | AT1G72910 | Similar to part of disease resistance protein                                             |
 |  41 | AT4G11660  | HSFB2B    | Heat stress transcription factor B-2b                                                     |
 |  42 | AT1G14170  | AT1G14170 | F7A19.25 protein                                                                          |
 |  43 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                                                                     |
 |  44 | AT5G60800  | AT5G60800 | Heavy metal transport/detoxification superfamily protein                                  |
 |  45 | AT2G15220  | AT2G15220 | At2g15220/F15A23.4                                                                        |
 |  46 | AT3G28580  | AT3G28580 | AAA-ATPase At3g28580                                                                      |
 |  47 | AT1G29500  | SAUR66    | Auxin-responsive protein SAUR66                                                           |
 |  48 | AT1G61610  | AT1G61610 | Serine/threonine-protein kinase                                                           |
 |  49 | AT1G22500  | ATL15     | E3 ubiquitin-protein ligase ATL15                                                         |
 |  50 | AT3G08870  | AT3G08870 | Concanavalin A-like lectin protein kinase family protein                                  |
 |  51 | AT2G36790  | UGT73C6   | Glycosyltransferase (Fragment)                                                            |
 |  52 | AT1G15100  | RHA2A     | E3 ubiquitin-protein ligase RHA2A                                                         |
 |  53 | AT5G10520  | RBK1      | RBK1                                                                                      |
 |  54 | AT3G46930  | AT3G46930 | Protein kinase superfamily protein                                                        |
 |  55 | AT1G15010  | AT1G15010 | Mediator of RNA polymerase II transcription subunit                                       |
 |  56 | AT1G78460  | AT1G78460 | AT1G78460 protein                                                                         |
 |  57 | AT1G61860  | AT1G61860 | Protein kinase superfamily protein                                                        |
 |  58 | AT4G35070  | AT4G35070 | At4g35070                                                                                 |
 |  59 | AT5G11680  | AT5G11680 | Classical AGP protein                                                                     |
 |  60 | AT5G43790  | PCMP-E30  | Pentatricopeptide repeat-containing protein At5g43790                                     |
 |  61 | AT1G54970  | PRP1      | Proline-rich protein 1                                                                    |
 |  62 | AT5G43180  | AT5G43180 | At5g43180                                                                                 |
 |  63 | AT4G17500  | ERF1A     | Ethylene-responsive transcription factor 1A                                               |
 |  64 | AT4G01390  | AT4G01390 | TRAF-like family protein                                                                  |
 |  65 | AT2G45480  | GRF9      | Growth-regulating factor 9                                                                |
 |  66 | AT1G51850  | AT1G51850 | Leucine-rich repeat protein kinase family protein                                         |
 |  67 | AT1G07135  | AT1G07135 | At1g07135                                                                                 |
 |  68 | AT1G51270  | AT1G51270 | Vesicle-associated protein 1-4                                                            |
 |  69 | AT3G47090  | AT3G47090 | Leucine-rich repeat protein kinase family protein                                         |
 |  70 | AT2G37100  | AT2G37100 | Protamine P1 family protein                                                               |
 |  71 | AT1G36640  | AT1G36640 | Transmembrane protein                                                                     |
 |  72 | AT1G07530  | SCL14     | AT1G07530 protein                                                                         |
 |  73 | AT1G05675  | UGT74E1   | Glycosyltransferase (Fragment)                                                            |
 |  74 | AT1G21100  | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                |
 |  75 | AT1G35710  | AT1G35710 | Probable leucine-rich repeat receptor-like protein kinase At1g35710                       |
 |  76 | AT3G02130  | RPK2      | LRR receptor-like serine/threonine-protein kinase RPK2                                    |
 |  77 | AT3G01840  | LYK2      | Protein LYK2                                                                              |
 |  78 | AT5G48880  | KAT5      | PKT2                                                                                      |
 |  79 | AT1G71030  | ATMYBL2   | At1g71030/F23N20_2                                                                        |
 |  80 | AT1G62610  | AT1G62610 | NAD(P)-binding Rossmann-fold superfamily protein                                          |
 |  81 | AT1G51860  | AT1G51860 | Probable LRR receptor-like serine/threonine-protein kinase At1g51860                      |
 |  82 | AT2G22980  | SCPL13    | Serine carboxypeptidase-like 13                                                           |
 |  83 | AT1G24147  | AT1G24147 | Transmembrane protein                                                                     |
 |  84 | AT4G22080  | RHS14     | Probable pectate lyase 16                                                                 |
 |  85 | AT5G38930  | AT5G38930 | Germin-like protein subfamily 1 member 10                                                 |
 |  86 | AT5G26340  | STP13     | STP13                                                                                     |
 |  87 | AT2G25460  | AT2G25460 | CONTAINS InterPro DOMAIN/s: C2 calcium-dependent membrane targeting (InterPro:IPR000008)  |
 |  88 | AT2G20142  | AT2G20142 | Toll-Interleukin-Resistance (TIR) domain family protein                                   |
 |  89 | AT5G59070  | AT5G59070 | UDP-Glycosyltransferase superfamily protein                                               |
 |  90 | AT4G39830  | AT4G39830 | At4g39830                                                                                 |
 |  91 | AT2G39980  | AT2G39980 | At2g39980/T28M21.14                                                                       |
 |  92 | AT4G13180  | AT4G13180 | AT4g13180/F17N18_70                                                                       |
 |  93 | AT4G28490  | RLK5      | Receptor-like protein kinase 5                                                            |
 |  94 | AT1G66090  | AT1G66090 | Disease resistance protein (TIR-NBS class)                                                |
 |  95 | AT4G08950  | EXO       | Protein EXORDIUM                                                                          |
 |  96 | AT2G25125  | AT2G25125 | None                                                                                      |
 |  97 | AT2G26560  | PLP2      | Patatin-like protein 2                                                                    |
 |  98 | AT4G23680  | AT4G23680 | AT4g23680/F9D16_150                                                                       |
 |  99 | AT4G23030  | DTX49     | Protein DETOXIFICATION 49                                                                 |
 | 100 | AT5G45240  | AT5G45240 | Disease resistance protein (TIR-NBS-LRR class)                                            |
 | 101 | AT2G32660  | AtRLP22   | Receptor like protein 22                                                                  |
 | 102 | AT3G13650  | DIR7      | Dirigent protein 7                                                                        |
 | 103 | AT5G10650  | AT5G10650 | At5g10650                                                                                 |
 | 104 | AT5G20670  | AT5G20670 | At5g20670                                                                                 |
 | 105 | AT5G65500  | AT5G65500 | U-box domain-containing protein kinase family protein                                     |
 | 106 | AT4G21380  | SD18      | Receptor-like serine/threonine-protein kinase SD1-8                                       |
 | 107 | AT4G11890  | AT4G11890 | Protein kinase superfamily protein                                                        |
 | 108 | AT5G03830  | AT5G03830 | CDK inhibitor P21 binding protein                                                         |
 | 109 | AT4G33720  | AT4G33720 | AT4g33720/T16L1_210                                                                       |
 | 110 | AT5G49360  | BXL1      | Beta-D-xylosidase 1                                                                       |
 | 111 | AT4G27980  | AT4G27980 | Domain of unknown function (DUF3444)                                                      |
 | 112 | AT2G19190  | SIRK      | Senescence-induced receptor-like serine/threonine-protein kinase                          |
 | 113 | AT4G24810  | AT4G24810 | Protein kinase superfamily protein                                                        |
 | 114 | AT3G19850  | AT3G19850 | BTB/POZ domain-containing protein At3g19850                                               |
 | 115 | AT5G05300  | AT5G05300 | Gb                                                                                        |
 | 116 | AT1G20870  | IDM3      | Increased DNA methylation 3                                                               |
 | 117 | AT2G42840  | PDF1      | Protodermal factor 1                                                                      |
 | 118 | AT2G24850  | TAT3      | Probable aminotransferase TAT3                                                            |
 | 119 | AT1G33760  | ERF022    | Ethylene-responsive transcription factor ERF022                                           |
 | 120 | AT3G48450  | AT3G48450 | At3g48450                                                                                 |
 | 121 | AT5G57560  | XTH22     | Xyloglucan endotransglucosylase/hydrolase                                                 |
 | 122 | AT2G28630  | KCS12     | 3-ketoacyl-CoA synthase 12                                                                |
 | 123 | AT4G05910  | AT4G05910 | None                                                                                      |
 | 124 | AT2G21050  | LAX2      | Auxin transporter-like protein 2                                                          |
 | 125 | AT1G62500  | AT1G62500 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | 126 | AT1G72900  | AT1G72900 | Similar to part of disease resistance protein                                             |
 | 127 | AT1G70190  | AT1G70190 | F20P5.9 protein                                                                           |
 | 128 | AT2G22790  | AT2G22790 | Uncharacterized protein At2g22790                                                         |
 | 129 | AT1G67855  | AT1G67855 | unknown protein                                                                           |
 | 130 | AT1G69790  | PBL18     | Probable serine/threonine-protein kinase PBL18                                            |
 | 131 | AT3G25790  | HHO1      | Transcription factor HHO1                                                                 |
 | 132 | AT5G65410  | ZHD1      | Zinc-finger homeodomain protein 1                                                         |
 | 133 | AT3G29400  | ATEXO70E1 | Exocyst subunit Exo70 family protein                                                      |
 | 134 | AT1G31050  | AT1G31050 | basic helix-loop-helix (bHLH) DNA-binding superfamily protein                             |
 | 135 | AT1G50750  | AT1G50750 | Plant mobile domain protein family                                                        |
 | 136 | AT4G11000  | AT4G11000 | Ankyrin repeat family protein                                                             |
 | 137 | AT5G40400  | AT5G40400 | Pentatricopeptide repeat (PPR) superfamily protein                                        |
 | 138 | AT4G21903  | AT4G21903 | Protein DETOXIFICATION                                                                    |
 | 139 | AT2G35640  | AT2G35640 | Homeodomain-like superfamily protein                                                      |
 | 140 | AT5G46570  | BSK2      | Serine/threonine-protein kinase BSK2                                                      |
 | 141 | AT1G12780  | UGE1      | Bifunctional UDP-glucose 4-epimerase and UDP-xylose 4-epimerase 1                         |
 | 142 | AT3G11080  | AtRLP35   | Receptor-like protein 35                                                                  |
 | 143 | AT2G46600  | KIC       | Calcium-binding protein KIC                                                               |
 | 144 | AT4G22485  | AT4G22485 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | 145 | AT4G23210  | CRK13     | Cysteine-rich receptor-like protein kinase 13                                             |
 | 146 | AT5G41740  | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                                     |
 | 147 | AT1G66500  | PCFS1     | Polyadenylation and cleavage factor homolog 1                                             |
 | 148 | AT3G16400  | NSP1      | Nitrile-specifier protein 1                                                               |
 | 149 | AT3G51570  | AT3G51570 | Disease resistance protein (TIR-NBS-LRR class) family                                     |
 | 150 | AT3G43580  | AT3G43580 | At3g43580                                                                                 |
 | 151 | AT1G02310  | MAN1      | MAN1                                                                                      |
 | 152 | AT2G41231  | AT2G41231 | unknown protein.                                                                          |
 | 153 | AT4G33220  | PME44     | Probable pectinesterase/pectinesterase inhibitor 44                                       |
 | 154 | AT4G22495  | AT4G22495 | None                                                                                      |
 | 155 | AT3G49620  | DIN11     | Probable 2-oxoglutarate-dependent dioxygenase DIN11                                       |
 | 156 | AT3G46090  | ZAT7      | ZAT7                                                                                      |
 | 157 | AT3G55090  | ABCG16    | ABC transporter G family member 16                                                        |
 | 158 | AT3G60415  | AT3G60415 | At3g60420                                                                                 |
 | 159 | AT1G55020  | LOX1      | Linoleate 9S-lipoxygenase 1                                                               |
 | 160 | AT1G59860  | HSP17.6A  | 17.6 kDa class I heat shock protein 1                                                     |
 | 161 | AT3G18950  | AT3G18950 | En/Spm-like transposon protein-like                                                       |
 | 162 | AT5G21900  | AT5G21900 | At5g21900                                                                                 |
 | 163 | AT2G35980  | NHL10     | NDR1/HIN1-like protein 10                                                                 |
 | 164 | AT1G75240  | ZHD5      | ZHD5                                                                                      |
 | 165 | AT5G51670  | AT5G51670 | Similarity to unknown protein                                                             |
 | 166 | AT3G01175  | AT3G01175 | Transmembrane protein                                                                     |
 | 167 | AT1G27370  | SPL10     | Squamosa promoter-binding-like protein 10                                                 |
 | 168 | AT2G38530  | LTP2      | Non-specific lipid-transfer protein                                                       |
 | 169 | AT4G31875  | AT4G31875 | At4g31872/At4g31872                                                                       |
 | 170 | AT3G50800  | AT3G50800 | Uncharacterized protein At3g50800                                                         |
 | 171 | AT5G16170  | AT5G16170 | At5g16170                                                                                 |
 | 172 | AT5G27830  | AT5G27830 | FUNCTIONS IN: molecular_function unknown                                                  |
 | 173 | AT3G44860  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                               |
 | 174 | AT1G13520  | AT1G13520 | At1g13520                                                                                 |
 | 175 | AT2G21210  | AT2G21210 | SAUR-like auxin-responsive protein family                                                 |
 | 176 | AT1G22890  | AT1G22890 | AT1G22890 protein                                                                         |
 | 177 | AT3G23120  | AtRLP38   | Receptor-like protein 38                                                                  |
 | 178 | AT5G51465  | AT5G51465 | None                                                                                      |
 | 179 | AT3G10710  | PME24     | Putative pectinesterase/pectinesterase inhibitor 24                                       |
 | 180 | AT4G04700  | CPK27     | Calcium-dependent protein kinase 27                                                       |
 | 181 | AT1G44446  | CAO       | CH1                                                                                       |
 | 182 | AT4G01870  | AT4G01870 | tolB protein-related                                                                      |
 | 183 | AT2G29720  | CTF2B     | FAD/NAD(P)-binding oxidoreductase family protein                                          |
 | 184 | AT2G38210  | PDX1L4    | Pyridoxal 5'-phosphate synthase PDX1-like 4                                               |
 | 185 | AT3G46280  | AT3G46280 | Kinase-like protein                                                                       |
 | 186 | AT2G07698  | AT2G07698 | ATPase, F1 complex, alpha subunit protein                                                 |
 | 187 | AT1G14480  | AT1G14480 | Ankyrin repeat family protein                                                             |
 | 188 | AT4G22510  | AT4G22510 | unknown protein                                                                           |
 | 189 | AT3G54890  | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                            |
 | 190 | AT4G26800  | AT4G26800 | Pentatricopeptide repeat-containing protein At4g26800                                     |
 | 191 | AT4G19520  | AT4G19520 | Probable disease resistance protein At4g19520                                             |
 | 192 | AT5G27490  | AT5G27490 | Protein YIPF                                                                              |
 | 193 | AT5G66000  | AT5G66000 | Uncharacterized protein At5g66000                                                         |
 | 194 | AT2G38580  | AT2G38580 | Mitochondrial ATP synthase D chain-related protein                                        |
 | 195 | AT5G50790  | SWEET10   | Bidirectional sugar transporter SWEET10                                                   |
 | 196 | AT3G54200  | AT3G54200 | Late embryogenesis abundant (LEA) hydroxyproline-rich glycoprotein family                 |
 | 197 | AT2G46440  | CNGC11    | Cyclic nucleotide-gated ion channel 11                                                    |
 | 198 | ATCG00760  | RPL36     | 50S ribosomal protein L36, chloroplastic                                                  |
 | 199 | AT5G16800  | AT5G16800 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                                     |
 | 200 | AT3G63255  | AT3G63255 | None                                                                                      |
 | 201 | AT2G22860  | PSK2      | Phytosulfokines 2                                                                         |
 | 202 | AT3G05200  | ATL6      | E3 ubiquitin-protein ligase ATL6                                                          |
 | 203 | AT5G56870  | BGAL4     | Beta-galactosidase 4                                                                      |
 | 204 | AT4G30570  | AT4G30570 | Probable mannose-1-phosphate guanylyltransferase 3                                        |
 | 205 | AT2G46750  | GULLO2    | L-gulonolactone oxidase 2                                                                 |
 | 206 | AT4G33050  | EDA39     | calmodulin-binding family protein                                                         |
 | 207 | AT1G72280  | AERO1     | Like disulfide bond formation protein                                                     |
 | 208 | AT1G63350  | AT1G63350 | Disease resistance protein (CC-NBS-LRR class) family                                      |
 | 209 | AT4G17490  | ERF6      | Ethylene-responsive transcription factor 6                                                |
 | 210 | AT5G65207  | AT5G65207 | Uncharacterized protein At5g65207                                                         |
 | 211 | AT5G06730  | PER54     | Peroxidase 54                                                                             |
 | 212 | AT5G48657  | AT5G48657 | defense protein-related                                                                   |
 | 213 | AT3G21780  | UGT71B6   | UDP-glycosyltransferase 71B6                                                              |
 | 214 | AT5G46500  | AT5G46500 | Protein VARIATION IN COMPOUND TRIGGERED ROOT growth protein                               |
 | 215 | AT4G38840  | AT4G38840 | At4g38840                                                                                 |
 | 216 | AT4G35180  | LHT7      | Lysine histidine transporter-like 7                                                       |
 | 217 | AT1G17345  | SAUR77    | Auxin-responsive protein SAUR77                                                           |
 | 218 | AT1G56430  | NAS4      | Probable nicotianamine synthase 4                                                         |
 | 219 | AT4G35110  | AT4G35110 | Phospholipase-like protein (PEARLI 4) family protein                                      |
 | 220 | AT5G28630  | AT5G28630 | Glycine-rich protein                                                                      |
 | 221 | AT4G35770  | STR15     | SEN1                                                                                      |
 | 222 | AT3G21230  | 4CL4      | 4-coumarate--CoA ligase 4                                                                 |
 | 223 | AT1G26761  | AT1G26761 | Arabinanase/levansucrase/invertase                                                        |
 | 224 | AT2G19210  | AT2G19210 | Putative leucine-rich repeat receptor-like protein kinase At2g19210                       |
 | 225 | AT3G55980  | SZF1      | Salt-inducible zinc finger 1                                                              |
 | 226 | AT3G61280  | AT3G61280 | Glycosyltransferase                                                                       |
 | 227 | AT3G56260  | AT3G56260 | At3g56260                                                                                 |
 | 228 | AT4G01970  | AtSTS     | stachyose synthase                                                                        |
 | 229 | AT1G51890  | AT1G51890 | Leucine-rich repeat protein kinase family protein                                         |
 | 230 | AT5G42380  | CML37     | Calcium-binding protein CML37                                                             |
 | 231 | AT2G23210  | AT2G23210 | UDP-Glycosyltransferase superfamily protein                                               |
 | 232 | AT3G04210  | AT3G04210 | At3g04210/T6K12_17                                                                        |
 | 233 | AT5G65860  | AT5G65860 | Ankyrin repeat family protein                                                             |
 | 234 | AT4G19230  | CYP707A1  | Cytochrome P450, family 707, subfamily A, polypeptide 1                                   |
 | 235 | AT1G74930  | ERF018    | Ethylene-responsive transcription factor ERF018                                           |
 | 236 | AT4G04540  | CRK39     | Putative cysteine-rich receptor-like protein kinase 39                                    |
 | 237 | AT5G40000  | AT5G40000 | AAA-ATPase At5g40000                                                                      |
 | 238 | AT1G17610  | CHS1      | Disease resistance protein CHS1                                                           |
 | 239 | AT4G24110  | AT4G24110 | NADP-specific glutamate dehydrogenase                                                     |
 | 240 | AT1G25560  | TEM1      | AP2/ERF and B3 domain-containing transcription repressor TEM1                             |
 | 241 | AT1G70175  | AT1G70175 | None                                                                                      |
 | 242 | AT1G68570  | NPF3.1    | Protein NRT1/ PTR FAMILY 3.1                                                              |
 | 243 | AT2G23120  | AT2G23120 | Expressed protein                                                                         |
 | 244 | AT5G54569  | AT5G54569 | other RNA                                                                                 |
 | 245 | AT3G15740  | AT3G15740 | RING/U-box superfamily protein                                                            |
 | 246 | AT1G72645  | AT1G72645 | At1g72645                                                                                 |
 | 247 | AT1G51660  | MKK4      | MKK4                                                                                      |
 | 248 | AT3G62680  | PRP3      | Proline-rich protein 3                                                                    |
 | 249 | AT1G14870  | PCR2      | PCR2                                                                                      |
 :END:


**** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('6h' in c and 'cer' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=20000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [181]:
 # text/org
 | gene      |   importance | name      | description                                                                               |
 |-----------+--------------+-----------+-------------------------------------------------------------------------------------------|
 | AT1G61610 |      0.00575 | AT1G61610 | Serine/threonine-protein kinase                                                           |
 | AT3G54200 |      0.0056  | AT3G54200 | Late embryogenesis abundant (LEA) hydroxyproline-rich glycoprotein family                 |
 | AT1G66500 |      0.0054  | PCFS1     | Polyadenylation and cleavage factor homolog 1                                             |
 | AT1G73805 |      0.00535 | SARD1     | Protein SAR DEFICIENT 1                                                                   |
 | AT1G70190 |      0.00525 | AT1G70190 | F20P5.9 protein                                                                           |
 | AT5G66000 |      0.00515 | AT5G66000 | Uncharacterized protein At5g66000                                                         |
 | AT3G02130 |      0.0051  | RPK2      | LRR receptor-like serine/threonine-protein kinase RPK2                                    |
 | AT4G01870 |      0.0051  | AT4G01870 | tolB protein-related                                                                      |
 | AT1G36640 |      0.0051  | AT1G36640 | Transmembrane protein                                                                     |
 | AT3G08870 |      0.005   | AT3G08870 | Concanavalin A-like lectin protein kinase family protein                                  |
 | AT4G24110 |      0.005   | AT4G24110 | NADP-specific glutamate dehydrogenase                                                     |
 | AT5G46500 |      0.00495 | AT5G46500 | Protein VARIATION IN COMPOUND TRIGGERED ROOT growth protein                               |
 | AT2G37100 |      0.00495 | AT2G37100 | Protamine P1 family protein                                                               |
 | AT4G22485 |      0.0049  | AT4G22485 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | AT3G25790 |      0.00485 | HHO1      | Transcription factor HHO1                                                                 |
 | AT4G17500 |      0.00485 | ERF1A     | Ethylene-responsive transcription factor 1A                                               |
 | AT1G29460 |      0.00485 | AT1G29460 | SAUR-like auxin-responsive protein family                                                 |
 | AT4G11660 |      0.00485 | HSFB2B    | Heat stress transcription factor B-2b                                                     |
 | AT4G23700 |      0.00485 | CHX17     | Cation/H(+) antiporter 17                                                                 |
 | AT1G08630 |      0.00485 | THA1      | Probable low-specificity L-threonine aldolase 1                                           |
 | AT1G33760 |      0.00485 | ERF022    | Ethylene-responsive transcription factor ERF022                                           |
 | AT3G63255 |      0.00485 | AT3G63255 | None                                                                                      |
 | AT5G21900 |      0.00485 | AT5G21900 | At5g21900                                                                                 |
 | AT2G20142 |      0.0048  | AT2G20142 | Toll-Interleukin-Resistance (TIR) domain family protein                                   |
 | AT4G35110 |      0.0048  | AT4G35110 | Phospholipase-like protein (PEARLI 4) family protein                                      |
 | AT4G01390 |      0.0048  | AT4G01390 | TRAF-like family protein                                                                  |
 | AT2G19190 |      0.0048  | SIRK      | Senescence-induced receptor-like serine/threonine-protein kinase                          |
 | ATCG00760 |      0.0048  | RPL36     | 50S ribosomal protein L36, chloroplastic                                                  |
 | AT1G35710 |      0.00475 | AT1G35710 | Probable leucine-rich repeat receptor-like protein kinase At1g35710                       |
 | AT1G62610 |      0.00475 | AT1G62610 | NAD(P)-binding Rossmann-fold superfamily protein                                          |
 | AT5G27830 |      0.00475 | AT5G27830 | FUNCTIONS IN: molecular_function unknown                                                  |
 | AT1G56430 |      0.00475 | NAS4      | Probable nicotianamine synthase 4                                                         |
 | AT4G19520 |      0.00475 | AT4G19520 | Probable disease resistance protein At4g19520                                             |
 | AT5G57560 |      0.00475 | XTH22     | Xyloglucan endotransglucosylase/hydrolase                                                 |
 | AT3G43580 |      0.0047  | AT3G43580 | At3g43580                                                                                 |
 | AT2G46600 |      0.0047  | KIC       | Calcium-binding protein KIC                                                               |
 | AT1G70175 |      0.0047  | AT1G70175 | None                                                                                      |
 | AT4G38840 |      0.0047  | AT4G38840 | At4g38840                                                                                 |
 | AT3G49620 |      0.0047  | DIN11     | Probable 2-oxoglutarate-dependent dioxygenase DIN11                                       |
 | AT4G35180 |      0.00465 | LHT7      | Lysine histidine transporter-like 7                                                       |
 | AT4G13820 |      0.00465 | AT4G13820 | Disease resistance like protein                                                           |
 | AT4G01970 |      0.00465 | AtSTS     | stachyose synthase                                                                        |
 | AT5G26340 |      0.00465 | STP13     | STP13                                                                                     |
 | AT1G67856 |      0.00465 | AT1G67856 | RING/U-box superfamily protein                                                            |
 | AT5G59070 |      0.00465 | AT5G59070 | UDP-Glycosyltransferase superfamily protein                                               |
 | AT5G10650 |      0.00465 | AT5G10650 | At5g10650                                                                                 |
 | AT1G17610 |      0.00465 | CHS1      | Disease resistance protein CHS1                                                           |
 | AT3G01175 |      0.0046  | AT3G01175 | Transmembrane protein                                                                     |
 | AT1G14480 |      0.0046  | AT1G14480 | Ankyrin repeat family protein                                                             |
 | AT5G45240 |      0.0046  | AT5G45240 | Disease resistance protein (TIR-NBS-LRR class)                                            |
 | AT5G54569 |      0.0046  | AT5G54569 | other RNA                                                                                 |
 | AT4G23670 |      0.0046  | AT4G23670 | AT4G23670 protein                                                                         |
 | AT2G15220 |      0.00455 | AT2G15220 | At2g15220/F15A23.4                                                                        |
 | AT4G14450 |      0.00455 | AT4G14450 | Uncharacterized protein At4g14450, chloroplastic                                          |
 | AT2G45480 |      0.0045  | GRF9      | Growth-regulating factor 9                                                                |
 | AT2G19210 |      0.0045  | AT2G19210 | Putative leucine-rich repeat receptor-like protein kinase At2g19210                       |
 | AT4G26800 |      0.0045  | AT4G26800 | Pentatricopeptide repeat-containing protein At4g26800                                     |
 | AT5G48657 |      0.0045  | AT5G48657 | defense protein-related                                                                   |
 | AT4G14860 |      0.0045  | OFP11     | Transcription repressor OFP11                                                             |
 | AT4G21903 |      0.0045  | AT4G21903 | Protein DETOXIFICATION                                                                    |
 | AT3G50800 |      0.0045  | AT3G50800 | Uncharacterized protein At3g50800                                                         |
 | AT3G11080 |      0.0045  | AtRLP35   | Receptor-like protein 35                                                                  |
 | AT5G57345 |      0.0045  | AT5G57345 | At5g57345                                                                                 |
 | AT3G55980 |      0.0045  | SZF1      | Salt-inducible zinc finger 1                                                              |
 | AT4G35070 |      0.0045  | AT4G35070 | At4g35070                                                                                 |
 | AT1G26761 |      0.00445 | AT1G26761 | Arabinanase/levansucrase/invertase                                                        |
 | AT5G43180 |      0.00445 | AT5G43180 | At5g43180                                                                                 |
 | AT5G51670 |      0.00445 | AT5G51670 | Similarity to unknown protein                                                             |
 | AT2G23120 |      0.00445 | AT2G23120 | Expressed protein                                                                         |
 | AT5G57540 |      0.00445 | XTH13     | Putative xyloglucan endotransglucosylase/hydrolase protein 13                             |
 | AT1G78460 |      0.0044  | AT1G78460 | AT1G78460 protein                                                                         |
 | AT4G13180 |      0.0044  | AT4G13180 | AT4g13180/F17N18_70                                                                       |
 | AT2G23210 |      0.0044  | AT2G23210 | UDP-Glycosyltransferase superfamily protein                                               |
 | AT5G46570 |      0.0044  | BSK2      | Serine/threonine-protein kinase BSK2                                                      |
 | AT1G20870 |      0.00435 | IDM3      | Increased DNA methylation 3                                                               |
 | AT4G33220 |      0.00435 | PME44     | Probable pectinesterase/pectinesterase inhibitor 44                                       |
 | AT3G22886 |      0.00435 | MIR167A   | MIR167A                                                                                   |
 | AT5G19890 |      0.00435 | PER59     | Peroxidase 59                                                                             |
 | AT1G12780 |      0.00435 | UGE1      | Bifunctional UDP-glucose 4-epimerase and UDP-xylose 4-epimerase 1                         |
 | AT1G50750 |      0.00435 | AT1G50750 | Plant mobile domain protein family                                                        |
 | AT1G07530 |      0.00435 | SCL14     | AT1G07530 protein                                                                         |
 | AT3G13650 |      0.00435 | DIR7      | Dirigent protein 7                                                                        |
 | AT5G65860 |      0.00435 | AT5G65860 | Ankyrin repeat family protein                                                             |
 | AT5G03830 |      0.0043  | AT5G03830 | CDK inhibitor P21 binding protein                                                         |
 | AT5G40000 |      0.0043  | AT5G40000 | AAA-ATPase At5g40000                                                                      |
 | AT1G62500 |      0.0043  | AT1G62500 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | AT3G05200 |      0.0043  | ATL6      | E3 ubiquitin-protein ligase ATL6                                                          |
 | AT3G48450 |      0.0043  | AT3G48450 | At3g48450                                                                                 |
 | AT1G07135 |      0.00425 | AT1G07135 | At1g07135                                                                                 |
 | AT1G55420 |      0.00425 | EDA11     | Cysteine/Histidine-rich C1 domain family protein                                          |
 | AT1G19330 |      0.00425 | AT1G19330 | unknown protein                                                                           |
 | AT3G46090 |      0.00425 | ZAT7      | ZAT7                                                                                      |
 | AT3G29170 |      0.0042  | AT3G29170 | At3g29170                                                                                 |
 | AT1G27370 |      0.0042  | SPL10     | Squamosa promoter-binding-like protein 10                                                 |
 | AT3G28740 |      0.0042  | CYP81D11  | Cytochrome P450 81D11                                                                     |
 | AT3G60415 |      0.0042  | AT3G60415 | At3g60420                                                                                 |
 | AT2G29720 |      0.0042  | CTF2B     | FAD/NAD(P)-binding oxidoreductase family protein                                          |
 | AT5G42380 |      0.0042  | CML37     | Calcium-binding protein CML37                                                             |
 | AT3G46930 |      0.0042  | AT3G46930 | Protein kinase superfamily protein                                                        |
 | AT2G38580 |      0.0042  | AT2G38580 | Mitochondrial ATP synthase D chain-related protein                                        |
 | AT5G44578 |      0.0042  | AT5G44578 | unknown protein                                                                           |
 | AT5G41740 |      0.00415 | AT5G41740 | Disease resistance protein (TIR-NBS-LRR class) family                                     |
 | AT5G43160 |      0.00415 | QWRF9     | Family of unknown function (DUF566)                                                       |
 | AT4G28490 |      0.00415 | RLK5      | Receptor-like protein kinase 5                                                            |
 | AT2G39980 |      0.00415 | AT2G39980 | At2g39980/T28M21.14                                                                       |
 | AT5G58620 |      0.00415 | AT5G58620 | Zinc finger CCCH domain-containing protein 66                                             |
 | AT3G55090 |      0.00415 | ABCG16    | ABC transporter G family member 16                                                        |
 | AT1G22890 |      0.00415 | AT1G22890 | AT1G22890 protein                                                                         |
 | AT5G10520 |      0.00415 | RBK1      | RBK1                                                                                      |
 | AT2G46440 |      0.00415 | CNGC11    | Cyclic nucleotide-gated ion channel 11                                                    |
 | AT3G28580 |      0.00415 | AT3G28580 | AAA-ATPase At3g28580                                                                      |
 | AT1G05675 |      0.00415 | UGT74E1   | Glycosyltransferase (Fragment)                                                            |
 | AT2G21210 |      0.0041  | AT2G21210 | SAUR-like auxin-responsive protein family                                                 |
 | AT1G68570 |      0.0041  | NPF3.1    | Protein NRT1/ PTR FAMILY 3.1                                                              |
 | AT5G43790 |      0.0041  | PCMP-E30  | Pentatricopeptide repeat-containing protein At5g43790                                     |
 | AT1G72910 |      0.0041  | AT1G72910 | Similar to part of disease resistance protein                                             |
 | AT4G21380 |      0.0041  | SD18      | Receptor-like serine/threonine-protein kinase SD1-8                                       |
 | AT3G01840 |      0.0041  | LYK2      | Protein LYK2                                                                              |
 | AT5G65410 |      0.0041  | ZHD1      | Zinc-finger homeodomain protein 1                                                         |
 | AT2G26560 |      0.0041  | PLP2      | Patatin-like protein 2                                                                    |
 | AT5G11680 |      0.0041  | AT5G11680 | Classical AGP protein                                                                     |
 | AT1G25560 |      0.0041  | TEM1      | AP2/ERF and B3 domain-containing transcription repressor TEM1                             |
 | AT2G28630 |      0.0041  | KCS12     | 3-ketoacyl-CoA synthase 12                                                                |
 | AT4G33050 |      0.0041  | EDA39     | calmodulin-binding family protein                                                         |
 | AT5G50790 |      0.0041  | SWEET10   | Bidirectional sugar transporter SWEET10                                                   |
 | AT1G02310 |      0.0041  | MAN1      | MAN1                                                                                      |
 | AT2G07698 |      0.00405 | AT2G07698 | ATPase, F1 complex, alpha subunit protein                                                 |
 | AT4G04540 |      0.00405 | CRK39     | Putative cysteine-rich receptor-like protein kinase 39                                    |
 | AT5G40170 |      0.00405 | AtRLP54   | Receptor-like protein 54                                                                  |
 | AT2G02990 |      0.00405 | RNS1      | Ribonuclease 1                                                                            |
 | AT2G38530 |      0.00405 | LTP2      | Non-specific lipid-transfer protein                                                       |
 | AT5G65207 |      0.00405 | AT5G65207 | Uncharacterized protein At5g65207                                                         |
 | AT4G04700 |      0.00405 | CPK27     | Calcium-dependent protein kinase 27                                                       |
 | AT3G18950 |      0.00405 | AT3G18950 | En/Spm-like transposon protein-like                                                       |
 | AT2G41231 |      0.004   | AT2G41231 | unknown protein.                                                                          |
 | AT5G48880 |      0.004   | KAT5      | PKT2                                                                                      |
 | AT2G47800 |      0.004   | ABCC4     | ABC transporter C family member 4                                                         |
 | AT4G23030 |      0.004   | DTX49     | Protein DETOXIFICATION 49                                                                 |
 | AT1G77640 |      0.004   | ERF013    | Ethylene-responsive transcription factor ERF013                                           |
 | AT1G44446 |      0.004   | CAO       | CH1                                                                                       |
 | AT4G11890 |      0.00395 | AT4G11890 | Protein kinase superfamily protein                                                        |
 | AT4G26560 |      0.00395 | CBL7      | Calcineurin B-like protein 7                                                              |
 | AT2G35980 |      0.00395 | NHL10     | NDR1/HIN1-like protein 10                                                                 |
 | AT1G75240 |      0.00395 | ZHD5      | ZHD5                                                                                      |
 | AT1G72280 |      0.00395 | AERO1     | Like disulfide bond formation protein                                                     |
 | AT2G22980 |      0.00395 | SCPL13    | Serine carboxypeptidase-like 13                                                           |
 | AT1G14170 |      0.0039  | AT1G14170 | F7A19.25 protein                                                                          |
 | AT1G72900 |      0.0039  | AT1G72900 | Similar to part of disease resistance protein                                             |
 | AT5G25250 |      0.0039  | FLOT1     | Flotillin-like protein 1                                                                  |
 | AT4G03600 |      0.00385 | AT4G03600 | Pyrroline-5-carboxylate reductase                                                         |
 | AT5G28630 |      0.00385 | AT5G28630 | Glycine-rich protein                                                                      |
 | AT2G36790 |      0.00385 | UGT73C6   | Glycosyltransferase (Fragment)                                                            |
 | AT4G24810 |      0.00385 | AT4G24810 | Protein kinase superfamily protein                                                        |
 | AT5G45340 |      0.0038  | CYP707A3  | Abscisic acid 8'-hydroxylase 3                                                            |
 | AT5G38930 |      0.0038  | AT5G38930 | Germin-like protein subfamily 1 member 10                                                 |
 | AT2G21050 |      0.0038  | LAX2      | Auxin transporter-like protein 2                                                          |
 | AT5G27490 |      0.0038  | AT5G27490 | Protein YIPF                                                                              |
 | AT5G16170 |      0.0038  | AT5G16170 | At5g16170                                                                                 |
 | AT5G61570 |      0.00375 | AT5G61570 | Protein kinase superfamily protein                                                        |
 | AT3G53150 |      0.00375 | UGT73D1   | UDP-glucosyl transferase 73D1                                                             |
 | AT1G51850 |      0.00375 | AT1G51850 | Leucine-rich repeat protein kinase family protein                                         |
 | AT3G15740 |      0.00375 | AT3G15740 | RING/U-box superfamily protein                                                            |
 | AT4G19230 |      0.00375 | CYP707A1  | Cytochrome P450, family 707, subfamily A, polypeptide 1                                   |
 | AT3G62680 |      0.0037  | PRP3      | Proline-rich protein 3                                                                    |
 | AT4G08950 |      0.0036  | EXO       | Protein EXORDIUM                                                                          |
 | AT3G23120 |      0.0036  | AtRLP38   | Receptor-like protein 38                                                                  |
 | AT2G02880 |      0.0036  | AT2G02880 | Mucin-like protein                                                                        |
 | AT2G35640 |      0.00355 | AT2G35640 | Homeodomain-like superfamily protein                                                      |
 | AT1G72645 |      0.00355 | AT1G72645 | At1g72645                                                                                 |
 | AT4G22080 |      0.00355 | RHS14     | Probable pectate lyase 16                                                                 |
 | AT1G15010 |      0.0035  | AT1G15010 | Mediator of RNA polymerase II transcription subunit                                       |
 | AT2G38210 |      0.00345 | PDX1L4    | Pyridoxal 5'-phosphate synthase PDX1-like 4                                               |
 | AT1G15100 |      0.0034  | RHA2A     | E3 ubiquitin-protein ligase RHA2A                                                         |
 | AT4G11000 |      0.0033  | AT4G11000 | Ankyrin repeat family protein                                                             |
 | AT5G40400 |      0.00325 | AT5G40400 | Pentatricopeptide repeat (PPR) superfamily protein                                        |
 | AT1G17345 |      0.0032  | SAUR77    | Auxin-responsive protein SAUR77                                                           |
 | AT5G06730 |      0.0031  | PER54     | Peroxidase 54                                                                             |
 | AT4G22475 |      0.00295 | AT4G22475 | Transmembrane protein                                                                     |
 | AT4G22495 |      0.0029  | AT4G22495 | None                                                                                      |
 | AT1G63350 |      0.0028  | AT1G63350 | Disease resistance protein (CC-NBS-LRR class) family                                      |
 | AT2G42840 |      0.0027  | PDF1      | Protodermal factor 1                                                                      |
 | AT2G24850 |      0.0027  | TAT3      | Probable aminotransferase TAT3                                                            |
 | AT1G55020 |      0.0027  | LOX1      | Linoleate 9S-lipoxygenase 1                                                               |
 | AT1G74930 |      0.0027  | ERF018    | Ethylene-responsive transcription factor ERF018                                           |
 | AT1G24147 |      0.00265 | AT1G24147 | Transmembrane protein                                                                     |
 | AT1G76680 |      0.0026  | OPR1      | 12-oxophytodienoate reductase 1                                                           |
 | AT1G23550 |      0.0026  | SRO2      | Probable inactive poly                                                                    |
 | AT4G17490 |      0.0026  | ERF6      | Ethylene-responsive transcription factor 6                                                |
 | AT3G46280 |      0.0026  | AT3G46280 | Kinase-like protein                                                                       |
 | AT1G21100 |      0.00255 | IGMT1     | Indole glucosinolate O-methyltransferase 1                                                |
 | AT4G35770 |      0.00255 | STR15     | SEN1                                                                                      |
 | AT5G42800 |      0.00255 | DFRA      | Dihydroflavonol reductase                                                                 |
 | AT3G16400 |      0.00255 | NSP1      | Nitrile-specifier protein 1                                                               |
 | AT1G13530 |      0.00245 | AT1G13530 | Protein of unknown function (DUF1262)                                                     |
 | AT1G66090 |      0.00245 | AT1G66090 | Disease resistance protein (TIR-NBS class)                                                |
 | AT1G29500 |      0.0024  | SAUR66    | Auxin-responsive protein SAUR66                                                           |
 | AT4G23210 |      0.0024  | CRK13     | Cysteine-rich receptor-like protein kinase 13                                             |
 | AT1G51660 |      0.00235 | MKK4      | MKK4                                                                                      |
 | AT1G59860 |      0.00235 | HSP17.6A  | 17.6 kDa class I heat shock protein 1                                                     |
 | AT1G54970 |      0.00235 | PRP1      | Proline-rich protein 1                                                                    |
 | AT5G51465 |      0.00225 | AT5G51465 | None                                                                                      |
 | AT1G13520 |      0.00225 | AT1G13520 | At1g13520                                                                                 |
 | AT5G20670 |      0.00225 | AT5G20670 | At5g20670                                                                                 |
 | AT4G31875 |      0.00225 | AT4G31875 | At4g31872/At4g31872                                                                       |
 | AT3G19850 |      0.0022  | AT3G19850 | BTB/POZ domain-containing protein At3g19850                                               |
 | AT3G61280 |      0.0022  | AT3G61280 | Glycosyltransferase                                                                       |
 | AT2G46750 |      0.0022  | GULLO2    | L-gulonolactone oxidase 2                                                                 |
 | AT3G51570 |      0.00215 | AT3G51570 | Disease resistance protein (TIR-NBS-LRR class) family                                     |
 | AT4G27980 |      0.00215 | AT4G27980 | Domain of unknown function (DUF3444)                                                      |
 | AT3G04210 |      0.00215 | AT3G04210 | At3g04210/T6K12_17                                                                        |
 | AT3G10710 |      0.00215 | PME24     | Putative pectinesterase/pectinesterase inhibitor 24                                       |
 | AT1G71030 |      0.0021  | ATMYBL2   | At1g71030/F23N20_2                                                                        |
 | AT2G22790 |      0.0021  | AT2G22790 | Uncharacterized protein At2g22790                                                         |
 | AT1G51270 |      0.0021  | AT1G51270 | Vesicle-associated protein 1-4                                                            |
 | AT3G44860 |      0.0021  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase                                               |
 | AT5G65500 |      0.00205 | AT5G65500 | U-box domain-containing protein kinase family protein                                     |
 | AT3G22600 |      0.00205 | AT3G22600 | AT3g22600/F16J14_17                                                                       |
 | AT4G30570 |      0.00205 | AT4G30570 | Probable mannose-1-phosphate guanylyltransferase 3                                        |
 | AT5G16800 |      0.00205 | AT5G16800 | Acyl-CoA N-acyltransferases (NAT) superfamily protein                                     |
 | AT5G60800 |      0.00205 | AT5G60800 | Heavy metal transport/detoxification superfamily protein                                  |
 | AT1G69790 |      0.002   | PBL18     | Probable serine/threonine-protein kinase PBL18                                            |
 | AT5G52670 |      0.002   | AT5G52670 | Copper transport protein family                                                           |
 | AT1G51860 |      0.00195 | AT1G51860 | Probable LRR receptor-like serine/threonine-protein kinase At1g51860                      |
 | AT2G22860 |      0.00185 | PSK2      | Phytosulfokines 2                                                                         |
 | AT3G21230 |      0.00185 | 4CL4      | 4-coumarate--CoA ligase 4                                                                 |
 | AT1G72240 |      0.0018  | AT1G72240 | Uncharacterized protein T9N14.5                                                           |
 | AT1G14870 |      0.0018  | PCR2      | PCR2                                                                                      |
 | AT3G56260 |      0.0018  | AT3G56260 | At3g56260                                                                                 |
 | AT3G54890 |      0.0018  | LHCA1     | Chlorophyll a-b binding protein, chloroplastic                                            |
 | AT4G05910 |      0.00175 | AT4G05910 | None                                                                                      |
 | AT1G31050 |      0.00175 | AT1G31050 | basic helix-loop-helix (bHLH) DNA-binding superfamily protein                             |
 | AT1G61860 |      0.0017  | AT1G61860 | Protein kinase superfamily protein                                                        |
 | AT4G22490 |      0.00165 | AT4G22490 | Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin superfamily protein |
 | AT3G52060 |      0.00165 | AT3G52060 | GnTL                                                                                      |
 | AT5G05300 |      0.0016  | AT5G05300 | Gb                                                                                        |
 | AT2G25460 |      0.00155 | AT2G25460 | CONTAINS InterPro DOMAIN/s: C2 calcium-dependent membrane targeting (InterPro:IPR000008)  |
 | AT5G56870 |      0.00155 | BGAL4     | Beta-galactosidase 4                                                                      |
 | AT4G39830 |      0.0015  | AT4G39830 | At4g39830                                                                                 |
 | AT1G22500 |      0.0015  | ATL15     | E3 ubiquitin-protein ligase ATL15                                                         |
 | AT2G32660 |      0.0015  | AtRLP22   | Receptor like protein 22                                                                  |
 | AT3G47090 |      0.0015  | AT3G47090 | Leucine-rich repeat protein kinase family protein                                         |
 | AT5G49360 |      0.00145 | BXL1      | Beta-D-xylosidase 1                                                                       |
 | AT1G51890 |      0.00145 | AT1G51890 | Leucine-rich repeat protein kinase family protein                                         |
 | AT3G21780 |      0.00145 | UGT71B6   | UDP-glycosyltransferase 71B6                                                              |
 | AT1G67855 |      0.0014  | AT1G67855 | unknown protein                                                                           |
 | AT3G29400 |      0.0013  | ATEXO70E1 | Exocyst subunit Exo70 family protein                                                      |
 | AT4G23680 |      0.00125 | AT4G23680 | AT4g23680/F9D16_150                                                                       |
 | AT4G33720 |      0.0012  | AT4G33720 | AT4g33720/T16L1_210                                                                       |
 | AT4G22510 |      0.0012  | AT4G22510 | unknown protein                                                                           |
 | AT2G25125 |      0.0012  | AT2G25125 | None                                                                                      |
 :END:

 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(2,1, figsize=(20,40), sharex=True)
 res_df=res_df.sort_values(by='importance', ascending=False)
 size = len(res_df)
 sns.barplot(data=res_df.reset_index().iloc[:int(size/2)], y='description', x='importance', ax=ax[0])
 sns.barplot(data=res_df.reset_index().iloc[int(size/2):], y='description', x='importance', ax=ax[1])
 fig.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [182]:
 # text/plain
 : <Figure size 1440x2880 with 2 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/703f60afdc6ffbfb23a6c0113ee865a2ebf33ef0.png]]
 :END:


* Selecting genes for all genotypes at all times C/W
** RFE selecting 25 genes
 #+BEGIN_SRC ipython :session :tangle recursive_feature.py
   from sklearn.feature_selection import RFE, RFECV
   from sklearn.linear_model import LogisticRegression

   # load data
   DE_pairings_05hr = read_xl('/Users/hughesn/PHD/Transcripts/Data/pairings_05hr.xlsx')
   sig = DE_pairings_05hr[DE_pairings_05hr['padj'] < 0.01]
   sig = sig['log2FoldChange'].sort_values()
   locs = sig.index
   df = counts.loc[locs][[c for c in counts.columns if (('col' in c or 'lym' in c or 'cer' in c))]].T
   df = df.loc[:,~df.columns.duplicated()]
   df = df[[c for c in set(df.columns.values)]]
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [183]:
 :END:


 #+BEGIN_SRC ipython :session  :tangle recursive_feature.py
   # Feature Extraction with RFE
   X = df.values
   y = [y.rsplit('_',1)[0] for y in df.reset_index()['index']]
   # feature extraction
   model = LogisticRegression()
   rfe = RFE(model, n_features_to_select=25)
   fit = rfe.fit(X, y)
   print("Num Features: {0}".format(fit.n_features_))
   print("Selected Features: {0}".format(fit.support_))
   print("Feature Ranking: {0}".format(fit.ranking_))
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [184]:
 # output
 Num Features: 25
 Selected Features: [False False False ... False False False]
 Feature Ranking: [ 821 2397 3365 ...  912  633 1129]

 :END:


 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
   genes = []
   for r,f in zip(fit.ranking_, df.columns.values):
         if r ==1:
               genes.append(f)
   get_gene_names(genes)
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [185]:
 # text/org
 |    | incoming   | name      | description                                   |
 |----+------------+-----------+-----------------------------------------------|
 |  0 | AT3G06355  | AT3G06355 | None                                          |
 |  1 | AT4G29780  | AT4G29780 | Nuclease                                      |
 |  2 | AT1G62730  | AT1G62730 | At1g62730                                     |
 |  3 | AT1G26380  | FOX1      | Berberine bridge enzyme-like 3                |
 |  4 | AT1G62740  | HOP2      | Hsp70-Hsp90 organizing protein 2              |
 |  5 | AT5G24110  | WRKY30    | Probable WRKY transcription factor 30         |
 |  6 | AT5G63160  | BT1       | BTB/POZ and TAZ domain-containing protein 1   |
 |  7 | AT3G47420  | ATPS3     | Putative glycerol-3-phosphate transporter 1   |
 |  8 | AT3G28740  | CYP81D11  | Cytochrome P450 81D11                         |
 |  9 | AT4G08950  | EXO       | Protein EXORDIUM                              |
 | 10 | AT4G24570  | PUMP4     | DIC2                                          |
 | 11 | AT4G35180  | LHT7      | Lysine histidine transporter-like 7           |
 | 12 | AT5G20620  | UBQ4      | Polyubiquitin 4                               |
 | 13 | AT4G23680  | AT4G23680 | AT4g23680/F9D16_150                           |
 | 14 | AT1G24280  | G6PD3     | Glucose-6-phosphate 1-dehydrogenase           |
 | 15 | AT3G09440  | HSP70-3   | Heat shock protein 70 (Hsp 70) family protein |
 | 16 | AT3G50770  | CML41     | Probable calcium-binding protein CML41        |
 | 17 | AT1G02930  | GSTF6     | Glutathione S-transferase F6                  |
 | 18 | AT1G56660  | AT1G56660 | F25P12.91 protein                             |
 | 19 | AT1G26240  | AT1G26240 | Proline-rich extensin-like family protein     |
 | 20 | AT5G49360  | BXL1      | Beta-D-xylosidase 1                           |
 | 21 | AT3G44860  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase   |
 | 22 | AT4G24110  | AT4G24110 | NADP-specific glutamate dehydrogenase         |
 | 23 | AT2G17120  | LYM2      | LysM domain-containing GPI-anchored protein 2 |
 | 24 | AT5G21940  | AT5G21940 | At5g21940                                     |
 :END:


*** Forest on this RFE set

 #+BEGIN_SRC ipython :session :display text/org  :tangle recursive_feature.py
     rfe_forest = counts.loc[genes][[c for c in counts.columns if ('col' in c or 'lym' in c or 'cer' in c)]].T
     rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
     rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

     feat_labels = rfe_forest.columns.values
     y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

     X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
     forest = RandomForestClassifier(n_estimators=200000, random_state=1, n_jobs=-1)
     forest.fit(X_train, y_train)
     res = {k: v for k, v in sorted(
         zip(feat_labels, forest.feature_importances_), key=lambda x: x[1], reverse=True)}
     res_df = pd.DataFrame(list(res.items()), columns=[
                           'gene', 'importance']).set_index('gene')
     names = get_gene_names(list(res_df.index))
     res_df = pd.merge(res_df, names, left_index=True, right_on='incoming').rename(
         columns={'incoming': 'gene'}).set_index('gene').sort_values('importance', ascending=False)
     res_df
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [186]:
 # text/org
 | gene      |   importance | name      | description                                   |
 |-----------+--------------+-----------+-----------------------------------------------|
 | AT5G20620 |    0.0594945 | UBQ4      | Polyubiquitin 4                               |
 | AT4G08950 |    0.0537744 | EXO       | Protein EXORDIUM                              |
 | AT3G06355 |    0.0523862 | AT3G06355 | None                                          |
 | AT4G24110 |    0.0504935 | AT4G24110 | NADP-specific glutamate dehydrogenase         |
 | AT3G28740 |    0.0501161 | CYP81D11  | Cytochrome P450 81D11                         |
 | AT5G21940 |    0.0498109 | AT5G21940 | At5g21940                                     |
 | AT3G09440 |    0.0491729 | HSP70-3   | Heat shock protein 70 (Hsp 70) family protein |
 | AT1G02930 |    0.0476493 | GSTF6     | Glutathione S-transferase F6                  |
 | AT5G63160 |    0.0449373 | BT1       | BTB/POZ and TAZ domain-containing protein 1   |
 | AT1G24280 |    0.044786  | G6PD3     | Glucose-6-phosphate 1-dehydrogenase           |
 | AT2G17120 |    0.0421376 | LYM2      | LysM domain-containing GPI-anchored protein 2 |
 | AT3G50770 |    0.0421243 | CML41     | Probable calcium-binding protein CML41        |
 | AT5G49360 |    0.0420693 | BXL1      | Beta-D-xylosidase 1                           |
 | AT1G62740 |    0.0402053 | HOP2      | Hsp70-Hsp90 organizing protein 2              |
 | AT4G35180 |    0.0390995 | LHT7      | Lysine histidine transporter-like 7           |
 | AT4G29780 |    0.0351811 | AT4G29780 | Nuclease                                      |
 | AT3G47420 |    0.0334156 | ATPS3     | Putative glycerol-3-phosphate transporter 1   |
 | AT1G62730 |    0.0328065 | AT1G62730 | At1g62730                                     |
 | AT1G26380 |    0.0322609 | FOX1      | Berberine bridge enzyme-like 3                |
 | AT4G24570 |    0.0316438 | PUMP4     | DIC2                                          |
 | AT1G56660 |    0.0296291 | AT1G56660 | F25P12.91 protein                             |
 | AT1G26240 |    0.0285743 | AT1G26240 | Proline-rich extensin-like family protein     |
 | AT5G24110 |    0.0250461 | WRKY30    | Probable WRKY transcription factor 30         |
 | AT3G44860 |    0.022443  | FAMT      | Farnesoic acid carboxyl-O-methyltransferase   |
 | AT4G23680 |    0.0207426 | AT4G23680 | AT4g23680/F9D16_150                           |
 :END:


 #+BEGIN_SRC ipython :session
 fig, ax = plt.subplots(1, figsize=(20,20))
 sns.barplot(data=res_df.reset_index(), y='description', x='importance', ax=ax)
 plt.tight_layout()
 #+END_SRC

 #+RESULTS:
 :RESULTS:
 # Out [187]:
 # text/plain
 : <Figure size 1440x1440 with 1 Axes>

 # image/png
 [[file:obipy-resources/93e2fbf76ed477962282ae99767b8408de4d3ed9/65666fbca873a47968edcf553fd409812446c3ba.png]]
 :END:




**** C45 Decision tree

#+BEGIN_SRC ipython :session
from sklearn.tree import DecisionTreeClassifier
rfe_forest = counts.loc[genes][[c for c in counts.columns if ('col' in c or 'lym' in c or 'cer' in c)]].T
rfe_forest = rfe_forest.loc[:,~rfe_forest.columns.duplicated()]
rfe_forest = rfe_forest[[c for c in set(rfe_forest.columns.values)]]

feat_labels = rfe_forest.columns.values
y = [d.rsplit('_', 1)[0] for d in rfe_forest.index.values]

X_train, X_test, y_train, y_test = train_test_split(rfe_forest.values, y, test_size=1, random_state=42)
gnb = DecisionTreeClassifier()
gnb = gnb.fit(X_train, y_train)

# Export as dot file
export_graphviz(gnb, out_file='./tree.dot',
                feature_names = get_gene_names(list(feat_labels))['description'].values,
                class_names = list(set(y)),
                rounded = True, proportion = False,
                precision = 2, filled = True)
# Convert to png using system command (requires Graphviz)
from subprocess import call
_=call(['dot', '-Tpng', './tree.dot', '-o', './tree.png', '-Gdpi=50'])
print('[[./tree.png]]')

#+END_SRC

#+RESULTS:
:RESULTS:
# Out [188]:
# output

NameErrorTraceback (most recent call last)
<ipython-input-188-da840864ae98> in <module>
     12
     13 # Export as dot file
---> 14 export_graphviz(gnb, out_file='./tree.dot',
     15                 feature_names = get_gene_names(list(feat_labels))['description'].values,
     16                 class_names = list(set(y)),

NameError: name 'export_graphviz' is not defined
:END:
